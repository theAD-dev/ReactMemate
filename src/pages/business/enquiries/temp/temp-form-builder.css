.mf-builder{
  --bg:#f6f8fb;
  --panel:#ffffff;
  --border:#e6e8ee;
  --text:#1f2937;
  --muted:#6b7280;
  --brand:#2563eb;
  --brand-600:#1d4ed8;
  --brand-700:#1e40af;
  --ok:#10b981;
  --warn:#f59e0b;
  --danger:#ef4444;
  --shadow:0 6px 18px rgba(20, 40, 90, .08);
}

/* Page */
.mf-builder{background:var(--bg);}
.mf-builder .mf-container{margin:28px auto;padding:0 20px;font-family:system-ui, -apple-system, Segoe UI, Roboto, sans-serif;color:var(--text);}
.mf-builder header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.mf-builder header h1{font-size:22px;font-weight:700;margin:0}

/* 4-column layout */
.mf-builder .editor-container{display:grid;grid-template-columns:280px minmax(640px,1fr) 340px 340px;gap:18px;align-items:start}
.mf-builder .fields-panel,.mf-builder .editor-panel,.mf-builder .field-properties,.mf-builder .form-details{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
.mf-builder .fields-panel{position:sticky;top:16px}
.mf-builder .field-properties{position:sticky;top:16px;}
.mf-builder .form-details{position:sticky;top:16px;}
.mf-builder .editor-panel{min-height:520px}

/* Field palette */
.mf-builder .field-types{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
.mf-builder .field-type{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:18px 16px;
  border:1px solid var(--border);
  border-radius:14px;
  background:#fff;
  cursor:grab;
  box-shadow:var(--shadow);
  transition:transform .08s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
}
.mf-builder .field-type:hover{
  background:#f8fbff;
  border-color:#d9def1;
  box-shadow:0 10px 22px rgba(20,40,90,.10);
}
.mf-builder .field-type:active{cursor:grabbing;transform:scale(.98)}
.mf-builder .field-type .icon{display:inline-flex}
.mf-builder .field-type .icon svg{width:22px;height:22px}
.mf-builder .field-type span{
  font-weight:600;
  font-size:16px;
}

/* Preview area */
.mf-builder .form-preview h3{margin:0 0 10px}
.mf-builder #preview-container{min-height:520px;background:linear-gradient(#ffffff, #ffffff) padding-box, linear-gradient(135deg,#f0f3fb,#eef2ff) border-box;border:1px solid transparent;border-radius:12px;padding:16px}
.mf-builder #preview-container .empty-state{display:flex;flex-direction:column;align-items:center;gap:6px;color:var(--muted);padding:24px;border:1px dashed var(--border);border-radius:10px}
.mf-builder #preview-container.dragover{outline:2px dashed var(--brand);outline-offset:6px;background:rgba(37, 99, 235, .04)}

/* Individual preview field */
.mf-builder .preview-field{position:relative;border:1px solid var(--border);border-radius:10px;padding:16px;background:#fff;margin-bottom:12px}
.mf-builder .preview-field .form-field{margin:0}
.mf-builder .preview-field{padding-top:20px;}

/* Field action bar */
.mf-builder .field-actions{display:flex;gap:10px;position:absolute;right:14px;top:14px}
.mf-builder .field-actions button{width:28px;height:28px;display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--border);border-radius:8px;background:#f8fafc;color:#334155;cursor:pointer;transition:background .12s ease, border-color .12s ease, transform .05s;margin:0;}
.mf-builder .field-actions button:hover{background:#eef2ff;border-color:#c7d2fe}
.mf-builder .field-actions button:active{transform:translateY(1px)}

/* Form inputs + labels */
.mf-builder .form-field{margin-bottom:14px}
.mf-builder .form-field label{display:block;text-align: left;font-size:13px;font-weight:600;margin:0 0 6px}
.mf-builder .form-field input,.mf-builder .form-field select,.mf-builder .form-field textarea{width:100%;box-sizing:border-box;padding:10px 12px;border:1px solid #d6dae6;border-radius:10px;background:#fff;font-size:14px;color:var(--text);outline:none;transition:border-color .15s ease, box-shadow .15s ease}
.mf-builder .form-field input:focus,.mf-builder .form-field select:focus,.mf-builder .form-field textarea:focus{border-color:var(--brand);box-shadow:0 0 0 4px rgba(37,99,235,.1)}

.mf-builder .checkbox-field,.mf-builder .radio-field{display:flex;align-items:center;gap:10px}
.mf-builder .checkbox-field input,.mf-builder .radio-field input{width:16px;height:16px}

/* Right panels */
.mf-builder .field-properties h2,.mf-builder .form-details h2{margin-top:0}

/* Ensure Field Properties titles are left-aligned */
.mf-builder .field-properties h2,
.mf-builder .field-properties .property-group h3,
.mf-builder .field-properties label {
  text-align: left;
}
.mf-builder .property-group{border-top:1px solid var(--border);padding-top:12px;margin-top:12px}
.mf-builder .property-group h3{margin:0 0 8px;font-size:13px;color:var(--muted);text-transform:uppercase;letter-spacing:.02em}
.mf-builder .property-group label{display:block;margin-bottom:8px}
.mf-builder .property-group label.inline{
  display:inline-flex;
  align-items:center;
  gap:8px;
  margin-bottom:8px;
  justify-content:flex-start;
  text-align:left;
  width:auto;
}
.mf-builder .property-group input, .mf-builder .property-group textarea{width:100%;box-sizing:border-box;padding:9px 10px;border:1px solid #d6dae6;border-radius:10px;background:#fff}
.mf-builder .property-group textarea{min-height:110px}
.mf-builder #fp-options > div{display:flex;gap:8px;margin-bottom:8px}
.mf-builder #fp-options input{flex:1}

/* Footer actions */
.mf-builder .editor-actions{display:flex;gap:12px;margin-top:18px}
.mf-builder .btn{padding:.55rem .9rem;border-radius:10px;border:1px solid var(--border);background:#fff;cursor:pointer;transition:transform .05s ease, box-shadow .1s ease, background .15s}
.mf-builder .btn:hover{box-shadow:var(--shadow)}
.mf-builder .btn:active{transform:translateY(1px)}
.mf-builder .btn-primary{background:var(--brand);border-color:var(--brand);color:#fff}
.mf-builder .btn-primary:hover{background:var(--brand-600)}
.mf-builder .btn-secondary{background:#f3f6ff; color:#000;}

/* Modal */
.mf-builder .modal{position:fixed;inset:0;background:rgba(0,10,30,.45);display:none}
.mf-builder .modal .modal-content{
  background:#fff;
  width:min(900px,92vw);
  margin:8vh auto;
  border-radius:14px;
  padding:20px;
  box-shadow:var(--shadow);
  max-height:80vh;           /* allow tall content */
  overflow:auto;             /* scroll when preview is long */
}
.mf-builder .modal .modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.mf-builder .modal .modal-header h2{margin:0}
.mf-builder .modal .modal-close{border:none;background:#eef2ff;color:#334155;border-radius:8px;width:34px;height:34px;cursor:pointer}

/* Small screens */
@media (min-width: 1700px){
  .mf-builder .container{max-width:1800px}
  .mf-builder .editor-container{grid-template-columns:280px minmax(900px,1fr) 360px 360px}
}
@media (max-width: 1100px){
  .mf-builder .editor-container{grid-template-columns:1fr;}
  .mf-builder .fields-panel,.mf-builder .field-properties,.mf-builder .form-details{position:static;max-height:none}
}
.mf-builder .field-actions button:disabled{
  opacity:.45;
  cursor:not-allowed;
  filter:grayscale(30%);
}

/* Scrollable preview body inside modal */
.mf-builder #preview-form-container{
  max-height:70vh;
  overflow:auto;
}