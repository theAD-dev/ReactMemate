{"version":3,"file":"static/js/4908.bef8070b.chunk.js","mappings":"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","sources":["pages/business/enquiries/forms/forms-list.jsx","pages/business/enquiries/form-builder/api.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { listFormsByOrganization, deleteForm } from '../form-builder/api';\nimport '../form-builder/form-builder.css';\n\nconst DEFAULT_ORG_ID = 5;\n\nexport default function FormsList({ organizationId = DEFAULT_ORG_ID }) {\n  const [orgId, setOrgId] = useState(String(organizationId || DEFAULT_ORG_ID));\n  const [forms, setForms] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const fetchData = async (id) => {\n    setLoading(true);\n    setError('');\n    try {\n      const data = await listFormsByOrganization(id);\n      // API returns an array (per backend impl)\n      const normalized = Array.isArray(data) ? data : (data?.results || []);\n      setForms(normalized);\n    } catch (e) {\n      setError(e.message || 'Failed to load forms');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData(orgId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleReload = () => fetchData(orgId);\n  const handleOrgChange = (e) => setOrgId(e.target.value);\n  const handleGo = () => fetchData(orgId);\n\n  const copyEmbed = async (formId) => {\n    const host = process.env.REACT_APP_URL || window.location.origin;\n    const snippet = `<script src=\"${host}/astatic/inquiries/embed.js\" data-form-id=\"${formId}\"></` + `script>`;\n    try {\n      await navigator.clipboard.writeText(snippet);\n      alert('Embed code copied to clipboard');\n    } catch (_) {\n      // Fallback\n      const ta = document.createElement('textarea');\n      ta.value = snippet;\n      document.body.appendChild(ta);\n      ta.select();\n      document.execCommand && document.execCommand('copy');\n      document.body.removeChild(ta);\n      alert('Embed code copied to clipboard');\n    }\n  };\n\n  const handleDelete = async (formId) => {\n    if (!window.confirm('Are you sure you want to delete this form?')) return;\n    try {\n      await deleteForm(formId);\n      alert('Form deleted successfully');\n      fetchData(orgId); // refresh list\n    } catch (e) {\n      alert(e.message || 'Failed to delete form');\n    }\n  };\n\n  return (\n    <div className=\"mf-builder\">{/* reuse base styles */}\n      <div className=\"container\">\n        <header>\n          <h1>Forms</h1>\n        </header>\n\n        <div className=\"editor-actions\" style={{gap:12}}>\n          <div className=\"form-field\" style={{display:'flex',alignItems:'center',gap:8,margin:0}}>\n            <label htmlFor=\"org-id\" style={{margin:0}}>Organization ID</label>\n            <input id=\"org-id\" value={orgId} onChange={handleOrgChange} style={{width:120}} />\n            <button className=\"btn\" onClick={handleGo}>Load</button>\n            <button className=\"btn\" onClick={handleReload}>Reload</button>\n            <a className=\"btn btn-primary\" href=\"/enquiries/form-builder/new\">New Form</a>\n          </div>\n        </div>\n\n        {loading && <p>Loadingâ€¦</p>}\n        {error && <p className=\"error-message\">{error}</p>}\n\n        {!loading && !error && (\n          <div className=\"table-wrap\" style={{overflowX:'auto', marginTop:12}}>\n            <table className=\"mf-table\" style={{width:'100%',borderCollapse:'collapse'}}>\n              <thead>\n                <tr>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>ID</th>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>Form</th>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>Domain</th>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>Created At</th>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>Inquiries</th>\n                  <th style={{textAlign:'center',padding:'8px 10px',borderBottom:'1px solid #e5e7eb'}}>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {forms.length === 0 && (\n                  <tr>\n                    <td colSpan={6} style={{padding:'12px'}}>No forms found for this organization.</td>\n                  </tr>\n                )}\n                {forms.map((f) => (\n                  <tr key={f.id}>\n                    <td style={{padding:'8px 10px'}}>{f.id}</td>\n                    <td style={{padding:'8px 10px'}}>{f.title || '(untitled)'}</td>\n                    <td style={{padding:'8px 10px'}}>{f.domain || '-'}</td>\n                    <td style={{padding:'8px 10px'}}>{f.created ? new Date(f.created).toLocaleString() : '-'}</td>\n                    <td style={{padding:'8px 10px'}}>{f.inquiries_count || 0}</td>\n                    <td style={{padding:'8px 10px',display:'flex',gap:8}}>\n                      <button className=\"btn btn-secondary\" onClick={() => copyEmbed(f.id)}>Copy Embed</button>\n                      <a className=\"btn btn-secondary\" href={`/enquiries/form-builder/new?id=${f.id}`}>Edit</a>\n                      <a className=\"btn btn-secondary\" href={`/enquiries/form-builder/inquiries?id=${f.id}`}>Inquiries</a>\n                      <button className=\"btn\" style={{ backgroundColor: '#f87171', color: 'white' }} onClick={() => handleDelete(f.id)}>Delete</button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","export const INQUIRY_FORM_API_URL = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/`;\nexport const INQUIRY_FORM_DETAIL_URL = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/`;\n\nexport async function saveFormToApi(payload) {\n  const res = await fetch(INQUIRY_FORM_API_URL, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return res.json();\n}\n\nexport async function listFormsByOrganization(orgId) {\n  const base = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/forms/`;\n  const url = `${base}?organization=${encodeURIComponent(orgId)}`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return res.json();\n}\n\nexport async function getFormById(id) {\n  const base = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/`;\n  const url = `${base}${id}/`;\n  const res = await fetch(url);\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return res.json();\n}\n\nexport async function updateFormToApi(id, payload) {\n  const base = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/`;\n  const url = `${base}${id}/update/`;\n  const res = await fetch(url, {\n    method: 'PATCH',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(payload),\n  });\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return res.json();\n}\n\nexport async function listFormSubmissions(formId, params = {}) {\n  if (!formId) throw new Error('formId is required');\n  const base = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/${encodeURIComponent(formId)}/submissions/`;\n\n  const qs = new URLSearchParams();\n  // Optional filters/pagination if backend supports them\n  if (params.page) qs.set('page', params.page);\n  if (params.page_size) qs.set('page_size', params.page_size);\n  if (params.status != null) qs.set('status', params.status); // e.g., 0,1,2\n  if (params.assigned_to) qs.set('assigned_to', params.assigned_to); // user id/email if supported\n  if (params.search) qs.set('search', params.search);\n  if (params.ordering) qs.set('ordering', params.ordering);\n\n  const url = qs.toString() ? `${base}?${qs.toString()}` : base;\n  const res = await fetch(url);\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return res.json();\n}\n\nexport async function deleteForm(id) {\n  const base = `${process.env.REACT_APP_BACKEND_API_URL}/inquiries/form/`;\n  const url = `${base}${id}/delete/`;\n  const res = await fetch(url, { method: 'DELETE' });\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`API ${res.status}: ${text || res.statusText}`);\n  }\n  return true;\n}"],"names":["DEFAULT_ORG_ID","FormsList","_ref","organizationId","orgId","setOrgId","useState","String","forms","setForms","loading","setLoading","error","setError","fetchData","async","data","listFormsByOrganization","id","normalized","Array","isArray","results","e","message","useEffect","_jsx","className","children","_jsxs","style","gap","display","alignItems","margin","htmlFor","value","onChange","target","width","onClick","handleGo","handleReload","href","overflowX","marginTop","borderCollapse","textAlign","padding","borderBottom","length","colSpan","map","f","title","domain","created","Date","toLocaleString","inquiries_count","snippet","formId","navigator","clipboard","writeText","alert","_","ta","document","createElement","body","appendChild","select","execCommand","removeChild","copyEmbed","backgroundColor","color","window","confirm","deleteForm","handleDelete","INQUIRY_FORM_API_URL","saveFormToApi","payload","res","fetch","method","headers","JSON","stringify","ok","text","catch","Error","status","statusText","json","url","encodeURIComponent","getFormById","updateFormToApi","listFormSubmissions","params","arguments","undefined","base","qs","URLSearchParams","page","set","page_size","assigned_to","search","ordering","toString"],"sourceRoot":""}