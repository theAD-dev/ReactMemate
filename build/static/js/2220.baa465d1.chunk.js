"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[2220],{31342:(e,t,s)=>{s.d(t,{f:()=>n});const n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{method:n="GET",headers:r={},body:i}=t,a=localStorage.getItem("access_token"),o=i instanceof FormData,l={"Content-Type":o?"multipart/form-data":"application/json",...r};s&&(l.Authorization=`Bearer ${a}`);const c={method:n,headers:l,body:o?i:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,c);if(!s.ok){if(401===s.status&&(window.localStorage.clear(),window.sessionStorage.clear(),window.location.replace("/login")),404===s.status)throw new Error("Not found");throw new Error(`HTTP error! Status: ${s.status}`)}const n=s.headers.get("Content-Type");if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(d){throw console.error("Fetch API error:",d),d}}},32220:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var n=s(65043),r=s(27066),i=s(55850),a=s(49367),o=s(35475),l=s(93747),c=s(72018),d=s(9642),u=s(64824),h=s(55797),p=s(56328);const m={circledesignstyle:"quote_circledesignstyle__3Ladr",out:"quote_out__yoHfT"};var g=s(50565),f=s(45004),y=s(93740);const x="RecurringJobActions_actionButton__Url96",j="RecurringJobActions_actionMenu__LJy6r",v="RecurringJobActions_menuItem__5g-js",w="RecurringJobActions_menuItemText__PFDZG",b="RecurringJobActions_menuItemIcon__yAzDR",N="RecurringJobActions_suspendItem__jwIcc",k="RecurringJobActions_activateItem__GENGy",_="RecurringJobActions_deleteItem__RkzDp",R="RecurringJobActions_disabled__k2fr+";var A=s(31342);const S="https://dev.memate.com.au/api/v1";var $=s(70579);const P=e=>{let{jobId:t,status:s,onActionComplete:r}=e;const i=(0,n.useRef)(null),[a,o]=(0,n.useState)(!1),l=[{label:"active"===s?"Pause":"Activate",icon:"active"===s?"pi pi-pause":"pi pi-play",command:"active"===s?async()=>{try{o(!0),await(async e=>{const t=`/settings/projects/recurrings/${e}/pause/`,s={method:"POST",body:JSON.stringify({})},n=new URL(`${S}${t}`);return(0,A.f)(n.toString(),s)})(t),r&&r("pause")}catch(e){console.error("Error pausing recurring job:",e),p.oR.error("Failed to pause recurring job")}finally{o(!1)}}:async()=>{try{o(!0),await(async e=>{const t=`/settings/projects/recurrings/${e}/activate/`,s={method:"POST",body:JSON.stringify({})},n=new URL(`${S}${t}`);return(0,A.f)(n.toString(),s)})(t),r&&r("activate")}catch(e){console.error("Error activating recurring job:",e),p.oR.error("Failed to activate recurring job")}finally{o(!1)}},className:"active"===s?N:k,disabled:a,template:e=>(0,$.jsxs)("div",{className:`${v} ${a?R:""}`,onClick:a?null:e.command,style:{opacity:a?.6:1,cursor:a?"not-allowed":"pointer"},children:[(0,$.jsx)("span",{className:w,children:"active"===s?"Suspend schedule":"Activate schedule"}),(0,$.jsx)("span",{className:b,children:"active"===s?(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,$.jsx)("path",{d:"M5 6.25a1.25 1.25 0 1 1 2.5 0v3.5a1.25 1.25 0 1 1-2.5 0v-3.5zm3.5 0a1.25 1.25 0 1 1 2.5 0v3.5a1.25 1.25 0 1 1-2.5 0v-3.5z"})]}):(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,$.jsx)("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z"})]})})]})},{label:"Delete",icon:"pi pi-trash",command:async()=>{try{o(!0),await(async e=>{const t=new URL(`${S}/settings/projects/recurrings/${e}/`);return(0,A.f)(t.toString(),{method:"DELETE"})})(t),r&&r("delete")}catch(e){console.error("Error deleting recurring job:",e),p.oR.error("Failed to delete recurring job")}finally{o(!1)}},className:_,disabled:a,template:e=>(0,$.jsxs)("div",{className:`${v} ${a?R:""}`,onClick:a?null:e.command,style:{opacity:a?.6:1,cursor:a?"not-allowed":"pointer"},children:[(0,$.jsx)("span",{className:w,children:"Delete"}),(0,$.jsx)("span",{className:b,children:(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),(0,$.jsx)("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})})]})}];return(0,$.jsxs)("div",{className:x,children:[(0,$.jsx)(c.$,{icon:a?(0,$.jsx)(y.p,{style:{width:"18px",height:"18px"}}):(0,$.jsx)(g.A,{size:18,color:a?"#ccc":"#667085"}),className:"m-auto",onClick:e=>{a||(e.stopPropagation(),i.current.toggle(e))},disabled:a,"aria-label":"Actions",style:{backgroundColor:"transparent",border:"none",width:"fit-content",height:"fit-content",cursor:a?"not-allowed":"pointer",opacity:a?.7:1}}),(0,$.jsx)(f.W,{model:a?[]:l,popup:!0,ref:i,className:j,appendTo:document.body})]})};var z=s(48417),C=s(27734);function E(e){return new Date(1e3*+e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}const V={D:"Daily",W:"Weekly",B:"Biweekly",M:"Monthly",L:"Last Day of the Month",Q:"Quarterly",Y:"Yearly"},M=()=>{const{trialHeight:e}=(0,z.$)(),t=new URLSearchParams(location.search).get("recurringId"),[s,g]=(0,n.useState)(1),[f,y]=(0,n.useState)(!1),[x,j]=(0,n.useState)([]),v=5*(s-1),{data:w,isLoading:b,refetch:N}=(0,l.I)({queryKey:["recurring",5,v],queryFn:()=>(async e=>{let{limit:t,offset:s}=e;const n=new URL(`${S}/settings/projects/recurrings?limit=${t}&offset=${s}`);return(0,A.f)(n.toString(),{method:"GET"})})({limit:5,offset:v}),keepPreviousData:!0});(0,n.useEffect)((()=>{N()}),[s,N]);const{results:k=[],count:_}=w||{},R=Math.ceil(_/5)||1,M=e=>g(e),D=e=>{p.oR.success({delete:"Recurring job deleted successfully",pause:"Recurring job paused successfully",activate:"Recurring job activated successfully"}[e]||"Action completed successfully"),N()},O=(0,$.jsx)("div",{className:`${m.modalHeader}`,children:(0,$.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,$.jsx)("div",{className:m.circledesignstyle,children:(0,$.jsx)("div",{className:m.out,children:(0,$.jsx)(r.A,{size:24,color:"#1AB2FF",className:"mb-0"})})}),(0,$.jsx)("span",{className:`white-space-nowrap ${m.headerTitle}`,children:"Recurring History"})]})}),I=(0,$.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,$.jsx)("span",{}),(0,$.jsx)("div",{className:"d-flex justify-content-end gap-2",children:(0,$.jsx)(c.$,{className:"outline-button",onClick:()=>y(!1),children:"Close"})})]}),L=(0,n.useCallback)((e=>{const t=k.find((t=>t.unique_id===e));j((null===t||void 0===t?void 0:t.history)||[]),y(!0)}),[k]);return(0,n.useEffect)((()=>{if(t&&w){L(t);const e=new URL(window.location.href);e.searchParams.delete("recurringId"),window.history.replaceState({},"",e)}}),[t,w,L]),(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(a.mg,{children:(0,$.jsx)("title",{children:"MeMate - Recurring Quotes"})}),(0,$.jsxs)("div",{className:"headSticky",children:[(0,$.jsx)("h1",{children:"Quotes & Jobs"}),(0,$.jsx)("div",{className:"contentMenuTab",children:(0,$.jsxs)("ul",{children:[(0,$.jsx)("li",{className:"menuActive",children:(0,$.jsx)(o.N_,{to:"/settings/quotesjobs/recurring-quotes",children:"Recurring Quotes"})}),(0,$.jsx)("li",{children:(0,$.jsx)(o.N_,{to:"/settings/quotesjobs/recurring-jobs",children:"Recurring Jobs"})})]})})]}),(0,$.jsx)("div",{className:"content_wrap_main",style:{height:`calc(100vh - 150px - ${e}px)`},children:(0,$.jsxs)("div",{className:"listwrapper",children:[(0,$.jsx)("div",{className:"topHeadStyle mb-4 align-items-center",children:(0,$.jsx)("h2",{className:"mb-0",children:"Recurring Quotes"})}),(0,$.jsxs)(u.b,{value:k,showGridlines:!0,tableStyle:{minWidth:"50rem"},children:[(0,$.jsx)(d.V,{header:"Client name",field:"client.name",body:e=>(0,$.jsxs)("div",{className:"d-flex align-items-center justify-content-between show-on-hover",children:[(0,$.jsx)("div",{className:"ellipsis-width",children:e.client.name}),(0,$.jsx)(c.$,{label:"Open",onClick:()=>L(e.unique_id),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Order Reference",field:"project.reference",body:e=>{var t;return(0,$.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px",fontWeight:600},children:(null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference)||""})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Frequency",field:"frequency",body:e=>V[e.frequency],style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Date started",field:"start_date",body:e=>E(e.start_date),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Processed/Occurrences",field:"occurrences",body:e=>`${e.processed||0}/${e.occurrences||0}`,style:{width:"auto",textAlign:"center"}}),(0,$.jsx)(d.V,{header:"Status",field:"active",body:e=>e.active?(0,$.jsx)(i.A,{size:24,color:"#17B26A"}):"",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Actions",field:"",className:"text-center",body:e=>(0,$.jsx)(P,{jobId:e.unique_id,status:e.active?"active":"inactive",onActionComplete:D}),style:{width:"auto"}})]}),(0,$.jsxs)("div",{className:"bottomPagenation",children:[(0,$.jsx)("nav",{children:(0,$.jsxs)("ul",{className:"pagination",children:[(0,$.jsx)("li",{className:"page-item "+(1===s?"disabled":""),children:(0,$.jsx)("button",{onClick:()=>M(s-1),className:"page-link",style:{borderRadius:"20px"},disabled:1===s,children:"Previous"})}),(0,$.jsx)("li",{className:"page-item "+(s===R?"disabled":""),children:(0,$.jsx)("button",{onClick:()=>M(s+1),className:"page-link",style:{borderRadius:"20px"},disabled:s===R,children:"Next"})})]})}),(0,$.jsx)("div",{className:"countpage",children:(0,$.jsxs)("p",{children:["Page ",s," of ",R]})})]})]})}),b&&(0,$.jsx)(C.A,{}),(0,$.jsx)(h.l,{visible:f,modal:!0,header:O,footer:I,className:`${m.modal} custom-modal`,onHide:()=>y(!1),children:(0,$.jsxs)(u.b,{value:x||[],showGridlines:!0,tableStyle:{minWidth:"50rem"},children:[(0,$.jsx)(d.V,{header:"#",field:"unique_id",body:(e,t)=>{let{rowIndex:s}=t;return(0,$.jsx)($.Fragment,{children:s+1})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Date",field:"date",body:e=>E(e.date),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Project Number",field:"project.number",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Project Reference",field:"project.reference",body:e=>{var t;return(0,$.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px"},children:(null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference)||""})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Processed",field:"processed",body:e=>e.processed?(0,$.jsx)(i.A,{size:24,color:"#17B26A"}):"",style:{width:"auto"}})]})})]})}},55850:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(65043),r=s(65173),i=s.n(r),a=["color","size","title","className"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},o.apply(null,arguments)}var l=(0,n.forwardRef)((function(e,t){var s=e.color,r=void 0===s?"currentColor":s,i=e.size,l=void 0===i?"1em":i,c=e.title,d=void 0===c?null:c,u=e.className,h=void 0===u?"":u,p=function(e,t){if(null==e)return{};var s,n,r=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;s[n]=e[n]}return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.includes(s)||{}.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}(e,a);return n.createElement("svg",o({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:l,height:l,fill:r,className:["bi","bi-check-circle-fill",h].filter(Boolean).join(" ")},p),d?n.createElement("title",null,d):null,n.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}))}));l.propTypes={color:i().string,size:i().oneOfType([i().string,i().number]),title:i().string,className:i().string};const c=l},93740:(e,t,s)=>{s.d(t,{p:()=>c});var n=s(65043),r=s(84052),i=s(41828),a=s(2028),o=s(4504),l=i.x.extend({defaultProps:{__TYPE:"ProgressSpinner",id:null,style:null,className:null,strokeWidth:"2",fill:"none",animationDuration:"2s",children:void 0},css:{classes:{root:"p-progress-spinner",spinner:"p-progress-spinner-svg",circle:"p-progress-spinner-circle"},styles:"\n@layer primereact {\n    .p-progress-spinner {\n        position: relative;\n        margin: 0 auto;\n        width: 100px;\n        height: 100px;\n        display: inline-block;\n    }\n    \n    .p-progress-spinner::before {\n        content: '';\n        display: block;\n        padding-top: 100%;\n    }\n    \n    .p-progress-spinner-svg {\n        animation: p-progress-spinner-rotate 2s linear infinite;\n        height: 100%;\n        transform-origin: center center;\n        width: 100%;\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        margin: auto;\n    }\n    \n    .p-progress-spinner-circle {\n        stroke-dasharray: 89, 200;\n        stroke-dashoffset: 0;\n        stroke: #d62d20;\n        animation: p-progress-spinner-dash 1.5s ease-in-out infinite, p-progress-spinner-color 6s ease-in-out infinite;\n        stroke-linecap: round;\n    }\n}\n\n@keyframes p-progress-spinner-rotate {\n    100% {\n        transform: rotate(360deg);\n    }\n}\n\n@keyframes p-progress-spinner-dash {\n    0% {\n        stroke-dasharray: 1, 200;\n        stroke-dashoffset: 0;\n    }\n    50% {\n        stroke-dasharray: 89, 200;\n        stroke-dashoffset: -35px;\n    }\n    100% {\n        stroke-dasharray: 89, 200;\n        stroke-dashoffset: -124px;\n    }\n}\n\n@keyframes p-progress-spinner-color {\n    100%,\n    0% {\n        stroke: #d62d20;\n    }\n    40% {\n        stroke: #0057e7;\n    }\n    66% {\n        stroke: #008744;\n    }\n    80%,\n    90% {\n        stroke: #ffa700;\n    }\n}\n",inlineStyles:{spinner:function(e){return{animationDuration:e.props.animationDuration}}}}}),c=n.memo(n.forwardRef((function(e,t){var s=(0,a.qV)(),c=n.useContext(r.UM),d=l.getProps(e,c),u=n.useRef(null),h=l.setMetaData({props:d}),p=h.ptm,m=h.cx,g=h.sx,f=h.isUnstyled;(0,i.j)(l.css.styles,f,{name:"progressspinner"}),n.useImperativeHandle(t,(function(){return{props:d,getElement:function(){return u.current}}}));var y=s({id:d.id,ref:u,style:d.style,className:(0,o.xW)(d.className,m("root")),role:"progressbar","aria-busy":!0},l.getOtherProps(d),p("root")),x=s({className:m("spinner"),viewBox:"25 25 50 50",style:g("spinner")},p("spinner")),j=s({className:m("circle"),cx:"50",cy:"50",r:"20",fill:d.fill,strokeWidth:d.strokeWidth,strokeMiterlimit:"10"},p("circle"));return n.createElement("div",y,n.createElement("svg",x,n.createElement("circle",j)))})));c.displayName="ProgressSpinner"}}]);
//# sourceMappingURL=2220.baa465d1.chunk.js.map