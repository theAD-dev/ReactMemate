"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[8600],{17030:(e,t,l)=>{l.d(t,{DY:()=>r,Dc:()=>n,MY:()=>j,VL:()=>x,Vn:()=>d,WL:()=>o,_0:()=>h,ax:()=>i,cM:()=>p,jH:()=>v,mL:()=>u,sl:()=>g,tA:()=>c,zw:()=>m});var s=l(31342);const a="https://dev.memate.com.au/api/v1",i=async e=>{const t=new URL(`${a}/references/calc-indexes/`);return 1===e&&t.searchParams.append("all",1),(0,s.f)(t.toString(),{method:"GET"})},n=async e=>{const t=new URL(`${a}${`/references/calculators/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${a}${`/projects/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},r=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/sales/new-request/`);return(0,s.f)(l.toString(),t)},d=async(e,t)=>{if(!e)throw new Error("No id found");const l={method:"PUT",body:t},i=new URL(`${a}${`/sales/projects/${e}/`}`);return(0,s.f)(i.toString(),l)},c=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/projects/merges/new/`);return(0,s.f)(l.toString(),t)},u=async e=>{const t=new URL(`${a}${`/projects/merges/${e}/delete/`}`);return(0,s.f)(t.toString(),{method:"DELETE"})},x=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/settings/departments/`);return(0,s.f)(l.toString(),t)},p=async(e,t)=>{if(!e)return;const l={method:"PUT",body:t},i=new URL(`${a}${`/settings/departments/update/${e}/`}`);return(0,s.f)(i.toString(),l)},m=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/settings/sub-departments/`);return(0,s.f)(l.toString(),t)},h=async(e,t)=>{if(!e)return;const l={method:"PUT",body:t},i=new URL(`${a}${`/settings/sub-departments/update/${e}/`}`);return(0,s.f)(i.toString(),l)},v=async(e,t)=>{const l={method:"POST",body:t},i=new URL(`${a}${`/references/calculators/${e}/new/`}`);return(0,s.f)(i.toString(),l)},g=async(e,t,l)=>{const i={method:"PUT",body:l},n=new URL(`${a}${`/references/calculators/${e}/update/${t}/`}`);return(0,s.f)(n.toString(),i)},j=async e=>{const t=new URL(`${a}${e}`);return(0,s.f)(t.toString(),{method:"DELETE"})}},81047:(e,t,l)=>{l.d(t,{Bz:()=>b,Hb:()=>u,IT:()=>j,Kb:()=>o,Pf:()=>m,SQ:()=>c,VQ:()=>g,Xm:()=>d,bd:()=>v,hS:()=>p,hx:()=>h,iS:()=>n,p4:()=>r,s:()=>x,tC:()=>i});var s=l(31342);const a="https://dev.memate.com.au/api/v1",i=async()=>{const e=new URL(`${a}/jobs/templates/`);return(0,s.f)(e.toString(),{method:"GET"})},n=async e=>{const t=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},o=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/jobs/templates/`);return(0,s.f)(l.toString(),t)},r=async(e,t)=>{const l={method:"PUT",body:t},i=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,s.f)(i.toString(),l)},d=async e=>{const t=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,s.f)(t.toString(),{method:"DELETE"})},c=async()=>{const e=new URL(`${a}/settings/templates/email-templates/`);return(0,s.f)(e.toString(),{method:"GET"})},u=async e=>{const t={method:"POST",body:e},l=new URL(`${a}/settings/templates/email-templates/`);return(0,s.f)(l.toString(),t)},x=async(e,t)=>{const l={method:"PUT",body:t},i=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,s.f)(i.toString(),l)},p=async e=>{const t=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},m=async e=>{const t=new URL(`${a}${`/proposals/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},h=async()=>{const e=new URL(`${a}/references/outgoing-email/`);return(0,s.f)(e.toString(),{method:"GET"})},v=async e=>{const t=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,s.f)(t.toString(),{method:"DELETE"})},g=async()=>{const e=new URL(`${a}/settings/proposals/`);return(0,s.f)(e.toString(),{method:"GET"})},j=async e=>{const t=new URL(`${a}${`/settings/proposals/${e}/`}`);return(0,s.f)(t.toString(),{method:"GET"})},b=async e=>{const t=new URL(`${a}${`/settings/proposals/delete/${e}/`}`);return(0,s.f)(t.toString(),{method:"DELETE"})}},35866:(e,t,l)=>{l.r(t),l.d(t,{default:()=>at});var s=l(65043),a=l(38294),i=l(22636),n=l(83700),o=l(73216),r=l(35475),d=l(70579);const c=e=>{let{label:t,name:l,value:s,checked:a,onChange:i}=e;return(0,d.jsxs)("label",{className:"custom-radio-button",children:[(0,d.jsx)("input",{type:"radio",name:l,value:s,checked:a,onChange:i}),(0,d.jsx)("span",{className:"custom-radio-button__checkmark"}),t]})};var u=l(63718),x=l(93747),p=l(94819),m=l(48792),h=l(38161),v=l(66415),g=l(17030),j=l(26189),b=l(10605),f=l(21165),y=l(34404);l(93066);const A=e=>{var t;let{departments:l,handleChange:a,isShowlabel:i=!1,title:n}=e;const[o,r]=(0,s.useState)(n||null);return(0,d.jsx)(j.W,{menuButton:(0,d.jsxs)(b.I,{style:{width:"150px",display:"inline-flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0px",cursor:"pointer",background:"transparent",border:"none",color:"#98A2B3"},children:[(0,d.jsx)("span",{children:o||"Department"})," ",(0,d.jsx)("span",{children:(0,d.jsx)(v.A,{color:"#98A2B3",size:15})})]}),overflow:"auto",position:"anchor",children:null===l||void 0===l||null===(t=l.filter((e=>!(null!==e&&void 0!==e&&e.deleted))))||void 0===t?void 0:t.map(((e,t)=>{var l,n,o;return(0,d.jsx)(s.Fragment,{children:null!==e&&void 0!==e&&null!==(l=e.subindexes)&&void 0!==l&&l.length?(0,d.jsxs)(f.g,{overflow:"auto",menuStyle:{maxHeight:"320px",overflow:"auto",textAlign:"left"},label:null===e||void 0===e?void 0:e.name,children:[" ",null===(n=e.subindexes)||void 0===n||null===(o=n.filter((e=>!(null!==e&&void 0!==e&&e.deleted))))||void 0===o?void 0:o.map((e=>(0,d.jsx)(y.D,{onClick:()=>{return t=null===e||void 0===e?void 0:e.name,l=null===e||void 0===e?void 0:e.id,i&&r(t),void a(l,t);var t,l},children:null===e||void 0===e?void 0:e.name},e.id)))]},e.id):(0,d.jsx)(y.D,{style:{textAlign:"left"},children:null===e||void 0===e?void 0:e.name},e.id)},e.id)}))})};var N=l(65975);const w=()=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{width:"24px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"64px",textAlign:"center"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"192px",textAlign:"center"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"600px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"128px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"185px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"118px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"166px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"83px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"118px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})}),(0,d.jsx)("td",{style:{width:"32px"},children:(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary"})})})]});var S=l(56328),C=l(58387),_=l(80899),k=l(73722),q=l(24858),B=l(47097),F=l(18403),$=l(14282),R=l(61424),E=l(32223),L=l(61072),z=l(78602);const T="create-merge-calculation_mergeButton__A2lWg",P="create-merge-calculation_disabled__-KWur",I="create-merge-calculation_deleteButton__AA6vR";l.p;var M=l(24572);const D=_.Ik({title:_.Yj().required("Title is required"),description:_.Yj().required("Description is required")}).required(),W=e=>{var t,l,a;let{unique_id:i,selectItem:n,setSelectItem:o,merges:r,setMerges:c,refetch:u}=e;const[x,m]=(0,s.useState)(!1),h=(0,M.Mf)(((null===r||void 0===r?void 0:r.length)||0)+1),[v,j]=(0,s.useState)({title:"",description:""}),{register:b,reset:f,handleSubmit:y,formState:{errors:A}}=(0,q.mN)({resolver:(0,F.t)(D),defaultValues:v});(0,s.useEffect)((()=>{f()}),[n]);(0,B.n)({mutationFn:e=>(0,g.tA)(e),onSuccess:e=>{u(),o({}),N(),S.oR.success("New merge items created successfully.")},onError:e=>{console.error("Error creating task:",e),S.oR.error("Failed to create new merge items. Please try again.")}});const N=()=>m(!1);return(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)($.A,{type:"button",disabled:(null===(t=Object.keys(n))||void 0===t?void 0:t.length)<2,onClick:()=>m(!0),className:(0,C.A)(T,"text-button",{[P]:(null===(l=Object.keys(n))||void 0===l?void 0:l.length)<2}),children:"Merge Items"}),(0,d.jsxs)(R.A,{size:"lg",show:x,centered:!0,onHide:N,className:(0,C.A)("task-form","mergeForm"),children:[(0,d.jsx)(R.A.Header,{closeButton:!0,children:(0,d.jsxs)(R.A.Title,{className:"d-flex align-items-center",style:{padding:"24px"},children:[(0,d.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"36px",height:"36px",borderRadius:"50%",border:"1px solid #EAECF0",background:"#F2F4F7",color:"#344054",fontSize:"14px",fontWeight:600},children:h}),(0,d.jsx)("span",{className:"modal-task-title",children:"Merge Items"})]})}),(0,d.jsx)(R.A.Body,{className:"px-0",children:(0,d.jsxs)(k.A,{onSubmit:y((e=>{var t;const l={...e,alias:h,calculators:null===(t=Object.values(n))||void 0===t?void 0:t.flat().map((e=>({calculator:e.calculator,id:e.id,label:e.label,total:e.total,description:e.description})))};c((e=>[...e,l])),N(),o({})})),children:[(0,d.jsxs)("div",{className:"px-4",style:{maxHeight:"450px",overflow:"auto"},children:[(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{children:"Task Title"}),(0,d.jsx)(k.A.Control,{...b("title"),type:"text",placeholder:"Merge items title",className:""+(A.title?"border border-danger":"")}),A.title&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:A.title.message})]}),(0,d.jsxs)(k.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,d.jsx)(k.A.Label,{children:"Describe merging items"}),(0,d.jsx)(k.A.Control,{as:"textarea",rows:2,placeholder:"Enter a description...",...b("description"),style:{height:"80px",outline:"none",boxShadow:"none"},className:""+(A.description?"border border-danger":"")}),A.description&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:A.description.message})]}),(0,d.jsx)(E.A,{variant:"flush border rounded mb-4",style:{border:"1px solid var(--Gray-100, #F2F4F7)"},children:null===(a=Object.entries(n))||void 0===a?void 0:a.map((e=>{let[t,l]=e;return null===l||void 0===l?void 0:l.map(((e,l)=>(0,d.jsx)(E.A.Item,{className:"d-flex justify-content-between",children:(0,d.jsxs)(L.A,{className:"w-100",children:[(0,d.jsx)(z.A,{sm:4,className:"text-start",children:(0,d.jsx)("span",{style:{color:"#101828",fontSize:"16px"},children:(null===e||void 0===e?void 0:e.label)||""})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsx)("span",{style:{color:"#101828",fontSize:"16px"},children:(null===e||void 0===e?void 0:e.description)||""})}),(0,d.jsx)(z.A,{sm:2,className:"text-end text-nowrap",children:(0,d.jsxs)("span",{style:{color:"#101828",fontSize:"16px",textAlign:"end"},children:["$ ",parseFloat(null===e||void 0===e?void 0:e.total).toFixed(2)]})})]})},`${t}-${e.id}`)))}))})]}),(0,d.jsxs)(R.A.Footer,{className:"d-flex justify-content-between align-items-center",children:[(0,d.jsx)($.A,{type:"button",onClick:()=>{m(!1),o({})},className:I,children:(0,d.jsx)(p.A,{color:"#B42318",size:18})}),(0,d.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,d.jsx)($.A,{type:"button",onClick:N,className:"outline-button",style:{minWidth:"67px"},children:"Cancel"}),(0,d.jsx)($.A,{type:"submit",className:"solid-button",style:{minWidth:"67px"},children:"Save"})]})]})]})})]})]})},U="list-merge-calculation_mergeListItem__lMMHT",O="list-merge-calculation_mergeListSrBox__Pg9x-",G="list-merge-calculation_divider__uLh55",K="list-merge-calculation_divider2__ixjfs";var H=l(41451),Q=l(99367),V=l(85632);const J=e=>{let{title:t,alias:l,items:a}=e;const i=(0,s.useRef)(null),[n,o]=(0,s.useState)(!1),r=(0,H.k)(n,o);return(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)("button",{type:"button",className:"btn p-0 ellipsis-width",style:{maxWidth:"450px"},ref:i,...r,children:t}),(0,d.jsxs)(Q.k,{state:n?"open":"closed",anchorRef:i,onClose:()=>o(!1),menuStyle:{padding:"24px 24px 20px 24px",width:"365px"},children:[(0,d.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,d.jsx)("div",{className:"BoxNo",children:(0,d.jsx)("div",{className:"no",children:l})}),(0,d.jsx)(V.A,{onClick:()=>o(!1)})]}),(0,d.jsx)(E.A,{variant:"flush border",style:{marginTop:"16px"},children:null===a||void 0===a?void 0:a.map(((e,t)=>(0,d.jsxs)(E.A.Item,{className:"d-flex justify-content-between border-0",children:[(0,d.jsx)("span",{style:{color:"#475467",fontSize:"14px",fontWeight:400},children:null===e||void 0===e?void 0:e.label}),(0,d.jsxs)("span",{style:{color:"#475467",fontSize:"14px",fontWeight:600,whiteSpace:"nowrap"},children:["$ ",(null===e||void 0===e?void 0:e.total)||"0.00"]})]},t)))})]})]})};var Y=l(27417),X=l(30970);const Z=e=>{let{id:t,alias:l,refetch:a,setMerges:i}=e;const{unique_id:n}=(0,o.g)(),r=(0,B.n)({mutationFn:e=>(0,g.mL)(t),onSuccess:()=>{S.oR.success("Merge item deleted successfully"),a()},onError:e=>{S.oR.error("Failed to delete merge item. Please try again.")}}),c=()=>{if(n){if(!t)return S.oR.error("Id not found");r.mutate()}else i((e=>e.filter((e=>e.alias!==l))))},u=()=>{};return(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)(X.r,{}),r.isPending?(0,d.jsx)(Y.A,{animation:"border",role:"status",size:"sm",children:(0,d.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):(0,d.jsx)(p.A,{onClick:e=>{(0,X.P)({target:e.currentTarget,message:"Do you want to delete this record?",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:c,reject:u})},color:"#98A2B3",size:16,className:"cursor-pointer"})]})},ee="edit-merge-calculation_mergeButton__MJN7A",te="edit-merge-calculation_deleteButton__5ACo9",le=_.Ik({title:_.Yj().required("Title is required"),description:_.Yj().required("Description is required")}).required(),se=e=>{var t;let{merge:l,alias:a,setMerges:i,refetch:n,deleteMergeCalculator:o}=e;const[r,c]=(0,s.useState)(!1),u=a,[x,m]=(0,s.useState)({title:(null===l||void 0===l?void 0:l.title)||"",description:(null===l||void 0===l?void 0:l.description)||""}),{register:h,reset:v,handleSubmit:j,formState:{errors:b}}=(0,q.mN)({resolver:(0,F.t)(le),defaultValues:x});(0,s.useEffect)((()=>{v()}),[a]);(0,B.n)({mutationFn:e=>(0,g.tA)(e),onSuccess:e=>{n(),f(),S.oR.success("New merge items created successfully.")},onError:e=>{console.error("Error creating task:",e),S.oR.error("Failed to create new merge items. Please try again.")}});const f=()=>c(!1);return(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)($.A,{type:"button",onClick:()=>c(!0),className:(0,C.A)(ee,"text-button"),children:"Edit"}),(0,d.jsxs)(R.A,{size:"lg",show:r,centered:!0,onHide:f,className:(0,C.A)("task-form","mergeForm"),children:[(0,d.jsx)(R.A.Header,{closeButton:!0,children:(0,d.jsxs)(R.A.Title,{className:"d-flex align-items-center",style:{padding:"24px"},children:[(0,d.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"36px",height:"36px",borderRadius:"50%",border:"1px solid #EAECF0",background:"#F2F4F7",color:"#344054",fontSize:"14px",fontWeight:600},children:u}),(0,d.jsx)("span",{className:"modal-task-title",children:"Edit Merge Items"})]})}),(0,d.jsx)(R.A.Body,{className:"px-0",children:(0,d.jsxs)(k.A,{onSubmit:j((e=>{var t;const s={...e,alias:u,calculators:null===l||void 0===l||null===(t=l.calculators)||void 0===t?void 0:t.map((e=>({calculator:e.calculator,id:e.id,label:e.label,total:e.total,description:e.description})))};i((e=>e.map((e=>e.alias===u?{...e,...s}:e)))),f()})),children:[(0,d.jsxs)("div",{className:"px-4",style:{maxHeight:"450px",overflow:"auto"},children:[(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{children:"Task Title"}),(0,d.jsx)(k.A.Control,{...h("title"),type:"text",placeholder:"Merge items title",className:""+(b.title?"border border-danger":"")}),b.title&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:b.title.message})]}),(0,d.jsxs)(k.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,d.jsx)(k.A.Label,{children:"Describe merging items"}),(0,d.jsx)(k.A.Control,{as:"textarea",rows:2,placeholder:"Enter a description...",...h("description"),style:{height:"80px",outline:"none",boxShadow:"none"},className:""+(b.description?"border border-danger":"")}),b.description&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:b.description.message})]}),(0,d.jsx)(E.A,{variant:"flush border rounded mb-4",style:{border:"1px solid var(--Gray-100, #F2F4F7)"},children:null===l||void 0===l||null===(t=l.calculators)||void 0===t?void 0:t.map(((e,t)=>(0,d.jsx)(E.A.Item,{className:"d-flex justify-content-between",children:(0,d.jsxs)(L.A,{className:"w-100",children:[(0,d.jsx)(z.A,{sm:4,className:"text-start",children:(0,d.jsx)("span",{style:{color:"#101828",fontSize:"16px"},children:(null===e||void 0===e?void 0:e.label)||""})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsx)("span",{style:{color:"#101828",fontSize:"16px"},children:(null===e||void 0===e?void 0:e.description)||""})}),(0,d.jsxs)(z.A,{sm:2,className:"text-end text-nowrap",children:[(0,d.jsxs)("span",{style:{color:"#101828",fontSize:"16px",textAlign:"end"},children:["$ ",parseFloat(null===e||void 0===e?void 0:e.total).toFixed(2)]}),(0,d.jsx)(p.A,{onClick:()=>o(e.calculator),color:"#98A2B3",size:16,className:"ms-2",style:{position:"relative",left:"20px",cursor:"pointer"}})]})]})},`${t}-${e.id}`)))})]}),(0,d.jsxs)(R.A.Footer,{className:"d-flex justify-content-between align-items-center",children:[(0,d.jsx)($.A,{type:"button",onClick:()=>{c(!1)},className:te,children:(0,d.jsx)(p.A,{color:"#B42318",size:18})}),(0,d.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,d.jsx)($.A,{type:"button",onClick:f,className:"outline-button",style:{minWidth:"67px"},children:"Cancel"}),(0,d.jsx)($.A,{type:"submit",className:"solid-button",style:{minWidth:"67px"},children:"Save"})]})]})]})})]})]})},ae=e=>{let{unique_id:t,merges:l,setMerges:s,refetch:a,deleteMergeCalculator:i}=e;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:(0,C.A)("w-100",G),style:{}}),(null===l||void 0===l?void 0:l.length)&&(0,d.jsx)("p",{className:"mb-0",style:{fontSize:"14px",fontWeight:"500",color:"#475467"},children:"Merged Items"})||"",l.map(((e,t)=>{var l;return(0,d.jsxs)("div",{className:(0,C.A)("d-flex align-items-center gap-3",U),children:[(0,d.jsx)("div",{className:(0,C.A)("d-flex justify-content-center align-items-center",O),children:null===e||void 0===e?void 0:e.alias}),(0,d.jsxs)("div",{className:"d-flex align-items-center gap-3",style:{width:"317px"},children:[(0,d.jsx)(J,{title:e.title,alias:null===e||void 0===e?void 0:e.alias,items:e.calculators}),(0,d.jsx)(se,{merge:e,setMerges:s,alias:null===e||void 0===e?void 0:e.alias,deleteMergeCalculator:i})]}),(0,d.jsxs)("span",{style:{minWidth:"120px",color:"#667085"},children:["$ ",(null===e||void 0===e||null===(l=e.calculators)||void 0===l?void 0:l.reduce(((e,t)=>e+parseFloat(t.total)),0).toFixed(2))||"0.00"]}),(0,d.jsx)(Z,{id:e.id,alias:null===e||void 0===e?void 0:e.alias,refetch:a,setMerges:s})]},`${t}-${e.id}`)})),(null===l||void 0===l?void 0:l.length)&&(0,d.jsx)("div",{className:(0,C.A)("w-100",K)})||""]})},ie=e=>{let{srNo:t,departments:l,handleChange:s}=e;return(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{width:"24px"}}),(0,d.jsx)("td",{style:{width:"64px",textAlign:"left"},children:t+1}),(0,d.jsx)("td",{style:{width:"192px"},children:(0,d.jsx)(A,{departments:l,handleChange:s,isShowlabel:!1})}),(0,d.jsx)("td",{style:{width:"100%",paddingTop:"10px"},children:(0,d.jsx)("textarea",{disabled:!0,rows:1,placeholder:"Enter a description...",style:{background:"transparent",border:"0px solid #fff",resize:"none",boxSizing:"border-box"},onChange:e=>{}})}),(0,d.jsx)("td",{style:{width:"128px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("span",{style:{color:"#475467"},children:"$"}),(0,d.jsx)("input",{type:"text",disabled:!0,style:{padding:"4px",width:"100px",background:"transparent",color:"#98A2B3"},value:"0.00",onChange:e=>{}})]})}),(0,d.jsx)("td",{style:{width:"185px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",disabled:!0,style:{padding:"4px",width:"60px",background:"transparent",color:"#98A2B3"},value:"0.00",onChange:e=>{}}),(0,d.jsxs)("select",{value:"MRG",style:{border:"0px solid #fff",background:"transparent"},onChange:e=>{},children:[(0,d.jsx)("option",{value:"MRG",children:"MRG %"}),(0,d.jsx)("option",{value:"AMN",children:"AMT $"}),(0,d.jsx)("option",{value:"MRK",children:"MRK %"})]})]})}),(0,d.jsxs)("td",{style:{width:"118px",textAlign:"left"},children:["$ ","0.00"]}),(0,d.jsx)("td",{style:{width:"166px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",disabled:!0,style:{padding:"4px",width:"60px",background:"transparent",color:"#98A2B3"},value:"0.00",onChange:e=>{}}),(0,d.jsxs)("select",{value:"Cost",style:{border:"0px solid #fff",background:"transparent"},onChange:e=>{},children:[(0,d.jsx)("option",{value:"Cost",children:"1/Q"}),(0,d.jsx)("option",{value:"Hourly",children:"1/H"})]})]})}),(0,d.jsx)("td",{style:{width:"83px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",style:{width:"60px",padding:"4px",background:"transparent",color:"#98A2B3"},value:"0.00",onChange:e=>{}}),(0,d.jsx)("span",{children:"%"})]})}),(0,d.jsxs)("td",{style:{width:"118px",textAlign:"left"},children:["$ ","0.00"]}),(0,d.jsx)("td",{style:{width:"32px"},children:(0,d.jsx)(p.A,{color:"#98A2B3",style:{cursor:"not-allowed",opacity:".5"},onClick:()=>{}})})]})},ne=()=>(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{style:{width:"24px"}}),(0,d.jsx)("th",{style:{width:"64px",textAlign:"left"},children:"Order"}),(0,d.jsx)("th",{style:{width:"192px"},children:"Department"}),(0,d.jsx)("th",{style:{width:"100%"},children:"Description"}),(0,d.jsx)("th",{style:{width:"128px"},children:"Cost"}),(0,d.jsx)("th",{style:{width:"185px"},children:"Markup / Margin"}),(0,d.jsx)("th",{style:{width:"118px"},children:"Unit Price"}),(0,d.jsx)("th",{style:{width:"166px"},children:"Qty / Unit"}),(0,d.jsx)("th",{style:{width:"83px"},children:"Discount"}),(0,d.jsx)("th",{style:{width:"118px"},children:"Amount"}),(0,d.jsx)("th",{style:{width:"32px"}})]})}),oe=e=>{let{rows:t,updateData:l,deleteRow:a,defaultDiscount:i,selectItem:n,setSelectItem:o,mapMergeItemWithNo:r,checkedItems:c=[]}=e;return(0,d.jsx)(d.Fragment,{children:Object.entries(t).map(((e,t)=>{let[i,x]=e;return(0,d.jsx)(s.Fragment,{children:null===x||void 0===x?void 0:x.map(((e,s)=>(0,d.jsx)(u.sx,{draggableId:`row-${i}-${e.id}`,index:t,children:u=>(0,d.jsxs)("tr",{ref:u.innerRef,...u.draggableProps,style:{...u.draggableProps.style,cursor:"default"},className:"calculation-tr "+(c.includes(i)?"selected":""),children:[(0,d.jsx)("td",{...u.dragHandleProps,style:{width:"24px"},children:0===s&&(0,d.jsx)(m.A,{color:"#98A2B3",style:{cursor:"move"}})}),(0,d.jsx)("td",{calculator:e.calculator,style:{width:"64px",textAlign:"left"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[0===s&&(0,d.jsx)("span",{children:t+1}),r[e.calculator]?(0,d.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"20px",height:"20px",borderRadius:"24px",background:"#F2F4F7",border:"1px solid #EAECF0",color:"#344054",fontSize:"10px",marginRight:"0px"},children:r[e.calculator]}):(0,d.jsxs)("label",{className:"customCheckBox checkbox",style:{marginRight:"0px"},children:[(0,d.jsx)("input",{type:"checkbox",checked:!!n[e.id],onChange:t=>((e,t)=>{o((l=>{if(e.target.checked){const e={label:t.label,description:null===t||void 0===t?void 0:t.description,calculator:null===t||void 0===t?void 0:t.calculator,id:null===t||void 0===t?void 0:t.id,index:null===t||void 0===t?void 0:t.index,total:null===t||void 0===t?void 0:t.total};return{...l,[null===t||void 0===t?void 0:t.id]:[e]}}{const e={...l};return e[null===t||void 0===t?void 0:t.id]&&delete e[null===t||void 0===t?void 0:t.id],e}}))})(t,e)}),(0,d.jsx)("span",{className:"checkmark",style:{top:"0px"},children:(0,d.jsx)(h.A,{color:"#1AB2FF",size:20})})]})]})}),(0,d.jsx)("td",{style:{width:"192px"},children:0===s&&(0,d.jsxs)("div",{className:"disabledSelectBox",children:[(0,d.jsx)("div",{title:e.label,className:"disabledSelectBoxLabel",style:{color:"#101828",fontSize:"14px"},children:e.label})," ",(0,d.jsx)(v.A,{color:"#98A2B3",size:15})]})}),(0,d.jsx)("td",{style:{width:"100%"},children:(0,d.jsx)("textarea",{rows:1,style:{background:"transparent",border:"0px solid #fff",resize:"none",boxSizing:"border-box",fontSize:"14px"},value:e.description,onChange:t=>l(i,e.id,"description",t.target.value)})}),(0,d.jsx)("td",{style:{width:"128px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("span",{style:{fontSize:"14px"},children:"$"}),(0,d.jsx)("input",{type:"text",style:{padding:"4px",width:"100px",background:"transparent",fontSize:"14px"},value:`${e.cost}`,onChange:t=>l(i,e.id,"cost",t.target.value)})]})}),(0,d.jsx)("td",{style:{width:"185px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",style:{padding:"4px",width:"60px",background:"transparent",fontSize:"14px"},value:`${e.profit_type_value}`,onChange:t=>l(i,e.id,"profit_type_value",t.target.value)}),(0,d.jsxs)("select",{value:e.profit_type,style:{border:"0px solid #fff",background:"transparent",fontSize:"14px"},onChange:t=>l(i,e.id,"profit_type",t.target.value),children:[(0,d.jsx)("option",{value:"MRG",children:"MRG %"}),(0,d.jsx)("option",{value:"AMN",children:"AMT $"}),(0,d.jsx)("option",{value:"MRK",children:"MRK %"})]})]})}),(0,d.jsxs)("td",{style:{width:"118px",textAlign:"left",fontSize:"14px"},children:["$ ",e.unit_price||"0.00"]}),(0,d.jsx)("td",{style:{width:"166px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",style:{padding:"4px",width:"60px",background:"transparent",fontSize:"14px"},value:`${e.quantity}`,onChange:t=>l(i,e.id,"quantity",t.target.value)}),(0,d.jsxs)("select",{value:e.type,style:{border:"0px solid #fff",background:"transparent",fontSize:"14px"},onChange:t=>l(i,e.id,"type",t.target.value),children:[(0,d.jsx)("option",{value:"Cost",children:"1/Q"}),(0,d.jsx)("option",{value:"Hourly",children:"1/H"})]})]})}),(0,d.jsx)("td",{style:{width:"83px"},children:(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("input",{type:"text",style:{width:"60px",padding:"4px",background:"transparent",fontSize:"14px"},value:`${e.discount}`,onChange:t=>l(i,e.id,"discount",t.target.value)}),(0,d.jsx)("span",{style:{fontSize:"14px"},children:"%"})]})}),(0,d.jsxs)("td",{style:{width:"118px",textAlign:"left",fontSize:"14px"},children:["$ ",e.total||0]}),(0,d.jsx)("td",{style:{width:"32px"},children:(0,d.jsx)(p.A,{color:"#98A2B3",style:{cursor:"pointer"},onClick:()=>a(i,e.id,e.calculator)})})]},e.id)},`${i}-${e.id}`)))},i)}))})},re=e=>{let{setTotals:t,setPayload:l,defaultDiscount:a,xero_tax:i,preExistCalculation:n,preMerges:r,refetch:c,setMergeDeletedItems:p}=e;const{unique_id:m}=(0,o.g)(),[h,v]=(0,s.useState)({}),[j,b]=(0,s.useState)(null),[f,y]=(0,s.useState)(null),[A,N]=(0,s.useState)([]),[C,_]=(0,s.useState)([]),[k,q]=(0,s.useState)({}),[B,F]=(0,s.useState)({}),{data:$}=(0,x.I)({queryKey:["departments"],queryFn:g.ax,enabled:!0}),{isLoading:R,data:E}=(0,x.I)({queryKey:["calcReferenceId",j],queryFn:()=>(0,g.Dc)(j),enabled:!!j,retry:1}),L=(e,t)=>{e&&b(e),t&&y(t)},z=e=>{let t=(parseFloat(e.cost)||0)*(parseFloat(e.quantity)||0),l=parseFloat(e.profit_type_value)||0;return"MRK"===e.profit_type?t+=t*l/100:"MRG"===e.profit_type?t/=1-l/100:"AMN"===e.profit_type&&(t+=l),(t-t*(parseFloat(e.discount)||0)/100).toFixed(2)},T=e=>{let t=parseFloat(e.cost)||0,l=0,s=parseFloat(e.profit_type_value)||0;return"MRK"===e.profit_type?l=t+t*(s/100):"MRG"===e.profit_type?l=t/(1-s/100):"AMN"===e.profit_type&&(l=t+s),l.toFixed(2)},P=(e,t,l,s)=>{v((a=>({...a,[e]:a[e].map((e=>{if(e.id===t){const t={...e,[l]:s};return"MRG"===t.profit_type&&t.profit_type_value>=100&&(t.profit_type_value=99.99),t.unit_price=T(t),t.total=z(t),t}return e}))})))},I=e=>{let t=[];const l=C.reduce(((l,s)=>{const a=s.calculators.filter((t=>t.calculator!==e));return a.length<2?(s.id&&m&&t.push(s.id),l):(l.push({...s,calculators:a}),l)}),[]);_(l),p((e=>[...new Set([...e,...t])]))},D=(e,t,l)=>{v((l=>{const s={...l,[e]:l[e].filter((e=>e.id!==t))};return 0===s[e].length&&delete s[e],s})),I(l)};(0,s.useEffect)((()=>{if(E&&E.length){E.length?E.forEach((e=>{e.label=f,e.calculator=e.id,e.index=j,e.discount=a,e.unit_price=T(e),e.total=z(e)})):E.push({label:f,calculator:E.id,index:j,discount:a});let e=E.filter(((e,t,l)=>t===l.findIndex((t=>t.id===e.id))));j&&!h[j]&&v((t=>({...t,[`_${j}_`]:e})))}0===(null===E||void 0===E?void 0:E.length)&&(console.log("data.length: ",E.length),S.oR.error(`No calculation found inside ${f}`))}),[E]);return(0,s.useEffect)((()=>{var e;const s=(e=>{var t;let l=0,s=0;null===(t=Object.values(h))||void 0===t||t.forEach((e=>{null===e||void 0===e||e.forEach((e=>{let t=parseFloat(e.cost)||0,a=parseFloat(e.quantity)||0;l+=parseFloat(t*a||0),s+=parseFloat(e.total||0)}))}));let a=0,i=0;"ex"===e?(a=.1*s,i=s+a):"in"===e?(i=s,a=.1*i/1.1,s=i-a):"no"===e&&(a=0,i=s);const n=s-l;return{budget:l.toFixed(2),operationalProfit:n.toFixed(2),subtotal:s.toFixed(2),tax:a.toFixed(2),total:i.toFixed(2)}})(i);t(s);const a=null===(e=Object.values(h))||void 0===e?void 0:e.flat().map(((e,t)=>{const{id:l,...s}=e;return{...s,cost:parseFloat(s.cost||0).toFixed(2),profit_type_value:parseFloat(s.profit_type_value||0).toFixed(2),unit_price:parseFloat(s.unit_price||0).toFixed(),quantity:parseFloat(s.quantity||0).toFixed(2),discount:parseFloat(s.discount||0).toFixed(2),order:t}}));l((e=>({...e,expense:s.total||"",calculations:a})))}),[h,i]),(0,s.useEffect)((()=>{N(r)}),[r]),(0,s.useEffect)((()=>{if(null===n||void 0===n||!n.length||null===$||void 0===$||!$.length)return;const e=$.reduce(((e,t)=>(t.subindexes.forEach((t=>{e[t.id]=t.name})),e)),{}),t=n.reduce(((t,l)=>{let{order:s,index:a,...i}=l;const n=`_${a}_`;t[n]=t[n]||[];let o=i.unit_price;return"0.00"===i.unit_price&&(o=T(i)),t[n].push({...i,unit_price:o,label:e[a],index:a}),t}),{}),l=A.map(((t,l)=>{var s;const a=(0,M.Mf)(l+1),i=null===t||void 0===t||null===(s=t.calculators)||void 0===s?void 0:s.map((t=>{const l=n.find((e=>e.id===t.calculator));return{label:e[null===l||void 0===l?void 0:l.index],description:null===l||void 0===l?void 0:l.description,total:null===l||void 0===l?void 0:l.total,id:null===l||void 0===l?void 0:l.id,calculator:null===l||void 0===l?void 0:l.calculator}}));return{...t,alias:a,calculators:i}}));v(t),_(l)}),[n,A,$]),(0,s.useEffect)((()=>{if(null!==$&&void 0!==$&&$.length){const e={};null===C||void 0===C||C.forEach(((t,l)=>{var s;const a=(0,M.Mf)(l+1);null===t||void 0===t||null===(s=t.calculators)||void 0===s||s.forEach((t=>{e[t.calculator]=a}))})),F(e),l((e=>({...e,merges:C})))}}),[C]),(0,d.jsxs)("div",{children:[(0,d.jsx)(u.JY,{onDragEnd:e=>{const{source:t,destination:l}=e;if(!l)return;const s=Object.keys(h),a=s[t.index],i=s[l.index];if(!a||!i)return void console.error("Invalid source or destination key.");const n=Array.from(s),[o]=n.splice(t.index,1);n.splice(l.index,0,o);const r=n.reduce(((e,t)=>(e[t]=h[t],e)),{});v(r)},children:(0,d.jsxs)("table",{className:"w-100 department-calculation",children:[(0,d.jsx)(ne,{}),(0,d.jsx)(u.gL,{droppableId:"departmentQuoteTable",children:e=>(0,d.jsxs)("tbody",{...e.droppableProps,ref:e.innerRef,children:[(0,d.jsx)(oe,{rows:h,updateData:P,deleteRow:D,defaultDiscount:a,selectItem:k,setSelectItem:q,mapMergeItemWithNo:B,checkedItems:Object.keys(k)}),R&&(0,d.jsx)(w,{}),(0,d.jsx)(ie,{srNo:Object.keys(h||{}).length,departments:$,handleChange:L}),e.placeholder]})})]})}),(0,d.jsxs)("div",{className:"merge-section",style:{marginTop:"20px",textAlign:"left"},children:[(0,d.jsx)(W,{unique_id:m,selectItem:k,setSelectItem:q,merges:C,setMerges:_,setPayload:l,refetch:c,setPreExistMerges:N}),(0,d.jsx)(ae,{unique_id:m,merges:C,setMerges:_,refetch:c,deleteMergeCalculator:I})]})]})};var de=l(53193),ce=l(69285),ue=l(37970),xe=l(77918),pe=l(73898),me=l(57290),he=l(90922),ve=l(71666),ge=l(37753);const je=e=>{let{isLoading:t,data:l}=e;const[a,i]=(0,s.useState)(!1),[n,o]=(0,s.useState)(l.name||""),[r,c]=(0,s.useState)(l.phone||""),[u,x]=(0,s.useState)(l.email||""),[p,m]=(0,s.useState)(l.contact_persons||[]),[h,g]=(0,s.useState)(l.addresses||[]),[j,b]=(0,s.useState)(""),[f,y]=(0,s.useState)(""),A=h.find((e=>e.is_main))||(null!==h&&void 0!==h&&h.length?h[0]:{}),w=p.find((e=>e.is_main))||(null!==p&&void 0!==p&&p.length?p[0]:{}),[S,C]=(0,s.useState)({name:!1});return(0,d.jsx)(d.Fragment,{children:a?(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{sm:6,children:(0,d.jsx)(de.A,{className:"mb-3 mui-select-custom",fullWidth:!0,children:(0,d.jsx)(ce.A,{value:n,onChange:e=>o(e.target.value),displayEmpty:!0,IconComponent:v.A,style:{color:"#101828"},children:(0,d.jsx)(ue.A,{value:"",children:"[ Business Name 1 ]"})})})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsx)(de.A,{className:"mb-3 mui-select-custom",fullWidth:!0,children:(0,d.jsx)(ce.A,{value:f,onChange:e=>y(e.target.value),displayEmpty:!0,IconComponent:v.A,style:{color:"#101828"},children:null===p||void 0===p?void 0:p.map(((e,t)=>(0,d.jsx)(ue.A,{value:t,children:`${(null===e||void 0===e?void 0:e.firstname)||"-"} ${(null===e||void 0===e?void 0:e.lastname)||"-"}`})))})})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{style:{color:"#667085",fontSize:"14px",fontWeight:400,marginBottom:"4px"},children:"ABN"}),(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Enter ABN",value:"32 635 443 221",className:"border-0 p-0",style:{color:"#475467",fontWeight:600,fontSize:"16px",boxShadow:"none",outline:"none"},onChange:e=>o(e.target.value)}),S.taskTitle&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:"ABN is required"})]})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{style:{color:"#667085",fontSize:"14px",fontWeight:400,marginBottom:"4px"},children:"Phone"}),(0,d.jsxs)(ve.A,{children:[(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Enter phone",value:r,className:"border-0 p-0",style:{color:"#475467",fontWeight:600,fontSize:"16px",boxShadow:"none",outline:"none"},onChange:e=>c(e.target.value)}),(0,d.jsx)(ve.A.Text,{className:"border-0 bg-white",children:(0,d.jsx)(ge.A,{color:"#1AB2FF"})})]}),S.taskTitle&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:"Phone number is required"})]})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{style:{color:"#667085",fontSize:"14px",fontWeight:400,marginBottom:"4px"},children:"Email"}),(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Enter email",value:u,className:"border-0 p-0",style:{color:"#475467",fontWeight:600,fontSize:"16px",boxShadow:"none",outline:"none"},onChange:e=>x(e.target.value)}),S.taskTitle&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:"Email is required"})]})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsx)(de.A,{className:"mb-3 mui-select-custom",fullWidth:!0,children:(0,d.jsx)(ce.A,{value:j,onChange:e=>b(e.target.value),displayEmpty:!0,IconComponent:v.A,style:{color:"#101828"},children:null===h||void 0===h?void 0:h.map(((e,t)=>(0,d.jsx)(ue.A,{value:t,children:null===e||void 0===e?void 0:e.address})))})})}),(0,d.jsxs)(z.A,{sm:12,className:"d-flex",style:{gap:"16px"},children:[(0,d.jsx)("button",{onClick:()=>{},className:"btn p-0",style:{color:"#158ECC",fontSize:"14px",fontWeight:"600"},children:"Save"}),(0,d.jsx)("button",{onClick:()=>i(!a),className:"btn p-0",style:{color:"#B42318",fontSize:"14px",fontWeight:"600"},children:"Cancel"})]})]}):(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{children:t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{style:{color:"#667085",fontSize:"14px",fontWeight:"600",marginBottom:"4px"},children:"Company"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:(null===l||void 0===l?void 0:l.name)||"-"}),(0,d.jsxs)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:["ABN: ",(null===l||void 0===l?void 0:l.abn)||"-"]}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:(null===l||void 0===l?void 0:l.phone)||"-"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"8px"},children:(null===A||void 0===A?void 0:A.address)||"-"})]})}),(0,d.jsxs)(z.A,{children:[(0,d.jsx)("p",{style:{color:"#667085",fontSize:"14px",fontWeight:"600",marginBottom:"4px"},children:"Main Contact"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:`${(null===w||void 0===w?void 0:w.firstname)||"-"} ${(null===w||void 0===w?void 0:w.lastname)||"-"}`}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:`${(null===w||void 0===w?void 0:w.position)||"-"}`}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:`${(null===w||void 0===w?void 0:w.phone)||"-"}`}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:`${(null===w||void 0===w?void 0:w.email)||"-"}`})]}),(0,d.jsx)(z.A,{sm:12})]})})},be=e=>{var t;let{isLoading:l,data:a}=e;const[i,n]=(0,s.useState)(!1),[o,r]=(0,s.useState)((null===a||void 0===a?void 0:a.name)||""),[c,u]=(0,s.useState)((null===a||void 0===a?void 0:a.phone)||""),[x,p]=(0,s.useState)((null===a||void 0===a?void 0:a.email)||""),[m,h]=(0,s.useState)((null===a||void 0===a||null===(t=a.contact_persons)||void 0===t?void 0:t[0])||{}),[g,j]=(0,s.useState)({name:!1});return(0,s.useEffect)((()=>{a&&r(a.name)}),[a]),(0,d.jsx)(d.Fragment,{children:i?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(z.A,{sm:12,children:(0,d.jsx)(de.A,{className:"mb-3 mui-select-custom",fullWidth:!0,children:(0,d.jsx)(ce.A,{value:m,onChange:e=>h(e.target.value),displayEmpty:!0,IconComponent:v.A,style:{color:"#101828"},children:(0,d.jsx)(ue.A,{value:"",children:"Paul Stein"})})})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{style:{color:"#667085",fontSize:"14px",fontWeight:400,marginBottom:"4px"},children:"Email"}),(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Enter ABN",value:"company@email.com",className:"border-0 p-0",style:{color:"#475467",fontWeight:600,fontSize:"16px",boxShadow:"none",outline:"none"},onChange:e=>r(e.target.value)}),g.taskTitle&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:"Email is required"})]})}),(0,d.jsx)(z.A,{sm:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3",children:[(0,d.jsx)(k.A.Label,{style:{color:"#667085",fontSize:"14px",fontWeight:400,marginBottom:"4px"},children:"Phone"}),(0,d.jsxs)(ve.A,{children:[(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Enter ABN",value:"+61-8-8533-5602",className:"border-0 p-0",style:{color:"#475467",fontWeight:600,fontSize:"16px",boxShadow:"none",outline:"none"},onChange:e=>r(e.target.value)}),(0,d.jsx)(ve.A.Text,{className:"border-0 bg-white",children:(0,d.jsx)(ge.A,{color:"#1AB2FF"})})]}),g.taskTitle&&(0,d.jsx)(k.A.Text,{className:"text-danger",children:"Task title is required"})]})}),(0,d.jsxs)(z.A,{sm:12,className:"d-flex",style:{gap:"16px"},children:[(0,d.jsx)("button",{onClick:()=>{},className:"btn p-0",style:{color:"#158ECC",fontSize:"14px",fontWeight:"600"},children:"Save"}),(0,d.jsx)("button",{onClick:()=>n(!i),className:"btn p-0",style:{color:"#B42318",fontSize:"14px",fontWeight:"600"},children:"Cancel"})]})]}):(0,d.jsx)(z.A,{children:l?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"p",animation:"wave",className:"mb-1 mt-0",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,d.jsx)(N.A,{as:"div",animation:"wave",className:"mt-4",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",size:"md",style:{width:"100px",height:"30px",borderRadius:"4px"}})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{style:{color:"#667085",fontSize:"14px",fontWeight:"600",marginBottom:"4px"},children:"Main Contact"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:o||"-"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:m.position||"-"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"4px"},children:c||"-"}),(0,d.jsx)("p",{style:{color:"#1D2939",fontSize:"16px",fontWeight:"400",marginBottom:"8px"},children:x||""})]})})})};var fe=l(59638);const ye=e=>(0,d.jsxs)(me.c.Option,{...e,children:[(0,d.jsx)("img",{src:e.data.image,alt:e.data.label,style:{width:20,height:20,marginRight:10}}),e.data.label]}),Ae=s.memo((e=>{var t,l,a,i;let{payload:n,setPayload:o,setTotals:r,refetch:u,preExistCalculation:p,preExistMerges:m,setMergeDeletedItems:h,setContactPersons:g}=e;const[j,b]=(0,s.useState)(""),[f,y]=(0,s.useState)([]),[A,w]=(0,s.useState)(""),[S,C]=(0,s.useState)(!1),[_,q]=(0,s.useState)(""),[B,F]=(0,s.useState)(!1),$=e=>{w(e.target.value),q(e.target.value)},R=(0,x.I)({queryKey:["project-manager"],queryFn:fe.Fl}),E=(0,x.I)({queryKey:["id",n.client],queryFn:()=>(0,fe.EZ)(n.client),enabled:!!n.client,retry:1});return(0,s.useEffect)((()=>{var e,t;if(null!==(e=E.data)&&void 0!==e&&null!==(t=e.contact_persons)&&void 0!==t&&t.length){var l,s,a;let e=null===(l=E.data)||void 0===l?void 0:l.contact_persons[0],t=null===(s=E.data)||void 0===s?void 0:s.contact_persons.find((e=>!0===e.is_main));o(t?e=>({...e,contact_person:t.id}):t=>({...t,contact_person:e.id})),g(null===(a=E.data)||void 0===a?void 0:a.contact_persons)}}),[E.data]),(0,s.useEffect)((()=>{if(n.managers){const e=n.managers.reduce(((e,t)=>(e.some((e=>e.manager===t.manager))||e.push(t),e)),[]).map((e=>{var t,l,s,a;return{value:e.manager,label:(null===R||void 0===R||null===(t=R.data)||void 0===t||null===(l=t.find((t=>t.id===e.manager)))||void 0===l?void 0:l.name)||"Unknown",image:(null===R||void 0===R||null===(s=R.data)||void 0===s||null===(a=s.find((t=>t.id===e.manager)))||void 0===a?void 0:a.photo)||"https://dev.memate.com.au/media/no_org.png"}}));y(e)}}),[n.managers,R.data]),(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)("div",{className:"company-info text-left",style:{background:"#fff",borderRadius:"4px",padding:"16px",marginBottom:"16px"},children:(0,d.jsxs)(L.A,{children:[(0,d.jsxs)(z.A,{md:8,style:{borderRight:"1px solid #F2F4F7"},children:[(0,d.jsxs)("h3",{style:{color:"#344054",fontSize:"16px",fontWeight:"600"},children:["Reference  ",(0,d.jsx)(xe.A,{color:"#667085",size:16})]}),E.isLoading?(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):S?(0,d.jsx)("p",{children:(0,d.jsx)("input",{type:"text",value:A,onChange:$,onBlur:()=>{C(!1),o((e=>({...e,reference:A})))},autoFocus:!0,className:"border rounded p-2 w-100"})}):(0,d.jsx)("div",{children:(0,d.jsxs)("p",{style:{color:"#475467",fontSize:"16px",fontWeight:"400",marginBottom:"16px",whiteSpace:"pre-line"},children:[n.reference,(0,d.jsx)(pe.A,{size:16,color:"#106B99",onClick:()=>{C(!0),w(n.reference||"")},className:"ms-2",style:{cursor:"pointer"}})]})}),(0,d.jsx)("h3",{style:{color:"#344054",fontSize:"16px",fontWeight:"600"},children:"Description"}),E.isLoading?(0,d.jsx)(N.A,{as:"p",animation:"wave",children:(0,d.jsx)(N.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):B?(0,d.jsx)("p",{children:(0,d.jsx)("textarea",{type:"text",value:_,onChange:$,onBlur:()=>{F(!1),o((e=>({...e,description:_})))},autoFocus:!0,className:"border rounded p-2",style:{resize:"none",width:"100%",height:"120px"}})}):(0,d.jsx)("div",{children:(0,d.jsxs)("p",{style:{color:"#475467",fontSize:"16px",fontWeight:"400",marginBottom:"16px",whiteSpace:"pre-line"},children:[n.description,(0,d.jsx)(pe.A,{size:16,color:"#106B99",onClick:()=>{F(!0),q(n.description||"")},className:"ms-2",style:{cursor:"pointer"}})]})})]}),(0,d.jsxs)(z.A,{md:4,children:[(0,d.jsxs)("h3",{style:{color:"#344054",fontSize:"16px",fontWeight:"600"},children:["Quote To  ",(0,d.jsx)(xe.A,{color:"#667085",size:16})]}),(0,d.jsx)(L.A,{children:null!==E&&void 0!==E&&null!==(t=E.data)&&void 0!==t&&t.is_business?(0,d.jsx)(je,{isLoading:null===E||void 0===E?void 0:E.isLoading,data:null===E||void 0===E?void 0:E.data}):(0,d.jsx)(be,{isLoading:null===E||void 0===E?void 0:E.isLoading,data:null===E||void 0===E?void 0:E.data})})]})]})}),(0,d.jsxs)("div",{className:"DepartmentQuote",style:{background:"#fff",borderRadius:"4px",padding:"16px"},children:[(0,d.jsx)(re,{setTotals:r,setPayload:o,xero_tax:n.xero_tax,defaultDiscount:null===E||void 0===E||null===(l=E.data)||void 0===l||null===(a=l.category)||void 0===a?void 0:a.value,preExistCalculation:p,preMerges:m,refetch:u,setMergeDeletedItems:h}),(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{md:6,children:(0,d.jsxs)(k.A.Group,{className:"mb-3 text-start note-textarea",controlId:"exampleForm.ControlTextarea1",children:[(0,d.jsx)(k.A.Label,{style:{color:"#475467",fontSize:"14px"},children:"Notes on the quote/invoice"}),(0,d.jsx)(k.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:n.note||"",onChange:e=>o((t=>({...t,note:e.target.value}))),required:!0,className:"textarea",style:{height:"229px",padding:"12px 14px",resize:"none"}})]})}),(0,d.jsx)(z.A,{md:6,children:(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{children:(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{sm:12,className:"text-start",children:(0,d.jsxs)("div",{className:"formgroupboxs mb-3 mt-1",children:[(0,d.jsxs)("label",{style:{color:"#475467",fontSize:"14px",display:"block",marginBottom:"6px"},children:["Project Manager ",(0,d.jsx)("sup",{className:"text-danger",children:"*"})]}),(0,d.jsx)("div",{className:"inputInfo px-0",style:{minHeight:"46px",height:"fit-content",padding:"0px 14px"},children:(0,d.jsx)(he.Ay,{placeholder:"Select Manager",className:"basic-multi-select w-100 border-0",closeMenuOnSelect:!1,components:{Option:ye},value:f,onChange:e=>{const t=e?[...new Map(e.map((e=>[e.value,{manager:e.value}]))).values()]:[];y(e),o((e=>({...e,managers:t||[]})))},isMulti:!0,styles:{control:e=>({...e,boxShadow:"none"}),multiValueRemove:e=>({...e,":hover":{backgroundColor:"#fff",cursor:"pointer"}}),multiValue:(e,t)=>{let{data:l}=t;return{...e,backgroundColor:"#fff",border:"1px solid #D0D5DD",borderRadius:"4px",":before":{borderRadius:"50%",content:'" "',backgroundImage:`url(${l.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",display:"block",marginRight:8,position:"relative",top:"5px",left:"5px",height:16,width:16,border:"0.3px solid #101828"}}}},options:null===R||void 0===R||null===(i=R.data)||void 0===i?void 0:i.map((e=>({value:e.id,label:e.name,image:e.photo||"https://dev.memate.com.au/media/no_org.png"})))})})]})}),(0,d.jsx)(z.A,{sm:12,className:"text-start",children:(0,d.jsxs)("div",{className:"formgroupboxs mb-3",children:[(0,d.jsx)("label",{style:{color:"#475467",fontSize:"14px",marginBottom:"6px"},children:"PO"}),(0,d.jsx)("div",{className:"inputInfo px-0",style:{height:"46px"},children:(0,d.jsx)(k.A.Control,{required:!0,type:"text",placeholder:"Purchase Order #",value:(null===n||void 0===n?void 0:n.purchase_order)||"",style:{color:"#101828"},className:"w-100 m-0 border-0 no-border-outline",onChange:e=>o((t=>({...t,purchase_order:e.target.value})))})})]})}),(0,d.jsx)(z.A,{sm:12,className:"text-start",children:(0,d.jsxs)(k.A.Group,{className:"mb-3 mui-select-custom",children:[(0,d.jsx)(k.A.Label,{style:{color:"#475467",fontSize:"14px",marginBottom:"6px"},children:"Amounts are"}),(0,d.jsx)(de.A,{sx:{m:0,minWidth:"100%",color:"#101828"},children:(0,d.jsxs)(ce.A,{value:(null===n||void 0===n?void 0:n.xero_tax)||"",onChange:e=>o((t=>({...t,xero_tax:e.target.value}))),displayEmpty:!0,inputProps:{"aria-label":"Without label"},IconComponent:v.A,children:[(0,d.jsx)(ue.A,{value:"ex",children:"Tax exclusive"}),(0,d.jsx)(ue.A,{value:"in",children:"Tax Inclusive"}),(0,d.jsx)(ue.A,{value:"no",children:"No tax"})]})})]})})]})}),(0,d.jsx)(z.A,{children:(0,d.jsxs)(L.A,{children:[(0,d.jsx)(z.A,{sm:12,className:"quoteInvoice",children:(0,d.jsxs)("div",{className:"radio-buttons mt-4 pt-3",children:[(0,d.jsx)(c,{label:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("b",{children:"Request Payment "})," ",(0,d.jsxs)("span",{children:[" Create an invoice requesting ",(0,d.jsx)("br",{}),"payment on a specific date"]})]}),name:"payment",value:"request",checked:"request"===j,onChange:()=>b("request")}),(0,d.jsx)(c,{label:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("b",{children:"Autocharge Customer "})," ",(0,d.jsxs)("span",{children:[" Automatically charge a payment",(0,d.jsx)("br",{})," method on file"]})]}),name:"payment",value:"auto",checked:"auto"===j,onChange:()=>b("auto")})]})}),(0,d.jsx)(z.A,{sm:12,children:(0,d.jsxs)("div",{className:"toggle-switch-wrap",children:[(0,d.jsxs)("label",{className:"toggle-switch",children:[(0,d.jsx)("input",{type:"checkbox",checked:Boolean(n.display_discount),onChange:e=>o((t=>({...t,display_discount:e.target.checked})))}),(0,d.jsx)("span",{className:"switch"})]}),(0,d.jsx)("em",{children:"Display Discounts"})]})})]})})]})})]})]})]})}));var Ne=l(93740),we=l(23274);const Se=e=>{let{show:t,setShow:l,contactPersons:s,setPayload:a,createNewRequest:i}=e;return(0,d.jsx)(we.A,{show:t,setShow:l,contactPersons:s,setPayload:a,save:async()=>{try{await i("send")}catch(e){}}})};var Ce=l(55797),_e=l(8868),ke=l(8129),qe=l(72052),Be=l(28676),Fe=l(74532),$e=l(21052);const Re={iconStyle:"create-proposal_iconStyle__Q0cmV",headerTitle:"create-proposal_headerTitle__vMyBv",customLabel:"create-proposal_customLabel__vKXkN",dropdownSelect:"create-proposal_dropdownSelect__uAoBl",accordion:"create-proposal_accordion__WM+iT",error:"create-proposal_error__QxGLm","p-accordion-content":"create-proposal_p-accordion-content__om9Aa",uploadBox:"create-proposal_uploadBox__KxAAF",imageBox:"create-proposal_imageBox__-Eh-d",uploadButton:"create-proposal_uploadButton__jHShw",uploadText:"create-proposal_uploadText__mWPJf",trashBox:"create-proposal_trashBox__A3WDp"};var Ee=l(99832),Le=l(83627),ze=l(69956),Te=l(81047),Pe=l(75758);const Ie={headerTitle:"send-proposal-email_headerTitle__Z8dTz",customLabel:"send-proposal-email_customLabel__BN+xG",bag:"send-proposal-email_bag__a-GeD",lable:"send-proposal-email_lable__PQY4a",dropdownSelect:"send-proposal-email_dropdownSelect__WENZ5",autoCompleteBox:"send-proposal-email_autoCompleteBox__la62D",AutoComplete:"send-proposal-email_AutoComplete__55Bdi",bcc:"send-proposal-email_bcc__G5naH",box:"send-proposal-email_box__CiEmC",active:"send-proposal-email_active__ERNoo",inputBox:"send-proposal-email_inputBox__-sHnD"},Me=(0,d.jsx)("div",{className:`${Ie.modalHeader}`,children:(0,d.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,d.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${Ie.headerTitle}`,children:"Send a Proposal"})})}),De=(0,d.jsxs)("span",{className:"ql-formats",children:[(0,d.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,d.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,d.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,d.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,d.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,d.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,d.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,d.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,d.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,d.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,d.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,d.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,d.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,d.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),We=e=>{var t,l,a,i;let{show:n,setShow:o,contactPersons:r,setPayload:c,save:u,handleOtherClose:p}=e;const[m,h]=(0,s.useState)(""),[v,g]=(0,s.useState)([]),[j,b]=(0,s.useState)([]),[f,y]=(0,s.useState)([]),[A,N]=(0,s.useState)(null),[w,S]=(0,s.useState)(null),[_,k]=(0,s.useState)({}),[q,B]=(0,s.useState)([]),F=(0,s.useRef)(null),R=(0,s.useRef)(null),E=(0,s.useRef)(null),[T,P]=(0,s.useState)(!1),[I,M]=(0,s.useState)(!1),[D,W]=(0,s.useState)(!1),[U,O]=(0,s.useState)(null),G=(0,x.I)({queryKey:["emailTemplate"],queryFn:Te.SQ}),K=(0,x.I)({queryKey:["getOutgoingEmail"],queryFn:Te.hx}),H=(0,x.I)({queryKey:["emailQuery",U],queryFn:()=>(0,Te.hS)(U),enabled:!!U,retry:1});(0,s.useEffect)((()=>{var e,t;null!==K&&void 0!==K&&K.data&&(null!==K&&void 0!==K&&null!==(e=K.data)&&void 0!==e&&e.outgoing_email&&h(null===K||void 0===K||null===(t=K.data)||void 0===t?void 0:t.outgoing_email));!U&&null!==G&&void 0!==G&&G.data&&O(20)}),[H,K]);const Q=(0,d.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,d.jsx)($.A,{className:"outline-button",onClick:()=>o(!1),children:"Cancel"}),(0,d.jsxs)($.A,{className:"solid-button",onClick:async()=>{let e=0;k({}),m||(++e,k((e=>({...e,from:!0})))),0===(null===v||void 0===v?void 0:v.length)&&(++e,k((e=>({...e,to:!0})))),A||(++e,k((e=>({...e,subject:!0})))),w||(++e,k((e=>({...e,text:!0})))),e||(W(!0),await u(),W(!1))},children:["Send"," ",D&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]}),V=e=>{var t;const l=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let s=r.map((e=>e.email));s=s.filter((e=>!v.includes(e))),s=s.filter((e=>!j.includes(e))),s=s.filter((e=>!f.includes(e))),s=s.filter((e=>e.toLowerCase().includes(l))),B(s)},J=()=>{V(),F.current&&F.current.show()},Y=()=>{V(),R.current&&R.current.show()},X=()=>{V(),E.current&&E.current.show()};return(0,s.useEffect)((()=>{if(null!==r&&void 0!==r&&r.length){let e=r.map((e=>e.email));B(e)}}),[r]),(0,s.useEffect)((()=>{c((e=>({...e,subject:A,email_body:w,from_email:m,to:null===v||void 0===v?void 0:v.toString(),...j.length>0&&{cc:j.toString()},...f.length>0&&{bcc:f.toString()}})))}),[A,w,m,v,j,f]),(0,s.useEffect)((()=>{var e,t;S((null===H||void 0===H||null===(e=H.data)||void 0===e?void 0:e.body)||""),N(null===H||void 0===H||null===(t=H.data)||void 0===t?void 0:t.subject),k((e=>({...e,subject:!1}))),k((e=>({...e,text:!1})))}),[null===H||void 0===H||null===(t=H.data)||void 0===t?void 0:t.body]),(0,d.jsxs)(Ce.l,{visible:n,modal:!0,header:Me,footer:Q,className:`${Ie.modal} custom-modal`,style:{width:"896px"},onHide:()=>o(!1),children:[(0,d.jsxs)(L.A,{children:[(0,d.jsxs)(z.A,{sm:6,className:"mb-3",children:[(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"FROM"}),(0,d.jsx)(ke.m,{options:K&&(null===K||void 0===K?void 0:K.data)&&[{value:null===K||void 0===K||null===(l=K.data)||void 0===l?void 0:l.outgoing_email,label:`${null===K||void 0===K||null===(a=K.data)||void 0===a?void 0:a.outgoing_email}`}]||[],className:(0,C.A)(Ie.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{h(e.value),k((e=>({...e,from:!1})))},value:m})]}),(null===_||void 0===_?void 0:_.from)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,d.jsx)(z.A,{sm:6,className:"mb-3",children:(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"Templates"}),(0,d.jsx)(ke.m,{options:G&&(null===(i=G.data)||void 0===i?void 0:i.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,C.A)(Ie.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{O(e.value)},value:U,loading:null===G||void 0===G?void 0:G.isFetching})]})})]}),(0,d.jsxs)(L.A,{children:[(0,d.jsxs)(z.A,{sm:12,className:"mb-3",children:[(0,d.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,d.jsxs)("div",{style:{position:"relative"},className:Ie.autoCompleteBox,children:[(0,d.jsx)("div",{style:{width:"50px"},className:Ie.bag}),(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"TO"}),(0,d.jsx)(Pe.j,{ref:F,value:v,completeMethod:V,onChange:e=>{g(e.value),k((e=>({...e,to:!1})))},multiple:!0,suggestions:q,onClick:J,onFocus:J,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));g((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(g((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,C.A)(Ie.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,d.jsx)($.A,{className:(0,C.A)(Ie.box,{[Ie.active]:T}),onClick:()=>{P(!T),b([])},children:"CC"}),(0,d.jsx)($.A,{className:(0,C.A)(Ie.box,{[Ie.active]:I}),onClick:()=>{M(!I),y([])},children:"BCC"})]}),(null===_||void 0===_?void 0:_.to)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"To email is required"})]}),T&&(0,d.jsx)(z.A,{sm:6,className:"mb-3",children:(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("div",{style:{width:"50px"},className:Ie.bag}),(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"CC"}),(0,d.jsx)(Pe.j,{ref:R,value:j,completeMethod:V,onChange:e=>{b(e.value)},multiple:!0,suggestions:q,onClick:Y,onFocus:Y,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));b((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(b((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,C.A)(Ie.AutoComplete,"w-100"),placeholder:"CC"})]})}),I&&(0,d.jsx)(z.A,{sm:6,className:"mb-3",children:(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("div",{style:{width:"60px"},className:Ie.bag}),(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"BCC"}),(0,d.jsx)(Pe.j,{ref:E,value:f,completeMethod:V,onChange:e=>{y(e.value)},multiple:!0,suggestions:q,onClick:X,onFocus:X,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));y((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(y((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,C.A)(Ie.AutoComplete,Ie.bcc,"w-100"),placeholder:"BCC"})]})}),(0,d.jsxs)(z.A,{sm:12,className:"mb-2",children:[(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("div",{style:{width:"60px"},className:Ie.bag}),(0,d.jsx)("label",{className:(0,C.A)(Ie.customLabel),children:"SUBJECT"}),(0,d.jsxs)(Be.C,{children:[(0,d.jsx)(Fe.m,{children:(null===H||void 0===H?void 0:H.isFetching)&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,d.jsx)(qe.S,{value:A,className:(0,C.A)(Ie.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{N(e.target.value),k((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===_||void 0===_?void 0:_.subject)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,d.jsxs)(z.A,{sm:12,children:[(0,d.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,d.jsx)("label",{className:(0,C.A)(Ie.lable),children:"Message"}),(0,d.jsx)(Fe.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===H||void 0===H?void 0:H.isFetching)&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,d.jsx)(_e.K,{style:{minHeight:"150px"},headerTemplate:De,value:w,placeholder:"Enter a description...",onTextChange:e=>{S(e.htmlValue),k((e=>({...e,text:!1})))}})]}),(null===_||void 0===_?void 0:_.text)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]})]})]})},Ue=e=>{let{show:t,setShow:l,contactPersons:s,setPayload:a,onSubmit:i,handleClose:n}=e;return(0,d.jsx)(We,{show:t,setShow:l,contactPersons:s,setPayload:a,save:async()=>await i("send"),handleOtherClose:n})};var Oe=l(33155),Ge=l(55683);const Ke="file-uploader_title__MJFJ7",He="file-uploader_previewSection__ot4jI",Qe="file-uploader_previewBox__KC4if",Ve="file-uploader_previewBoxImg1__rKP04",Je="file-uploader_previewActions__r3LWm",Ye="file-uploader_label__pWhYK";var Xe=l(76163);const Ze=e=>{let{show:t,setShow:l,setPhoto:a,additionalDesign:i,shape:n="rect"}=e;const[o,r]=(0,s.useState)([]),[c,u]=(0,s.useState)({x:0,y:0}),[x,p]=(0,s.useState)(1),[m,h]=(0,s.useState)(0),[v,g]=(0,s.useState)(null),[j,b]=(0,s.useState)({}),f=(0,s.useCallback)(((e,t)=>{g(t)}),[]),y=(0,s.useCallback)((async()=>{if(!o.length||!v)return;const e=document.createElement("canvas"),t=e.getContext("2d"),l=new Image;l.src=o[0].preview,await new Promise((e=>l.onload=e)),e.width=v.width,e.height=v.height,t.translate(e.width/2,e.height/2),t.rotate(m*Math.PI/180),t.translate(-e.width/2,-e.height/2),t.drawImage(l,v.x,v.y,v.width,v.height,0,0,v.width,v.height);return e.toDataURL("image/jpeg")}),[o,v,m]),A=async()=>{const e=await y();e&&b({img2:e,img3:e,img4:e,img5:e})};(0,s.useEffect)((()=>{A()}),[x,c,m,o,v]);const{getRootProps:N,getInputProps:w}=(0,Oe.VB)({maxFiles:1,accept:{"image/*":[]},onDrop:e=>{r(e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e)}))))}});return(0,d.jsxs)(R.A,{style:{zIndex:1111},show:t,centered:!0,onHide:()=>l(!1),onShow:A,children:[(0,d.jsx)(R.A.Header,{closeButton:!0,children:(0,d.jsx)(R.A.Title,{children:(0,d.jsx)("span",{className:`${Ke}`,children:"Edit Photo"})})}),(0,d.jsxs)(R.A.Body,{children:[i,(0,d.jsxs)("div",{className:`${He}`,children:[(0,d.jsx)("div",{className:`${Qe}`,children:(0,d.jsx)("div",{className:(0,C.A)(Ve,"round"===n?"rounded-circle":""),children:(0,d.jsx)(Ge.Ay,{image:o.length>0?o[0].preview:null,crop:c,zoom:x,cropShape:n,rotation:m,onCropChange:u,onZoomChange:p,onCropComplete:f,aspect:1.5,restrictPosition:!1,style:{containerStyle:{width:"100%",height:"100%",position:"relative"},cropAreaStyle:{width:"100%",height:"100%"},mediaStyle:{width:"100%",height:"100%",objectFit:"contain"}}})})}),(0,d.jsxs)("div",{className:`${Je}`,children:[(0,d.jsxs)(k.A.Group,{children:[(0,d.jsx)(k.A.Label,{className:`${Ye}`,children:"Zoom"}),(0,d.jsx)(k.A.Range,{value:x,min:1,max:3,step:.1,className:"custom-range",onChange:e=>p(e.target.value)})]}),(0,d.jsx)("div",{className:"d-flex align-item-center pt-4 ms-4",style:{gap:"8px"},children:(0,d.jsxs)($.A,{className:"text-button",onClick:()=>{h((e=>(e+90)%360))},children:[(0,d.jsx)(Xe.A,{color:"#106B99",size:24}),"Rotate"]})})]})]}),(0,d.jsxs)("div",{...N({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"16px"},children:[(0,d.jsx)("input",{...w()}),(0,d.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:(0,d.jsx)(ze.A,{})}),(0,d.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,d.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,d.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"SVG, PNG, JPG or GIF (max. 800x400px)"})]})]}),(0,d.jsxs)(R.A.Footer,{className:"d-flex justify-content-end",children:[(0,d.jsx)($.A,{className:"outline-button",onClick:e=>{e.stopPropagation(),r([]),b({}),l(!1)},children:"Cancel"}),(0,d.jsx)($.A,{className:"solid-button",onClick:async()=>{const e=await y();if(!e)return S.oR.error("Please select a photo");const t=function(e,t){const l=atob(e.split(",")[1]),s=new ArrayBuffer(l.length),a=new Uint8Array(s);for(let i=0;i<l.length;i++)a[i]=l.charCodeAt(i);return new Blob([s],{type:t})}(e,"image/jpeg");a({croppedImageBase64:e,croppedImageBlob:t}),l(!1),r([]),b({})},children:"Save Photo"})]})]})};var et=l(63712);const tt=(0,d.jsx)("div",{className:`${Re.modalHeader}`,children:(0,d.jsxs)("div",{className:"w-100 d-flex align-items-center gap-2",children:[(0,d.jsx)("b",{className:Re.iconStyle,children:(0,d.jsx)(Ee.A,{size:24,color:"#079455"})}),(0,d.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${Re.headerTitle}`,children:"Proposal"})]})}),lt=(0,d.jsxs)("span",{className:"ql-formats",children:[(0,d.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,d.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,d.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,d.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,d.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,d.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,d.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,d.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,d.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,d.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,d.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,d.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,d.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,d.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),st=e=>{var t,l,a;let{show:i,setShow:n,refetch:r,contactPersons:c}=e;const{unique_id:u}=(0,o.g)(),[m,h]=(0,s.useState)(!1),[v,g]=(0,s.useState)(!1),[j,b]=(0,s.useState)({}),[f,y]=(0,s.useState)(""),[A,N]=(0,s.useState)(null),[w,_]=(0,s.useState)(!1),[k,q]=(0,s.useState)({}),[B,F]=(0,s.useState)(null),[R,E]=(0,s.useState)([]),[T,P]=(0,s.useState)(null),I=(0,x.I)({queryKey:["proposalTemplate"],queryFn:Te.VQ}),M=(0,x.I)({queryKey:["readProposal",u],queryFn:()=>(0,Te.Pf)(u),enabled:!!u,retry:0});(0,s.useEffect)((()=>{var e,t,l;null!==M&&void 0!==M&&M.data&&(console.log("read proposal: ",null===M||void 0===M?void 0:M.data),F(null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.template));!T&&null!==M&&void 0!==M&&null!==(e=M.data)&&void 0!==e&&e.image&&P({croppedImageBase64:null===M||void 0===M||null===(l=M.data)||void 0===l?void 0:l.image})}),[null===M||void 0===M?void 0:M.data]);const D=(0,x.I)({queryKey:["getProposal",B],queryFn:()=>(0,Te.IT)(B),enabled:!!B,retry:0}),W=async e=>{var t;if(!u)return S.oR.error("Id not found");let l=null===R||void 0===R?void 0:R.filter((e=>!e.delete));if(null===l||void 0===l||!l.length)return S.oR.error("Please add proposal content");b({});const s={},a=null===R||void 0===R||null===(t=R.filter((e=>!e.delete)))||void 0===t?void 0:t.map(((e,t)=>{const l={};return e.title||(l.title=!0),e.description||(l.description=!0),l}));if(a.some((e=>Object.keys(e).length>0))&&(s.sections=a),b(s),0===Object.keys(s).length){const t=new FormData;if(R.forEach(((e,l)=>{t.append(`sections[${l}]title`,e.title),t.append(`sections[${l}]description`,e.description),t.append(`sections[${l}]delete`,!!e.delete),null!==M&&void 0!==M&&M.data&&e.id&&t.append(`sections[${l}]id`,e.id)})),B?t.append("template",B):t.append("template",""),"send"===e?(t.append("action","send"),t.append("subject",null===k||void 0===k?void 0:k.subject),t.append("email_body",null===k||void 0===k?void 0:k.email_body),t.append("from_email",null===k||void 0===k?void 0:k.from_email),t.append("to",null===k||void 0===k?void 0:k.to),null!==k&&void 0!==k&&k.cc&&t.append("cc",null===k||void 0===k?void 0:k.cc),null!==k&&void 0!==k&&k.bcc&&t.append("bcc",null===k||void 0===k?void 0:k.bcc)):t.append("action","create"),null!==T&&void 0!==T&&T.croppedImageBlob){const e=(0,et.Ak)(6);t.append("image",null===T||void 0===T?void 0:T.croppedImageBlob,`${e}.jpg`)}const l=localStorage.getItem("access_token");h(!0);let s="POST",a=`https://dev.memate.com.au/api/v1/proposals/new/${u}/`;null!==M&&void 0!==M&&M.data&&(s="PUT",a=`https://dev.memate.com.au/api/v1/proposals/update/${u}/`);try{h(!0);const i=await fetch(a,{method:s,headers:{Authorization:`Bearer ${l}`},body:t});await i.json();return h(!1),i.ok?(U(),S.oR.success(`Proposal ${"send"===e?"created and send":"created"} successfully!`),r(),M.refetch(),"success"):(S.oR.error(`Failed to ${"send"===e?"create and send":"create"} the proposal. Please try again.`),"error")}catch(i){return h(!1),console.error("Error creating proposal:",i),S.oR.error(`Failed to ${"send"===e?"create and send":"create"} the proposal. Please try again.`),"error"}finally{h(!1)}}},U=()=>{n(!1),_(!1)},O=(0,d.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,d.jsx)($.A,{className:"text-button text-danger",onClick:U,children:"Cancel"}),(0,d.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,d.jsxs)($.A,{className:"btn info-button",onClick:()=>{E([...R,{title:"",description:""}])},children:["Add  New Section ",(0,d.jsx)(Le.A,{color:"#106B99"})]}),(0,d.jsxs)($.A,{className:"outline-button",onClick:W,children:["Create & Save",m&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,d.jsx)($.A,{className:"solid-button",onClick:()=>{var e;if(!u)return S.oR.error("Id not found");let t=null===R||void 0===R?void 0:R.filter((e=>!e.delete));if(null===t||void 0===t||!t.length)return S.oR.error("Please add proposal content");const l={},s=null===R||void 0===R||null===(e=R.filter((e=>!e.delete)))||void 0===e?void 0:e.map(((e,t)=>{const l={};return e.title||(l.title=!0),e.description||(l.description=!0),l}));s.some((e=>Object.keys(e).length>0))&&(l.sections=s),b(l),0===Object.keys(l).length&&(n(!1),_(!0))},children:"Send Proposal"})]})]});return(0,s.useEffect)((()=>{var e,t,l,s,a,i;if(B&&B!=(null===M||void 0===M||null===(e=M.data)||void 0===e?void 0:e.template)&&null!==D&&void 0!==D&&D.data)E([...(null===M||void 0===M||null===(l=M.data)||void 0===l||null===(s=l.sections)||void 0===s?void 0:s.map((e=>({...e,delete:!0}))))||[],...(null===D||void 0===D||null===(a=D.data)||void 0===a||null===(i=a.sections)||void 0===i?void 0:i.map((e=>{let{id:t,...l}=e;return{...l}})))||[]]);else if(B===(null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.template)){var n;E(null===M||void 0===M||null===(n=M.data)||void 0===n?void 0:n.sections)}}),[B,null===D||void 0===D?void 0:D.data,null===M||void 0===M?void 0:M.data]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Ce.l,{visible:i,modal:!0,header:tt,footer:O,className:`${Re.modal} custom-modal p-0`,style:{width:"896px"},onHide:U,children:[(0,d.jsx)(L.A,{className:"px-4 pt-4 border-bottom mb-3 bg-white",children:(0,d.jsx)(z.A,{sm:12,className:"mb-3",children:(0,d.jsxs)("div",{style:{position:"relative"},children:[(0,d.jsx)("label",{className:(0,C.A)(Re.customLabel),children:"Templates"}),(0,d.jsx)(ke.m,{options:I&&(null===(t=I.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,C.A)(Re.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{F(e.value)},value:B,loading:null===I||void 0===I?void 0:I.isFetching,showClear:!0})]})})}),(0,d.jsxs)("div",{className:"d-flex flex-column px-4",children:[(0,d.jsx)("div",{className:"d-flex gap-3 justify-content-center align-items-center mb-1",children:null!==T&&void 0!==T&&T.croppedImageBase64?(0,d.jsxs)("div",{style:{position:"relative",cursor:"pointer"},onClick:()=>g(!0),children:[(0,d.jsx)("div",{className:Re.imageBox,style:{overflow:"hidden",textAlign:"center"},children:(0,d.jsx)("img",{alt:"uploaded-file",src:null===T||void 0===T?void 0:T.croppedImageBase64,style:{width:"100%",height:"100#"}})}),(0,d.jsx)("div",{className:(0,C.A)(Re.trashBox,"cursor-pointer"),onClick:e=>{e.stopPropagation(),P(null)},children:(0,d.jsx)(p.A,{color:"#F04438",size:16})})]}):(0,d.jsxs)("div",{className:Re.uploadBox,style:{cursor:"pointer"},onClick:()=>g(!0),children:[(0,d.jsx)("div",{className:Re.uploadButton,children:(0,d.jsx)(ze.A,{color:"#475467",size:20})}),(0,d.jsx)("p",{className:Re.uploadText,children:"Click to upload"})]})}),(0,d.jsx)(Ze,{show:v,setShow:g,setPhoto:P}),(null===j||void 0===j?void 0:j.image)&&(0,d.jsx)("p",{className:"error-message mb-2",children:"Image is required"}),(0,d.jsx)($e.n,{activeIndex:0,className:"mt-3",children:null===R||void 0===R||null===(l=R.map(((e,t)=>({...e,originalIndex:t}))))||void 0===l||null===(a=l.filter((e=>!e.delete)))||void 0===a?void 0:a.map(((e,t)=>{var l,s,a,i,n,o,r,c;return(0,d.jsxs)($e.g,{className:(0,C.A)(Re.accordion,{[Re.error]:!!(null!==j&&void 0!==j&&null!==(l=j.sections)&&void 0!==l&&null!==(s=l[t])&&void 0!==s&&s.title||null!==j&&void 0!==j&&null!==(a=j.sections)&&void 0!==a&&null!==(i=a[t])&&void 0!==i&&i.description)},"proposal-accordion"),header:`Paragraph ${t+1}`,children:[(0,d.jsxs)("div",{className:"flex flex-column gap-2 w-100",style:{marginBottom:"16px"},children:[(0,d.jsx)("label",{className:Re.label,children:"Paragraph title"}),(0,d.jsxs)(Be.C,{children:[(0,d.jsx)(Fe.m,{children:(null===D||void 0===D?void 0:D.isFetching)&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,d.jsx)(qe.S,{value:null===e||void 0===e?void 0:e.title,className:(0,C.A)(Re.inputBox,"w-100 border mt-2"),onChange:t=>{E((l=>{const s=[...l];return s[null===e||void 0===e?void 0:e.originalIndex]={...s[null===e||void 0===e?void 0:e.originalIndex],title:t.target.value},s}))},placeholder:"Section Title"})]}),(null===j||void 0===j||null===(n=j.sections)||void 0===n||null===(o=n[t])||void 0===o?void 0:o.title)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"Title is required"})]}),(0,d.jsxs)("div",{className:"d-flex flex-column gap-1 w-100 pb-2",style:{position:"relative"},children:[(0,d.jsx)("label",{className:(0,C.A)(Re.lable),children:"Paragraph"}),(0,d.jsx)(Fe.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===D||void 0===D?void 0:D.isFetching)&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,d.jsx)(_e.K,{style:{minHeight:"299px"},headerTemplate:lt,value:e.description,placeholder:"Enter a description...",onTextChange:t=>{E((l=>{const s=[...l];return s[null===e||void 0===e?void 0:e.originalIndex]={...s[null===e||void 0===e?void 0:e.originalIndex],description:t.htmlValue},s}))}}),(null===j||void 0===j||null===(r=j.sections)||void 0===r||null===(c=r[t])||void 0===c?void 0:c.description)&&(0,d.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,d.jsx)("div",{className:"bg-white mt-2 pt-2 d-flex justify-content-end",children:(0,d.jsx)($.A,{className:"danger-outline-button",onClick:()=>((e,t)=>{E(t?t=>t.map(((t,l)=>l===e?{...t,delete:!0}:t)):t=>t.filter(((t,l)=>l!==e)))})(null===e||void 0===e?void 0:e.originalIndex,null===e||void 0===e?void 0:e.id),children:"Delete Paragraph"})})]},(null===e||void 0===e?void 0:e.id)||`accordion-${t}`)}))})]})]}),(0,d.jsx)(Ue,{show:w,setShow:_,contactPersons:c,setPayload:q,onSubmit:W,handleClose:U})]})},at=()=>{var e,t,l,u,p,m,h,v,j,b;const f=(0,o.Zp)(),[y,A]=(0,s.useState)([]),[N,w]=(0,s.useState)(!1),[C,_]=(0,s.useState)(!1),[k,q]=(0,s.useState)(!1),[F,$]=(0,s.useState)("Standard"),[R,E]=(0,s.useState)({}),[L,z]=(0,s.useState)([]),[T,P]=(0,s.useState)({budget:0,operationalProfit:0,subtotal:0,tax:0,total:0}),{unique_id:I}=(0,o.g)(),M=(0,x.I)({queryKey:["unique_id",I],queryFn:()=>(0,g.WL)(I),enabled:!!I,retry:1,cacheTime:0});(0,s.useEffect)((()=>{if(I)E((e=>({...e,...null===M||void 0===M?void 0:M.data})));else{const e=JSON.parse(window.sessionStorage.getItem("new-request")||"{}"),t=JSON.parse(window.localStorage.getItem("profileData")||"{}");E((l=>({...l,xero_tax:"ex",display_discount:!0,managers:[{manager:null===t||void 0===t?void 0:t.desktop_user_id}],client:(null===e||void 0===e?void 0:e.id)||"",reference:(null===e||void 0===e?void 0:e.reference)||"",description:(null===e||void 0===e?void 0:e.requirements)||""})))}}),[I,null===M||void 0===M?void 0:M.data]);const D=(0,B.n)({mutationFn:e=>(0,g.DY)(e),onSuccess:e=>{e||S.oR.error("Failed to create new calculation quote. Please try again.")},onError:e=>{q(!1),console.error("Error creating new calculation quote:",e),S.oR.error("Failed to create new calculation quote. Please try again.")}}),W=(0,B.n)({mutationFn:e=>(0,g.Vn)(I,e),onSuccess:e=>{e||(q(!1),S.oR.error("Failed to update calculation quote. Please try again."))},onError:e=>{q(!1),console.error("Error updating new calculation quote:",e),S.oR.error("Failed to update calculation quote. Please try again.")}}),U=async e=>{var t;if(R.action=e,"send"!==e&&(delete R.subject,delete R.email_body,delete R.to,delete R.cc,delete R.bcc),"saveAndsend"===e)return void w(!0);"quote-pdf-open"===e&&(R.action="save"),R.recurring={frequency:"1",occurrences:10,start_date:new Date};const l=R.merges;if(R.merges&&delete R.merges,null===R||void 0===R||!R.client)return S.oR.error("Client is required");if(null===R||void 0===R||!R.contact_person)return S.oR.error("Contact person is required");if(null===R||void 0===R||!R.managers||null===(t=R.managers)||void 0===t||!t.length)return S.oR.error("Project manager is required");if(null===R||void 0===R||!R.calculations||!R.calculations.length)return S.oR.error("At least one calculation is required");if(null===R||void 0===R||!R.xero_tax)return S.oR.error("Tax details is required");if(null===R||void 0===R||!R.expense)return S.oR.error("Expense is required");let s;if(q(!0),L.length)for(const u of L)try{u&&await(0,g.mL)(u)}catch(c){console.log("Error during with deleting merge: ",c)}if(I){var a;s=await W.mutateAsync(R);let e=null===(a=s)||void 0===a?void 0:a.unique_id;if(l&&null!==l&&void 0!==l&&l.length){var i;let t=null===(i=s.calculations)||void 0===i?void 0:i.reduce(((e,t)=>(e[t.calculator]=t.id,e)),{});const a=null===l||void 0===l?void 0:l.map((l=>({...l,unique_id:e,calculations:l.calculators.map((e=>({calculator:t[e.calculator]})))})));for(const e of a)try{e.id&&await(0,g.mL)(e.id),await(0,g.tA)(e)}catch(c){q(!1),console.log("Error during with creating merge: ",c)}S.oR.success("Calculations and merge items updated successfully.")}else S.oR.success("Calculations updated successfully.")}else{var n;s=await D.mutateAsync(R);let e=null===(n=s)||void 0===n?void 0:n.unique_id;if(l&&null!==l&&void 0!==l&&l.length){var o;let t=null===(o=s.calculations)||void 0===o?void 0:o.reduce(((e,t)=>(e[t.calculator]=t.id,e)),{});(null===l||void 0===l?void 0:l.map((l=>({...l,unique_id:e,calculations:l.calculators.map((e=>({calculator:t[e.calculator]})))})))).forEach((async e=>{try{await(0,g.tA)(e)}catch(c){q(!1),console.log("Error during with creating merge: ",c)}})),S.oR.success("Calculations and new merge items created successfully.")}else S.oR.success("Calculations created successfully.")}if("quote-pdf-open"===e){var r,d;if(null!==(r=s)&&void 0!==r&&r.quote_url)return f(`${null===(d=s)||void 0===d?void 0:d.quote_url}`);S.oR.error("Quote PDF not found.")}f("/sales"),q(!1),w(!1)};return(0,d.jsxs)("div",{className:"newQuotePage",children:[(0,d.jsxs)("div",{className:"topbar d-flex justify-content-between",style:{padding:"16px 32px",height:"72px",position:"relative"},children:[(0,d.jsx)(r.k2,{to:"",children:(0,d.jsxs)("button",{className:"back-button",style:{padding:"10px 16px"},onClick:()=>{f(-1)},children:[(0,d.jsx)(a.A,{color:"#000000",size:20})," \xa0Go Back"]})}),(0,d.jsxs)("h2",{className:"m-0",style:{fontSize:"22px",fontWeight:"600",position:"absolute",left:"42.5%"},children:[(0,d.jsx)(i.A,{color:"#1D2939",size:16}),"\xa0 Calculate a Quote"]}),(0,d.jsxs)("div",{className:"d-flex align-items-center justify-content-end",children:[(0,d.jsx)(c,{label:"Standard",name:"customRadio",value:"Standard",checked:"Standard"===F,onChange:e=>$(e.target.value)}),(0,d.jsx)(c,{label:"Recurring",name:"customRadio",value:"Recurring",checked:"Recurring"===F,onChange:e=>$(e.target.value)}),(0,d.jsx)(c,{label:"Subscription",name:"customRadio",value:"Subscription",checked:"Subscription"===F,onChange:e=>$(e.target.value)}),(0,d.jsx)(c,{label:"Retainer",name:"customRadio",value:"Retainer",checked:"Retainer"===F,onChange:e=>$(e.target.value)})]})]}),(0,d.jsx)("div",{className:"w-100",style:{overflow:"auto",height:"calc(100% - 208px)",padding:"16px 32px"},children:(0,d.jsx)(Ae,{payload:R,setPayload:E,totals:T,setTotals:P,refetch:null===M||void 0===M?void 0:M.refetch,preExistMerges:(null===M||void 0===M||null===(e=M.data)||void 0===e?void 0:e.merges)||[],preExistCalculation:(null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.calculations)||[],setMergeDeletedItems:z,setContactPersons:A})}),(0,d.jsxs)("div",{className:"calculation-quote-bottom w-100",style:{padding:"8px 24px",height:"136px",background:"#fff",borderTop:"1px solid #EAECF0",boxShadow:"0px 1px 3px 0px rgba(16, 24, 40, 0.10), 0px 1px 2px 0px rgba(16, 24, 40, 0.06)"},children:[(0,d.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,d.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px"},children:[(0,d.jsxs)("div",{className:"item",children:[(0,d.jsx)("label",{children:"Budget"}),(0,d.jsxs)("div",{className:"amount",children:["$ ",T.budget]})]}),(0,d.jsxs)("div",{className:"item",children:[(0,d.jsx)("label",{children:"Operational Profit"}),(0,d.jsxs)("div",{className:"amount",style:{color:"#079455"},children:["$ ",T.operationalProfit]})]})]}),(0,d.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px"},children:[(0,d.jsxs)("div",{className:"item",children:[(0,d.jsx)("label",{children:"Subtotal"}),(0,d.jsxs)("div",{className:"amount",children:["$ ",T.subtotal]})]}),(0,d.jsxs)("div",{className:"item",children:[(0,d.jsx)("label",{children:"Tax ( 10% )"}),(0,d.jsxs)("div",{className:"amount",children:["$ ",T.tax]})]}),(0,d.jsxs)("div",{className:"item",style:{minWidth:"fit-content"},children:[(0,d.jsx)("label",{children:"Total"}),(0,d.jsxs)("div",{className:"amount",children:["$ ",T.total]})]})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,d.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"0px"},children:[(0,d.jsx)("a",{href:"/sales",type:"button",className:"button-custom text-button padding-left-0",style:{color:"#B42318"},children:"Cancel"}),(0,d.jsx)("a",{href:"#",onClick:()=>U("quote-pdf-open"),type:"button",className:"button-custom text-button px-2",children:"Quote PDF"}),null!==M&&void 0!==M&&null!==(l=M.data)&&void 0!==l&&l.proposal_pdf?(0,d.jsxs)("div",{className:"d-flex align-items-center",children:[(0,d.jsx)("button",{type:"button",className:"button-custom text-button px-2",onClick:()=>_(!0),children:"Edit Proposal"}),(0,d.jsx)("a",{href:`${null===M||void 0===M||null===(u=M.data)||void 0===u?void 0:u.proposal_pdf}`,target:"_blank",type:"button",className:"button-custom text-button px-2",children:(0,d.jsx)(n.A,{color:"#106B99",size:20})})]}):(0,d.jsx)("button",{type:"button",className:"button-custom text-button px-2",onClick:()=>_(!0),children:"Create Proposal"})]}),(0,d.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"8px"},children:[(0,d.jsxs)("button",{type:"button",onClick:()=>U("draft"),className:"button-custom text-button",children:["Save Draft",(D.isPending||W.isPending)&&("draft"===(null===D||void 0===D||null===(p=D.variables)||void 0===p?void 0:p.action)||"draft"===(null===W||void 0===W||null===(m=W.variables)||void 0===m?void 0:m.action))&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px"}})]}),(0,d.jsxs)("button",{type:"button",onClick:()=>U("save"),className:"button-custom submit-button-light",children:["Save",(D.isPending||W.isPending)&&("save"===(null===D||void 0===D||null===(h=D.variables)||void 0===h?void 0:h.action)||"save"===(null===W||void 0===W||null===(v=W.variables)||void 0===v?void 0:v.action))&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px"}})]}),(0,d.jsxs)("button",{type:"button",onClick:()=>U("saveAndsend"),className:"submit-button",children:["Save and Send",(D.isPending||W.isPending)&&("send"===(null===D||void 0===D||null===(j=D.variables)||void 0===j?void 0:j.action)||"send"===(null===W||void 0===W||null===(b=W.variables)||void 0===b?void 0:b.action))&&(0,d.jsx)(Ne.p,{style:{width:"20px",height:"20px"}})]})]})]})]}),(0,d.jsx)(Se,{show:N,setShow:w,contactPersons:y,setPayload:E,createNewRequest:U}),(0,d.jsx)(st,{show:C,setShow:_,refetch:null===M||void 0===M?void 0:M.refetch,contactPersons:y}),(D.isPending||M.isFetching||k)&&(0,d.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,d.jsx)(Y.A,{animation:"border",role:"status",children:(0,d.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})}},24572:(e,t,l)=>{function s(e){var t,l={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},s="";for(t in l)for(;e>=l[t];)s+=t,e-=l[t];return s}function a(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})}l.d(t,{Mf:()=>s,i$:()=>i,up:()=>a});const i=(e,t)=>{var l;if(!e)return"-";const s=new Date(1e3*+e);if(t){return s.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,".")}return null===(l=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))||void 0===l?void 0:l.replace(/,/g,"")}},23274:(e,t,l)=>{l.d(t,{A:()=>A});var s=l(65043),a=l(14282),i=l(61072),n=l(78602),o=l(93740),r=l(55797),d=l(8868),c=l(8129),u=l(75758),x=l(72052),p=l(93747);const m={headerTitle:"send-email_headerTitle__cXbQd",customLabel:"send-email_customLabel__ulebR",bag:"send-email_bag__+1Isj",lable:"send-email_lable__pfv8S",dropdownSelect:"send-email_dropdownSelect__yuxmj",autoCompleteBox:"send-email_autoCompleteBox__zqO6y",AutoComplete:"send-email_AutoComplete__peyFk",bcc:"send-email_bcc__vHuNY",box:"send-email_box__KRxo7",active:"send-email_active__sUnBO",inputBox:"send-email_inputBox__cV-UR"};var h=l(81047),v=l(58387),g=l(28676),j=l(74532),b=l(70579);const f=(0,b.jsx)("div",{className:`${m.modalHeader}`,children:(0,b.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,b.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${m.headerTitle}`,children:"Send a Quote"})})}),y=(0,b.jsxs)("span",{className:"ql-formats",children:[(0,b.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,b.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,b.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,b.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,b.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,b.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,b.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,b.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,b.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,b.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,b.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,b.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,b.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,b.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),A=e=>{var t,l,A,N;let{show:w,setShow:S,contactPersons:C,setPayload:_,save:k}=e;const[q,B]=(0,s.useState)(""),[F,$]=(0,s.useState)([]),[R,E]=(0,s.useState)([]),[L,z]=(0,s.useState)([]),[T,P]=(0,s.useState)(null),[I,M]=(0,s.useState)(null),[D,W]=(0,s.useState)({}),[U,O]=(0,s.useState)([]),G=(0,s.useRef)(null),K=(0,s.useRef)(null),H=(0,s.useRef)(null),[Q,V]=(0,s.useState)(!1),[J,Y]=(0,s.useState)(!1),[X,Z]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(null),le=(0,p.I)({queryKey:["emailTemplate"],queryFn:h.SQ}),se=(0,p.I)({queryKey:["getOutgoingEmail"],queryFn:h.hx}),ae=(0,p.I)({queryKey:["emailQuery",ee],queryFn:()=>(0,h.hS)(ee),enabled:!!ee,retry:1});(0,s.useEffect)((()=>{var e,t;null!==se&&void 0!==se&&se.data&&(null!==se&&void 0!==se&&null!==(e=se.data)&&void 0!==e&&e.outgoing_email&&B(null===se||void 0===se||null===(t=se.data)||void 0===t?void 0:t.outgoing_email));null!==le&&void 0!==le&&le.data&&te(17)}),[ae,se]);const ie=(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,b.jsx)(a.A,{className:"outline-button",onClick:()=>S(!1),children:"Cancel"}),(0,b.jsxs)(a.A,{className:"solid-button",onClick:async()=>{let e=0;W({}),q||(++e,W((e=>({...e,from:!0})))),0===(null===F||void 0===F?void 0:F.length)&&(++e,W((e=>({...e,to:!0})))),T||(++e,W((e=>({...e,subject:!0})))),I||(++e,W((e=>({...e,text:!0})))),e||(Z(!0),await k(),Z(!1))},children:["Send"," ",X&&(0,b.jsx)(o.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]}),ne=e=>{var t;const l=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let s=C.map((e=>e.email));s=s.filter((e=>!F.includes(e))),s=s.filter((e=>!R.includes(e))),s=s.filter((e=>!L.includes(e))),s=s.filter((e=>e.toLowerCase().includes(l))),console.log("emails: ",s),O(s)},oe=()=>{ne(),G.current&&G.current.show()},re=()=>{ne(),K.current&&K.current.show()},de=()=>{ne(),H.current&&H.current.show()};return(0,s.useEffect)((()=>{if(null!==C&&void 0!==C&&C.length){let e=C.map((e=>e.email));O(e)}}),[C]),(0,s.useEffect)((()=>{_((e=>({...e,subject:T,email_body:I,from_email:q,to:null===F||void 0===F?void 0:F.toString(),...R.length>0&&{cc:R.toString()},...L.length>0&&{bcc:L.toString()}})))}),[T,I,q,F,R,L]),(0,s.useEffect)((()=>{var e,t;M((null===ae||void 0===ae||null===(e=ae.data)||void 0===e?void 0:e.body)||""),P(null===ae||void 0===ae||null===(t=ae.data)||void 0===t?void 0:t.subject),W((e=>({...e,subject:!1}))),W((e=>({...e,text:!1})))}),[null===ae||void 0===ae||null===(t=ae.data)||void 0===t?void 0:t.body]),(0,b.jsxs)(r.l,{visible:w,modal:!0,header:f,footer:ie,className:`${m.modal} custom-modal`,style:{width:"896px"},onHide:()=>S(!1),children:[(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(n.A,{sm:6,className:"mb-3",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"FROM"}),(0,b.jsx)(c.m,{options:se&&(null===se||void 0===se?void 0:se.data)&&[{value:null===se||void 0===se||null===(l=se.data)||void 0===l?void 0:l.outgoing_email,label:`${null===se||void 0===se||null===(A=se.data)||void 0===A?void 0:A.outgoing_email}`}]||[],className:(0,v.A)(m.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{B(e.value),W((e=>({...e,from:!1})))},value:q})]}),(null===D||void 0===D?void 0:D.from)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,b.jsx)(n.A,{sm:6,className:"mb-3",children:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"Templates"}),(0,b.jsx)(c.m,{options:le&&(null===(N=le.data)||void 0===N?void 0:N.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,v.A)(m.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{te(e.value)},value:ee,loading:null===le||void 0===le?void 0:le.isFetching})]})})]}),(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(n.A,{sm:12,className:"mb-3",children:[(0,b.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,b.jsxs)("div",{style:{position:"relative"},className:m.autoCompleteBox,children:[(0,b.jsx)("div",{style:{width:"50px"},className:m.bag}),(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"TO"}),(0,b.jsx)(u.j,{ref:G,value:F,completeMethod:ne,onChange:e=>{$(e.value),W((e=>({...e,to:!1})))},multiple:!0,suggestions:U,onClick:oe,onFocus:oe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));$((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&($((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,v.A)(m.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,b.jsx)(a.A,{className:(0,v.A)(m.box,{[m.active]:Q}),onClick:()=>{V(!Q),E([])},children:"CC"}),(0,b.jsx)(a.A,{className:(0,v.A)(m.box,{[m.active]:J}),onClick:()=>{Y(!J),z([])},children:"BCC"})]}),(null===D||void 0===D?void 0:D.to)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"To email is required"})]}),Q&&(0,b.jsx)(n.A,{sm:6,className:"mb-3",children:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"50px"},className:m.bag}),(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"CC"}),(0,b.jsx)(u.j,{ref:K,value:R,completeMethod:ne,onChange:e=>{E(e.value)},multiple:!0,suggestions:U,onClick:re,onFocus:re,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));E((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(E((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,v.A)(m.AutoComplete,"w-100"),placeholder:"CC"})]})}),J&&(0,b.jsx)(n.A,{sm:6,className:"mb-3",children:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"60px"},className:m.bag}),(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"BCC"}),(0,b.jsx)(u.j,{ref:H,value:L,completeMethod:ne,onChange:e=>{z(e.value)},multiple:!0,suggestions:U,onClick:de,onFocus:de,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e));z((e=>[...new Set([...e,...l])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(z((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,v.A)(m.AutoComplete,m.bcc,"w-100"),placeholder:"BCC"})]})}),(0,b.jsxs)(n.A,{sm:12,className:"mb-2",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"60px"},className:m.bag}),(0,b.jsx)("label",{className:(0,v.A)(m.customLabel),children:"SUBJECT"}),(0,b.jsxs)(g.C,{children:[(0,b.jsx)(j.m,{children:(null===ae||void 0===ae?void 0:ae.isFetching)&&(0,b.jsx)(o.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,b.jsx)(x.S,{value:T,className:(0,v.A)(m.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{P(e.target.value),W((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===D||void 0===D?void 0:D.subject)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,b.jsxs)(n.A,{sm:12,children:[(0,b.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,v.A)(m.lable),children:"Message"}),(0,b.jsx)(j.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ae||void 0===ae?void 0:ae.isFetching)&&(0,b.jsx)(o.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,b.jsx)(d.K,{style:{minHeight:"150px"},headerTemplate:y,value:I,placeholder:"Enter a description...",onTextChange:e=>{M(e.htmlValue),W((e=>({...e,text:!1})))}})]}),(null===D||void 0===D?void 0:D.text)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]})]})]})}}}]);
//# sourceMappingURL=8600.a4dbf24c.chunk.js.map