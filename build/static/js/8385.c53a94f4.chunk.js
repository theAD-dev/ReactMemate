"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[8385],{34168:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(65043),a=(s(7245),s(27965)),o=s(70579);const l=e=>{let{onDataApply:t,dateRange:s,onClose:l}=e;const[r,i]=(0,n.useState)([]),c=(0,n.useRef)(null),[d,u]=(0,n.useState)(null),[p,h]=(0,n.useState)(null),[m,v]=(0,n.useState)(!1),[x,f]=(0,n.useState)("");(0,n.useEffect)((()=>{s&&(i([null===s||void 0===s?void 0:s.startDate,null===s||void 0===s?void 0:s.endDate]),u(null===s||void 0===s?void 0:s.startDate),h(null===s||void 0===s?void 0:s.endDate))}),[]),(0,n.useEffect)((()=>{const e=new Date,t=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;f(t)}),[]);(0,n.useEffect)((()=>{if(2===r.length){const e=r[0],t=r[1];u(e),h(t)}else if(1===r.length){const e=r[0];u(e)}}),[r]);(0,n.useEffect)((()=>{}),[m]);const g=()=>{const e=new Date;i([e,e])};return(0,n.useEffect)((()=>{if(d||p){if(d&&p){const e={year:"numeric",month:"short",day:"numeric"},t=`<p>${`${new Date(d).toLocaleDateString("en-US",e)} - ${new Date(p).toLocaleDateString("en-US",e)}`}</p><span class="today-span" style="cursor: pointer">Today</span>`,s=document.querySelector(".flatpickr-months");if(s){const e=document.querySelector(".custom-div");if(e)e.innerHTML=t;else{const e=document.createElement("div");e.className="custom-div",e.innerHTML=t,s.parentNode.insertBefore(e,s.nextSibling)}}}}else{const e=new Date;u(e),h(e)}}),[d,p]),(0,n.useEffect)((()=>{const e=document.querySelector(".today-span");return e&&e.addEventListener("click",g),()=>{e&&e.removeEventListener("click",g)}}),[d,p]),(0,o.jsxs)("div",{children:[(0,o.jsx)(a.A,{options:{dateFormat:"Y-m-d",mode:"range",locale:{firstDayOfWeek:1},inline:!0},value:r,onChange:e=>{i(e)},ref:c}),(0,o.jsxs)("div",{className:"calenderBut",children:[(0,o.jsx)("button",{className:"tabCancel",onClick:()=>{i([]),u(null),h(null),v(!1),l&&l();const e=document.querySelector(".custom-div p");e&&(e.textContent=`${x}`)},children:"Cancel"}),(0,o.jsx)("button",{className:"tabApply",onClick:()=>{v(!0),t({startDate:d,endDate:p});const e=document.querySelector(".tags-input-container .rangedatepicker .mainWrapperTags");e&&(e.textContent=`${d.toISOString().split("T")[0]} - ${p.toISOString().split("T")[0]}`)},children:"Apply"})]})]})}},72796:(e,t,s)=>{s.d(t,{_x:()=>l,dd:()=>a,mM:()=>o});const n="https://app.memate.com.au/api/v1",a=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const a={method:"GET",headers:t};try{const t=new URL(`${n}/tasks/${e}/`),s=await fetch(t,a);return await s.json()}catch(o){throw console.error("Tasks fetch error:",o),o}},o=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const a={method:"DELETE",headers:t,redirect:"follow"};try{const t=new URL(`${n}/tasks/delete/${e}/`);if((await fetch(t,a)).ok)return{message:"Task deleted successfully"};throw new Error("Error during deleting")}catch(o){throw console.error("Tasks fetch error:",o),o}},l=async(e,t)=>{const s=new Headers,a=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${a}`),s.append("Content-Type","application/json");const o={method:"PATCH",headers:s,body:JSON.stringify({finished:t}),redirect:"follow"};try{const t=new URL(`${n}/tasks/complete/${e}/`),s=await fetch(t,o);return await s.json()}catch(l){throw console.error("Tasks fetch error:",l),l}}},79106:(e,t,s)=>{s.d(t,{Af:()=>r,U9:()=>o,aU:()=>c,gg:()=>l,gy:()=>d,lC:()=>i});var n=s(31342);const a="https://app.memate.com.au/api/v1",o=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6?arguments[6]:void 0;const c=(e-1)*t,d=new URL(`${a}/tasks/`);return d.searchParams.append("limit",t),d.searchParams.append("offset",c),s&&d.searchParams.append("search",s),o&&d.searchParams.append("ordering",o),l&&d.searchParams.append("deleted",1),!0===r&&d.searchParams.append("finished",!1),!1===r&&d.searchParams.append("finished",!0),i&&d.searchParams.append("users",i),(0,n.f)(d.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${a}${`/tasks/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},r=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/tasks/new/`);return(0,n.f)(s.toString(),t)},i=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${a}${`/tasks/update/${e}/`}`);return(0,n.f)(o.toString(),s)},c=async()=>{const e=new URL(`${a}/desktop-users/`);return(0,n.f)(e.toString(),{method:"GET"})},d=async()=>{const e=new URL(`${a}/team/mobile-users/`);return(0,n.f)(e.toString(),{method:"GET"})}},98385:(e,t,s)=>{s.d(t,{A:()=>I});var n=s(65043),a=s(93202),o=s(56741),l=s(95192),r=s(93747),i=s(47097),c=s(58387),d=s(88060),u=s(93740),p=s(20288),h=s(14282),m=s(78602),v=s(29853),x=s(61072),f=s(56328);const g="create-task_circleDesignStyle__vtKho",j="create-task_out__LG-iY",y="create-task_taskTitleInput__s+lNu",k="create-task_formLabel__04J0h",b="create-task_taskDescriptionInput__RZWSI",w="create-task_projectDropdown__qXb5+";var A=s(10586),S=s(79106),N=s(72796),D=s(57189),T=s(58027),_=s(63040),$=s(34168),E=s(70579);const C=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},L=e=>{let{startDate:t,endDate:s}=e;return(0,E.jsx)("div",{className:"dateSelectdTaskBar",children:C(t,s)})},R=e=>{let{setDateRange:t,dateRange:s}=e;console.log("dateRange: ",s);const[a,o]=(0,n.useState)(!1),l=(0,n.useRef)(null),r=e=>{l.current&&!l.current.contains(e.target)&&o(!1)};return(0,n.useEffect)((()=>(a?document.addEventListener("mousedown",r):document.removeEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)})),[a]),(0,E.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:l,children:[(0,E.jsx)("div",{onClick:()=>o((e=>!e)),style:{cursor:"pointer"},children:null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate?(0,E.jsx)(L,{startDate:s.startDate,endDate:s.endDate}):(0,E.jsx)("div",{style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},className:"iconStyleCircle d-flex justify-content-center align-items-center iconStyleCircleRight "+(a?"active":""),children:(0,E.jsx)(_.A,{color:a?"#1AB2FF":"#475467",size:14})})}),a&&(0,E.jsx)("div",{className:"select-date-range",style:{position:"absolute",top:"-100px",background:"#fff",zIndex:1e3},children:(0,E.jsx)($.A,{onDataApply:e=>{t(e),o(!1)},dateRange:s,onClose:()=>o(!1)})})]})},U=e=>{if(!e)return null;return new Date(1e3*+e)},I=e=>{let{show:t,setShow:s,refetch:_,taskId:$,setTaskId:C,defaultValue:L,projectId:I}=e;const F=(0,n.useRef)(null),P=(0,n.useRef)(null),{session:q}=(0,D.As)(),[B,z]=(0,n.useState)(!1),[H,G]=(0,n.useState)(""),[M,W]=(0,n.useState)(""),[O,K]=(0,n.useState)(""),[Y,J]=(0,n.useState)(null),[V,X]=(0,n.useState)(null),[Z,Q]=(0,n.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1});(0,n.useEffect)((()=>{var e,t;$&&L&&(G(null===L||void 0===L?void 0:L.title),W(null===L||void 0===L?void 0:L.description),K(null===L||void 0===L||null===(e=L.project)||void 0===e?void 0:e.id),J(null===L||void 0===L||null===(t=L.user)||void 0===t?void 0:t.id),X({startDate:U(null===L||void 0===L?void 0:L.from_date),endDate:U(null===L||void 0===L?void 0:L.to_date)}))}),[$,L]);const ee=()=>{G(""),W(""),K(""),J(null),X(null),z(!1),Q({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},te=(0,r.I)({queryKey:["getProjectsList"],queryFn:A.Bu}),se=(0,r.I)({queryKey:["getUserList"],queryFn:S.aU}),ne=(0,r.I)({queryKey:["getMobileUserList"],queryFn:S.gy});(0,n.useEffect)((()=>{t||ee()}),[t]);const ae=(0,i.n)({mutationFn:e=>$?(0,S.lC)($,e):(0,S.Af)(e),onSuccess:()=>{_(),s(!1),ee(),$&&C(null),f.oR.success(`Task ${$?"updated":"created"} successfully`)},onError:e=>{console.error(`Error ${$?"updating":"creating"} task:`,e),f.oR.error(`Failed to ${$?"update":"create"} client. Please try again.`)}});(0,n.useEffect)((()=>{if(B){Q({taskTitle:!H,description:!M,project:!O,user:!Y,date:!V})}}),[H,M,O,Y,V,B]);const oe=()=>{z(!0);const e={taskTitle:!H,description:!M,project:!O,user:!Y,date:!V};Q(e),e.taskTitle||e.description||e.user||e.date||e.project||ae.mutate({title:H,description:M,project:O,user:Y,from_date:V.startDate,to_date:V.endDate})},le=(0,i.n)({mutationFn:e=>(0,N.mM)($),onSuccess:()=>{console.log("Delete success"),s(!1),_()},onError:e=>{console.error("Error creating task:",e)}}),re=()=>{le.mutate()},ie=()=>{s(!1),ee()};return(0,n.useEffect)((()=>{setTimeout((()=>{P.current&&(P.current.style.height="auto",P.current.style.height=P.current.scrollHeight+"px")}),200)}),[M,$]),(0,n.useEffect)((()=>{I&&K(+I)}),[I]),(0,E.jsx)(p.B,{visible:t,position:"right",onHide:()=>{s(!1)},modal:!1,dismissable:!1,style:{width:"591px",height:"97vh",borderRadius:"10px",marginRight:"10px"},content:e=>{var t,s,n,r,i,p,f,A,S,N;let{closeIconRef:D,hide:_}=e;return(0,E.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,E.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,E.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,E.jsx)("div",{className:g,children:(0,E.jsx)("div",{className:j,children:(0,E.jsx)(a.A,{size:24,color:"#17B26A"})})}),(0,E.jsxs)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:[$?"Update":"Create New"," Task"]})]}),(0,E.jsx)("span",{children:(0,E.jsx)(h.A,{type:"button",className:"text-button",ref:D,onClick:e=>_(e),children:(0,E.jsx)(o.A,{size:24,color:"#667085"})})})]}),(0,E.jsxs)("div",{className:"modal-body",style:{padding:"24px 24px",height:"calc(97vh - 98px - 80px)",overflow:"auto"},children:[(0,E.jsx)(v.A.Control,{type:"text",name:"taskTitle",id:"taskTitle",placeholder:"Enter task title",value:H,onChange:e=>G(e.target.value),className:y}),Z.taskTitle&&(0,E.jsx)(v.A.Text,{className:"error-message",children:"Task title is required"}),(0,E.jsxs)(x.A,{className:"mt-3",children:[(0,E.jsx)(m.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,E.jsx)(v.A.Label,{className:k,children:"Assignee"})}),(0,E.jsxs)(m.A,{sm:8,className:"d-flex flex-column justify-content-center",children:[!Y&&(0,E.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.show()},style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},children:(0,E.jsx)(l.A,{color:null!==(t=F.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(n=s.element)&&void 0!==n&&n.offsetParent?"#1AB2FF":"#475467",size:18,className:"cursor-pointer"})}),(0,E.jsx)(d.m,{ref:F,options:[{label:"Desktop User",items:(null===se||void 0===se||null===(r=se.data)||void 0===r||null===(i=r.users)||void 0===i||null===(p=i.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===p?void 0:p.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==q&&void 0!==q&&q.has_work_subscription?[{label:"Mobile User",items:(null===ne||void 0===ne||null===(f=ne.data)||void 0===f||null===(A=f.users)||void 0===A||null===(S=A.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===S?void 0:S.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{J(e.value)},valueTemplate:e=>e?(0,E.jsxs)("div",{className:"d-flex gap-2 align-items-center",style:{position:"relative",left:"-10px"},children:[(0,E.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,E.jsx)(T.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}):null,itemTemplate:e=>(0,E.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,E.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,E.jsx)(T.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:Y?"fit-content":"0px",height:Y?"46px":"0px",zIndex:Y?"1":"0",position:"relative",left:Y?"-4px":"-60px",top:Y?"0px":"-15px"},value:Y,dropdownIcon:(0,E.jsx)(E.Fragment,{}),collapseIcon:(0,E.jsx)(E.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"})]})]}),Z.user&&(0,E.jsx)(v.A.Text,{className:"error-message",children:"User is required"}),(0,E.jsxs)(x.A,{className:"mt-3",children:[(0,E.jsx)(m.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,E.jsx)(v.A.Label,{className:k,children:"Due Date"})}),(0,E.jsx)(m.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,E.jsx)(R,{dateRange:V,setDateRange:X})})]}),Z.date&&(0,E.jsx)(v.A.Text,{className:"error-message",children:"Date is required"}),(0,E.jsxs)(x.A,{className:"mt-3",children:[(0,E.jsx)(m.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,E.jsx)(v.A.Label,{className:k,children:"Link to Project"})}),(0,E.jsx)(m.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,E.jsx)(d.m,{options:(null===te||void 0===te||null===(N=te.data)||void 0===N?void 0:N.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{K(e.value)},className:(0,c.A)("outline-none",w),style:{height:"46px",maxWidth:"100%",width:"fit-content"},value:O,loading:null===te||void 0===te?void 0:te.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0})})]}),Z.project&&(0,E.jsx)(v.A.Text,{className:"error-message",children:"Project task is required"}),(0,E.jsxs)(x.A,{className:"mt-3",children:[(0,E.jsx)(m.A,{sm:4,children:(0,E.jsx)(v.A.Label,{className:k,children:"Description"})}),(0,E.jsx)(m.A,{sm:12,children:(0,E.jsx)(v.A.Control,{name:"taskDescription",id:"taskDescription",as:"textarea",placeholder:"Enter a description...",value:M,rows:6,ref:P,onChange:e=>{W(e.target.value)},className:b,onInput:e=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onFocus:()=>{P.current&&(P.current.style.height="auto",P.current.style.height=P.current.scrollHeight+"px")}})})]}),Z.description&&(0,E.jsx)(v.A.Text,{className:"error-message",children:"Description is required"})]}),(0,E.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-between gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"80px"},children:[(0,E.jsx)("div",{children:$&&(0,E.jsxs)(h.A,{className:"danger-text-button gap-2",onClick:re,children:["Delete",le.isPending&&(0,E.jsx)(u.p,{style:{width:"18px",height:"18px"}})]})}),(0,E.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,E.jsx)(h.A,{type:"button",onClick:ie,className:"outline-button",children:"Cancel"}),(0,E.jsxs)(h.A,{type:"button",onClick:oe,className:"solid-button",style:{minWidth:"70px"},disabled:ae.isPending,children:[$?"Update Task":"Create Task"," ",ae.isPending&&(0,E.jsx)(u.p,{style:{width:"18px",height:"18px"}})]})]})]})]})}})}}}]);
//# sourceMappingURL=8385.c53a94f4.chunk.js.map