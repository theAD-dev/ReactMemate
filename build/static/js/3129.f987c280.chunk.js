"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[3129],{623:(e,t,s)=>{s.d(t,{IY:()=>j,Kh:()=>d,Nh:()=>r,Np:()=>m,PR:()=>a,SG:()=>h,YC:()=>g,fD:()=>v,hW:()=>c,ic:()=>y,j:()=>u,ms:()=>b,oQ:()=>o,vU:()=>p,yA:()=>f,yi:()=>x});var i=s(63712);const n="https://dev.memate.com.au/api/v1",l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:i={},body:n}=t,l={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...i},body:JSON.stringify(n),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,l);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const i=s.headers.get("Content-Type");if(i&&i.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(o){throw console.error("Fetch API error:",o),o}},o=async()=>{const e=new URL(`${n}/settings/subscriptions/tax-id/`);return l(e.toString(),{method:"GET"})},a=async()=>{const e=new URL(`${n}/settings/subscriptions/upcoming/`);return l(e.toString(),{method:"GET"})},r=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/subscriptions/tax-id/`);return l(s.toString(),t)},d=async()=>{const e=new URL(`${n}/settings/subscriptions/payment-method/`);return l(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${n}/subscriptions/retry/`);return l(e.toString(),{method:"POST"})},u=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/subscriptions/payment-method/`);return l(s.toString(),t)},h=async()=>{const e=new URL(`${n}/settings/organization/region-language/`);return l(e.toString(),{method:"GET"})},p=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/organization/region-language/`);return l(s.toString(),t)},x=async e=>{console.log("data: ",e),e.id&&delete e.id,e.isNew&&delete e.isNew,e.isChanged&&delete e.isChanged,e.value&&delete e.value;const t={method:"POST",body:e},s=new URL(`${n}/settings/project-statuses/new/`);return l(s.toString(),t)},m=async(e,t)=>{const s={method:"PUT",body:t},i=new URL(`${n}${`/settings/project-statuses/update/${e}/`}`);return l(i.toString(),s)},v=async e=>{const t=new URL(`${n}${`/settings/project-statuses/delete/${e}/`}`);return l(t.toString(),{method:"DELETE"})},g=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/general/`,s);return await e.json()}catch(i){throw console.error("Profile fetch error:",i),i}},j=async(e,t)=>{const s=new Headers,l=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${l}`);const o=new FormData;if(Object.keys(e).forEach((t=>{o.append(t,e[t])})),null!==t&&void 0!==t&&t.croppedImageBlob){const e=(0,i.Ak)(6);o.append("company_logo",null===t||void 0===t?void 0:t.croppedImageBlob,`${e}.jpg`)}const a={method:"PUT",headers:s,body:o,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/general/`,a),t=await e.text();return console.log("result>>>>>>>>>>: ",t),t}catch(r){throw console.error("Profile fetch error:",r),r}},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/bank/`,s);return await e.text()}catch(i){throw console.error("Profile fetch error:",i),i}},f=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`);const i=new FormData;Object.keys(e).forEach((t=>{i.append(t,e[t])}));const l={method:"PUT",headers:t,body:i,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/bank/`,l),t=await e.text();return console.log("result: ",t),t}catch(o){throw console.error("Profile fetch error:",o),o}},y=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/project-statuses/`,s);return await e.json()}catch(i){throw console.error("project fetch error:",i),i}}},2557:(e,t,s)=>{s.r(t),s.d(t,{default:()=>It});var i=s(65043),n=s(49367),l=s(15258),o=s(14282),a=s(27417),r=s(89082),d=s(62812),c=s(39759),u=s(58387),h=s(748),p=s(11520),x=s(79106);let m,v,g;function j(e){return new Date(new Date(e).getTime()-60*new Date(e).getTimezoneOffset()*1e3)}function b(e,t){const s=[],i=null===e||void 0===e?void 0:e.map((e=>{var i,n,l,o,a,r,d,c,u;let h=(null===e||void 0===e||null===(i=e.custom_status)||void 0===i?void 0:i.color)||"rgb(192, 192, 192)",p=null===e||void 0===e||null===(n=e.custom_status)||void 0===n?void 0:n.background,x=null===e||void 0===e||null===(l=e.custom_status)||void 0===l?void 0:l.font;const m=null!==e&&void 0!==e&&null!==(o=e.custom_status)&&void 0!==o&&o.title?`<div style='color:${x}; background:${p}; border: 1px solid ${h}; width: fit-content; max-width: 85px; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px;' title="${e.custom_status.title}">\n          <div style='max-width: 80px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 0px; white-space: nowrap; font-size: 12px;'>${e.custom_status.title}</div>\n        </div>`:"<div style='font-size: 12px;color: #344054; background: #F2F4F7; border: 1px solid rgba(0, 0, 0, 0.498); width: fit-content; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px'>No status</div>";let v="not-started";0===e.jobs_count&&0===e.jobs_count?v="not-started":e.jobs_done===e.jobs_count?v="done":0===e.jobs_done?v="not-done":e.jobs_done&&(v="pending");const b=new Date(1e3*parseInt(e.booking_end));b.setHours(23,59,59,999);let f=b<new Date;s.push({start:j(1e3*+e.booking_start),end:j(1e3*+e.booking_end),id:e.unique_id,cssClass:"project-item",resource:e.unique_id,backColor:p,borderColor:h,tag:{number:e.number,reference:e.reference,value:e.id,type:"job"},text:`<ul class="eventStyleCal">\n        <li>\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_6815_57879)"><rect width="24" height="24" rx="4" fill="url(#paint0_linear_6815_57879)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="23.25" height="23.25" rx="3.625" stroke="#101828" stroke-width="0.75"/></g><g clip-path="url(#clip1_6815_57879)">\n            <path d="M8.57171 7.28592C8.57171 7.04923 8.76359 6.85735 9.00028 6.85735H9.85742C10.0941 6.85735 10.286 7.04923 10.286 7.28592V8.14307C10.286 8.37976 10.0941 8.57164 9.85742 8.57164H9.00028C8.76359 8.57164 8.57171 8.37976 8.57171 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M11.1431 7.28592C11.1431 7.04923 11.335 6.85735 11.5717 6.85735H12.4289C12.6655 6.85735 12.8574 7.04923 12.8574 7.28592V8.14307C12.8574 8.37976 12.6655 8.57164 12.4289 8.57164H11.5717C11.335 8.57164 11.1431 8.37976 11.1431 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M14.1431 6.85735C13.9064 6.85735 13.7146 7.04923 13.7146 7.28592V8.14307C13.7146 8.37976 13.9064 8.57164 14.1431 8.57164H15.0003C15.237 8.57164 15.4289 8.37976 15.4289 8.14307V7.28592C15.4289 7.04923 15.237 6.85735 15.0003 6.85735H14.1431Z" fill="#667085"/>\n            <path d="M8.57171 9.85735C8.57171 9.62066 8.76359 9.42878 9.00028 9.42878H9.85742C10.0941 9.42878 10.286 9.62066 10.286 9.85735V10.7145C10.286 10.9512 10.0941 11.1431 9.85742 11.1431H9.00028C8.76359 11.1431 8.57171 10.9512 8.57171 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M11.5717 9.42878C11.335 9.42878 11.1431 9.62066 11.1431 9.85735V10.7145C11.1431 10.9512 11.335 11.1431 11.5717 11.1431H12.4289C12.6655 11.1431 12.8574 10.9512 12.8574 10.7145V9.85735C12.8574 9.62066 12.6655 9.42878 12.4289 9.42878H11.5717Z" fill="#667085"/>\n            <path d="M13.7146 9.85735C13.7146 9.62066 13.9064 9.42878 14.1431 9.42878H15.0003C15.237 9.42878 15.4289 9.62066 15.4289 9.85735V10.7145C15.4289 10.9512 15.237 11.1431 15.0003 11.1431H14.1431C13.9064 11.1431 13.7146 10.9512 13.7146 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M9.00028 12.0002C8.76359 12.0002 8.57171 12.1921 8.57171 12.4288V13.2859C8.57171 13.5226 8.76359 13.7145 9.00028 13.7145H9.85742C10.0941 13.7145 10.286 13.5226 10.286 13.2859V12.4288C10.286 12.1921 10.0941 12.0002 9.85742 12.0002H9.00028Z" fill="#667085"/>\n            <path d="M11.1431 12.4288C11.1431 12.1921 11.335 12.0002 11.5717 12.0002H12.4289C12.6655 12.0002 12.8574 12.1921 12.8574 12.4288V13.2859C12.8574 13.5226 12.6655 13.7145 12.4289 13.7145H11.5717C11.335 13.7145 11.1431 13.5226 11.1431 13.2859V12.4288Z" fill="#667085"/>\n            <path d="M14.1431 12.0002C13.9064 12.0002 13.7146 12.1921 13.7146 12.4288V13.2859C13.7146 13.5226 13.9064 13.7145 14.1431 13.7145H15.0003C15.237 13.7145 15.4289 13.5226 15.4289 13.2859V12.4288C15.4289 12.1921 15.237 12.0002 15.0003 12.0002H14.1431Z" fill="#667085"/>\n            <path d="M6.85742 6.00021C6.85742 5.52682 7.24118 5.14307 7.71456 5.14307H16.286C16.7594 5.14307 17.1431 5.52682 17.1431 6.00021V18.0002C17.1431 18.4736 16.7594 18.8574 16.286 18.8574H7.71456C7.24118 18.8574 6.85742 18.4736 6.85742 18.0002V6.00021ZM16.286 6.00021L7.71456 6.00021V18.0002H10.286V15.8574C10.286 15.6207 10.4779 15.4288 10.7146 15.4288H13.286C13.5227 15.4288 13.7146 15.6207 13.7146 15.8574V18.0002H16.286V6.00021Z" fill="#667085"/></g></g><defs><linearGradient id="paint0_linear_6815_57879" x1="12" y1="0" x2="12" y2="24" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_6815_57879"><rect width="24" height="24" rx="4" fill="white"/></clipPath><clipPath id="clip1_6815_57879"><rect width="13.7143" height="13.7143" fill="white" transform="translate(5.14307 5.14307)"/></clipPath></defs>\n          </svg>\n          &nbsp;\n          <strong style="color: ${x}; font-weight: 400">${e.reference}</strong>\n        </li>\n      </ul>`});const y=(null===(a=e.tasks.filter((e=>!e.finished)))||void 0===a?void 0:a.length)||0,C=e.tasks.length,w=[];w.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M10.875 2.25C11.0821 2.25 11.25 2.41789 11.25 2.625V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V2.625C0.75 2.41789 0.917893 2.25 1.125 2.25H10.875ZM1.125 1.5C0.50368 1.5 0 2.00368 0 2.625V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V2.625C12 2.00368 11.4963 1.5 10.875 1.5H1.125Z" fill="#475467"/>\n                <path d="M5.25 4.125C5.25 3.91789 5.41789 3.75 5.625 3.75H9.375C9.58211 3.75 9.75 3.91789 9.75 4.125C9.75 4.33211 9.58211 4.5 9.375 4.5H5.625C5.41789 4.5 5.25 4.33211 5.25 4.125Z" fill="#475467"/>\n                <path d="M4.12767 3.48484C4.27411 3.63128 4.27411 3.86872 4.12767 4.01516L3.00267 5.14016C2.85622 5.28661 2.61878 5.28661 2.47234 5.14016L2.09734 4.76516C1.95089 4.61872 1.95089 4.38128 2.09734 4.23484C2.24378 4.08839 2.48122 4.08839 2.62767 4.23484L2.7375 4.34467L3.59734 3.48484C3.74378 3.33839 3.98122 3.33839 4.12767 3.48484Z" fill="#475467"/>\n                <path d="M5.25 7.125C5.25 6.91789 5.41789 6.75 5.625 6.75H9.375C9.58211 6.75 9.75 6.91789 9.75 7.125C9.75 7.33211 9.58211 7.5 9.375 7.5H5.625C5.41789 7.5 5.25 7.33211 5.25 7.125Z" fill="#475467"/>\n                <path d="M4.12767 6.48484C4.27411 6.63128 4.27411 6.86872 4.12767 7.01516L3.00267 8.14017C2.85622 8.28661 2.61878 8.28661 2.47234 8.14017L2.09734 7.76517C1.95089 7.61872 1.95089 7.38128 2.09734 7.23484C2.24378 7.08839 2.48122 7.08839 2.62767 7.23484L2.7375 7.34467L3.59734 6.48484C3.74378 6.33839 3.98122 6.33839 4.12767 6.48484Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Tasks</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(r=e.tasks)||void 0===r||r.forEach((e=>{var t;s.push({start:j(1e3*+e.from_date),end:j(1e3*+e.to_date),id:e.id,cssClass:"childEvent task-item",resource:e.id,backColor:e.finished?"#DCFAE6":"#F2F4F7",borderColor:e.finished?"#DCFAE6":"#F2F4F7",text:e.title,tag:{type:"task",task:e}});const i=e.finished?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>';w.push({id:e.id,name:`<div class="d-flex flex-column">\n            <div task-id="${e.id}" class="task-list rowResourceEvent" style="--main-color: ${h}" task-id="${e.id}">\n              <div class="flex">\n                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_5999_560822)"><rect width="16" height="16" rx="8" fill="url(#paint0_linear_5999_560822)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="15.25" height="15.25" rx="7.625" stroke="#101828" stroke-width="0.75"/></g>\n                  <path d="M6.57129 6.28585C6.41349 6.28585 6.28557 6.41377 6.28557 6.57157C6.28557 6.72936 6.41349 6.85728 6.57129 6.85728H9.42843C9.58623 6.85728 9.71415 6.72936 9.71415 6.57157C9.71415 6.41377 9.58623 6.28585 9.42843 6.28585H6.57129Z" fill="#475467"/>\n                  <path d="M6.57129 7.42871C6.41349 7.42871 6.28557 7.55663 6.28557 7.71443C6.28557 7.87222 6.41349 8.00014 6.57129 8.00014H8.28557C8.44337 8.00014 8.57129 7.87222 8.57129 7.71443C8.57129 7.55663 8.44337 7.42871 8.28557 7.42871H6.57129Z" fill="#475467"/>\n                  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99986 4.57157C8.63104 4.57157 9.14272 4.05989 9.14272 3.42871H10.5713C11.0447 3.42871 11.4284 3.81247 11.4284 4.28585V11.7144C11.4284 12.1878 11.0447 12.5716 10.5713 12.5716H5.42843C4.95505 12.5716 4.57129 12.1878 4.57129 11.7144V4.28585C4.57129 3.81247 4.95505 3.42871 5.42843 3.42871H6.857C6.857 4.05989 7.36868 4.57157 7.99986 4.57157ZM7.99986 5.143C8.74627 5.143 9.38127 4.66596 9.6166 4.00014H10.5713C10.7291 4.00014 10.857 4.12806 10.857 4.28585V11.7144C10.857 11.8722 10.7291 12.0001 10.5713 12.0001H5.42843C5.27064 12.0001 5.14272 11.8722 5.14272 11.7144V4.28585C5.14272 4.12806 5.27064 4.00014 5.42843 4.00014H6.38312C6.61846 4.66596 7.25345 5.143 7.99986 5.143Z" fill="#475467"/></g><defs><linearGradient id="paint0_linear_5999_560822" x1="8" y1="0" x2="8" y2="16" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_5999_560822"><rect width="16" height="16" rx="8" fill="white"/></clipPath></defs>\n                </svg>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===e||void 0===e||null===(t=e.assigned_to)||void 0===t?void 0:t.name}</span>\n                  <span class="task-title">${e.title}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===i?"completed-class":"incomplete-class"}">\n                ${i}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),w.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(d=e.tasks)&&void 0!==d&&d.length?"45px":"40px"}">\n              <button class="create-task-button" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}" style="margin-bottom: ${null!==(c=e.tasks)&&void 0!==c&&c.length?"16px":"6px"}">Create Task\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0});let A=0,N=0;var S,F,_,k,E,D;t&&(A=(null===e||void 0===e||null===(S=e.jobs)||void 0===S||null===(F=S.filter((e=>!e.finished)))||void 0===F?void 0:F.length)||0,N=(null===e||void 0===e||null===(_=e.jobs)||void 0===_?void 0:_.length)||0,w.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M4.875 0.75C4.2538 0.75 3.75 1.25338 3.75 1.87482V2.25H1.125C0.50368 2.25 0 2.75368 0 3.375V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V3.375C12 2.75368 11.4963 2.25 10.875 2.25H8.25V1.87482C8.25 1.25338 7.7462 0.75 7.125 0.75H4.875ZM4.875 1.5H7.125C7.33223 1.5 7.5 1.66847 7.5 1.87546V2.25H4.5V1.87482C4.5 1.66783 4.66777 1.5 4.875 1.5ZM6.28987 6.68581L11.25 5.3631V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V5.3631L5.71013 6.68581C5.90006 6.73645 6.09994 6.73645 6.28987 6.68581ZM1.125 3H10.875C11.0821 3 11.25 3.16789 11.25 3.375V4.5869L6.09662 5.96113C6.03331 5.97801 5.96669 5.97801 5.90338 5.96113L0.75 4.5869V3.375C0.75 3.16789 0.917893 3 1.125 3Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Jobs</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(k=e.jobs)||void 0===k||k.forEach(((e,t)=>{var i,n,l,o;s.push({start:j(1e3*+e.start_date),end:j(1e3*+e.end_date),id:`job_${e.id}_${t}`,cssClass:"childEvent task-item",resource:e.id,backColor:e.finished?"#DCFAE6":"#F2F4F7",borderColor:e.finished?"#DCFAE6":"#F2F4F7",text:e.short_description});const a="5"===e.status?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>',r=(null===e||void 0===e||null===(i=e.worker)||void 0===i?void 0:i.alias)||"",d=null!==e&&void 0!==e&&null!==(n=e.worker)&&void 0!==n&&n.has_photo?`<img src="${null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.photo}" style="width: 20px; height: 20px; border-radius: 50%;" onerror="this.outerHTML='<div class=\\'job-alias\\'>${r}</div>'" />`:`<div class="job-alias">${r}</div>`;w.push({id:e.id,name:`<div class="d-flex flex-column">\n            <div class="task-list rowResourceEvent" style="--main-color: ${h}">\n              <div class="flex">\n                <div class="job-icon">\n                 ${d}\n                </div>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===e||void 0===e||null===(o=e.worker)||void 0===o?void 0:o.full_name}</span>\n                  <span class="task-title">${e.short_description}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===a?"completed-class":"incomplete-class"}">\n                ${a}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),w.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(E=e.tasks)&&void 0!==E&&E.length?"45px":"40px"}">\n              <button class="createJobButton" project-id="${e.unique_id}" style="margin-bottom: ${null!==(D=e.tasks)&&void 0!==D&&D.length?"16px":"6px"}">\n                Create Job\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0}));const L=y+A,B=C+N;return{id:e.unique_id,expanded:g===e.unique_id,name:`<div class="resourceList rowResourceEvent" style="--main-color: ${h};">\n        <ul class="resourceMan me-2">\n          <li title="${e.number}">\n            <div style="width: 70px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 2px; white-space: nowrap;" class="">${e.number}</div>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M5 4C4.72386 4 4.5 4.22386 4.5 4.5C4.5 4.77614 4.72386 5 5 5H11C11.2761 5 11.5 4.77614 11.5 4.5C11.5 4.22386 11.2761 4 11 4H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M4.5 6.5C4.5 6.22386 4.72386 6 5 6H11C11.2761 6 11.5 6.22386 11.5 6.5C11.5 6.77614 11.2761 7 11 7H5C4.72386 7 4.5 6.77614 4.5 6.5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 8C4.72386 8 4.5 8.22386 4.5 8.5C4.5 8.77614 4.72386 9 5 9H11C11.2761 9 11.5 8.77614 11.5 8.5C11.5 8.22386 11.2761 8 11 8H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 10C4.72386 10 4.5 10.2239 4.5 10.5C4.5 10.7761 4.72386 11 5 11H8C8.27614 11 8.5 10.7761 8.5 10.5C8.5 10.2239 8.27614 10 8 10H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M2 2C2 0.89543 2.89543 0 4 0H12C13.1046 0 14 0.89543 14 2V14C14 15.1046 13.1046 16 12 16H4C2.89543 16 2 15.1046 2 14V2ZM12 1H4C3.44772 1 3 1.44772 3 2V14C3 14.5523 3.44772 15 4 15H12C12.5523 15 13 14.5523 13 14V2C13 1.44772 12.5523 1 12 1Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M11 7.5C11 7.22386 11.2239 7 11.5 7H12.5C12.7761 7 13 7.22386 13 7.5V8.5C13 8.77614 12.7761 9 12.5 9H11.5C11.2239 9 11 8.77614 11 8.5V7.5Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M3.5 0C3.77614 0 4 0.223858 4 0.5V1H12V0.5C12 0.223858 12.2239 0 12.5 0C12.7761 0 13 0.223858 13 0.5V1H14C15.1046 1 16 1.89543 16 3V14C16 15.1046 15.1046 16 14 16H2C0.895431 16 0 15.1046 0 14V3C0 1.89543 0.895431 1 2 1H3V0.5C3 0.223858 3.22386 0 3.5 0ZM2 2C1.44772 2 1 2.44772 1 3V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V3C15 2.44772 14.5523 2 14 2H2Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V5C13.5 5.27614 13.2761 5.5 13 5.5H3C2.72386 5.5 2.5 5.27614 2.5 5V4Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M4 10.7813C4.14782 12.4484 5.51294 13.6306 7.59107 13.7837V15H8.63448V13.7837C10.9039 13.6051 12.3125 12.3463 12.3125 10.4836C12.3125 8.89307 11.3647 7.97448 9.35617 7.45565L8.63448 7.26853V3.46659C9.75615 3.57716 10.5126 4.18104 10.7039 5.08262H12.1734C12.0082 3.4836 10.6343 2.33536 8.63448 2.20778V1H7.59107V2.23329C5.65207 2.46294 4.32172 3.70474 4.32172 5.38882C4.32172 6.84326 5.28687 7.87242 6.98241 8.3062L7.59107 8.4678V12.4994C6.44332 12.3293 5.65207 11.6999 5.46077 10.7813H4ZM7.39108 6.94532C6.34767 6.68165 5.79119 6.12029 5.79119 5.32928C5.79119 4.38518 6.49549 3.68773 7.59107 3.50061V6.99635L7.39108 6.94532ZM8.98228 8.81652C10.2692 9.13973 10.8343 9.67558 10.8343 10.5857C10.8343 11.6829 10.0083 12.4143 8.63448 12.5249V8.73147L8.98228 8.81652Z" fill="${e.is_invoice_created?"PAID"===e.paid?"#17B26A":"NOT PAID"===e.paid?"#F04438":"PARTIAL PAYMENT"===e.paid?"#fedf89":"#F79009":"#667085"}"/>\n            </svg>\n          </li>\n          <li>\n            <span class='${v}'>${e.jobs_done}/${e.jobs_count}</span>\n          </li>\n          <li>\n            ${f?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect width="24" height="24" rx="12" fill="#FEE4E2" />\n            <path d="M12.515 5.01896C12.344 5.00635 12.1722 5 12 5V4C12.1968 4 12.3931 4.00726 12.5885 4.02167L12.515 5.01896ZM14.5193 5.46905C14.1985 5.34533 13.8691 5.2454 13.5337 5.17008L13.7528 4.19438C14.1361 4.28046 14.5126 4.39467 14.8792 4.53605L14.5193 5.46905ZM15.889 6.17971C15.7458 6.08402 15.5994 5.99388 15.4503 5.90939L15.9432 5.0393C16.1136 5.13586 16.2809 5.23888 16.4446 5.34824C16.6082 5.4576 16.7674 5.5727 16.9219 5.69322L16.3066 6.48158C16.1715 6.37612 16.0322 6.27541 15.889 6.17971ZM17.7231 7.96934C17.5252 7.68829 17.3068 7.42218 17.0697 7.17321L17.794 6.48368C18.0649 6.76821 18.3145 7.07233 18.5407 7.39353L17.7231 7.96934ZM18.4672 9.32122C18.4012 9.16208 18.3296 9.00583 18.2526 8.85271L19.1458 8.40311C19.2339 8.5781 19.3157 8.75667 19.391 8.93853C19.4664 9.12039 19.5348 9.30453 19.5962 9.49054L18.6467 9.80423C18.5929 9.64147 18.5331 9.48035 18.4672 9.32122ZM18.9979 11.8282C18.9895 11.4846 18.9557 11.142 18.8969 10.8033L19.8822 10.6323C19.9494 11.0194 19.988 11.4109 19.9976 11.8037L18.9979 11.8282ZM18.8655 13.3656C18.8991 13.1967 18.9264 13.027 18.9474 12.8569L19.9398 12.9793C19.9159 13.1737 19.8847 13.3677 19.8463 13.5607C19.8079 13.7538 19.7625 13.9449 19.7102 14.1337L18.7464 13.867C18.7922 13.7018 18.8319 13.5346 18.8655 13.3656ZM17.914 15.745C18.0979 15.4546 18.2602 15.151 18.3995 14.8367L19.3137 15.2419C19.1545 15.6011 18.969 15.9481 18.7588 16.28L17.914 15.745ZM16.9497 16.9497C17.0715 16.828 17.1885 16.702 17.3005 16.5722L18.0577 17.2254C17.9297 17.3737 17.796 17.5177 17.6569 17.6569L16.9497 16.9497Z" fill="#F04438" />\n            <path d="M12 5C10.8488 5 9.71545 5.2839 8.70022 5.82655C7.68499 6.3692 6.81926 7.15386 6.17971 8.11101C5.54017 9.06816 5.14654 10.1683 5.03371 11.3139C4.92088 12.4595 5.09232 13.6153 5.53285 14.6788C5.97337 15.7423 6.66939 16.6808 7.55925 17.4111C8.44911 18.1414 9.50533 18.6409 10.6344 18.8655C11.7634 19.0901 12.9304 19.0327 14.032 18.6986C15.1336 18.3644 16.1358 17.7637 16.9497 16.9497L17.6569 17.6569C16.7266 18.5871 15.5812 19.2736 14.3223 19.6555C13.0633 20.0374 11.7296 20.1029 10.4393 19.8463C9.14895 19.5896 7.94183 19.0187 6.92486 18.1841C5.90788 17.3495 5.11243 16.2769 4.60897 15.0615C4.1055 13.846 3.90957 12.5251 4.03852 11.2159C4.16748 9.90659 4.61733 8.64933 5.34825 7.55544C6.07916 6.46155 7.06857 5.5648 8.22883 4.94463C9.38909 4.32446 10.6844 4 12 4V5Z" fill="#F04438" />\n            <path d="M11.5 7C11.7761 7 12 7.22386 12 7.5V12.7098L15.2481 14.5659C15.4878 14.7029 15.5711 15.0083 15.4341 15.2481C15.2971 15.4878 14.9917 15.5711 14.7519 15.4341L11.2519 13.4341C11.0961 13.3451 11 13.1794 11 13V7.5C11 7.22386 11.2239 7 11.5 7Z" fill="#F04438" />\n          </svg>':""}\n          </li>\n          <li class="text-end float-end me-2" style="width: 100px; flex: 1">\n            ${m}\n          </li>\n          <li class="me-3" style="position: relative;">\n            ${0!==L?`<div class="taskUnreadCount">${L}</div>`:""}\n            <div class="taskCount">${B||0}</div>\n          </li>\n        </ul>\n        <div class="project-content" unique-id="${e.unique_id}" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}">\n          <span class="small project-content-name" unique-id="${e.unique_id}">${null===e||void 0===e||null===(u=e.client)||void 0===u?void 0:u.name}</span>\n          <h2 class="project-content-name" unique-id="${e.unique_id}">${e.reference}</h2>\n        </div>\n      </div>`,children:w,minHeight:95}}));m.update({resources:i,events:s}),m.onResourceExpand=function(e){g=e.resource.id}}function f(e,t){try{m&&b(e,t)}catch(s){console.log(s)}}function y(e,t,s,i,n){try{!function(e,t,s,i,n){void 0!==typeof window&&Boolean(window.DayPilot)&&(v=window.DayPilot,m=new v.Scheduler(e,{days:365,scale:"Day",separators:[{color:"#48C1FF",width:4}],treeImage:"img/nochildren.png",rowMinHeight:110,eventEndSpec:"Date",durationBarVisible:!1,eventArrangement:"Cascade",eventMoveHandling:"Disabled",eventResizingStartEndEnabled:!0,timeRangeSelectedHandling:"Disabled",treeImageNoChildren:!1,rowHeaderWidth:380,timeHeaders:[{groupBy:"Month",format:"MMMM yyyy"},{groupBy:"Day",format:"d"}],treeEnabled:!0,progressiveRowRendering:!0,treePreventParentUsage:!1,scrollDelayEvents:0,infiniteScrollingEnabled:!0,infiniteScrollingStepDays:100}),m.onBeforeRowHeaderRender=function(e){e.row.cssClass="resourcesRow"},m.onBeforeEventRender=function(e){e.data.areas=[{top:0,left:0,right:0,width:1,cssClass:"childEventborder",text:e.data.text,backColor:e.data.borderColor,fontColor:"#ffffff",horizontalAlignment:"center",style:"border-top-left-radius: 4px; border-bottom-left-radius: 4px; background-color: #0000007f; color: #ffffff; padding: 2px;height: 36px;"}],e.data.text="Event details"},m.onEventClicked=function(e){const t=e.e.id();if(e.div.className.includes("task-item")&&t)s(t,!1);else if(e.div.className.includes("project-item")&&t){const i=e.e.tag();s(t,!0,i)}},m.onBeforeCellRender=function(e){6!==e.cell.start.getDayOfWeek()&&0!==e.cell.start.getDayOfWeek()||(e.cell.backColor="#F9FAFB")},m.onEventResize=async function(e){const t=e.e.id(),s=new Date(e.newStart).toISOString(),n=new Date(e.newEnd).toISOString();if("task"===e.e.tag().type){const i=e.e.tag().task;try{await(0,x.lC)(t,{title:i.title,description:i.description,user:i.assigned_to.id,from_date:s,to_date:n}),m.message("The task has been successfully updated.",{cssClass:"success_message"})}catch(l){console.log(l),m.message("An error occurred while updating the task. Please try again.")}}if("job"===e.e.tag().type)try{await(0,p.mw)(t,{booking_start:s,booking_end:n}),m.message("The project schedule has been successfully updated.",{cssClass:"success_message"}),i()}catch(l){console.log(l),m.message("An error occurred while updating the project schedule. Please try again.")}},m.init(),b(t,n))}(e,t,s,i,n)}catch(l){console.log(l)}}var C=s(623),w=s(57189),A=s(48417),N=s(11281),S=s(65975),F=s(64196),_=s(36097),k=s(10615),E=s(94673),D=s(73898),L=s(38345),B=s(44713),$=s(56741),I=s(71807),T=s(52572),R=s(72413),M=s(99832),P=s(27066),H=s(38300),z=s(22927),O=s(90991),q=s(33361),V=s(93202),U=s(72970),Z=s(88578),G=s(78869),W=s(70836),K=s(73216),J=s(35475),Y=s(47097),Q=s(9642),X=s(64824),ee=s(93740),te=s(78602),se=s(32952),ie=s(61072),ne=s(56328);const le=s.p+"static/media/addNoteModeIcon.43bdc8582f3ef769329a44f15a05fe67.svg";var oe=s(70579);const ae=e=>{let{projectId:t,projectCardData:s}=e;const[n,l]=(0,i.useState)(!1),[a,r]=(0,i.useState)(""),[d,c]=(0,i.useState)({description:""}),u=2e3,h=()=>l(!1),x=(0,Y.n)({mutationFn:e=>(0,p.o2)(t,e),onSuccess:()=>{h(),s(t)},onError:e=>{console.error("Error creating note:",e),c((t=>({...t,description:e.message||"Failed to save note. Please try again."})))}}),m=e=>e.trim()?e.length<3?"Note must be at least 3 characters long":e.length>u?"Note must not exceed 2000 characters":/^\s+$/.test(e)?"Note cannot contain only whitespace":"":"Note is required";return(0,i.useEffect)((()=>{n||(r(""),c({description:""}))}),[n]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"linkByttonStyle py-2 border-right",onClick:()=>l(!0),children:"Add Note"}),(0,oe.jsxs)(se.A,{show:n,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:h,animation:!1,size:"lg",children:[(0,oe.jsxs)(se.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,oe.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,oe.jsxs)("span",{children:[(0,oe.jsx)("img",{src:le,alt:"AddNoteModeIcon"}),"Add Note"]})}),(0,oe.jsx)("button",{className:"CustonCloseModal",onClick:h,children:(0,oe.jsx)($.A,{size:24,color:"#667085"})})]}),(0,oe.jsx)(se.A.Body,{children:(0,oe.jsx)("div",{className:"ContactModel",children:(0,oe.jsx)(ie.A,{children:(0,oe.jsx)(te.A,{children:(0,oe.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,oe.jsxs)("label",{htmlFor:"note-input",children:["Note ",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)("div",{className:"inputInfo "+(d.description?"error-border":""),children:(0,oe.jsx)("textarea",{id:"note-input",type:"text",name:"note",value:a,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value;r(t);const s=m(t);c((e=>({...e,description:s})))},maxLength:u,rows:10,className:"w-100"})}),(0,oe.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,oe.jsx)("small",{className:d.description?"error-message":"text-muted",children:d.description||`${a.length}/2000 characters`})})]})})})})}),(0,oe.jsx)(se.A.Footer,{className:"pt-0",children:(0,oe.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,oe.jsx)(o.A,{variant:"outline-danger",onClick:h,disabled:x.isPending,children:"Cancel"}),(0,oe.jsx)(o.A,{variant:"primary save",onClick:()=>{const e=m(a);e?c((t=>({...t,description:e}))):x.mutate({text:a.trim()})},disabled:x.isPending||!!d.description,children:x.isPending?"Saving...":"Save"})]})})]})]})};var re=s(93747),de=s(59638),ce=s(81047),ue=s(81242);const he=e=>{var t;let{clientId:s,projectId:n,projectCardData:l}=e;const o=(0,K.Zp)(),[,a]=(0,i.useState)({}),[r,d]=(0,i.useState)(!1),c=(0,re.I)({queryKey:["getOutgoingEmail"],queryFn:ce.hx}),u=(0,re.I)({queryKey:["getClientById",s],queryFn:()=>(0,de.EZ)(s),enabled:!!s,retry:1}),h=(0,Y.n)({mutationFn:e=>(0,p.jy)(n,"",e),onSuccess:()=>{d(!1),l(),ne.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),ne.oR.error("Failed to send email. Please try again.")}});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"linkByttonStyle py-2 ps-0",onClick:()=>{var e;"no-reply@memate.com.au"!==(null===c||void 0===c||null===(e=c.data)||void 0===e?void 0:e.outgoing_email)?d(!0):o("/settings/integrations?openEmail=true")},children:"Compose Email"}),(0,oe.jsx)(ue.A,{show:r,isLoading:!1,mutation:h,setShow:d,setPayload:a,contactPersons:(null===u||void 0===u||null===(t=u.data)||void 0===t?void 0:t.contact_persons)||[],isComposeEmail:!0})]})};const pe=s.p+"static/media/googleReviewIcon.0184cc6ef401c44935cf67effccb9dd0.svg",xe=e=>{var t;let{clientId:s,projectId:n}=e;const[,l]=(0,i.useState)({}),[a,r]=(0,i.useState)(!1),d=(0,re.I)({queryKey:["getClientById",s],queryFn:()=>(0,de.EZ)(s),enabled:!!s,retry:1}),c=(0,Y.n)({mutationFn:e=>(0,p.jy)(n,"google-review",e),onSuccess:()=>{r(!1),ne.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),ne.oR.error("Failed to send email. Please try again.")}});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(o.A,{className:"googleBut googleActive",onClick:()=>r(!0),children:["Google Review  ",(0,oe.jsx)("img",{src:pe,alt:"GoogleReview"})]}),(0,oe.jsx)(ue.A,{show:a,mutation:c,isLoading:!1,setShow:r,setPayload:l,contactPersons:(null===d||void 0===d||null===(t=d.data)||void 0===t?void 0:t.contact_persons)||[],defaultTemplateId:"Google Review"})]})};var me=s(46291),ve=s(75758),ge=s(88060),je=s(8868),be=s(28676),fe=s(74532),ye=s(72052);const Ce={headerTitle:"send-invoice_headerTitle__YBmdt",customLabel:"send-invoice_customLabel__0D26B",bag:"send-invoice_bag__VXoPF",lable:"send-invoice_lable__hDm-2",dropdownSelect:"send-invoice_dropdownSelect__y4YWM",autoCompleteBox:"send-invoice_autoCompleteBox__sVyzX",AutoComplete:"send-invoice_AutoComplete__cCiBx",bcc:"send-invoice_bcc__KYSsZ",box:"send-invoice_box__pOjbC",active:"send-invoice_active__hBlO9",inputBox:"send-invoice_inputBox__gIZLk"};var we=s(36166);const Ae=(0,oe.jsxs)("span",{className:"ql-formats",children:[(0,oe.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,oe.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,oe.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,oe.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,oe.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,oe.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,oe.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,oe.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,oe.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,oe.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,oe.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,oe.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,oe.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,oe.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),Ne=e=>{var t,s,n,l;let{show:a,setShow:r,contactPersons:d,setPayload:c,isLoading:h,create:x,projectId:m,projectCardData:v,isCreated:g}=e;const j=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[b,f]=(0,i.useState)(""),[y,C]=(0,i.useState)([]),[w,A]=(0,i.useState)([]),[N,S]=(0,i.useState)([]),[F,_]=(0,i.useState)(null),[k,E]=(0,i.useState)(null),[D,L]=(0,i.useState)(null),[B,$]=(0,i.useState)({}),[I,T]=(0,i.useState)([]),R=(0,i.useRef)(null),M=(0,i.useRef)(null),P=(0,i.useRef)(null),[H,z]=(0,i.useState)(!1),[O,q]=(0,i.useState)(!1),V=()=>r(!1),[U,Z]=(0,i.useState)(null),G=(0,re.I)({queryKey:["emailTemplate"],queryFn:ce.SQ}),W=(0,re.I)({queryKey:["getSignatureTemplates"],queryFn:ce.AO}),K=(0,re.I)({queryKey:["getOutgoingEmail"],queryFn:ce.hx}),J=(0,re.I)({queryKey:["emailQuery",U],queryFn:()=>(0,ce.hS)(U),enabled:!!U,retry:1});(0,i.useEffect)((()=>{var e,t,s;null!==K&&void 0!==K&&K.data&&(null!==K&&void 0!==K&&null!==(e=K.data)&&void 0!==e&&e.outgoing_email&&null!==K&&void 0!==K&&null!==(t=K.data)&&void 0!==t&&t.outgoing_email_verified?f(null===K||void 0===K||null===(s=K.data)||void 0===s?void 0:s.outgoing_email):f("no-reply@memate.com.au"))}),[J,K]);const Q=(0,Y.n)({mutationFn:e=>g?(0,we.LG)(m,e):(0,p.fi)(m,e),onSuccess:()=>{V(),v(),ne.oR.success("Invoice created and send successfully.")},onError:e=>{console.error("Error creating task:",e),ne.oR.error("Failed to create and send invoice. Please try again.")}}),X=e=>{var t;const s=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=d.map((e=>e.email));i=i.filter((e=>!y.includes(e))),i=i.filter((e=>!w.includes(e))),i=i.filter((e=>!N.includes(e))),i=i.filter((e=>e.toLowerCase().includes(s))),T(i)},le=()=>{X(),R.current&&R.current.show()},ae=()=>{X(),M.current&&M.current.show()},de=()=>{X(),P.current&&P.current.show()};return(0,i.useEffect)((()=>{if(null!==d&&void 0!==d&&d.length){let e=d.map((e=>e.email));T(e)}}),[d]),(0,i.useEffect)((()=>{c((e=>({...e,subject:F,email_body:k,from_email:b,to:null===y||void 0===y?void 0:y.toString(),...w.length>0&&{cc:w.toString()},...N.length>0&&{bcc:N.toString()},...D&&{signature:D}})))}),[F,k,b,y,w,N,D,c]),(0,i.useEffect)((()=>{var e,t;null!==W&&void 0!==W&&W.data&&L(null===W||void 0===W||null===(e=W.data)||void 0===e||null===(t=e.find((e=>e.id===j.email_signature)))||void 0===t?void 0:t.id)}),[null===W||void 0===W?void 0:W.data,j.email_signature]),(0,i.useEffect)((()=>{var e,t;E((null===J||void 0===J||null===(e=J.data)||void 0===e?void 0:e.body)||""),_(null===J||void 0===J||null===(t=J.data)||void 0===t?void 0:t.subject),$((e=>({...e,subject:!1}))),$((e=>({...e,text:!1})))}),[null===J||void 0===J?void 0:J.data]),(0,i.useEffect)((()=>{if(null!==G&&void 0!==G&&G.data){var e,t;const s=g?null===G||void 0===G||null===(e=G.data)||void 0===e?void 0:e.find((e=>"Invoice"===e.type)):null===G||void 0===G||null===(t=G.data)||void 0===t?void 0:t.find((e=>"Invoice"===e.type));Z(null===s||void 0===s?void 0:s.id)}}),[null===G||void 0===G?void 0:G.data,g]),(0,oe.jsxs)(se.A,{show:a,centered:!0,onHide:V,className:"invoice-form",size:"lg",children:[(0,oe.jsx)(se.A.Header,{closeButton:!0,children:(0,oe.jsx)("div",{className:`${Ce.modalHeader}`,children:(0,oe.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,oe.jsxs)("span",{className:`white-space-nowrap mt-2 mb-2 ${Ce.headerTitle}`,children:[g?"Resend":"Send"," a Invoice"]})})})}),(0,oe.jsxs)(se.A.Body,{children:[(0,oe.jsxs)(ie.A,{children:[(0,oe.jsxs)(te.A,{sm:6,className:"mb-3",children:[(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"FROM"}),(0,oe.jsx)(ge.m,{options:K&&(null===K||void 0===K?void 0:K.data)&&[{value:null===K||void 0===K||null===(t=K.data)||void 0===t?void 0:t.outgoing_email,label:`${null===K||void 0===K||null===(s=K.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,u.A)(Ce.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{f(e.value),$((e=>({...e,from:!1})))},value:b,filterInputAutoFocus:!0})]}),(null===B||void 0===B?void 0:B.from)&&(0,oe.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,oe.jsx)(te.A,{sm:6,className:"mb-3",children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"Templates"}),(0,oe.jsx)(ge.m,{options:G&&(null===(n=G.data)||void 0===n?void 0:n.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,u.A)(Ce.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{Z(e.value)},value:U,loading:null===G||void 0===G?void 0:G.isFetching,filterInputAutoFocus:!0})]})})]}),(0,oe.jsxs)(ie.A,{children:[(0,oe.jsxs)(te.A,{sm:12,className:"mb-3",children:[(0,oe.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,oe.jsxs)("div",{style:{position:"relative"},className:Ce.autoCompleteBox,children:[(0,oe.jsx)("div",{style:{width:"50px"},className:Ce.bag}),(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"TO"}),(0,oe.jsx)(ve.j,{ref:R,value:y,completeMethod:X,onChange:e=>{C(e.value),$((e=>({...e,to:!1})))},multiple:!0,suggestions:I,onClick:le,onFocus:le,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));C((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(C((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(Ce.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,oe.jsx)(o.A,{className:(0,u.A)(Ce.box,{[Ce.active]:H}),onClick:()=>{z(!H),A([])},children:"CC"}),(0,oe.jsx)(o.A,{className:(0,u.A)(Ce.box,{[Ce.active]:O}),onClick:()=>{q(!O),S([])},children:"BCC"})]}),(null===B||void 0===B?void 0:B.to)&&(0,oe.jsx)("p",{className:"error-message mb-0",children:"To email is required"})]}),H&&(0,oe.jsx)(te.A,{sm:6,className:"mb-3",children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{width:"50px"},className:Ce.bag}),(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"CC"}),(0,oe.jsx)(ve.j,{ref:M,value:w,completeMethod:X,onChange:e=>{A(e.value)},multiple:!0,suggestions:I,onClick:ae,onFocus:ae,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));A((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(A((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(Ce.AutoComplete,"w-100"),placeholder:"CC"})]})}),O&&(0,oe.jsx)(te.A,{sm:6,className:"mb-3",children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{width:"60px"},className:Ce.bag}),(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"BCC"}),(0,oe.jsx)(ve.j,{ref:P,value:N,completeMethod:X,onChange:e=>{S(e.value)},multiple:!0,suggestions:I,onClick:de,onFocus:de,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));S((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(S((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(Ce.AutoComplete,Ce.bcc,"w-100"),placeholder:"BCC"})]})}),(0,oe.jsxs)(te.A,{sm:12,className:"mb-2",children:[(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{width:"60px"},className:Ce.bag}),(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"SUBJECT"}),(0,oe.jsxs)(be.C,{children:[(0,oe.jsx)(fe.m,{children:(null===J||void 0===J?void 0:J.isFetching)&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,oe.jsx)(ye.S,{value:F,className:(0,u.A)(Ce.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{_(e.target.value),$((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===B||void 0===B?void 0:B.subject)&&(0,oe.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,oe.jsxs)(te.A,{sm:12,className:"mb-3",children:[(0,oe.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,oe.jsx)("label",{className:(0,u.A)(Ce.lable),children:"Message"}),(0,oe.jsx)(fe.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===J||void 0===J?void 0:J.isFetching)&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,oe.jsx)(je.K,{style:{minHeight:"150px"},headerTemplate:Ae,value:k,placeholder:"Enter a description...",onTextChange:e=>{E(e.htmlValue),$((e=>({...e,text:!1})))}})]}),(null===B||void 0===B?void 0:B.text)&&(0,oe.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,oe.jsx)(te.A,{sm:12,children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("label",{className:(0,u.A)(Ce.customLabel),children:"Signature"}),(0,oe.jsx)(ge.m,{options:W&&(null===(l=W.data)||void 0===l?void 0:l.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,u.A)(Ce.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{L(e.value)},value:D,loading:null===W||void 0===W?void 0:W.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,oe.jsxs)(se.A.Footer,{className:"d-flex justify-content-between",children:[(0,oe.jsx)(o.A,{onClick:V,className:"text-button text-danger",children:"Cancel"}),(0,oe.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[!g&&(0,oe.jsxs)(o.A,{disabled:h,className:"outline-button",onClick:x,children:["Create"," ",h&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,oe.jsxs)(o.A,{className:"solid-button",disabled:null===Q||void 0===Q?void 0:Q.isPending,onClick:async()=>{let e=0;$({}),b||(++e,$((e=>({...e,from:!0})))),0===(null===y||void 0===y?void 0:y.length)&&(++e,$((e=>({...e,to:!0})))),F||(++e,$((e=>({...e,subject:!0})))),k||(++e,$((e=>({...e,text:!0})))),e||Q.mutate({subject:F,email_body:k,from_email:b,to:null===y||void 0===y?void 0:y.toString(),...w.length>0&&{cc:w.toString()},...N.length>0&&{bcc:N.toString()},...D&&{signature:D}})},children:[g?"Resend":"Create and Send"," ",(null===Q||void 0===Q?void 0:Q.isPending)&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})},Se=e=>{var t;let{clientId:s,projectId:n,isLoading:l,create:a,projectCardData:r,isCreated:d}=e;const[c,u]=(0,i.useState)(!1),[,h]=(0,i.useState)({}),p=(0,re.I)({queryKey:["id",s],queryFn:()=>(0,de.EZ)(s),enabled:!!s,retry:1});return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(o.A,{className:"InvoiceAction InvoiceActive me-3",onClick:()=>u(!0),children:[d?"Resend":"Create"," Invoice  ",(0,oe.jsx)("img",{src:me.A,alt:"Invoices"})]}),(0,oe.jsx)(Ne,{projectId:n,show:c,create:a,isLoading:l,setShow:u,setPayload:h,contactPersons:(null===p||void 0===p||null===(t=p.data)||void 0===t?void 0:t.contact_persons)||[],projectCardData:r,isCreated:d})]})};var Fe=s(47994),_e=s(51038),ke=s(66415),Ee=s(95192),De=s(73722),Le=s(35470),Be=s(72796),$e=s(84678),Ie=s(58027);const Te=e=>{var t,s,n,l,a,r,d,c,u;let{show:h,setShow:p,project:m,reInitialize:v,projectCardData:g}=e;const j=(0,i.useRef)(null),{session:b}=(0,w.As)(),[f,y]=(0,i.useState)(""),[C,A]=(0,i.useState)(""),[N,S]=(0,i.useState)(null),[F,_]=(0,i.useState)(null),[k,E]=(0,i.useState)({taskTitle:!1,description:!1,user:!1,date:!1}),D=()=>{y(""),A(""),S(null),_(null),E({taskTitle:!1,description:!1,user:!1,date:!1})},L=(0,Y.n)({mutationFn:e=>(0,Be.Nl)(e),onSuccess:()=>{p(!1),D(),v(),g&&g()},onError:e=>{console.error("Error creating task:",e)}}),B=(0,re.I)({queryKey:["getUserList"],queryFn:x.aU}),$=(0,re.I)({queryKey:["getMobileUserList"],queryFn:x.gy});return(0,i.useEffect)((()=>{h||D()}),[h]),(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(se.A,{show:h,centered:!0,onHide:()=>p(!1),className:"task-form",children:[(0,oe.jsx)(se.A.Header,{closeButton:!0,children:(0,oe.jsxs)(se.A.Title,{children:[(0,oe.jsx)("img",{src:$e.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,oe.jsx)("span",{className:"modal-task-title",children:"New Task"})]})}),(0,oe.jsxs)(se.A.Body,{children:[(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsx)(De.A.Label,{children:"Task Title"}),(0,oe.jsxs)(Fe.A,{children:[(0,oe.jsx)(De.A.Control,{required:!0,type:"text",placeholder:"Enter task title",value:f,onChange:e=>y(e.target.value)}),(0,oe.jsx)(Fe.A.Text,{children:(0,oe.jsx)(_e.A,{})})]}),k.taskTitle&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Task title is required"})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,oe.jsx)(De.A.Label,{children:"Description"}),(0,oe.jsx)(De.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:C,onChange:e=>A(e.target.value),required:!0}),k.description&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Description is required"})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-2",children:[(0,oe.jsx)(De.A.Label,{children:"Project Task"}),(0,oe.jsxs)(Fe.A,{children:[(0,oe.jsx)(De.A.Select,{disabled:!0,children:(0,oe.jsxs)("option",{value:m.value,children:[m.reference," (",m.number,")"]})}),(0,oe.jsx)(Fe.A.Text,{children:(0,oe.jsx)(ke.A,{})})]}),!m&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Project task is required"})]})]}),(0,oe.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"20px",borderTop:"1px solid #eaecf0",padding:"12px 30px 8px 20px"},children:[!N&&(0,oe.jsx)(Ee.A,{color:null!==(t=j.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(n=s.element)&&void 0!==n&&n.offsetParent?"#1AB2FF":"#475467",size:22,style:{position:"relative",left:"10px",zIndex:1},onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.show()},className:"me-3 cursor-pointer"}),(0,oe.jsx)(ge.m,{ref:j,options:[{label:"Desktop User",items:(null===B||void 0===B||null===(l=B.data)||void 0===l||null===(a=l.users)||void 0===a||null===(r=a.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===r?void 0:r.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==b&&void 0!==b&&b.has_work_subscription?[{label:"Mobile User",items:(null===$||void 0===$||null===(d=$.data)||void 0===d||null===(c=d.users)||void 0===c||null===(u=c.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===u?void 0:u.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{S(e.value)},valueTemplate:e=>(0,oe.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"0px solid #dedede"},children:(0,oe.jsx)(Ie.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),itemTemplate:e=>(0,oe.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,oe.jsx)(Ie.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:N?"fit-content":"0px",height:N?"46px":"0px",zIndex:N?"1":"0",position:"relative",left:N?"0px":"-60px",top:N?"0px":"-15px"},value:N,dropdownIcon:(0,oe.jsx)(oe.Fragment,{}),collapseIcon:(0,oe.jsx)(oe.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items"}),(0,oe.jsx)(Le.A,{dateRange:F,setDateRange:_})]}),(0,oe.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px",padding:"0 30px 8px 30px"},children:[k.user&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"User is required"}),k.date&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Date is required"})]}),(0,oe.jsx)(se.A.Footer,{children:(0,oe.jsx)(o.A,{type:"button",className:"save-button",onClick:()=>{const e={taskTitle:!f,description:!C,user:!N,date:!F};E(e),e.taskTitle||e.description||e.user||e.date||(L.mutate({title:f,description:C,project:m.value,user:N,from_date:F.startDate,to_date:F.endDate}),console.log("Form submitted with:",{taskTitle:f,description:C,user:N,date:F}))},children:L.isPending?"Loading...":"Create Task"})})]})})},Re=e=>{let{project:t,reInitialize:s,projectCardData:n}=e;const[l,o]=(0,i.useState)(!1);return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"linkByttonStyle py-2 border-right pe-5",onClick:()=>o(!0),children:"New Task"}),(0,oe.jsx)(Te,{show:l,setShow:o,project:t,reInitialize:s,projectCardData:n})]})};var Me=s(69767),Pe=s(83570),He=s(64967);const ze=[{icon:(0,oe.jsx)(z.A,{size:16,color:"#1AB2FF"}),label:"Invoice",value:"invoice"},{icon:(0,oe.jsx)(Me.A,{size:16,color:"#1AB2FF"}),label:"Quote",value:"quote"},{icon:(0,oe.jsx)(Pe.A,{size:16,color:"#1AB2FF"}),label:"System",value:"system"},{icon:(0,oe.jsx)(P.A,{size:16,color:"#1AB2FF"}),label:"Notes",value:"note"},{icon:(0,oe.jsx)(q.A,{size:16,color:"#1AB2FF"}),label:"Email",value:"email"},{icon:(0,oe.jsx)(O.A,{size:16,color:"#1AB2FF"}),label:"SMS",value:"sms"},{icon:(0,oe.jsx)(H.A,{size:16,color:"#1AB2FF"}),label:"Tasks",value:"task"},{icon:(0,oe.jsx)(M.A,{size:16,color:"#1AB2FF"}),label:"Job Created",value:"job"},{icon:(0,oe.jsx)(He.A,{size:16,color:"#1AB2FF"}),label:"Expense Linked",value:"order"}],Oe=e=>{let{setFilteredHistoryOptions:t}=e;const[s,n]=(0,i.useState)(!1),[l,o]=(0,i.useState)([]);console.log("tempSelectedOptions: ",l);return(0,oe.jsxs)("div",{className:"projectCardFilterDropdown",children:[(0,oe.jsx)("span",{onClick:()=>n((e=>!e)),children:(0,oe.jsx)(c.A,{size:20,color:"#344054"})}),s&&(0,oe.jsxs)("div",{className:"dropdown-menuF px-0",children:[(0,oe.jsxs)("button",{className:"all p-0 ps-2 pe-2 mx-2 text-left d-flex justify-content-between align-items-center rounded",style:{background:"#F9FAFB",width:"94%"},onClick:()=>{(null===l||void 0===l?void 0:l.length)>0?o([]):o(ze.map((e=>e.value)))},children:[(0,oe.jsx)("span",{className:"border-0",style:{background:"transparent"},children:"All"}),ze.length===(null===l||void 0===l?void 0:l.length)&&(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,oe.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(0,oe.jsx)("ul",{className:"ps-3",children:ze.map((e=>{let{icon:t,label:s,value:i}=e;return(0,oe.jsx)("li",{className:l.includes(s)?"active":"",onClick:()=>(e=>{o((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(i),children:(0,oe.jsxs)("label",{htmlFor:s,className:"w-100 d-flex justify-content-between align-items-center",children:[(0,oe.jsx)("input",{id:s,type:"checkbox",checked:l.includes(i),readOnly:!0,style:{cursor:"pointer",height:"40px"}}),(0,oe.jsxs)("span",{className:"border-0",children:[t," ",s]}),l.includes(i)&&(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,oe.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]})},s)}))}),(0,oe.jsx)("hr",{}),(0,oe.jsxs)("div",{className:"dropdown-buttonsF pb-2 px-3",children:[(0,oe.jsx)("button",{className:"cancel",onClick:()=>o([]),children:"Cancel"}),(0,oe.jsx)("button",{className:"apply",onClick:()=>{t(l),n(!1)},children:"Apply"})]})]})]})};const qe=s.p+"static/media/OrdersIcon.bb129217463e985edc21ff683898e113.svg";var Ve=s(34168);const Ue=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},Ze=e=>{let{startDate:t,endDate:s}=e;return(0,oe.jsxs)(o.A,{className:"dateSelectdTaskBar schedule schActive",style:{minWidth:"160px",minHeight:"46px"},children:[Ue(t,s)," ",(0,oe.jsx)("img",{src:qe,alt:"OrdersIcon"})]})},Ge=e=>{let{projectId:t,projectCardData:s,isFetching:n,startDate:l,endDate:a}=e;const[r,d]=(0,i.useState)({startDate:null,endDate:null}),[c,u]=(0,i.useState)(!1),h=(0,i.useRef)(null),x=(0,Y.n)({mutationFn:e=>(0,p.mw)(t,e),onSuccess:async()=>{s(t)},onError:e=>{d({startDate:null,endDate:null}),console.error("Error creating task:",e)}}),m=e=>{h.current&&!h.current.contains(e.target)&&u(!1)};return(0,i.useEffect)((()=>{l&&a&&d({startDate:new Date(1e3*+l),endDate:new Date(1e3*+a)})}),[l,a]),(0,i.useEffect)((()=>(c?document.addEventListener("mousedown",m):document.removeEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)})),[c]),(0,oe.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:h,children:[(0,oe.jsx)("div",{onClick:()=>u((e=>!e)),style:{cursor:"pointer"},children:null!==r&&void 0!==r&&r.startDate&&null!==r&&void 0!==r&&r.endDate&&!x.isPending?(0,oe.jsx)(Ze,{isPending:x.isPending,startDate:r.startDate,endDate:r.endDate}):(0,oe.jsx)(o.A,{className:"schedule schActive",style:{minWidth:"201px",minHeight:"46px"},children:x.isPending||n?(0,oe.jsx)("div",{className:"dot-flashing"}):(0,oe.jsxs)("span",{children:["Schedule Project  ",(0,oe.jsx)("img",{src:qe,alt:"OrdersIcon"})]})})}),c&&(0,oe.jsx)("div",{className:"select-date-range",style:{position:"absolute",bottom:"40px",background:"#fff",zIndex:1e3},children:(0,oe.jsx)(Ve.A,{onDataApply:e=>{x.mutate({booking_start:e.startDate,booking_end:e.endDate}),d(e),u(!1)},dateRange:r,onClose:()=>u(!1)})})]})};var We=s(79726),Ke=s(3930),Je=s(35131);s(93066);const Ye={"#1AB2FF":{bg:"#BAE8FF",border:"#1AB2FF",color:"#0A4766",text:"Blue"},"#4E5BA6":{bg:"#EAECF5",border:"#4E5BA6",color:"#293056",text:"Deep Blue"},"#2970FF":{bg:"#D1E0FF",border:"#2970FF",color:"#0040C1",text:"Dark Blue"},"#FFB258":{bg:"#FFE8CD",border:"#FFB258",color:"#6D471A",text:"Orange"},"#15B79E":{bg:"#CCFBEF",border:"#15B79E",color:"#125D56",text:"Green"},"#66C61C":{bg:"#E3FBCC",border:"#66C61C",color:"#326212",text:"Light Green"},"#7A5AF8":{bg:"#EBE9FE",border:"#7A5AF8",color:"#4A1FB8",text:"Light Purple"},"#D444F1":{bg:"#FBE8FF",border:"#D444F1",color:"#821890",text:"Magenta"},"#F63D68":{bg:"#FFE4E8",border:"#F63D68",color:"#A11043",text:"Pink"},"#FF007F":{bg:"#FFCCE5",border:"#FF007F",color:"#6F0A3C",text:"Soft Pink"},"#FFD700":{bg:"#FFF8D1",border:"#FFD700",color:"#997100",text:"Yellow"},"#6C6C1C":{bg:"#E1E1B8",border:"#6C6C1C",color:"#444403",text:"Dark Yellow"}},Qe=e=>{var t,s,n;let{projectId:l,statusOptions:o,custom_status:a}=e;const[r,d]=(0,i.useState)(null),c=(0,Y.n)({mutationFn:e=>(0,p.Np)(l,e),onSuccess:async()=>{},onError:e=>{d(a),console.error("Error creating task:",e)}});return(0,i.useEffect)((()=>{d(a)}),[a]),(0,oe.jsx)(We.W,{menuButton:(0,oe.jsxs)(Ke.I,{style:{width:"204px",display:"inline-flex",alignItems:"center",justifyContent:"flex-end",padding:"8px 0px",cursor:"pointer",background:"transparent",border:"none",color:"#98A2B3",gap:"10px"},children:[r&&r.title?(0,oe.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,oe.jsx)(oe.Fragment,{children:c.isPending?(0,oe.jsx)("div",{className:"dot-flashing"}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=Ye[null===r||void 0===r?void 0:r.color])||void 0===t?void 0:t.border}`}}),(0,oe.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:`${null===(s=Ye[null===r||void 0===r?void 0:r.color])||void 0===s?void 0:s.bg}`},children:[(0,oe.jsx)("span",{style:{color:`${null===(n=Ye[null===r||void 0===r?void 0:r.color])||void 0===n?void 0:n.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===r||void 0===r?void 0:r.title}),(0,oe.jsx)("span",{className:"inArrow",children:(0,oe.jsx)(ke.A,{color:"#98A2B3",size:15})})]})]})})}):(0,oe.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"h-100",style:{width:"4px",background:"#1D2939"}}),(0,oe.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:"#F2F4F7"},children:[(0,oe.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:"No Status"}),(0,oe.jsx)("span",{className:"inArrow",children:(0,oe.jsx)(ke.A,{color:"#98A2B3",size:15})})]})]})})}),(0,oe.jsx)("span",{className:"outArrow",children:(0,oe.jsx)(ke.A,{color:"#98A2B3",size:15})})]}),overflow:"auto",position:"anchor",children:null===o||void 0===o?void 0:o.map((e=>{var t,s,i;return(0,oe.jsx)(Je.D,{style:{textAlign:"left"},onClick:()=>{var t;null!==(t=e)&&void 0!==t&&t.id&&(c.mutate({custom_status:null===t||void 0===t?void 0:t.id}),d(t))},children:(0,oe.jsxs)("div",{className:"d-flex",style:{width:"163px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:[(0,oe.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=Ye[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.border}`}}),(0,oe.jsx)("div",{className:"h-100 d-flex align-items-center",style:{width:"100%",background:`${null===(s=Ye[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.bg}`},children:(0,oe.jsx)("span",{style:{color:`${null===(i=Ye[null===e||void 0===e?void 0:e.color])||void 0===i?void 0:i.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===e||void 0===e?void 0:e.title})})]})},e.id)}))})};var Xe=s(17380),et=s(17803);const tt={phoneInput:"send-sms_phoneInput__Qgh+S",countrySelector:"send-sms_countrySelector__y14UT",customLabel:"send-sms_customLabel__RzF9F"},st=et.PhoneNumberUtil.getInstance(),it=e=>{try{return st.isValidNumber(st.parseAndKeepRawInput(e))}catch(t){return!1}},nt=e=>{var t;let{projectId:s,projectCardData:n}=e;const l=(0,K.Zp)(),[a,r]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),[h,x]=(0,i.useState)(""),[m,v]=(0,i.useState)({}),[g,j]=(0,i.useState)(""),b=()=>{c(!1),x(""),j(""),v({}),r(null)},f=(0,re.I)({queryKey:["getSMSTemplates"],queryFn:ce.pJ}),y=(0,re.I)({queryKey:["smsQuery",a],queryFn:()=>(0,ce.Mp)(a),enabled:!!a,retry:1}),C=(0,Y.n)({mutationFn:e=>(0,p.qm)(s,e),onSuccess:()=>{ne.oR.success("SMS send successfully"),b(),n()},onError:e=>{console.error("Error creating expense:",e),ne.oR.error("Failed to send sms. Please try again.")}});return(0,i.useEffect)((()=>{var e;null!==y&&void 0!==y&&null!==(e=y.data)&&void 0!==e&&e.text&&(x(y.data.text),v((e=>({...e,message:!1}))))}),[y.data]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{className:"linkByttonStyle py-2 border-right text-center ps-0",onClick:()=>{const e=JSON.parse(window.localStorage.getItem("profileData")||"{}");null!==e&&void 0!==e&&e.has_twilio?c(!0):l("/settings/integrations?openTwilio=true")},children:"Send SMS"}),(0,oe.jsxs)(se.A,{show:d,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:b,animation:!1,children:[(0,oe.jsxs)(se.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,oe.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,oe.jsxs)("span",{children:[(0,oe.jsx)("img",{src:le,alt:"AddNoteModeIcon"}),"Send SMS"]})}),(0,oe.jsx)("button",{className:"CustonCloseModal",onClick:b,children:(0,oe.jsx)($.A,{size:24,color:"#667085"})})]}),(0,oe.jsx)(se.A.Body,{children:(0,oe.jsxs)("div",{className:"ContactModel",children:[(0,oe.jsxs)(ie.A,{children:[(0,oe.jsx)(te.A,{sm:12,className:"mb-3",children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("label",{className:(0,u.A)(tt.customLabel),children:"Templates"}),(0,oe.jsx)(ge.m,{options:f&&(null===(t=f.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.title}`}))))||[],className:(0,u.A)(tt.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{r(e.value)},value:a,loading:null===f||void 0===f?void 0:f.isFetching,filterInputAutoFocus:!0})]})}),(0,oe.jsx)(te.A,{children:(0,oe.jsxs)("div",{className:"formgroup sendSMSPhone mb-2 mt-0",children:[(0,oe.jsxs)("label",{children:["To",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)("div",{className:"inputInfo p-0 "+(m.taskRead?"error-border":"border-0"),children:(0,oe.jsx)(Xe.LR,{defaultCountry:"au",placeholder:"Enter phone number",value:g||"",className:"phoneInput w-100",containerClass:tt.countrySelector,onChange:e=>{j(e),it(e)&&v((e=>({...e,phone:!1})))}})}),m.phone&&(0,oe.jsx)("p",{className:"error-message",children:"Phone is not valid"})]})})]}),(0,oe.jsx)(ie.A,{children:(0,oe.jsx)(te.A,{children:(0,oe.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,oe.jsxs)("label",{children:["Message",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsxs)("div",{className:"inputInfo "+(m.description?"error-border":""),style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{position:"absolute",right:"10px",top:"15px"},children:(null===y||void 0===y?void 0:y.isFetching)&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,oe.jsx)("textarea",{type:"text",name:"Enter a message here...",value:h,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value.slice(0,150);x(t),v((e=>({...e,message:!1})))}})]}),(0,oe.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-1",children:[(0,oe.jsx)("p",{className:"error-message",children:m.message&&"Description is required"}),(0,oe.jsxs)("div",{style:{float:"right",fontSize:"14px",color:"#6c757d"},children:[(null===h||void 0===h?void 0:h.length)||0,"/150"]})]})]})})}),(0,oe.jsx)(ie.A,{}),(0,oe.jsxs)("div",{className:"popoverbottom  mt-0 pt-4",children:[(0,oe.jsx)(o.A,{variant:"outline-danger",onClick:b,children:"Cancel"}),(0,oe.jsxs)(o.A,{disabled:null===C||void 0===C?void 0:C.isPending,variant:"primary save d-flex align-items-center gap-2",onClick:()=>{let e={};if(h||(e.message=!0),g&&it(g)||(e.phone=!0),Object.keys(e).length)return v(e);C.mutate({phone_number:g,message:h})},children:["Send",(null===C||void 0===C?void 0:C.isPending)&&(0,oe.jsx)(ee.p,{style:{width:"15px",height:"15px"}})]})]})]})})]})]})};var lt=s(9634),ot=s(86213),at=s(55917),rt=s(85371);const dt="send-to-calendar_calendarButton__wLLgP",ct="send-to-calendar_calendarModal__ZnyeK",ut="send-to-calendar_modalTitle__yfOOC",ht="send-to-calendar_formLabel__eKaq1",pt="send-to-calendar_AutoComplete__iw4uu",xt="send-to-calendar_borderDanger__P-SWh";const mt=s.p+"static/media/calendar.9ebe7da58af479b138e37b33d2affea2.svg",vt=e=>{let{projectId:t,project:s,projectCardData:n}=e;const l=(0,i.useRef)(null),a=JSON.parse(window.localStorage.getItem("profileData")||"{}"),r=localStorage.getItem("access_token"),[d,c]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[x,m]=(0,i.useState)(""),[v,g]=(0,i.useState)(""),[j,b]=(0,i.useState)(""),[f,y]=(0,i.useState)(""),[C,w]=(0,i.useState)(null),[A,N]=(0,i.useState)(null),[S,F]=(0,i.useState)([]),[_,k]=(0,i.useState)(""),[E,D]=(0,i.useState)([]),[L,B]=(0,i.useState)({}),$=(0,re.I)({queryKey:["getClientById",null===s||void 0===s?void 0:s.client],queryFn:()=>(0,de.EZ)(null===s||void 0===s?void 0:s.client),enabled:!(null===s||void 0===s||!s.client)&&!!d,retry:1}),I=(0,re.I)({queryKey:["getOutgoingEmail"],queryFn:ce.hx,enabled:!!d}),T=()=>{c(!1),F([]),m(""),g(""),b(""),w(null),N(null),y(""),k("")};(0,i.useEffect)((()=>{null!==s&&void 0!==s&&s.booking_start&&!C&&w(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&!A&&N(new Date(1e3*s.booking_end))}),[s,C,A]);const R=e=>{var t,s;const i=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let n=((null===(s=$.data)||void 0===s?void 0:s.contact_persons)||[]).map((e=>e.email));n=n.filter((e=>!S.includes(e))),n=n.filter((e=>e.toLowerCase().includes(i))),D(n)},M=()=>{R(),l.current&&l.current.show()};return(0,i.useEffect)((()=>{var e,t,s;null!==I&&void 0!==I&&I.data&&(null!==I&&void 0!==I&&null!==(e=I.data)&&void 0!==e&&e.outgoing_email&&null!==I&&void 0!==I&&null!==(t=I.data)&&void 0!==t&&t.outgoing_email_verified?k(null===I||void 0===I||null===(s=I.data)||void 0===s?void 0:s.outgoing_email):k("no-reply@memate.com.au"))}),[I]),(0,i.useEffect)((()=>{null!==a&&void 0!==a&&a.email&&d&&F([null===a||void 0===a?void 0:a.email])}),[null===a||void 0===a?void 0:a.email,d]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(o.A,{disabled:!(null!==s&&void 0!==s&&s.booking_start),className:`calenBut calenActive ${dt}`,onClick:()=>{null!==s&&void 0!==s&&s.reference?m(`${s.reference}`):null!==s&&void 0!==s&&s.number?m(`Project #${s.number}`):m("Project Event"),g((null===s||void 0===s?void 0:s.description)||""),null!==s&&void 0!==s&&s.booking_start&&w(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&N(new Date(1e3*s.booking_end)),c(!0)},children:["Send to Calendar ",(0,oe.jsx)("img",{src:mt,alt:"Calendar"})]}),(0,oe.jsxs)(se.A,{show:d,onHide:T,centered:!0,className:ct,children:[(0,oe.jsx)(se.A.Header,{closeButton:!0,children:(0,oe.jsx)(se.A.Title,{className:ut,children:"Send to Calendar"})}),(0,oe.jsx)(se.A.Body,{children:(0,oe.jsxs)(De.A,{onSubmit:async e=>{e.preventDefault(),p(!0);try{if(!(()=>{const e={};return x.trim()||(e.eventTitle="Event title is required"),C||(e.startDate="Start date is required"),A||(e.endDate="End date is required"),C>A&&(e.endDate="End date must be after start date"),0===S.length&&(e.guests="Guests are required"),_||(e.from="From email is required"),v.trim()||(e.eventDescription="Description is required"),!(Object.keys(e).length>0)||(B(e),!1)})())return void p(!1);const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(null===a||void 0===a?void 0:a.email)||"no-reply@memate.com.au";const s=e=>(0,at.A)(e,"yyyyMMdd'T'HHmmss'Z'"),i=new Date,n=`${Date.now()}@memate.com.au`,l=s(i);let o=v||"Meeting Invitation",r=`<html><body><p>${v||"Meeting Invitation"}</p>`;if(f){const e=(d=f)?d.includes("zoom.us")?"Zoom":d.includes("teams.microsoft.com")?"Microsoft Teams":d.includes("meet.google.com")?"Google Meet":d.includes("webex.com")?"Cisco Webex":"Online Meeting":null;o+=`\n\n${e} Link: ${f}`,r+=`<p><strong>${e} Link:</strong> <a href="${f}">${f}</a></p>`}var d;r+="</body></html>",r=r.replace(/\n/g,"").replace(/\s+/g," ");const c=["BEGIN:VCALENDAR","PRODID:-//MeMate//Calendar//EN","VERSION:2.0","CALSCALE:GREGORIAN","METHOD:REQUEST","BEGIN:VEVENT",`UID:${n}`,`DTSTAMP:${l}`,`SUMMARY:${x}`,`DESCRIPTION:${o.replace(/\n/g,"\\n")}`,`LOCATION:${j||f||""}`,f?`URL:${f}`:"",`DTSTART:${s(C)}`,`DTEND:${s(A)}`,`ORGANIZER;CN=${null!==a&&void 0!==a&&a.first_name&&null!==a&&void 0!==a&&a.last_name?`${a.first_name} ${a.last_name}`:t.split("@")[0]||"MeMate"}:mailto:${t}`].filter((e=>""!==e));return e&&e.length>0&&e.forEach((e=>{let t=e.split("@")[0].replace(/[.]/g," ");t=t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),c.push(`ATTENDEE;CUTYPE=INDIVIDUAL;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;CN=${t}:mailto:${e}`)})),c.push("STATUS:CONFIRMED","SEQUENCE:0","TRANSP:OPAQUE","BEGIN:VALARM","TRIGGER:-PT15M","ACTION:DISPLAY","DESCRIPTION:Reminder","END:VALARM","X-MICROSOFT-CDO-BUSYSTATUS:BUSY","X-MICROSOFT-CDO-IMPORTANCE:1","X-MICROSOFT-DISALLOW-COUNTER:FALSE","X-MICROSOFT-DONOTFORWARDMEETING:FALSE","X-MICROSOFT-CDO-ALLDAYEVENT:FALSE"),f&&(f.includes("meet.google.com")?c.push(`X-GOOGLE-CONFERENCE:${f}`):f.includes("teams.microsoft.com")&&c.push(`X-MICROSOFT-SKYPETEAMSMEETINGURL:${f}`)),c.push(`X-ALT-DESC;FMTTYPE=text/html:${r}`),c.push("END:VEVENT","END:VCALENDAR"),c.join("\r\n")}(S,_),s=new File([e],"invite.ics",{type:"text/calendar"}),i=new FormData;i.append("subject",`Invitation: ${x}`),i.append("email_body",v),i.append("from_email",_),i.append("to",S.toString()),i.append("attachments",s),await ot.A.post(`https://dev.memate.com.au/api/v1/custom/email/${t}/`,i,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),ne.oR.success("Calendar event created successfully!"),T(),n(t)}catch(s){console.error("Error creating calendar event:",s),ne.oR.error("Failed to create calendar event. Please try again.")}finally{p(!1)}},children:[(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsxs)(De.A.Label,{className:ht,children:["Event Title",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)(De.A.Control,{type:"text",placeholder:"Enter event title",value:x,onChange:e=>m(e.target.value),className:(0,u.A)("border outline-none",(null===L||void 0===L?void 0:L.eventTitle)&&"border-danger")}),(null===L||void 0===L?void 0:L.eventTitle)&&(0,oe.jsx)(De.A.Text,{className:"error-message",children:L.eventTitle})]}),(0,oe.jsxs)(ie.A,{className:"mb-3",children:[(0,oe.jsx)(te.A,{children:(0,oe.jsxs)(De.A.Group,{children:[(0,oe.jsxs)(De.A.Label,{className:ht,children:["Start Date & Time",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)(rt.V,{value:C,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{w(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,oe.jsx)(lt.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===L||void 0===L?void 0:L.startDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===L||void 0===L?void 0:L.startDate)&&(0,oe.jsx)(De.A.Text,{className:"error-message",children:null===L||void 0===L?void 0:L.startDate})]})}),(0,oe.jsx)(te.A,{children:(0,oe.jsxs)(De.A.Group,{children:[(0,oe.jsxs)(De.A.Label,{className:ht,children:["End Date & Time",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)(rt.V,{value:A,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{N(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,oe.jsx)(lt.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===L||void 0===L?void 0:L.endDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===L||void 0===L?void 0:L.endDate)&&(0,oe.jsx)(De.A.Text,{className:"error-message",children:null===L||void 0===L?void 0:L.endDate})]})})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsxs)(De.A.Label,{className:ht,children:["Add Guests",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)(ve.j,{ref:l,value:S,completeMethod:R,onChange:e=>{F(e.value)},multiple:!0,suggestions:E,onClick:M,onFocus:M,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));F((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(F((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(pt,"w-100",(null===L||void 0===L?void 0:L.guests)&&xt),placeholder:"Add guests"}),(null===L||void 0===L?void 0:L.guests)&&(0,oe.jsx)(De.A.Text,{className:"error-message",children:null===L||void 0===L?void 0:L.guests})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsx)(De.A.Label,{className:ht,children:"Location"}),(0,oe.jsx)(De.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter physical location (optional)",value:j,onChange:e=>b(e.target.value)})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsx)(De.A.Label,{className:ht,children:"Meeting Link"}),(0,oe.jsx)(De.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter meeting link (Zoom, Teams, etc.)",value:f,onChange:e=>y(e.target.value)})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsxs)(De.A.Label,{className:ht,children:["Description",(0,oe.jsx)("span",{className:"required",children:"*"})]}),(0,oe.jsx)(De.A.Control,{as:"textarea",rows:3,className:(0,u.A)("border outline-none",(null===L||void 0===L?void 0:L.eventDescription)&&"border-danger"),placeholder:"Enter event description",value:v,onChange:e=>g(e.target.value)}),(null===L||void 0===L?void 0:L.eventDescription)&&(0,oe.jsx)(De.A.Text,{className:"error-message",children:null===L||void 0===L?void 0:L.eventDescription})]}),(0,oe.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4 border-top pt-4",children:[(0,oe.jsx)(o.A,{className:"outline-button",variant:"secondary",onClick:T,children:"Cancel"}),(0,oe.jsx)(o.A,{className:"solid-button",variant:"primary",type:"submit",disabled:h,children:h?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Sending..."]}):"Send via Email"})]})]})})]})]})},gt=()=>(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,oe.jsx)("td",{children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,oe.jsx)("td",{children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,oe.jsx)("td",{children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,oe.jsx)("td",{children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]}),jt={defaultStatus:"job-status_defaultStatus__emAxy",status:"job-status_status__HXyT-",DRAFT:"job-status_DRAFT__HqpDF",OPEN:"job-status_OPEN__yb7zB",ASSIGNED:"job-status_ASSIGNED__0WFAv",CONFIRMED:"job-status_CONFIRMED__iTcji",DECLINED:"job-status_DECLINED__2RC2+",SUBMITTED:"job-status_SUBMITTED__GFRLu",FINISHED:"job-status_FINISHED__RbfR-",IN_PROGRESS:"job-status_IN_PROGRESS__BoR97"},bt=e=>{let{status:t,actionStatus:s,published:i}=e;const n=function(e,t){if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return{label:"Draft",className:"DRAFT",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"};if("a"===e&&t)return{label:"In Progress",className:"IN_PROGRESS",color:"#3D5AFE",backColor:"#EEF1FF",borderColor:"#C3CCFF"};return{1:{label:"Open",className:"OPEN",color:"#065b76",backColor:"#ecf7fd",borderColor:"#a9d6ef"},2:{label:"Assigned",className:"ASSIGNED",color:"#520676",backColor:"#f6ecfd",borderColor:"#dda9ef"},3:{label:"Submitted",className:"SUBMITTED",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"},4:{label:"Finished",className:"FINISHED",color:"#29B27C",backColor:"#BBFFE4",borderColor:"#BBFFE4"},6:{label:"Declined",className:"DECLINED",color:"#b42318",backColor:"#fef3f2",borderColor:"#fecdca"},a:{label:"Confirmed",className:"CONFIRMED",color:"#067647",backColor:"#ecfdf3",borderColor:"#a9efc5"}}[e]||{label:e,className:"defaultStatus"}};return(0,oe.jsx)("div",{className:(0,u.A)(jt.status,jt[n(t,s,i).className]),children:n(t,s,i).label})};var ft=s(67046),yt=s(41292),Ct=s(96327),wt=s(14834);const At=e=>{var t;let{viewShow:s,setViewShow:n,projectId:l,project:a,statusOptions:r,reInitialize:d}=e;const c=(0,K.Zp)(),u=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[h,x]=(0,i.useState)(!1),[m,v]=(0,i.useState)(!0),[g,j]=(0,i.useState)(null),[b,f]=(0,i.useState)(!1),[y,C]=(0,i.useState)(""),[w,A]=(0,i.useState)([]),[N,le]=(0,i.useState)([]),[re,de]=(0,i.useState)([]),[ce,ue]=(0,i.useState)(!1),pe=parseFloat(null===g||void 0===g?void 0:g.cost_of_sale)||0,me=parseFloat(null===g||void 0===g?void 0:g.labor_expenses)||0,ve=parseFloat(null===g||void 0===g?void 0:g.operating_expense)||0,ge=parseFloat(pe+me+ve).toFixed(2),je=()=>{n(!1),d()},be=async e=>{v(!0);try{const t=await(0,p.OE)(e);j(t)}catch(t){console.error("Error fetching project card data:",t)}finally{v(!1)}},fe=(0,Y.n)({mutationFn:e=>(0,p.aj)(l,e),onSuccess:()=>{j((e=>({...e,reference:y})))},onError:e=>{console.error("Error creating task:",e)}}),ye=e=>{const t=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(t)} | ${`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}`},Ce=(0,Y.n)({mutationFn:e=>(0,p.jE)(e),onSuccess:e=>{e?c("/sales"):ne.oR.error("Failed to update sendBack to sales. Please try again.")},onError:e=>{console.error("Error updating sendBack to sales:",e),ne.oR.error("Failed to update sendBack to sales. Please try again.")}}),we=(0,Y.n)({mutationFn:e=>(0,p.ZE)(e),onSuccess:e=>{e?(je(),ne.oR.success("Order has been successfully declined")):ne.oR.error("Failed to decline the order. Please try again.")},onError:e=>{console.error("Error declining the order:",e),ne.oR.error("Failed to decline the order. Please try again.")}}),Ae=(0,Y.n)({mutationFn:e=>(0,p.yE)(e),onSuccess:e=>{e?(je(),ne.oR.success("Project has been successfully completed")):ne.oR.error("Failed to complete the project. Please try again.")},onError:e=>{console.error("Error completing the project:",e),ne.oR.error("Failed to complete the project. Please try again.")}}),Ne=(0,Y.n)({mutationFn:e=>(0,p.SE)(e),onSuccess:e=>{e?(je(),be(l),ne.oR.success("Invoice has been successfully created")):ne.oR.error("Failed to create the invoice. Please try again.")},onError:e=>{console.error("Error creating the invoice:",e),ne.oR.error("Failed to create the invoice. Please try again.")}});(0,i.useEffect)((()=>{if(null!==re&&void 0!==re&&re.length){var e;let t=null===g||void 0===g||null===(e=g.history)||void 0===e?void 0:e.filter((e=>re.includes(e.type)));le(t||[])}else le(null===g||void 0===g?void 0:g.history)}),[re,null===g||void 0===g?void 0:g.history]),(0,i.useEffect)((()=>{if(g){let e=[...null===g||void 0===g?void 0:g.expenses.map((e=>({...e,type:"expense"}))),...null===g||void 0===g?void 0:g.jobs.map((e=>({...e,type:"job"})))].sort(((e,t)=>parseInt(t.created)-parseInt(e.created)));A(e),le((null===g||void 0===g?void 0:g.history)||[])}}),[g]),(0,i.useEffect)((()=>{l&&s&&be(l)}),[l,s]);const Fe=e=>{var t,s,n,l;let{emailData:o}=e;const[a,r]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),u=(0,i.useRef)(null),h=(e=>{var t,s,i;const n=e.split("\n"),l=(null===(t=n.find((e=>e.startsWith("Subject:"))))||void 0===t?void 0:t.replace("Subject: ",""))||"",o=(null===(s=n.find((e=>null===e||void 0===e?void 0:e.startsWith("Recipient(s):"))))||void 0===s?void 0:s.replace("Recipient(s): ",""))||[];return{subject:l,recipients:JSON.parse((null===o||void 0===o?void 0:o.length)&&(null===o||void 0===o?void 0:o.replace(/'/g,'"'))),body:null===(i=e.split("Body:")[1])||void 0===i?void 0:i.trim()}})(o),p=null===(t=h.body)||void 0===t||null===(s=t.split(/<\/p>\s*<p>|<br\s*\/?>|\n/))||void 0===s?void 0:s.map(((e,t)=>`<p key=${t}>${null===e||void 0===e?void 0:e.trim()}</p>`)),x=null===p||void 0===p?void 0:p.join("");return(0,i.useEffect)((()=>{if(u.current){const e=u.current.scrollHeight;c(e>90)}}),[x]),(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("ul",{className:"d-flex flex-column align-items-start",children:[(0,oe.jsxs)("li",{className:"font-12",children:[(0,oe.jsx)("strong",{className:"font-12",children:"Subject:"}),"\xa0 ",h.subject]}),(0,oe.jsxs)("li",{children:[(0,oe.jsx)("strong",{className:"font-12",children:"Recipients:"}),"\xa0",(0,oe.jsx)("ul",{children:(null===h||void 0===h||null===(n=h.recipients)||void 0===n?void 0:n.length)&&(null===h||void 0===h||null===(l=h.recipients)||void 0===l?void 0:l.map(((e,t)=>(0,oe.jsx)("li",{className:"font-12",children:e},t))))})]})]}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("div",{ref:u,style:{maxHeight:a?"none":"87px",overflowY:"hidden",overflowX:a?"auto":"hidden"},dangerouslySetInnerHTML:{__html:x}}),d&&(0,oe.jsx)("button",{className:"text-button font-12 px-0",onClick:()=>r(!a),children:a?"Show Less":"Load More"})]})]})};return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(se.A,{show:s,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"projectCardModel",onHide:je,animation:!1,children:[(0,oe.jsxs)(se.A.Header,{className:"mb-0 pb-0 justify-content-between ",children:[(0,oe.jsx)("div",{className:"modelHeader",style:{flex:"1",maxWidth:"calc(100% - 350px)"},children:(0,oe.jsxs)("ul",{className:"d-flex align-items-center",children:[(0,oe.jsxs)("li",{className:"me-1 d-flex align-items-center",children:[(0,oe.jsx)("strong",{className:"dollorIcon",style:{background:null!==g&&void 0!==g&&g.invoice_created?"paid"===(null===g||void 0===g?void 0:g.payment_status)?"#F2FDEC":"not_paid"===(null===g||void 0===g?void 0:g.payment_status)?"#FEF3F2":"#FFFAEB":"#F9FAFB"},children:(0,oe.jsx)(E.A,{size:13,color:null!==g&&void 0!==g&&g.invoice_created?"paid"===(null===g||void 0===g?void 0:g.payment_status)?"#17B26A":"not_paid"===(null===g||void 0===g?void 0:g.payment_status)?"#F04438":"#B54708":"#667085"})}),m?(0,oe.jsx)(S.A,{as:"span",animation:"wave",className:"ms-2 me-2",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",size:"md",style:{width:"120px"}})}):(0,oe.jsxs)("span",{className:"cardId text-nowrap",children:[null===g||void 0===g?void 0:g.number," \xa0"]})]}),(0,oe.jsxs)("li",{className:"refrencesTag mt-1",style:{width:"calc(100% - 120px)"},children:["Reference:\xa0",m?(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):b?(0,oe.jsx)("input",{type:"text",value:y,onChange:e=>{C(e.target.value)},onBlur:async()=>{f(!1),await fe.mutateAsync({reference:y}),await(0,p.SE)(l)},autoFocus:!0,className:"border rounded w-100",style:{maxWidth:"calc(100% - 120px)"}}):(0,oe.jsx)(oe.Fragment,{children:fe.isPending?(0,oe.jsx)("div",{className:"dot-flashing ms-5 mt-1"}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("small",{className:"ellipsis-width",style:{color:"#1D2939",fontSize:"16px",maxWidth:"calc(100% - 220px)"},children:[" ",null===g||void 0===g?void 0:g.reference]}),(0,oe.jsxs)("span",{children:[" ",(0,oe.jsx)(D.A,{size:16,color:"#106B99",onClick:()=>{f(!0),C((null===g||void 0===g?void 0:g.reference)||"")},style:{cursor:"pointer"}})]})]})})]})]})}),(0,oe.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"15px"},children:[(0,oe.jsx)(J.N_,{to:`/api/v1/project-card/${l}/pdf/`,target:"_blank",children:(0,oe.jsx)(o.A,{variant:"light",className:"rounded-circle px-2",title:"Project Card",children:(0,oe.jsx)(L.A,{color:"#344054",size:20})})}),(0,oe.jsx)(J.N_,{to:`/api/v1/sales/${l}/label/`,target:"_blank",title:"Label",children:(0,oe.jsx)(o.A,{variant:"light",className:"rounded-circle px-2",children:(0,oe.jsx)(B.A,{color:"#344054",size:20})})}),(0,oe.jsx)("div",{className:"selectButStatus",children:m?(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):(0,oe.jsx)(Qe,{projectId:l,statusOptions:r,custom_status:null===g||void 0===g?void 0:g.custom_status})}),(0,oe.jsx)("button",{className:"CustonCloseModal",onClick:je,children:(0,oe.jsx)($.A,{size:24,color:"#667085"})})]})]}),(0,oe.jsx)(se.A.Body,{className:"p-0",children:(0,oe.jsxs)("div",{className:"ContactModel",children:[(0,oe.jsxs)(ie.A,{className:"text-left mt-0 projectCardMain",children:[(0,oe.jsxs)(te.A,{sm:6,className:"orderDiscription",children:[(0,oe.jsx)("strong",{children:"Order Description"}),(0,oe.jsx)("div",{className:"customScrollBar",children:m?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})})]}):(0,oe.jsx)("ul",{children:null!==g&&void 0!==g&&null!==(t=g.calculator_descriptions)&&void 0!==t&&t.length?g.calculator_descriptions.map(((e,t)=>{let{description:s}=e;return(0,oe.jsxs)("li",{children:["- ",s]},t)})):(0,oe.jsx)("li",{children:"No Description available"})})}),(0,oe.jsxs)("div",{className:"currentJobsTable",children:[(0,oe.jsx)("h5",{children:"Current Jobs / Expense for this order"}),(0,oe.jsxs)(F.A,{responsive:!0,children:[(0,oe.jsx)("thead",{style:{position:"sticky",top:"0px",zIndex:9},children:(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("th",{className:"border-right",children:"#"}),(0,oe.jsx)("th",{children:"Reference"}),(0,oe.jsx)("th",{children:"Provider"}),(0,oe.jsx)("th",{children:"Estimate/Total"}),(0,oe.jsx)("th",{children:"Status"})]})}),(0,oe.jsx)("tbody",{children:m?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(gt,{}),(0,oe.jsx)(gt,{}),(0,oe.jsx)(gt,{}),(0,oe.jsx)(gt,{})]}):null!==w&&void 0!==w&&w.length?w.map(((e,t)=>{var s,i,n,l,o,a,r;return(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{className:"border-right",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,oe.jsx)(J.N_,{to:`/work/jobs?jobId=${null===e||void 0===e?void 0:e.id}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number}):(0,oe.jsx)(J.N_,{to:`/expenses?expenseId=${null===e||void 0===e?void 0:e.id}&supplierName=${null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.name}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number})}),(0,oe.jsx)("td",{children:(0,oe.jsx)("div",{className:"ellipsis-width",children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e?void 0:e.reference)||"-":(null===e||void 0===e?void 0:e.invoice_reference)||"-"})}),(0,oe.jsx)("td",{children:(0,oe.jsx)(_.A,{placement:"top",overlay:(0,oe.jsx)(k.A,{className:"TooltipOverlay",id:`tooltip-${top}`,children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e||null===(i=e.worker)||void 0===i?void 0:i.full_name)||"":(null===e||void 0===e||null===(n=e.supplier)||void 0===n?void 0:n.name)||""}),children:(0,oe.jsx)("div",{className:"mx-auto d-flex align-items-center justify-content-center ps-2",style:{width:"fit-content"},children:"job"===(null===e||void 0===e?void 0:e.type)?(0,oe.jsx)(Ie.h,{has_photo:null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.has_photo,photo:null===e||void 0===e||null===(o=e.worker)||void 0===o?void 0:o.photo,is_business:!1,size:16}):(0,oe.jsx)(Ie.h,{has_photo:null===e||void 0===e||null===(a=e.supplier)||void 0===a?void 0:a.has_photo,photo:null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.photo,is_business:!0,size:16})})},"top")}),(0,oe.jsxs)("td",{children:["$",(0,wt.m)(null===e||void 0===e?void 0:e.total)||"-"]}),(0,oe.jsx)("td",{className:"status",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,oe.jsx)(bt,{status:null===e||void 0===e?void 0:e.status,actionStatus:null===e||void 0===e?void 0:e.action_status,published:null===e||void 0===e?void 0:e.published}):(0,oe.jsx)("span",{className:null!==e&&void 0!==e&&e.paid?"paid":"unpaid",children:null!==e&&void 0!==e&&e.paid?"Paid":"Not Paid"})})]},e.number||`je-${t}`)})):(0,oe.jsx)("tr",{children:(0,oe.jsx)("td",{colSpan:5,className:"noDataAvilable text-center",children:" No data available"})})})]})]})]}),(0,oe.jsxs)(te.A,{sm:6,className:"projectHistoryCol",children:[(0,oe.jsxs)(ie.A,{children:[(0,oe.jsxs)(te.A,{className:"tabModelMenu d-flex justify-content-between align-items-center p-0",children:[(0,oe.jsx)(ae,{projectId:l,projectCardData:be}),(0,oe.jsx)(Re,{project:a,reInitialize:d,projectCardData:()=>be(l)}),(0,oe.jsx)(nt,{projectId:l,projectCardData:()=>be(l)}),(0,oe.jsx)(he,{clientId:null===g||void 0===g?void 0:g.client,projectId:l,projectCardData:()=>be(l)})]}),(0,oe.jsx)(te.A,{className:"d-flex justify-content-center align-items-center filter",children:(0,oe.jsx)(Oe,{setFilteredHistoryOptions:de})})]}),(0,oe.jsx)(ie.A,{className:"projectHistoryWrap",children:(0,oe.jsxs)(te.A,{className:"p-0",children:[(0,oe.jsx)("h3",{children:"Project History"}),m?(0,oe.jsx)(oe.Fragment,{children:Array.from({length:10},((e,t)=>(0,oe.jsx)(S.A,{as:"p",animation:"wave",className:t%2===0?"mb-0 mt-1":"mb-3 mt-1",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:t%2===0?"200px":"90%",height:t%2===0?"15px":"10px"}})},`history-key-${t+1}`)))}):(0,oe.jsx)("div",{className:"projectHistoryScroll",children:null!==N&&void 0!==N&&N.length?N.map(((e,t)=>{let{id:s,type:i,text:n,title:o,created:a,manager:r,links:d}=e;return(0,oe.jsxs)("div",{className:"projectHistorygroup",children:[(0,oe.jsx)("ul",{children:(0,oe.jsx)("li",{children:"quote"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)("div",{className:"d-flex align-items-center",children:[(0,oe.jsx)(I.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Quote \xa0"}),"\xa0",(null===d||void 0===d?void 0:d.quote_pdf)&&(0,oe.jsx)(J.N_,{to:`${(null===d||void 0===d?void 0:d.quote_pdf)||"#"}`,target:"_blank",children:(0,oe.jsx)(T.A,{color:"#FF0000",size:14})}),"\xa0\xa0",l&&"Quote Created"===o&&(0,oe.jsx)(J.N_,{to:`/quote/${l}`,target:"_blank",children:(0,oe.jsx)(R.A,{color:"#3366CC",size:16})})]})}):"task"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(M.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Task"})]})}):"order"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(M.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Order"})]})}):"note"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(P.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Note"})]})}):"tag"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(H.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Tag"})]})}):"invoice"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)("div",{className:"d-flex align-items-center",children:[(0,oe.jsx)(z.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Invoice\xa0"}),"\xa0",(null===d||void 0===d?void 0:d.invoice_pdf)&&(0,oe.jsx)(J.N_,{to:`${(null===d||void 0===d?void 0:d.invoice_pdf)||"#"}`,target:"_blank",children:(0,oe.jsx)(T.A,{color:"#FF0000",size:14})}),"\xa0\xa0",l&&"Invoice Created"===o&&(0,oe.jsx)(J.N_,{to:`/invoice/${l}`,target:"_blank",children:(0,oe.jsx)(R.A,{color:"#3366CC",size:16})})]})}):"billing"===i?(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(O.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Billing"})]})}):"email"===i?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(q.A,{size:16,color:"#1AB2FF"})," ",(0,oe.jsx)("strong",{children:"\xa0 Email"})]}):""})}),(0,oe.jsx)("h5",{style:{whiteSpace:"pre-line"},children:"email"!==i&&o||""}),"email"===i?(0,oe.jsx)(Fe,{emailData:n}):(0,oe.jsx)("h6",{style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:n}}),(0,oe.jsxs)("p",{children:[ye(a)," by ",r]})]},`history-${s||t}`)})):(0,oe.jsx)("p",{children:"No history available"})})]})})]})]}),(0,oe.jsx)(ie.A,{className:"projectCardButWrap",children:(0,oe.jsxs)(te.A,{children:[(0,oe.jsx)(Ge,{projectId:l,projectCardData:be,isFetching:m,startDate:+(null===g||void 0===g?void 0:g.booking_start),endDate:+(null===g||void 0===g?void 0:g.booking_end)},l),(0,oe.jsx)(J.N_,{to:`/expenses?projectId=${null===a||void 0===a?void 0:a.value}&reference=${null===a||void 0===a?void 0:a.reference}`,children:(0,oe.jsxs)(o.A,{className:"expense expActive",children:["Create Expense ",(0,oe.jsx)("img",{src:Ct.A,alt:"Expense"})]})}),(null===u||void 0===u?void 0:u.has_work_subscription)&&(0,oe.jsx)(J.N_,{to:`/work/jobs?projectId=${null===a||void 0===a?void 0:a.value}&reference=${null===a||void 0===a?void 0:a.reference}`,children:(0,oe.jsxs)(o.A,{className:"createJob jobActive",children:["Create a Job ",(0,oe.jsx)("img",{src:yt.A,alt:"briefcase"})]})}),(0,oe.jsx)(xe,{clientId:null===g||void 0===g?void 0:g.client,projectId:l}),(0,oe.jsx)(vt,{projectId:l,project:g,projectCardData:be})]})}),(0,oe.jsxs)(ie.A,{className:"projectCardCalculation",children:[(0,oe.jsxs)(te.A,{className:"proCostSale projectColBg",children:[(0,oe.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,oe.jsx)("h5",{children:"Cost Of Sale"}),(0,oe.jsxs)("p",{children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.cost_of_sale)]})]}),(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,oe.jsx)(V.A,{size:20,color:"#344054"})})]}),(0,oe.jsxs)(te.A,{className:"proLabour projectColBg",children:[(0,oe.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,oe.jsx)("h5",{children:"Labour"}),(0,oe.jsxs)("p",{children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.labor_expenses)]})]}),(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,oe.jsx)(V.A,{size:20,color:"#344054"})})]}),(0,oe.jsxs)(te.A,{className:"proOperatingExpense projectColBg",children:[(0,oe.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,oe.jsx)("h5",{children:"Operating Expense"}),(0,oe.jsxs)("p",{children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.operating_expense)]})]}),(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,oe.jsx)("path",{d:"M4.16675 8H15.8334M4.16675 13H15.8334",stroke:"#344054",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,oe.jsxs)(te.A,{className:"proRealCost projectColBg",children:[(0,oe.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,oe.jsx)("h5",{children:"Real Cost"}),(0,oe.jsxs)("p",{children:["$",(0,wt.m)(ge)]})]}),(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,oe.jsx)("span",{className:"font-14",children:"VS"})})]}),(0,oe.jsx)(te.A,{className:"proBuget projectColBg",children:(0,oe.jsxs)("div",{children:[(0,oe.jsx)("h5",{children:"Budget"}),(0,oe.jsxs)("p",{children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.budget)]})]})})]}),(0,oe.jsxs)(ie.A,{className:"projectCardactionBut",children:[(0,oe.jsxs)(te.A,{className:"actionLeftSide",children:[(0,oe.jsxs)(o.A,{onClick:()=>{we.mutate(l)},disabled:!(null!==g&&void 0!==g&&g.can_be_declined)||we.isPending,className:"declineAction",children:[(0,oe.jsx)(U.A,{size:20,color:"#912018"})," Decline Order",we.isPending&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]}),(0,oe.jsxs)(o.A,{disabled:h,className:"duplicateAction",onClick:async()=>{try{if(!l)return ne.oR.error("Project id not found");x(!0),await(0,ft.CK)(l),c("/sales"),ne.oR.success("Sale has been successfully duplicated")}catch(e){console.error("Error is duplicating:",e),ne.oR.error("Failed to duplicate sale. Please try again.")}finally{x(!1)}},children:[(0,oe.jsx)(Z.A,{size:20,color:"#0A4766",className:"me-1"}),(0,oe.jsx)("span",{style:{position:"relative",top:"2px"},children:"Duplicate"})," ",h&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"6px"}})]}),(0,oe.jsxs)(o.A,{disabled:!(null!==g&&void 0!==g&&g.can_be_return),onClick:()=>{!(null!==g&&void 0!==g&&g.can_be_return)||Ce.mutate(l)},className:"sendBackAction",children:[(0,oe.jsx)(G.A,{size:20,color:"#344054",opacity:null!==g&&void 0!==g&&g.can_be_return?1:.5}),"Send Back to Sales",Ce.isPending&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]}),(0,oe.jsxs)(te.A,{className:"actionRightSide",children:[(0,oe.jsx)(Se,{clientId:null===g||void 0===g?void 0:g.client,isCreated:null===g||void 0===g?void 0:g.invoice_created,projectId:l,isLoading:null===Ne||void 0===Ne?void 0:Ne.isPending,create:()=>{Ne.mutate(l)},projectCardData:()=>be(l)}),(0,oe.jsxs)(o.A,{onClick:()=>Ae.mutate(l),disabled:!(null!==g&&void 0!==g&&g.can_be_completed),className:"CompleteActionBut",children:["Complete & Archive",(null===Ae||void 0===Ae?void 0:Ae.isPending)&&(0,oe.jsx)(ee.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]})]}),(0,oe.jsx)(ie.A,{className:"projectBreakdown px-0 pb-0",children:(0,oe.jsxs)(te.A,{sm:12,className:"px-0",children:[(0,oe.jsxs)(o.A,{className:"mb-2",onClick:()=>ue(!ce),children:[ce?"Hide":"Show"," Cost breakdown"]}),ce&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(X.b,{value:(null===g||void 0===g?void 0:g.calculations)||[],showGridlines:!0,className:"border-top",children:[(0,oe.jsx)(Q.V,{field:"id",header:"Order",bodyClassName:"text-center",headerClassName:"text-center",style:{width:"60px"},body:(e,t)=>t.rowIndex+1}),(0,oe.jsx)(Q.V,{field:"subindex",header:"Department",style:{minWidth:"192px"},body:e=>(0,oe.jsx)("div",{className:"ellipsis-width",title:e.subindex,style:{maxWidth:"192px"},children:e.subindex})}),(0,oe.jsx)(Q.V,{field:"description",header:"Description",body:e=>(0,oe.jsx)("div",{className:"ellipsis-width",title:e.description,style:{maxWidth:"350px"},children:e.description}),style:{width:"100%"}}),(0,oe.jsx)(Q.V,{field:"cost",header:"Cost",style:{width:"100%"},body:e=>`$${(0,wt.m)(e.cost)}`}),(0,oe.jsx)(Q.V,{field:"profit_type_value",header:"Markup/Margin",body:e=>`${e.profit_type_value} ${"AMN"===e.profit_type?"AMT $":"MRG"===e.profit_type?"MRG %":"MRK %"}`,style:{width:"100%"}}),(0,oe.jsx)(Q.V,{field:"unit_price",header:"Unit Price",style:{width:"100%"},body:e=>`$${(0,wt.m)(e.unit_price)}`}),(0,oe.jsx)(Q.V,{field:"quantity",header:"Qty/Unit",style:{width:"100%"}}),(0,oe.jsx)(Q.V,{field:"discount",header:"Discount",style:{width:"100%"},body:e=>`${e.discount}%`}),(0,oe.jsx)(Q.V,{field:"total",header:"Amount",style:{width:"100%"},body:e=>`$${(0,wt.m)(e.total)}`})]}),(0,oe.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-end gap-4",style:{background:"#EBF8FF",padding:"8px 24px 8px 40px"},children:[(0,oe.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,oe.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Sub Total"}),(0,oe.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.sub_total)]})]}),(0,oe.jsx)("div",{children:(0,oe.jsx)(V.A,{size:20,color:"#106B99"})}),(0,oe.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,oe.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Tax"}),(0,oe.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.gst)]})]}),(0,oe.jsx)("div",{children:(0,oe.jsx)("div",{children:(0,oe.jsx)(W.A,{size:20,color:"#106B99",style:{transform:"rotate(90deg)"}})})}),(0,oe.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,oe.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Total Invoice Amount"}),(0,oe.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,wt.m)(null===g||void 0===g?void 0:g.total)]})]})]})]})]})})]})})]})})};var Nt=s(33183),St=s(12532);const Ft=e=>{if(!e)return"-";return new Date(1e3*+e)},_t=e=>{var t,s,n,l,a,r,d,c,u,h,p,m,v;let{show:g,setShow:j,data:b,reInitialize:f}=e;const y=(0,i.useRef)(null),{session:C}=(0,w.As)(),A=null===b||void 0===b?void 0:b.id,N={value:null===b||void 0===b||null===(t=b.project)||void 0===t?void 0:t.id,reference:null===b||void 0===b||null===(s=b.project)||void 0===s?void 0:s.reference,number:null===b||void 0===b||null===(n=b.project)||void 0===n?void 0:n.number},[S,F]=(0,i.useState)(b.title||""),[_,k]=(0,i.useState)(b.description||""),[E,D]=(0,i.useState)((null===b||void 0===b||null===(l=b.user)||void 0===l?void 0:l.id)||null),[L,B]=(0,i.useState)({startDate:Ft(b.from_date),endDate:Ft(b.to_date)}),[$,I]=(0,i.useState)({taskTitle:!1,description:!1,user:!1,date:!1}),T=(0,Y.n)({mutationFn:e=>(0,Be.wW)(e,A),onSuccess:()=>{j(!1),f()},onError:e=>{console.error("Error creating task:",e)}}),R=(0,Y.n)({mutationFn:()=>(0,Be.mM)(A),onSuccess:()=>{console.log("Delete success"),j(!1),f()},onError:e=>{console.error("Error creating task:",e)}}),M=()=>{const e={taskTitle:!S,description:!_,date:!L};I(e),e.taskTitle||e.description||e.user||e.date||(console.log("Form submitted with:",{taskTitle:S,description:_,project:N,user:E,date:L}),T.mutate({title:S,description:_,project:N.value,from_date:L.startDate,to_date:L.endDate,...E&&{user:E}}))},P=(0,re.I)({queryKey:["getUserList"],queryFn:x.aU}),H=(0,re.I)({queryKey:["getMobileUserList"],queryFn:x.gy});return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(De.A,{onSubmit:M,children:(0,oe.jsxs)(se.A,{show:g,centered:!0,onHide:()=>j(!1),className:"task-form",children:[(0,oe.jsx)(se.A.Header,{closeButton:!0,children:(0,oe.jsxs)(se.A.Title,{children:[(0,oe.jsx)("img",{src:St.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,oe.jsx)("span",{className:"modal-task-title",children:"Edit Task"})]})}),(0,oe.jsxs)(se.A.Body,{children:[(0,oe.jsxs)(De.A.Group,{className:"mb-2",children:[(0,oe.jsx)(De.A.Label,{children:"Project Task"}),(0,oe.jsxs)(Fe.A,{children:[(0,oe.jsx)(De.A.Select,{disabled:!0,children:(0,oe.jsxs)("option",{value:null===N||void 0===N?void 0:N.value,children:[null===N||void 0===N?void 0:N.reference," (",null===N||void 0===N?void 0:N.number,")"]})}),(0,oe.jsx)(Fe.A.Text,{children:(0,oe.jsx)(ke.A,{})})]}),!N&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Project task is required"})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",children:[(0,oe.jsx)(De.A.Label,{children:"Task Title"}),(0,oe.jsxs)(Fe.A,{children:[(0,oe.jsx)(De.A.Control,{required:!0,type:"text",placeholder:"Enter task title",value:S,onChange:e=>F(e.target.value)}),(0,oe.jsx)(Fe.A.Text,{children:(0,oe.jsx)(_e.A,{})})]}),$.taskTitle&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Task title is required"})]}),(0,oe.jsxs)(De.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,oe.jsx)(De.A.Label,{children:"Description"}),(0,oe.jsx)(De.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:_,onChange:e=>k(e.target.value),required:!0}),$.description&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Description is required"})]})]}),(0,oe.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"20px",borderTop:"1px solid #eaecf0",padding:"12px 30px 8px 20px"},children:[!E&&(0,oe.jsx)(Ee.A,{color:null!==(a=y.current)&&void 0!==a&&null!==(r=a.panel)&&void 0!==r&&null!==(d=r.element)&&void 0!==d&&d.offsetParent?"#1AB2FF":"#475467",size:22,style:{position:"relative",left:"10px",zIndex:1},onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.show()},className:"me-3 cursor-pointer"}),(0,oe.jsx)(ge.m,{ref:y,options:[{label:"Desktop User",items:(null===P||void 0===P||null===(c=P.data)||void 0===c||null===(u=c.users)||void 0===u||null===(h=u.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===h?void 0:h.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==C&&void 0!==C&&C.has_work_subscription?[{label:"Mobile User",items:(null===H||void 0===H||null===(p=H.data)||void 0===p||null===(m=p.users)||void 0===m||null===(v=m.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===v?void 0:v.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{D(e.value)},valueTemplate:e=>(0,oe.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"0px solid #dedede"},children:(0,oe.jsx)(Ie.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),itemTemplate:e=>(0,oe.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,oe.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,oe.jsx)(Ie.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:E?"fit-content":"0px",height:E?"46px":"0px",zIndex:E?"1":"0",position:"relative",left:E?"0px":"-60px",top:E?"0px":"-15px"},value:E,dropdownIcon:(0,oe.jsx)(oe.Fragment,{}),collapseIcon:(0,oe.jsx)(oe.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items"}),(0,oe.jsx)(Le.A,{dateRange:L,setDateRange:B})]}),(0,oe.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px",padding:"0 30px 8px 30px"},children:[$.user&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"User is required"}),$.date&&(0,oe.jsx)(De.A.Text,{className:"text-danger",children:"Date is required"})]}),(0,oe.jsxs)(se.A.Footer,{className:"d-flex justify-content-between",children:[(0,oe.jsx)(o.A,{type:"button",className:"delete-button",onClick:()=>{R.mutate()},children:R.isPending?"Loading...":"Delete Task"}),(0,oe.jsx)(o.A,{type:"button",className:"save-button",onClick:M,children:T.isPending?"Loading...":"Save Task"})]})]})})})};var kt=s(42265),Et=s(42052);const Dt=()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",size:"lg"})}),(0,oe.jsx)(S.A,{as:"p",animation:"wave",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",style:{height:"80px"},size:"lg"})}),(0,oe.jsx)("table",{className:"task-deatils-table w-100",children:(0,oe.jsxs)("tbody",{children:[(0,oe.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})})]}),(0,oe.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})})]}),(0,oe.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})})]}),(0,oe.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:(0,oe.jsx)(S.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary"})})})]})]})})]}),Lt=e=>{var t,s;let{view:n,setView:l,taskId:a,setTaskId:r,reInitialize:d}=e;const[c,u]=(0,i.useState)(!1),{isFetching:h,data:p}=(0,re.I)({queryKey:["taskId",a],queryFn:()=>(0,Be.dd)(a),enabled:!!a,retry:1}),x=(0,Y.n)({mutationFn:e=>(0,Be._x)(a,e),onSuccess:()=>{m(),r(null),d()},onError:e=>{console.error("Error updating task:",e)}}),m=()=>l(!1),v=e=>{var t;if(!e)return"-";return null===(t=new Date(1e3*+e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))||void 0===t?void 0:t.replace(/,/g,"")};return(0,i.useEffect)((()=>{c||r(null)}),[c]),(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)(se.A,{show:n,centered:!0,onHide:m,children:[(0,oe.jsx)(se.A.Header,{closeButton:!0,children:(0,oe.jsxs)(se.A.Title,{children:[(0,oe.jsx)("img",{src:Et.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,oe.jsx)("span",{className:"modal-task-title",children:"Task Details"})]})}),(0,oe.jsx)(se.A.Body,{children:h?(0,oe.jsx)(Dt,{}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("p",{className:"task-title",children:(null===p||void 0===p?void 0:p.title)||"-"}),(0,oe.jsx)("p",{className:"task-description",children:(null===p||void 0===p?void 0:p.description)||"-"}),(0,oe.jsx)("table",{className:"task-deatils-table",children:(0,oe.jsxs)("tbody",{children:[(0,oe.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Project Task"}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:null!==p&&void 0!==p&&p.project&&p.project.reference?p.project.reference:"-"})]}),(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"ID"}),(0,oe.jsx)("td",{style:{paddingBottom:"12px"},children:(null===p||void 0===p?void 0:p.number)||"-"})]}),(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Assigned"}),(0,oe.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,oe.jsx)("img",{src:null!==p&&void 0!==p&&null!==(t=p.user)&&void 0!==t&&t.has_photo?null===p||void 0===p?void 0:p.user.photo:kt.A,alt:"img-assigned",style:{width:"24px",height:"24px",borderRadius:"50%"}}),(0,oe.jsx)("span",{children:(null===p||void 0===p||null===(s=p.user)||void 0===s?void 0:s.full_name)||"-"})]})]}),(0,oe.jsxs)("tr",{children:[(0,oe.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Date"}),(0,oe.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,oe.jsx)("span",{children:v(null===p||void 0===p?void 0:p.from_date)}),(0,oe.jsx)(Nt.A,{size:20,color:"#475467"}),(0,oe.jsx)("span",{children:v(null===p||void 0===p?void 0:p.to_date)})]})]})]})})]})}),(0,oe.jsx)(se.A.Footer,{children:h?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(S.A,{as:"p",animation:"wave",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",style:{height:"46px",width:"115px",borderRadius:"4px"},size:"lg"})}),(0,oe.jsx)(S.A,{as:"p",animation:"wave",children:(0,oe.jsx)(S.A,{xs:12,bg:"secondary",style:{height:"46px",width:"125px",borderRadius:"4px"},size:"lg"})})]}):(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(o.A,{className:"edit-button",onClick:function(){u(!0),m()},children:"Edit Task"}),null!==p&&void 0!==p&&p.finished?(0,oe.jsx)(o.A,{className:"incomplete-button",onClick:()=>x.mutate(!1),children:x.isPending?(0,oe.jsx)(oe.Fragment,{children:"Loading..."}):(0,oe.jsxs)(oe.Fragment,{children:["Incomplete",(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,oe.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#F04438"})})]})}):(0,oe.jsx)(o.A,{className:"complete-button",onClick:()=>x.mutate(!0),children:x.isPending?(0,oe.jsx)(oe.Fragment,{children:"Loading..."}):(0,oe.jsxs)(oe.Fragment,{children:["Complete",(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,oe.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#17B26A"})})]})})]})})]}),p&&(0,oe.jsx)(_t,{show:c,setShow:u,data:p,reInitialize:d},c)]})},Bt="calender";const $t=function(){const{session:e}=(0,w.As)(),t=(null===e||void 0===e?void 0:e.has_work_subscription)||!1,s=(0,i.useRef)(null),{trialHeight:n}=(0,A.$)(),[x,m]=(0,i.useState)(""),[v,g]=(0,i.useState)([]),[j,b]=(0,i.useState)(!1),[S,F]=(0,i.useState)(!1),[_,k]=(0,i.useState)(!1),[E,D]=(0,i.useState)(!1),[L,B]=(0,i.useState)([]),[$,I]=(0,i.useState)(null),[T,R]=(0,i.useState)(null),[M,P]=(0,i.useState)({}),[H,z]=(0,i.useState)(""),[O,q]=(0,i.useState)(""),[V,U]=(0,i.useState)(""),[Z,G]=(0,i.useState)(!1),[W,K]=(0,i.useState)(null),J=window.location.href,Y=new URL(J),Q=new URLSearchParams(Y.search),X=Q.get("unique_id");if(X&&!T){R(X);const e=Q.get("reference"),t=Q.get("number"),s=Q.get("value");P({number:t||"",reference:e,value:s}),k(!0)}function ee(e){let t=arguments.length>2?arguments[2]:void 0;arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(R(e),P(t),k(!0)):(I(e),F(!0))}(0,i.useEffect)((()=>{(async()=>{try{const e=await(0,C.ic)();B([...e])}catch(e){console.error("Error fetching project status data:",e)}})()}),[]),(0,i.useEffect)((()=>{const e=e=>{if(!(e.target instanceof HTMLSelectElement)){if(e.target.closest(".createJobButton")){const t=e.target.getAttribute("project-id");K(t),G(!0)}if(e.target.closest(".create-task-button")){const t=e.target.getAttribute("number"),s=e.target.getAttribute("reference"),i=e.target.getAttribute("project-id");P({number:t,reference:s,value:i}),b(!0)}else if(e.target.closest(".task-list")){const t=e.target.closest(".task-list").getAttribute("task-id");console.log("task-list: ....",t),t&&ee(t)}else if(e.target.closest(".project-content")){const t=e.target.closest(".project-content").getAttribute("unique-id"),s=e.target.closest(".project-content").getAttribute("number"),i=e.target.closest(".project-content").getAttribute("reference"),n=e.target.closest(".project-content").getAttribute("project-id");console.log("uniqueId: ....",t),R(t),P({number:s,reference:i,value:n}),k(!0)}}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]);const te=async()=>{try{D(!0);const e=await(0,p.Mv)();g(e),x?ie(x,e):f(e,t),D(!1)}catch(e){console.error("Error initializing DayPilot:",e)}};(0,i.useEffect)((()=>{const e=document.createElement("script");e.src="/daypilot-all.min.js",e.id="daypilot-script-ele";const s=()=>{console.error("Failed to load DayPilot script.")},i=async()=>{try{const e=await(0,p.Mv)();g(e),y(Bt,e,ee,te,t)}catch(e){console.error("Error initializing DayPilot:",e)}};return e.addEventListener("error",s),e.addEventListener("load",i),document.body.appendChild(e),()=>{e.removeEventListener("error",s),e.removeEventListener("load",i),document.body.contains(e)&&document.body.removeChild(e)}}),[]);const se=()=>{console.log("handleViewTask: ")};(0,i.useEffect)((()=>{const e=document.querySelector(".task-list");if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.addEventListener("click",se())}return()=>{if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.removeEventListener("click",se)}}}),[]);const ie=(e,i)=>{const n=i||v;s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{f(n.filter((t=>{var s,i,n,l,o,a;return!!(null!==t&&void 0!==t&&null!==(s=t.number)&&void 0!==s&&null!==(i=s.toLowerCase())&&void 0!==i&&i.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(n=t.reference)&&void 0!==n&&null!==(l=n.toLowerCase())&&void 0!==l&&l.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(o=t.client)&&void 0!==o&&null!==(a=o.name.toLowerCase())&&void 0!==a&&a.includes((null===e||void 0===e?void 0:e.toLowerCase())||""))}))||[],t)}),600)},ne=(0,i.useCallback)((()=>{let e=[...v];if("Not Invoiced"===H?e=e.filter((e=>!e.is_invoice_created)):"Not Booked"===H?e=e.filter((e=>!e.booking_start)):"Not Paid"===H&&(e=e.filter((e=>"PAID"!==e.paid))),"Date Due"===O?e.sort(((e,t)=>new Date(1e3*e.booking_end)-new Date(1e3*t.booking_end))):"Date Accepted"===O?e.sort(((e,t)=>new Date(1e3*e.booking_start)-new Date(1e3*t.booking_start))):"Job Number"===O?e.sort(((e,t)=>e.number.localeCompare(t.number))):"Order Status"===O&&e.sort(((e,t)=>{var s,i;return((null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.title)||"").localeCompare((null===t||void 0===t||null===(i=t.custom_status)||void 0===i?void 0:i.title)||"")})),(null===V||void 0===V?void 0:V.length)>0){const t=V.map((e=>e.id));e=e.filter((e=>{var s;return t.includes(null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.id)}))}x&&(e=e.filter((e=>{var t,s,i,n,l,o;return!!(null!==e&&void 0!==e&&null!==(t=e.number)&&void 0!==t&&null!==(s=t.toLowerCase())&&void 0!==s&&s.includes((null===x||void 0===x?void 0:x.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(i=e.reference)&&void 0!==i&&null!==(n=i.toLowerCase())&&void 0!==n&&n.includes((null===x||void 0===x?void 0:x.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(l=e.client)&&void 0!==l&&null!==(o=l.name.toLowerCase())&&void 0!==o&&o.includes((null===x||void 0===x?void 0:x.toLowerCase())||""))}))),f(e,t)}),[v,H,O,x,t,V]);(0,i.useEffect)((()=>{ne()}),[H,O,x,ne,V]);const le=e=>{z(e)},ae=e=>{q(e)};return(0,oe.jsxs)(i.Fragment,{children:[(0,oe.jsxs)("div",{className:"topbar bottom-border",style:{padding:"0px 20px",position:"relative"},children:[(0,oe.jsxs)("div",{className:"left-side d-flex align-items-center",style:{gap:"12px"},children:[(0,oe.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,oe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,oe.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,oe.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>{const t=e.target.value;m(t)},className:"border search-resource",style:{borderRadius:"4px",border:"1px solid #D0D5DD",width:"184px",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,oe.jsxs)("div",{className:"d-flex gap-1 justify-content-end align-items-center",style:{position:"absolute",left:"4px",top:"56px",zIndex:1e3},children:[(0,oe.jsxs)(l.A,{children:[(0,oe.jsxs)(l.A.Toggle,{as:o.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,oe.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,oe.jsx)(r.A,{size:16,color:"#667085",className:"me-2"}),(0,oe.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:O,children:O||(0,oe.jsx)("span",{style:{color:"#667085"},children:"Sort By"})})]}),O&&(0,oe.jsx)("span",{onClick:e=>{e.stopPropagation(),ae("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,oe.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,oe.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,oe.jsxs)(l.A.Menu,{children:[(0,oe.jsx)(l.A.Item,{eventKey:"Date Due",active:"Date Due"===O,onClick:()=>ae("Date Due"),children:"Date Due"},"Date Due"),(0,oe.jsx)(l.A.Item,{eventKey:"Date Accepted",active:"Date Accepted"===O,onClick:()=>ae("Date Accepted"),children:"Date Accepted"},"Date Accepted"),(0,oe.jsx)(l.A.Item,{eventKey:"Job Number",active:"Job Number"===O,onClick:()=>ae("Job Number"),children:"Job Number"},"Job Number"),(0,oe.jsx)(l.A.Item,{eventKey:"Order Status",active:"Order Status"===O,onClick:()=>ae("Order Status"),children:"Order Status"},"Order Status")]})]}),(0,oe.jsxs)(l.A,{children:[(0,oe.jsxs)(l.A.Toggle,{as:o.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,oe.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,oe.jsx)(d.A,{size:16,color:"#667085",className:"me-2"}),(0,oe.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:H,children:H||(0,oe.jsx)("span",{style:{color:"#667085"},children:"Filter By"})})]}),H&&(0,oe.jsx)("span",{onClick:e=>{e.stopPropagation(),le("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,oe.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,oe.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,oe.jsxs)(l.A.Menu,{children:[(0,oe.jsx)(l.A.Item,{eventKey:"Not Invoiced",active:"Not Invoiced"===H,onClick:()=>le("Not Invoiced"),children:"Not Invoiced"},"Not Invoiced"),(0,oe.jsx)(l.A.Item,{eventKey:"Not Booked",active:"Not Booked"===H,onClick:()=>le("Not Booked"),children:"Not Booked"},"Not Booked"),(0,oe.jsx)(l.A.Item,{eventKey:"Not Paid",active:"Not Paid"===H,onClick:()=>le("Not Paid"),children:"Not Paid"},"Not Paid")]})]}),(0,oe.jsxs)("div",{style:{position:"relative",maxWidth:"113px"},children:[(0,oe.jsx)("div",{style:{position:"absolute",top:"3px",left:"12px",zIndex:1},children:(0,oe.jsx)(c.A,{size:20,color:"#667085"})}),(0,oe.jsx)(h.K,{value:V,options:L,onChange:e=>U(e.value),optionLabel:"title",placeholder:"Status",maxSelectedLabels:0,itemTemplate:e=>{var t,s,i;return(0,oe.jsx)("div",{className:"d-flex align-items-center gap-2",style:{width:"250px"},children:(0,oe.jsx)("div",{className:"w-100 p-2 rounded",style:{background:`${null===(t=Ye[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.bg}`,borderLeft:`4px solid ${null===(s=Ye[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.border}`,color:`${null===(i=Ye[null===e||void 0===e?void 0:e.color])||void 0===i?void 0:i.color}`},children:(0,oe.jsx)("span",{className:"ellipsis-width",style:{maxWidth:"250px"},children:e.title})})})},filter:!0,scrollHeight:"400px",display:"chip",showClear:!0,className:"w-100 custom-multiselect management-multiselect",style:{width:"184px",borderRadius:"40px",padding:"2px 8px",paddingLeft:"34px"}})]})]})]}),(0,oe.jsx)("div",{className:"featureName",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,oe.jsx)("h1",{className:"title mx-0",children:"Project Management"})}),(0,oe.jsx)("div",{className:"right-side d-flex align-items-center"})]}),(0,oe.jsx)("div",{className:n&&"trial-height-added",children:(0,oe.jsx)("div",{id:Bt,children:(0,oe.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,oe.jsx)(a.A,{animation:"border",role:"status",children:(0,oe.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})})}),(0,oe.jsx)(Lt,{view:S,setView:F,taskId:$,setTaskId:I,reInitialize:te}),(0,oe.jsx)(Te,{show:j,setShow:b,project:M,reInitialize:te}),(0,oe.jsx)(At,{viewShow:_,setViewShow:k,projectId:T,project:M,statusOptions:L,reInitialize:te},T),(0,oe.jsx)(N.A,{visible:Z,setVisible:G,setRefetch:te,jobProjectId:W}),E&&(0,oe.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,oe.jsx)(a.A,{animation:"border",role:"status",children:(0,oe.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})},It=()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(n.mg,{children:(0,oe.jsx)("title",{children:"MeMate - Management"})}),(0,oe.jsx)($t,{})]})},11520:(e,t,s)=>{s.d(t,{Mv:()=>g,Np:()=>o,OE:()=>j,SE:()=>h,ZE:()=>c,aj:()=>a,fi:()=>p,jE:()=>d,jy:()=>x,ky:()=>v,mw:()=>l,o2:()=>r,qm:()=>m,yE:()=>u});const i="https://dev.memate.com.au/api/v1",n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:i={},body:n}=t,l={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...i},body:JSON.stringify(n),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,l);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const i=s.headers.get("Content-Type");if(i&&i.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(o){throw console.error("Fetch API error:",o),o}},l=async(e,t)=>{const s={method:"PUT",body:t},l=new URL(`${i}${`/project-card/schedule/${e}/`}`);return n(l.toString(),s)},o=async(e,t)=>{const s={method:"PUT",body:t},l=new URL(`${i}${`/project-card/custom-status/${e}/`}`);return n(l.toString(),s)},a=async(e,t)=>{const s={method:"PUT",body:t},l=new URL(`${i}${`/project-card/reference/${e}/`}`);return n(l.toString(),s)},r=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/project-card/note/${e}/`}`);return n(l.toString(),s)},d=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${i}/projects/back/`);return n(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${i}/projects/decline/`);return n(s.toString(),t)},u=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${i}/projects/complete/`);return n(s.toString(),t)},h=async e=>{const t=new URL(`${i}${`/invoices/create/${e}/`}`);return n(t.toString(),{method:"POST"})},p=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/invoices/send/${e}/`}`);return n(l.toString(),s)},x=async(e,t,s)=>{let l;l=t?`/custom/email/${e}/${t}/`:`/custom/email/${e}/`;const o={method:"POST",body:s},a=new URL(`${i}${l}`);return n(a.toString(),o)},m=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/sms/${e}/`}`);return n(l.toString(),s)},v=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/resend/quote/${e}/`}`);return n(l.toString(),s)},g=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`),e.append("Content-Type","application/json");const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/management/`,s);return await e.json()}catch(n){throw console.error(n),n}},j=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"GET",headers:t,redirect:"follow"};try{const t=await fetch(`${i}/project-card/${e}/`,n);return await t.json()}catch(l){throw console.error(l),l}}},36166:(e,t,s)=>{s.d(t,{DX:()=>l,H2:()=>a,LG:()=>c,Y4:()=>o,de:()=>p,e0:()=>u,ml:()=>d,os:()=>x,r$:()=>r,rf:()=>h});var i=s(31342);const n="https://dev.memate.com.au/api/v1",l=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0;const a=(e-1)*t,r=new URL(`${n}/invoices/`);return r.searchParams.append("limit",t),r.searchParams.append("offset",a),s&&r.searchParams.append("search",s),l&&r.searchParams.append("ordering",l),o&&r.searchParams.append("status","not_paid"),(0,i.f)(r.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${n}${`/invoices/view/${e}/`}`);return(0,i.f)(t.toString(),{method:"GET"},!1)},a=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${n}${`/invoices/payment-intent/${e}/`}`);return(0,i.f)(l.toString(),s,!1)},r=async e=>{const t=new URL(`${n}${`/invoices/delete/${e}/`}`);return(0,i.f)(t.toString(),{method:"DELETE"})},d=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${n}${`/invoices/send/${e}/`}`);return(0,i.f)(l.toString(),s)},c=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${n}${`/resend/invoice/${e}/`}`);return(0,i.f)(l.toString(),s)},u=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${n}${`/invoices/partial-payment/${e}/`}`);return(0,i.f)(l.toString(),s)},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/invoices/to-xero/`);return(0,i.f)(s.toString(),t)},p=async e=>{const t=new URL(`${n}${`/team/mobile-users/invoices/${e}/pay/`}`);return(0,i.f)(t.toString(),{method:"POST"})},x=async e=>{const t=new URL(`${n}${`/team/mobile-users/invoices/${e}/unpay/`}`);return(0,i.f)(t.toString(),{method:"POST"})}}}]);
//# sourceMappingURL=3129.f987c280.chunk.js.map