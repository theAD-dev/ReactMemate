"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[121,3076,8941],{623:(e,t,s)=>{s.d(t,{IY:()=>f,Kh:()=>c,Nh:()=>d,Np:()=>v,PR:()=>r,SG:()=>m,YC:()=>j,fD:()=>g,hW:()=>u,ic:()=>C,j:()=>h,ms:()=>b,oQ:()=>a,sq:()=>w,vU:()=>p,yA:()=>y,yi:()=>x});var l=s(63712),i=s(40472);const n="https://app.memate.com.au/api/v1",o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:l={},body:i}=t,n={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...l},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,n);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const l=s.headers.get("Content-Type");if(l&&l.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(o){throw console.error("Fetch API error:",o),o}},a=async()=>{const e=new URL(`${n}/settings/subscriptions/tax-id/`);return o(e.toString(),{method:"GET"})},r=async()=>{const e=new URL(`${n}/settings/subscriptions/upcoming/`);return o(e.toString(),{method:"GET"})},d=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/subscriptions/tax-id/`);return o(s.toString(),t)},c=async()=>{const e=new URL(`${n}/settings/subscriptions/payment-method/`);return o(e.toString(),{method:"GET"})},u=async()=>{const e=new URL(`${n}/subscriptions/retry/`);return o(e.toString(),{method:"POST"})},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/subscriptions/payment-method/`);return o(s.toString(),t)},m=async()=>{const e=new URL(`${n}/settings/organization/region-language/`);return o(e.toString(),{method:"GET"})},p=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/settings/organization/region-language/`);return o(s.toString(),t)},x=async e=>{console.log("data: ",e),e.id&&delete e.id,e.isNew&&delete e.isNew,e.isChanged&&delete e.isChanged,e.value&&delete e.value;const t={method:"POST",body:e},s=new URL(`${n}/settings/project-statuses/new/`);return o(s.toString(),t)},v=async(e,t)=>{const s={method:"PUT",body:t},l=new URL(`${n}${`/settings/project-statuses/update/${e}/`}`);return o(l.toString(),s)},g=async e=>{const t=new URL(`${n}${`/settings/project-statuses/delete/${e}/`}`);return o(t.toString(),{method:"DELETE"})},j=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/general/`,s);return await e.json()}catch(l){throw console.error("Profile fetch error:",l),l}},f=async(e,t)=>{const s=new Headers,i=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${i}`);const o=new FormData;if(Object.keys(e).forEach((t=>{o.append(t,e[t])})),null!==t&&void 0!==t&&t.croppedImageBlob){const e=(0,l.Ak)(6);o.append("company_logo",null===t||void 0===t?void 0:t.croppedImageBlob,`${e}.jpg`)}const a={method:"PUT",headers:s,body:o,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/general/`,a),t=await e.text();return console.log("result>>>>>>>>>>: ",t),t}catch(r){throw console.error("Profile fetch error:",r),r}},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/bank/`,s);return await e.text()}catch(l){throw console.error("Profile fetch error:",l),l}},y=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`);const l=new FormData;Object.keys(e).forEach((t=>{l.append(t,e[t])}));const i={method:"PUT",headers:t,body:l,redirect:"follow"};try{const e=await fetch(`${n}/settings/organization/bank/`,i),t=await e.text();return console.log("result: ",t),t}catch(o){throw console.error("Profile fetch error:",o),o}},C=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/settings/project-statuses/`,s);return await e.json()}catch(l){throw console.error("project fetch error:",l),l}},w=async()=>{try{const e=JSON.parse(localStorage.getItem("profileData")).location,t=await(0,i.g$)(e);if(!t||!t.state)return console.error("Invalid location details:",t),[];const s=`/locations/${t.state}/holidays/`,l={method:"GET"},a=new URL(`${n}${s}`);return o(a.toString(),l)}catch(e){return console.error("Error fetching holidays:",e),[]}}},1690:(e,t,s)=>{s.d(t,{A:()=>l});s(65043);const l=s.p+"static/media/Featured icon.f0452deecdd8a0600a95469561a90cfe.svg"},11520:(e,t,s)=>{s.d(t,{Mv:()=>b,Np:()=>o,OE:()=>y,SE:()=>h,Wb:()=>v,ZE:()=>c,aj:()=>a,fi:()=>m,jE:()=>d,jy:()=>g,ky:()=>f,m2:()=>x,mw:()=>n,o2:()=>r,pV:()=>p,qm:()=>j,yE:()=>u});const l="https://app.memate.com.au/api/v1",i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:l={},body:i}=t,n={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...l},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,n);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const l=s.headers.get("Content-Type");if(l&&l.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(o){throw console.error("Fetch API error:",o),o}},n=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${l}${`/project-card/schedule/${e}/`}`);return i(n.toString(),s)},o=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${l}${`/project-card/custom-status/${e}/`}`);return i(n.toString(),s)},a=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${l}${`/project-card/reference/${e}/`}`);return i(n.toString(),s)},r=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${l}${`/project-card/note/${e}/`}`);return i(n.toString(),s)},d=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${l}/projects/back/`);return i(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${l}/projects/decline/`);return i(s.toString(),t)},u=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${l}/projects/complete/`);return i(s.toString(),t)},h=async e=>{const t=new URL(`${l}${`/invoices/create/${e}/`}`);return i(t.toString(),{method:"POST"})},m=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${l}${`/invoices/send/${e}/`}`);return i(n.toString(),s)},p=async e=>{const t=new URL(`${l}${`/projects/file-list/${e}/`}`);return i(t.toString(),{method:"GET"})},x=async(e,t)=>{const s={method:"POST",body:{file_name:t}},n=new URL(`${l}${`/projects/file-delete/${e}/`}`);return i(n.toString(),s)},v=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${l}${`/project-card/calc-description/${e}/`}`);return i(n.toString(),s)},g=async(e,t,s)=>{let n;n=t?`/custom/email/${e}/${t}/`:`/custom/email/${e}/`;const o={method:"POST",body:s},a=new URL(`${l}${n}`);return i(a.toString(),o)},j=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${l}${`/sms/${e}/`}`);return i(n.toString(),s)},f=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${l}${`/resend/quote/${e}/`}`);return i(n.toString(),s)},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`),e.append("Content-Type","application/json");const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${l}/management/`,s);return await e.json()}catch(i){throw console.error(i),i}},y=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"GET",headers:t,redirect:"follow"};try{const t=await fetch(`${l}/project-card/${e}/`,i);return await t.json()}catch(n){throw console.error(n),n}}},34168:(e,t,s)=>{s.d(t,{A:()=>o});var l=s(65043),i=(s(7245),s(27965)),n=s(70579);const o=e=>{let{onDataApply:t,dateRange:s,onClose:o}=e;const[a,r]=(0,l.useState)([]),d=(0,l.useRef)(null),[c,u]=(0,l.useState)(null),[h,m]=(0,l.useState)(null),[p,x]=(0,l.useState)(!1),[v,g]=(0,l.useState)("");(0,l.useEffect)((()=>{s&&(r([null===s||void 0===s?void 0:s.startDate,null===s||void 0===s?void 0:s.endDate]),u(null===s||void 0===s?void 0:s.startDate),m(null===s||void 0===s?void 0:s.endDate))}),[]),(0,l.useEffect)((()=>{const e=new Date,t=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;g(t)}),[]);(0,l.useEffect)((()=>{if(2===a.length){const e=a[0],t=a[1];u(e),m(t)}else if(1===a.length){const e=a[0];u(e)}}),[a]);(0,l.useEffect)((()=>{}),[p]);const j=()=>{const e=new Date;r([e,e])};return(0,l.useEffect)((()=>{if(c||h){if(c&&h){const e={year:"numeric",month:"short",day:"numeric"},t=`<p>${`${new Date(c).toLocaleDateString("en-US",e)} - ${new Date(h).toLocaleDateString("en-US",e)}`}</p><span class="today-span" style="cursor: pointer">Today</span>`,s=document.querySelector(".flatpickr-months");if(s){const e=document.querySelector(".custom-div");if(e)e.innerHTML=t;else{const e=document.createElement("div");e.className="custom-div",e.innerHTML=t,s.parentNode.insertBefore(e,s.nextSibling)}}}}else{const e=new Date;u(e),m(e)}}),[c,h]),(0,l.useEffect)((()=>{const e=document.querySelector(".today-span");return e&&e.addEventListener("click",j),()=>{e&&e.removeEventListener("click",j)}}),[c,h]),(0,n.jsxs)("div",{children:[(0,n.jsx)(i.A,{options:{dateFormat:"Y-m-d",mode:"range",locale:{firstDayOfWeek:1},inline:!0},value:a,onChange:e=>{r(e)},ref:d}),(0,n.jsxs)("div",{className:"calenderBut",children:[(0,n.jsx)("button",{className:"tabCancel",onClick:()=>{r([]),u(null),m(null),x(!1),o&&o();const e=document.querySelector(".custom-div p");e&&(e.textContent=`${v}`)},children:"Cancel"}),(0,n.jsx)("button",{className:"tabApply",onClick:()=>{x(!0),t({startDate:c,endDate:h});const e=document.querySelector(".tags-input-container .rangedatepicker .mainWrapperTags");e&&(e.textContent=`${c.toISOString().split("T")[0]} - ${h.toISOString().split("T")[0]}`)},children:"Apply"})]})]})}},34558:(e,t,s)=>{s.d(t,{A:()=>c});s(65043);var l=s(75329),i=s(35475),n=s(72018),o=s(55797),a=s(93137),r=s(11281),d=s(70579);const c=e=>{let{show:t,setShow:s,attachments:c}=e;const u=(0,d.jsx)("div",{className:`${a.A.modalHeader}`,children:(0,d.jsx)("span",{className:`white-space-nowrap ${a.A.headerTitle}`,children:"Documents"})}),h=(0,d.jsx)("div",{className:"d-flex justify-content-center",children:(0,d.jsx)(n.$,{className:"outline-button",onClick:()=>s(!1),style:{borderRadius:"30px"},children:"Close"})});return(0,d.jsx)(o.l,{visible:t,modal:!1,header:u,footer:h,className:`${a.A.modal} custom-modal`,onHide:()=>{t&&s(!1)},children:(0,d.jsx)("div",{className:"d-flex flex-wrap gap-2",children:null===c||void 0===c?void 0:c.map((e=>(0,d.jsxs)("div",{className:a.A.attachmentBox,children:[(0,d.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,r.I)(null===e||void 0===e?void 0:e.extension),(0,d.jsx)(i.N_,{to:null===e||void 0===e?void 0:e.link,target:"_blank",children:(0,d.jsx)("span",{className:"text-dark",children:null===e||void 0===e?void 0:e.name})})]}),(0,d.jsx)("button",{className:"border-0 p-0 bg-none",onClick:()=>window.open(null===e||void 0===e?void 0:e.link,"_blank"),children:(0,d.jsx)(l.A,{})})]},null===e||void 0===e?void 0:e.link)))})})}},36166:(e,t,s)=>{s.d(t,{DX:()=>n,H2:()=>r,LG:()=>u,RC:()=>a,Y4:()=>o,de:()=>p,e0:()=>h,ml:()=>c,os:()=>x,r$:()=>d,rf:()=>m});var l=s(31342);const i="https://app.memate.com.au/api/v1",n=async function(e,t){var s;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;const d=(e-1)*t,c=new URL(`${i}/invoices/`);c.searchParams.append("limit",t),c.searchParams.append("offset",d),n&&c.searchParams.append("search",n),o&&c.searchParams.append("ordering",o),a&&c.searchParams.append("status","not_paid");let u="";var h;null!==r&&void 0!==r&&r.client&&(u=null===r||void 0===r||null===(h=r.client)||void 0===h?void 0:h.map((e=>e.id)).join(","));u&&c.searchParams.append("clients",u);let m="";var p;null!==r&&void 0!==r&&r.status&&1===(null===r||void 0===r||null===(s=r.status)||void 0===s?void 0:s.length)&&(null===r||void 0===r||null===(p=r.status)||void 0===p||p.forEach((e=>{"Paid"===(null===e||void 0===e?void 0:e.name)?m="paid":"Not Paid"===(null===e||void 0===e?void 0:e.name)&&(m="not_paid")})));if(m&&c.searchParams.append("status",m),null!==r&&void 0!==r&&r.date){var x,v,g,j;const e=null===r||void 0===r||null===(x=r.date[0])||void 0===x||null===(v=x.value)||void 0===v?void 0:v[0];if(e){const t=new Date(e),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");c.searchParams.append("create_date_after",`${s}-${l}-${i}`)}const t=null===r||void 0===r||null===(g=r.date[0])||void 0===g||null===(j=g.value)||void 0===j?void 0:j[1];if(t){const e=new Date(t),s=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");c.searchParams.append("create_date_before",`${s}-${l}-${i}`)}}return(0,l.f)(c.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${i}${`/invoices/view/${e}/`}`);return(0,l.f)(t.toString(),{method:"GET"},!1)},a=async e=>{if(!e)return null;const t=new URL(`${i}${`/invoices/read/${e}/`}`);return(0,l.f)(t.toString(),{method:"GET"})},r=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${i}${`/invoices/payment-intent/${e}/`}`);return(0,l.f)(n.toString(),s,!1)},d=async e=>{const t=new URL(`${i}${`/invoices/delete/${e}/`}`);return(0,l.f)(t.toString(),{method:"DELETE"})},c=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${i}${`/invoices/send/${e}/`}`);return(0,l.f)(n.toString(),s)},u=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${i}${`/resend/invoice/${e}/`}`);return(0,l.f)(n.toString(),s)},h=async(e,t)=>{const s={method:"POST",body:t},n=new URL(`${i}${`/invoices/partial-payment/${e}/`}`);return(0,l.f)(n.toString(),s)},m=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/invoices/to-xero/`);return(0,l.f)(s.toString(),t)},p=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/pay/`}`);return(0,l.f)(t.toString(),{method:"POST"})},x=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/unpay/`}`);return(0,l.f)(t.toString(),{method:"POST"})}},36766:(e,t,s)=>{s.d(t,{A:()=>l});const l={active:"jobs_active__ZiLB1",selectedCount:"jobs_selectedCount__ylTL-",filterBox:"jobs_filterBox__Fm1C9",newButton:"jobs_newButton__CoaUb",total:"jobs_total__tYu52",totalCount:"jobs_totalCount__c5FC+",shadowRight:"jobs_shadowRight__smZo7",payment:"jobs_payment__i+7WA",paymentHours:"jobs_paymentHours__e2Axb",paymentFix:"jobs_paymentFix__1tRgO",paymentTracker:"jobs_paymentTracker__sK5GM",time:"jobs_time__v7zI9",tracker:"jobs_tracker__aGhTF",clientImg:"jobs_clientImg__9499y",square:"jobs_square__5EeYW",clientName:"jobs_clientName__5iKeN",defaultStatus:"jobs_defaultStatus__XVACp",status:"jobs_status__EX7Lm",DRAFT:"jobs_DRAFT__+2Rds",OPEN:"jobs_OPEN__TRxzq",ASSIGNED:"jobs_ASSIGNED__vzQof",CONFIRMED:"jobs_CONFIRMED__VW8Jd",DECLINED:"jobs_DECLINED__XEbSy",SUBMITTED:"jobs_SUBMITTED__YBG-G",FINISHED:"jobs_FINISHED__AuxJC",IN_PROGRESS:"jobs_IN_PROGRESS__7pb65",type:"jobs_type__DW5S-",shift:"jobs_shift__6lLPh",fix:"jobs_fix__Jz8DC",hours:"jobs_hours__w07yY",timeFrame:"jobs_timeFrame__w+GZ5",timeTracker:"jobs_timeTracker__JTEx0",timeFrame2:"jobs_timeFrame2__mCys0",linkToProjectCard:"jobs_linkToProjectCard__9PXHf"}},40472:(e,t,s)=>{s.d(t,{MA:()=>c,N_:()=>h,Nt:()=>r,g$:()=>o,ir:()=>u,uU:()=>n,yJ:()=>a,zR:()=>d});var l=s(31342);const i="https://app.memate.com.au/api/v1",n=async()=>{const e=new URL(`${i}/locations/`);return(0,l.f)(e.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${i}${`/locations/${e}`}`);return(0,l.f)(t.toString(),{method:"GET"})},a=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/locations/new/`);return(0,l.f)(s.toString(),t)},r=async(e,t)=>{if(!e)throw new Error("No id found");const s={method:"PUT",body:t},n=new URL(`${i}${`/locations/${e}/update/`}`);return(0,l.f)(n.toString(),s)},d=async e=>{const t=new URL(`${i}${`/locations/${e}/delete/`}`);return(0,l.f)(t.toString(),{method:"DELETE"})},c=async()=>{const e=new URL(`${i}/references/desktop-users/`);return(0,l.f)(e.toString(),{method:"GET"})},u=async(e,t)=>{const s=new URL(`${i}${`/locations/${e}/${t}/assign-user/`}`);return(0,l.f)(s.toString(),{method:"POST"})},h=async(e,t)=>{if(!e)throw new Error("Location id not found");if(!t)throw new Error("User id not found");const s=new URL(`${i}${`/locations/${e}/${t}/unassign-user/`}`);return(0,l.f)(s.toString(),{method:"POST"})}},43515:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Pt});var l=s(65043),i=s(49367),n=s(94802),o=s(14282),a=s(27417),r=s(89082),d=s(62812),c=s(39759),u=s(58387),h=s(748),m=s(11520),p=s(79106);let x,v,g;function j(e){return new Date(new Date(e).getTime()-60*new Date(e).getTimezoneOffset()*1e3)}function f(e,t){const s=[],l=null===e||void 0===e?void 0:e.map((e=>{var l,i,n,o,a,r,d,c,u;let h=(null===e||void 0===e||null===(l=e.custom_status)||void 0===l?void 0:l.color)||"rgb(192, 192, 192)",m=null===e||void 0===e||null===(i=e.custom_status)||void 0===i?void 0:i.background,p=null===e||void 0===e||null===(n=e.custom_status)||void 0===n?void 0:n.font;const x=null!==e&&void 0!==e&&null!==(o=e.custom_status)&&void 0!==o&&o.title?`<div style='color:${p}; background:${m}; border: 1px solid ${h}; width: fit-content; max-width: 85px; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px;' title="${e.custom_status.title}">\n          <div style='max-width: 80px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 0px; white-space: nowrap; font-size: 12px;'>${e.custom_status.title}</div>\n        </div>`:"<div style='font-size: 12px;color: #344054; background: #F2F4F7; border: 1px solid rgba(0, 0, 0, 0.498); width: fit-content; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px'>No status</div>";let v="not-started";0===e.jobs_count&&0===e.jobs_count?v="not-started":e.jobs_done===e.jobs_count?v="done":0===e.jobs_done?v="not-done":e.jobs_done&&(v="pending");const f=new Date(1e3*parseInt(e.booking_end));f.setHours(23,59,59,999);let b=f<new Date;s.push({start:j(1e3*+e.booking_start),end:j(1e3*+e.booking_end),id:e.unique_id,cssClass:"project-item",resource:e.unique_id,backColor:m,borderColor:h,tag:{number:e.number,reference:e.reference,value:e.id,type:"project"},text:`<ul class="eventStyleCal">\n        <li>\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_6815_57879)"><rect width="24" height="24" rx="4" fill="url(#paint0_linear_6815_57879)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="23.25" height="23.25" rx="3.625" stroke="#101828" stroke-width="0.75"/></g><g clip-path="url(#clip1_6815_57879)">\n            <path d="M8.57171 7.28592C8.57171 7.04923 8.76359 6.85735 9.00028 6.85735H9.85742C10.0941 6.85735 10.286 7.04923 10.286 7.28592V8.14307C10.286 8.37976 10.0941 8.57164 9.85742 8.57164H9.00028C8.76359 8.57164 8.57171 8.37976 8.57171 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M11.1431 7.28592C11.1431 7.04923 11.335 6.85735 11.5717 6.85735H12.4289C12.6655 6.85735 12.8574 7.04923 12.8574 7.28592V8.14307C12.8574 8.37976 12.6655 8.57164 12.4289 8.57164H11.5717C11.335 8.57164 11.1431 8.37976 11.1431 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M14.1431 6.85735C13.9064 6.85735 13.7146 7.04923 13.7146 7.28592V8.14307C13.7146 8.37976 13.9064 8.57164 14.1431 8.57164H15.0003C15.237 8.57164 15.4289 8.37976 15.4289 8.14307V7.28592C15.4289 7.04923 15.237 6.85735 15.0003 6.85735H14.1431Z" fill="#667085"/>\n            <path d="M8.57171 9.85735C8.57171 9.62066 8.76359 9.42878 9.00028 9.42878H9.85742C10.0941 9.42878 10.286 9.62066 10.286 9.85735V10.7145C10.286 10.9512 10.0941 11.1431 9.85742 11.1431H9.00028C8.76359 11.1431 8.57171 10.9512 8.57171 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M11.5717 9.42878C11.335 9.42878 11.1431 9.62066 11.1431 9.85735V10.7145C11.1431 10.9512 11.335 11.1431 11.5717 11.1431H12.4289C12.6655 11.1431 12.8574 10.9512 12.8574 10.7145V9.85735C12.8574 9.62066 12.6655 9.42878 12.4289 9.42878H11.5717Z" fill="#667085"/>\n            <path d="M13.7146 9.85735C13.7146 9.62066 13.9064 9.42878 14.1431 9.42878H15.0003C15.237 9.42878 15.4289 9.62066 15.4289 9.85735V10.7145C15.4289 10.9512 15.237 11.1431 15.0003 11.1431H14.1431C13.9064 11.1431 13.7146 10.9512 13.7146 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M9.00028 12.0002C8.76359 12.0002 8.57171 12.1921 8.57171 12.4288V13.2859C8.57171 13.5226 8.76359 13.7145 9.00028 13.7145H9.85742C10.0941 13.7145 10.286 13.5226 10.286 13.2859V12.4288C10.286 12.1921 10.0941 12.0002 9.85742 12.0002H9.00028Z" fill="#667085"/>\n            <path d="M11.1431 12.4288C11.1431 12.1921 11.335 12.0002 11.5717 12.0002H12.4289C12.6655 12.0002 12.8574 12.1921 12.8574 12.4288V13.2859C12.8574 13.5226 12.6655 13.7145 12.4289 13.7145H11.5717C11.335 13.7145 11.1431 13.5226 11.1431 13.2859V12.4288Z" fill="#667085"/>\n            <path d="M14.1431 12.0002C13.9064 12.0002 13.7146 12.1921 13.7146 12.4288V13.2859C13.7146 13.5226 13.9064 13.7145 14.1431 13.7145H15.0003C15.237 13.7145 15.4289 13.5226 15.4289 13.2859V12.4288C15.4289 12.1921 15.237 12.0002 15.0003 12.0002H14.1431Z" fill="#667085"/>\n            <path d="M6.85742 6.00021C6.85742 5.52682 7.24118 5.14307 7.71456 5.14307H16.286C16.7594 5.14307 17.1431 5.52682 17.1431 6.00021V18.0002C17.1431 18.4736 16.7594 18.8574 16.286 18.8574H7.71456C7.24118 18.8574 6.85742 18.4736 6.85742 18.0002V6.00021ZM16.286 6.00021L7.71456 6.00021V18.0002H10.286V15.8574C10.286 15.6207 10.4779 15.4288 10.7146 15.4288H13.286C13.5227 15.4288 13.7146 15.6207 13.7146 15.8574V18.0002H16.286V6.00021Z" fill="#667085"/></g></g><defs><linearGradient id="paint0_linear_6815_57879" x1="12" y1="0" x2="12" y2="24" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_6815_57879"><rect width="24" height="24" rx="4" fill="white"/></clipPath><clipPath id="clip1_6815_57879"><rect width="13.7143" height="13.7143" fill="white" transform="translate(5.14307 5.14307)"/></clipPath></defs>\n          </svg>\n          &nbsp;\n          <strong style="color: ${p}; font-weight: 400">${e.reference}</strong>\n        </li>\n      </ul>`});const y=(null===(a=e.tasks.filter((e=>!e.finished)))||void 0===a?void 0:a.length)||0,C=e.tasks.length,w=[];w.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M10.875 2.25C11.0821 2.25 11.25 2.41789 11.25 2.625V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V2.625C0.75 2.41789 0.917893 2.25 1.125 2.25H10.875ZM1.125 1.5C0.50368 1.5 0 2.00368 0 2.625V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V2.625C12 2.00368 11.4963 1.5 10.875 1.5H1.125Z" fill="#475467"/>\n                <path d="M5.25 4.125C5.25 3.91789 5.41789 3.75 5.625 3.75H9.375C9.58211 3.75 9.75 3.91789 9.75 4.125C9.75 4.33211 9.58211 4.5 9.375 4.5H5.625C5.41789 4.5 5.25 4.33211 5.25 4.125Z" fill="#475467"/>\n                <path d="M4.12767 3.48484C4.27411 3.63128 4.27411 3.86872 4.12767 4.01516L3.00267 5.14016C2.85622 5.28661 2.61878 5.28661 2.47234 5.14016L2.09734 4.76516C1.95089 4.61872 1.95089 4.38128 2.09734 4.23484C2.24378 4.08839 2.48122 4.08839 2.62767 4.23484L2.7375 4.34467L3.59734 3.48484C3.74378 3.33839 3.98122 3.33839 4.12767 3.48484Z" fill="#475467"/>\n                <path d="M5.25 7.125C5.25 6.91789 5.41789 6.75 5.625 6.75H9.375C9.58211 6.75 9.75 6.91789 9.75 7.125C9.75 7.33211 9.58211 7.5 9.375 7.5H5.625C5.41789 7.5 5.25 7.33211 5.25 7.125Z" fill="#475467"/>\n                <path d="M4.12767 6.48484C4.27411 6.63128 4.27411 6.86872 4.12767 7.01516L3.00267 8.14017C2.85622 8.28661 2.61878 8.28661 2.47234 8.14017L2.09734 7.76517C1.95089 7.61872 1.95089 7.38128 2.09734 7.23484C2.24378 7.08839 2.48122 7.08839 2.62767 7.23484L2.7375 7.34467L3.59734 6.48484C3.74378 6.33839 3.98122 6.33839 4.12767 6.48484Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Tasks</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(r=e.tasks)||void 0===r||r.forEach((e=>{var t;s.push({start:j(1e3*+e.from_date),end:j(1e3*+e.to_date),id:e.id,cssClass:"childEvent task-item",resource:e.id,backColor:e.finished?"#DCFAE6":"#F2F4F7",borderColor:e.finished?"#DCFAE6":"#F2F4F7",text:e.title,tag:{type:"task",task:e}});const l=e.finished?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>';w.push({id:e.id,name:`<div class="d-flex flex-column">\n            <div task-id="${e.id}" class="task-list rowResourceEvent" style="--main-color: ${h}" task-id="${e.id}">\n              <div class="flex">\n                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_5999_560822)"><rect width="16" height="16" rx="8" fill="url(#paint0_linear_5999_560822)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="15.25" height="15.25" rx="7.625" stroke="#101828" stroke-width="0.75"/></g>\n                  <path d="M6.57129 6.28585C6.41349 6.28585 6.28557 6.41377 6.28557 6.57157C6.28557 6.72936 6.41349 6.85728 6.57129 6.85728H9.42843C9.58623 6.85728 9.71415 6.72936 9.71415 6.57157C9.71415 6.41377 9.58623 6.28585 9.42843 6.28585H6.57129Z" fill="#475467"/>\n                  <path d="M6.57129 7.42871C6.41349 7.42871 6.28557 7.55663 6.28557 7.71443C6.28557 7.87222 6.41349 8.00014 6.57129 8.00014H8.28557C8.44337 8.00014 8.57129 7.87222 8.57129 7.71443C8.57129 7.55663 8.44337 7.42871 8.28557 7.42871H6.57129Z" fill="#475467"/>\n                  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99986 4.57157C8.63104 4.57157 9.14272 4.05989 9.14272 3.42871H10.5713C11.0447 3.42871 11.4284 3.81247 11.4284 4.28585V11.7144C11.4284 12.1878 11.0447 12.5716 10.5713 12.5716H5.42843C4.95505 12.5716 4.57129 12.1878 4.57129 11.7144V4.28585C4.57129 3.81247 4.95505 3.42871 5.42843 3.42871H6.857C6.857 4.05989 7.36868 4.57157 7.99986 4.57157ZM7.99986 5.143C8.74627 5.143 9.38127 4.66596 9.6166 4.00014H10.5713C10.7291 4.00014 10.857 4.12806 10.857 4.28585V11.7144C10.857 11.8722 10.7291 12.0001 10.5713 12.0001H5.42843C5.27064 12.0001 5.14272 11.8722 5.14272 11.7144V4.28585C5.14272 4.12806 5.27064 4.00014 5.42843 4.00014H6.38312C6.61846 4.66596 7.25345 5.143 7.99986 5.143Z" fill="#475467"/></g><defs><linearGradient id="paint0_linear_5999_560822" x1="8" y1="0" x2="8" y2="16" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_5999_560822"><rect width="16" height="16" rx="8" fill="white"/></clipPath></defs>\n                </svg>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===e||void 0===e||null===(t=e.assigned_to)||void 0===t?void 0:t.name}</span>\n                  <span class="task-title">${e.title}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===l?"completed-class":"incomplete-class"}">\n                ${l}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),w.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(d=e.tasks)&&void 0!==d&&d.length?"45px":"40px"}">\n              <button class="create-task-button" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}" style="margin-bottom: ${null!==(c=e.tasks)&&void 0!==c&&c.length?"16px":"6px"}">Create Task\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0});let N=0,A=0;var _,S,F,k,E,$;t&&(N=(null===e||void 0===e||null===(_=e.jobs)||void 0===_||null===(S=_.filter((e=>!e.finished)))||void 0===S?void 0:S.length)||0,A=(null===e||void 0===e||null===(F=e.jobs)||void 0===F?void 0:F.length)||0,w.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M4.875 0.75C4.2538 0.75 3.75 1.25338 3.75 1.87482V2.25H1.125C0.50368 2.25 0 2.75368 0 3.375V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V3.375C12 2.75368 11.4963 2.25 10.875 2.25H8.25V1.87482C8.25 1.25338 7.7462 0.75 7.125 0.75H4.875ZM4.875 1.5H7.125C7.33223 1.5 7.5 1.66847 7.5 1.87546V2.25H4.5V1.87482C4.5 1.66783 4.66777 1.5 4.875 1.5ZM6.28987 6.68581L11.25 5.3631V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V5.3631L5.71013 6.68581C5.90006 6.73645 6.09994 6.73645 6.28987 6.68581ZM1.125 3H10.875C11.0821 3 11.25 3.16789 11.25 3.375V4.5869L6.09662 5.96113C6.03331 5.97801 5.96669 5.97801 5.90338 5.96113L0.75 4.5869V3.375C0.75 3.16789 0.917893 3 1.125 3Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Jobs</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(k=e.jobs)||void 0===k||k.forEach(((e,t)=>{var l,i,n,o;s.push({start:j(1e3*+e.start_date),end:j(1e3*+e.end_date),id:`job_${e.id}_${t}`,cssClass:"childEvent job-item",resource:e.id,backColor:e.finished?"#DCFAE6":"#F2F4F7",borderColor:e.finished?"#DCFAE6":"#F2F4F7",text:e.short_description,tag:{type:"job",job:e},resizeDisabled:!0});const a="5"===e.status?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>',r=(null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.alias)||"",d=null!==e&&void 0!==e&&null!==(i=e.worker)&&void 0!==i&&i.has_photo?`<img src="${null===e||void 0===e||null===(n=e.worker)||void 0===n?void 0:n.photo}" style="width: 20px; height: 20px; border-radius: 50%;" onerror="this.outerHTML='<div class=\\'job-alias\\'>${r}</div>'" />`:`<div class="job-alias">${r}</div>`;w.push({id:e.id,name:`<div class="d-flex flex-column job-resource-child" job-id="${e.id}">\n            <div class="task-list rowResourceEvent" style="--main-color: ${h}">\n              <div class="flex">\n                <div class="job-icon">\n                 ${d}\n                </div>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===e||void 0===e||null===(o=e.worker)||void 0===o?void 0:o.full_name}</span>\n                  <span class="task-title">${e.short_description}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===a?"completed-class":"incomplete-class"}">\n                ${a}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),w.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(E=e.tasks)&&void 0!==E&&E.length?"45px":"40px"}">\n              <button class="createJobButton" project-id="${e.id}" style="margin-bottom: ${null!==($=e.tasks)&&void 0!==$&&$.length?"16px":"6px"}">\n                Create Job\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0}));const I=y+N,T=C+A;return{id:e.unique_id,expanded:g===e.unique_id,name:`<div class="resourceList rowResourceEvent" style="--main-color: ${h};">\n        <ul class="resourceMan me-2">\n          <li title="${e.number}">\n            <div style="width: 70px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 2px; white-space: nowrap;" class="">${e.number}</div>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M5 4C4.72386 4 4.5 4.22386 4.5 4.5C4.5 4.77614 4.72386 5 5 5H11C11.2761 5 11.5 4.77614 11.5 4.5C11.5 4.22386 11.2761 4 11 4H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M4.5 6.5C4.5 6.22386 4.72386 6 5 6H11C11.2761 6 11.5 6.22386 11.5 6.5C11.5 6.77614 11.2761 7 11 7H5C4.72386 7 4.5 6.77614 4.5 6.5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 8C4.72386 8 4.5 8.22386 4.5 8.5C4.5 8.77614 4.72386 9 5 9H11C11.2761 9 11.5 8.77614 11.5 8.5C11.5 8.22386 11.2761 8 11 8H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 10C4.72386 10 4.5 10.2239 4.5 10.5C4.5 10.7761 4.72386 11 5 11H8C8.27614 11 8.5 10.7761 8.5 10.5C8.5 10.2239 8.27614 10 8 10H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M2 2C2 0.89543 2.89543 0 4 0H12C13.1046 0 14 0.89543 14 2V14C14 15.1046 13.1046 16 12 16H4C2.89543 16 2 15.1046 2 14V2ZM12 1H4C3.44772 1 3 1.44772 3 2V14C3 14.5523 3.44772 15 4 15H12C12.5523 15 13 14.5523 13 14V2C13 1.44772 12.5523 1 12 1Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M11 7.5C11 7.22386 11.2239 7 11.5 7H12.5C12.7761 7 13 7.22386 13 7.5V8.5C13 8.77614 12.7761 9 12.5 9H11.5C11.2239 9 11 8.77614 11 8.5V7.5Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M3.5 0C3.77614 0 4 0.223858 4 0.5V1H12V0.5C12 0.223858 12.2239 0 12.5 0C12.7761 0 13 0.223858 13 0.5V1H14C15.1046 1 16 1.89543 16 3V14C16 15.1046 15.1046 16 14 16H2C0.895431 16 0 15.1046 0 14V3C0 1.89543 0.895431 1 2 1H3V0.5C3 0.223858 3.22386 0 3.5 0ZM2 2C1.44772 2 1 2.44772 1 3V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V3C15 2.44772 14.5523 2 14 2H2Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V5C13.5 5.27614 13.2761 5.5 13 5.5H3C2.72386 5.5 2.5 5.27614 2.5 5V4Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M4 10.7813C4.14782 12.4484 5.51294 13.6306 7.59107 13.7837V15H8.63448V13.7837C10.9039 13.6051 12.3125 12.3463 12.3125 10.4836C12.3125 8.89307 11.3647 7.97448 9.35617 7.45565L8.63448 7.26853V3.46659C9.75615 3.57716 10.5126 4.18104 10.7039 5.08262H12.1734C12.0082 3.4836 10.6343 2.33536 8.63448 2.20778V1H7.59107V2.23329C5.65207 2.46294 4.32172 3.70474 4.32172 5.38882C4.32172 6.84326 5.28687 7.87242 6.98241 8.3062L7.59107 8.4678V12.4994C6.44332 12.3293 5.65207 11.6999 5.46077 10.7813H4ZM7.39108 6.94532C6.34767 6.68165 5.79119 6.12029 5.79119 5.32928C5.79119 4.38518 6.49549 3.68773 7.59107 3.50061V6.99635L7.39108 6.94532ZM8.98228 8.81652C10.2692 9.13973 10.8343 9.67558 10.8343 10.5857C10.8343 11.6829 10.0083 12.4143 8.63448 12.5249V8.73147L8.98228 8.81652Z" fill="${e.is_invoice_created?"PAID"===e.paid?"#17B26A":"NOT PAID"===e.paid?"#F04438":"PARTIAL PAYMENT"===e.paid?"#fedf89":"#F79009":"#667085"}"/>\n            </svg>\n          </li>\n          <li>\n            <span class='${v}'>${e.jobs_done}/${e.jobs_count}</span>\n          </li>\n          <li>\n            ${b?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect width="24" height="24" rx="12" fill="#FEE4E2" />\n            <path d="M12.515 5.01896C12.344 5.00635 12.1722 5 12 5V4C12.1968 4 12.3931 4.00726 12.5885 4.02167L12.515 5.01896ZM14.5193 5.46905C14.1985 5.34533 13.8691 5.2454 13.5337 5.17008L13.7528 4.19438C14.1361 4.28046 14.5126 4.39467 14.8792 4.53605L14.5193 5.46905ZM15.889 6.17971C15.7458 6.08402 15.5994 5.99388 15.4503 5.90939L15.9432 5.0393C16.1136 5.13586 16.2809 5.23888 16.4446 5.34824C16.6082 5.4576 16.7674 5.5727 16.9219 5.69322L16.3066 6.48158C16.1715 6.37612 16.0322 6.27541 15.889 6.17971ZM17.7231 7.96934C17.5252 7.68829 17.3068 7.42218 17.0697 7.17321L17.794 6.48368C18.0649 6.76821 18.3145 7.07233 18.5407 7.39353L17.7231 7.96934ZM18.4672 9.32122C18.4012 9.16208 18.3296 9.00583 18.2526 8.85271L19.1458 8.40311C19.2339 8.5781 19.3157 8.75667 19.391 8.93853C19.4664 9.12039 19.5348 9.30453 19.5962 9.49054L18.6467 9.80423C18.5929 9.64147 18.5331 9.48035 18.4672 9.32122ZM18.9979 11.8282C18.9895 11.4846 18.9557 11.142 18.8969 10.8033L19.8822 10.6323C19.9494 11.0194 19.988 11.4109 19.9976 11.8037L18.9979 11.8282ZM18.8655 13.3656C18.8991 13.1967 18.9264 13.027 18.9474 12.8569L19.9398 12.9793C19.9159 13.1737 19.8847 13.3677 19.8463 13.5607C19.8079 13.7538 19.7625 13.9449 19.7102 14.1337L18.7464 13.867C18.7922 13.7018 18.8319 13.5346 18.8655 13.3656ZM17.914 15.745C18.0979 15.4546 18.2602 15.151 18.3995 14.8367L19.3137 15.2419C19.1545 15.6011 18.969 15.9481 18.7588 16.28L17.914 15.745ZM16.9497 16.9497C17.0715 16.828 17.1885 16.702 17.3005 16.5722L18.0577 17.2254C17.9297 17.3737 17.796 17.5177 17.6569 17.6569L16.9497 16.9497Z" fill="#F04438" />\n            <path d="M12 5C10.8488 5 9.71545 5.2839 8.70022 5.82655C7.68499 6.3692 6.81926 7.15386 6.17971 8.11101C5.54017 9.06816 5.14654 10.1683 5.03371 11.3139C4.92088 12.4595 5.09232 13.6153 5.53285 14.6788C5.97337 15.7423 6.66939 16.6808 7.55925 17.4111C8.44911 18.1414 9.50533 18.6409 10.6344 18.8655C11.7634 19.0901 12.9304 19.0327 14.032 18.6986C15.1336 18.3644 16.1358 17.7637 16.9497 16.9497L17.6569 17.6569C16.7266 18.5871 15.5812 19.2736 14.3223 19.6555C13.0633 20.0374 11.7296 20.1029 10.4393 19.8463C9.14895 19.5896 7.94183 19.0187 6.92486 18.1841C5.90788 17.3495 5.11243 16.2769 4.60897 15.0615C4.1055 13.846 3.90957 12.5251 4.03852 11.2159C4.16748 9.90659 4.61733 8.64933 5.34825 7.55544C6.07916 6.46155 7.06857 5.5648 8.22883 4.94463C9.38909 4.32446 10.6844 4 12 4V5Z" fill="#F04438" />\n            <path d="M11.5 7C11.7761 7 12 7.22386 12 7.5V12.7098L15.2481 14.5659C15.4878 14.7029 15.5711 15.0083 15.4341 15.2481C15.2971 15.4878 14.9917 15.5711 14.7519 15.4341L11.2519 13.4341C11.0961 13.3451 11 13.1794 11 13V7.5C11 7.22386 11.2239 7 11.5 7Z" fill="#F04438" />\n          </svg>':""}\n          </li>\n          <li class="text-end float-end me-2" style="width: 100px; flex: 1">\n            ${x}\n          </li>\n          <li class="me-3" style="position: relative;">\n            ${0!==I?`<div class="taskUnreadCount">${I}</div>`:""}\n            <div class="taskCount">${T||0}</div>\n          </li>\n        </ul>\n        <div class="project-content" unique-id="${e.unique_id}" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}">\n          <span class="small project-content-name" unique-id="${e.unique_id}">${null===e||void 0===e||null===(u=e.client)||void 0===u?void 0:u.name}</span>\n          <h2 class="project-content-name" unique-id="${e.unique_id}">${e.reference}</h2>\n        </div>\n      </div>`,children:w,minHeight:95}}));x.update({resources:l,events:s}),x.onResourceExpand=function(e){g=e.resource.id}}function b(e,t){try{x&&f(e,t)}catch(s){console.log(s)}}function y(e,t,s,l,i,n){try{!function(e,t,s,l,i,n){if(void 0===typeof window||!Boolean(window.DayPilot))return;v=window.DayPilot,x=new v.Scheduler(e,{days:365,scale:"Day",separators:[{color:"#48C1FF",width:4}],treeImage:"img/nochildren.png",rowMinHeight:110,cellWidth:73,eventEndSpec:"Date",durationBarVisible:!1,eventArrangement:"Cascade",eventMoveHandling:"Disabled",eventResizingStartEndEnabled:!0,timeRangeSelectedHandling:"Disabled",treeImageNoChildren:!1,rowHeaderWidth:380,timeHeaders:[{groupBy:"Month",format:"MMMM yyyy"},{groupBy:"Day",format:"d"}],treeEnabled:!0,progressiveRowRendering:!0,treePreventParentUsage:!1,scrollDelayEvents:0,infiniteScrollingEnabled:!0,infiniteScrollingStepDays:100}),x.onBeforeRowHeaderRender=function(e){e.row.cssClass="resourcesRow"};const o=(null===n||void 0===n?void 0:n.map((e=>{const t=new Date(1e3*+e.date);return new Date(t.toLocaleString("en-US",{timeZone:"Australia/Sydney"})).toISOString().split("T")[0]})))||[],a=(null===n||void 0===n?void 0:n.reduce(((e,t)=>{const s=new Date(1e3*+t.date);return e[new Date(s.toLocaleString("en-US",{timeZone:"Australia/Sydney"})).toISOString().split("T")[0]]=t.title,e}),{}))||{};console.log("holidaysList: ",o,a),x.onBeforeTimeHeaderRender=function(e){if(e.header.text="",e.header.toolTip="",1===e.header.level){const t=e.header.start.toLocaleString("en-US",{timeZone:"Australia/Sydney"}).split("T")[0];e.header.start&&o.includes(t)?(e.header.backColor="#F2FAFF",e.header.cssClass="holidayHeader",e.header.html=`\n          <div style="color: #1AB2FF; position: relative; width: 84px;">\n            <div style="position: absolute; top: -25px; left: 0px; z-index: 1;" class="tooltip-container">\n              <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" fill="#EBF8FF"/>\n                <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" stroke="#BAE8FF"/>\n                <path d="M16.1402 14.1098C16.2866 14.2563 16.2866 14.4937 16.1402 14.6402L13.8902 16.8902C13.8198 16.9605 13.7245 17 13.625 17C13.5255 17 13.4302 16.9605 13.3598 16.8902L12.2348 15.7652C12.0884 15.6187 12.0884 15.3813 12.2348 15.2348C12.3813 15.0884 12.6187 15.0884 12.7652 15.2348L13.625 16.0947L15.6098 14.1098C15.7563 13.9634 15.9937 13.9634 16.1402 14.1098Z" fill="#158ECC"/>\n                <path d="M10.625 8C10.8321 8 11 8.16789 11 8.375V8.75H17V8.375C17 8.16789 17.1679 8 17.375 8C17.5821 8 17.75 8.16789 17.75 8.375V8.75H18.5C19.3284 8.75 20 9.42157 20 10.25V18.5C20 19.3284 19.3284 20 18.5 20H9.5C8.67157 20 8 19.3284 8 18.5V10.25C8 9.42157 8.67157 8.75 9.5 8.75H10.25V8.375C10.25 8.16789 10.4179 8 10.625 8ZM9.5 9.5C9.08579 9.5 8.75 9.83579 8.75 10.25V18.5C8.75 18.9142 9.08579 19.25 9.5 19.25H18.5C18.9142 19.25 19.25 18.9142 19.25 18.5V10.25C19.25 9.83579 18.9142 9.5 18.5 9.5H9.5Z" fill="#158ECC"/>\n                <path d="M9.875 11C9.875 10.7929 10.0429 10.625 10.25 10.625H17.75C17.9571 10.625 18.125 10.7929 18.125 11V11.75C18.125 11.9571 17.9571 12.125 17.75 12.125H10.25C10.0429 12.125 9.875 11.9571 9.875 11.75V11Z" fill="#158ECC"/>\n              </svg>\n              <span class="tooltip-text">${a[t]}</span>\n            </div>\n            ${e.header.html}\n          </div>\n        `):6!==e.header.start.getDayOfWeek()&&0!==e.header.start.getDayOfWeek()||(e.header.cssClass="weekendHeader",e.header.backColor="#F9FAFB")}},x.onBeforeEventRender=function(e){e.data.areas=[{top:0,left:0,right:0,width:1,cssClass:"childEventborder",text:e.data.text,backColor:e.data.borderColor,fontColor:"#ffffff",horizontalAlignment:"center",style:"border-top-left-radius: 4px; border-bottom-left-radius: 4px; background-color: #0000007f; color: #ffffff; padding: 2px;height: 36px;"}],e.data.text="Event details"},x.onEventClicked=function(e){const t=e.e.id();if(e.div.className.includes("task-item")&&t)s(t,!1);else if(e.div.className.includes("project-item")&&t){const l=e.e.tag();s(t,!0,l)}else if(e.div.className.includes("job-item")&&t){const l=e.e.tag();s(t,!0,l)}},x.onBeforeCellRender=function(e){6!==e.cell.start.getDayOfWeek()&&0!==e.cell.start.getDayOfWeek()||(e.cell.backColor="#F9FAFB");const t=e.cell.start.toLocaleString("en-US",{timeZone:"Australia/Sydney"}).split("T")[0];e.cell.start&&o.includes(t)&&(e.cell.backColor="#F2FAFF")},x.onEventResize=async function(e){const t=e.e.id(),s=new Date(e.newStart).toISOString(),i=new Date(e.newEnd).toISOString();if(console.log("args.e.tag().type: ",e.e.tag().type),"task"===e.e.tag().type){const l=e.e.tag().task;try{await(0,p.lC)(t,{title:l.title,description:l.description,user:l.assigned_to.id,from_date:s,to_date:i}),x.message("The task has been successfully updated.",{cssClass:"success_message"})}catch(n){console.log(n),x.message("An error occurred while updating the task. Please try again.")}}if("project"===e.e.tag().type)try{await(0,m.mw)(t,{booking_start:s,booking_end:i}),x.message("The project schedule has been successfully updated.",{cssClass:"success_message"}),l()}catch(n){console.log(n),x.message("An error occurred while updating the project schedule. Please try again.")}},x.init(),f(t,i)}(e,t,s,l,i,n)}catch(o){console.log(o)}}var C=s(623),w=s(57189),N=s(48417),A=s(11281),_=s(56008),S=s(65975),F=s(64196),k=s(36097),E=s(10615),$=s(73898),I=s(94673),T=s(38345),L=s(44713),D=s(56741),B=s(19e3),R=s(71807),H=s(52572),P=s(72413),M=s(99832),z=s(27066),O=s(38300),V=s(22927),U=s(90991),q=s(33361),Z=s(93202),G=s(72970),W=s(88578),J=s(78869),K=s(70836),Y=s(73216),X=s(35475),Q=s(47097),ee=s(9642),te=s(64824),se=s(93740),le=s(78602),ie=s(32952),ne=s(61072),oe=s(56328);const ae=s.p+"static/media/addNoteModeIcon.43bdc8582f3ef769329a44f15a05fe67.svg";var re=s(70579);const de=e=>{let{projectId:t,projectCardData:s}=e;const[i,n]=(0,l.useState)(!1),[a,r]=(0,l.useState)(""),[d,c]=(0,l.useState)({description:""}),u=2e3,h=()=>n(!1),p=(0,Q.n)({mutationFn:e=>(0,m.o2)(t,e),onSuccess:()=>{h(),s(t)},onError:e=>{console.error("Error creating note:",e),c((t=>({...t,description:e.message||"Failed to save note. Please try again."})))}}),x=e=>e.trim()?e.length<3?"Note must be at least 3 characters long":e.length>u?"Note must not exceed 2000 characters":/^\s+$/.test(e)?"Note cannot contain only whitespace":"":"Note is required";return(0,l.useEffect)((()=>{i||(r(""),c({description:""}))}),[i]),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"linkByttonStyle py-2 border-right",onClick:()=>n(!0),children:"Add Note"}),(0,re.jsxs)(ie.A,{show:i,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:h,animation:!1,size:"lg",children:[(0,re.jsxs)(ie.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,re.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,re.jsxs)("span",{children:[(0,re.jsx)("img",{src:ae,alt:"AddNoteModeIcon"}),"Add Note"]})}),(0,re.jsx)("button",{className:"CustonCloseModal",onClick:h,children:(0,re.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,re.jsx)(ie.A.Body,{children:(0,re.jsx)("div",{className:"ContactModel",children:(0,re.jsx)(ne.A,{children:(0,re.jsx)(le.A,{children:(0,re.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,re.jsxs)("label",{htmlFor:"note-input",children:["Note ",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)("div",{className:"inputInfo "+(d.description?"error-border":""),children:(0,re.jsx)("textarea",{id:"note-input",type:"text",name:"note",value:a,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value;r(t);const s=x(t);c((e=>({...e,description:s})))},maxLength:u,rows:10,className:"w-100"})}),(0,re.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,re.jsx)("small",{className:d.description?"error-message":"text-muted",children:d.description||`${a.length}/2000 characters`})})]})})})})}),(0,re.jsx)(ie.A.Footer,{className:"pt-0",children:(0,re.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,re.jsx)(o.A,{variant:"outline-danger",onClick:h,disabled:p.isPending,children:"Cancel"}),(0,re.jsx)(o.A,{variant:"primary save",onClick:()=>{const e=x(a);e?c((t=>({...t,description:e}))):p.mutate({text:a.trim()})},disabled:p.isPending||!!d.description,children:p.isPending?"Saving...":"Save"})]})})]})]})};var ce=s(93747),ue=s(59638),he=s(81047),me=s(81242);const pe=e=>{var t;let{clientId:s,projectId:i,projectCardData:n}=e;const o=(0,Y.Zp)(),[,a]=(0,l.useState)({}),[r,d]=(0,l.useState)(!1),c=(0,ce.I)({queryKey:["getOutgoingEmail"],queryFn:he.hx}),u=(0,ce.I)({queryKey:["getClientById",s],queryFn:()=>(0,ue.EZ)(s),enabled:!!s,retry:1}),h=(0,Q.n)({mutationFn:e=>(0,m.jy)(i,"",e),onSuccess:()=>{d(!1),n(),oe.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),oe.oR.error("Failed to send email. Please try again.")}});return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"linkByttonStyle py-2 ps-0",onClick:()=>{var e;"no-reply@memate.com.au"!==(null===c||void 0===c||null===(e=c.data)||void 0===e?void 0:e.outgoing_email)?d(!0):o("/settings/integrations?openEmail=true")},children:"Compose Email"}),(0,re.jsx)(me.A,{show:r,isLoading:!1,mutation:h,setShow:d,setPayload:a,contactPersons:(null===u||void 0===u||null===(t=u.data)||void 0===t?void 0:t.contact_persons)||[],isComposeEmail:!0})]})};var xe=s(69956),ve=s(94819),ge=s(89488),je=s(86213),fe=s(74856);const be=s.p+"static/media/folderFileIcon.ea8d1ab0e5f9d712876b6e6f3e9f303d.svg";var ye=s(95753);const Ce=e=>{var t;let{projectId:s}=e;const[i,n]=(0,l.useState)([]),[a,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),[u,h]=(0,l.useState)(""),[p,x]=(0,l.useState)(!1),v=localStorage.getItem("access_token"),g=()=>{c(!1)},j=(0,ce.I)({queryKey:["id",s],queryFn:()=>(0,m.pV)(s),enabled:!!s&&!!d,retry:1,staleTime:0,cacheTime:0}),f=async(e,t)=>je.A.put(t,e,{headers:{"Content-Type":""},onUploadProgress:s=>{const l=Math.round(s.loaded/s.total*100);n((s=>s.map((s=>s.name===e.name?Object.assign(s,{progress:l,url:t}):s))))}}).catch((s=>{console.log("err: ",s),n((s=>s.map((s=>s.name===e.name?Object.assign(s,{progress:0,url:t,error:!0}):s))))})),{getRootProps:b,getInputProps:y}=(0,ge.VB)({maxFiles:1,multiple:!1,accept:{"application/pdf":[".pdf",".png",".jpg",".jpeg",".mp4"]},maxSize:26214400,onDrop:e=>{const t=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0})));n((()=>[...t])),(async e=>{if(e.length){if(!v)return oe.oR.error("Access token is missing. Please log in again.");for(const l of e){const e=Date.now(),i=l.name.split("."),o=i.pop(),a=`${i.join(".")}-${e}.${o}`;try{x(!0);const e=await je.A.post(`https://app.memate.com.au/api/v1/projects/file/${s}/`,{file_name:a},{headers:{Authorization:`Bearer ${v}`}}),{url:t}=e.data;if(!t)return n([]),void oe.oR.error(`Failed to upload ${l.name}. Please try again.`);await f(l,t),null===j||void 0===j||j.refetch(),oe.oR.success(`Successfully uploaded ${l.name}`)}catch(t){console.error("Error uploading file:",l.name,t),oe.oR.error(`Failed to upload ${l.name}. Please try again.`)}finally{x(!1)}}}})(t)}}),C=(0,Q.n)({mutationFn:e=>(0,m.m2)(s,e),onSuccess:()=>{oe.oR.success("File deleted successfully"),null===j||void 0===j||j.refetch(),C.reset()},onError:()=>{oe.oR.error("Failed to delete file")}});return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(o.A,{className:" filebut fileActive",onClick:()=>{c(!0)},children:["Files ",(0,re.jsx)("img",{src:be,alt:"FolderFileIcon"})]}),(0,re.jsxs)(ie.A,{show:d,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject taskModelProjectFiles",onHide:g,animation:!1,children:[(0,re.jsxs)(ie.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,re.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start py-2",children:(0,re.jsx)("span",{children:"Integrated File System"})}),(0,re.jsx)("button",{className:"CustonCloseModal",onClick:g,children:(0,re.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,re.jsxs)(ie.A.Body,{children:[(0,re.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,re.jsx)("h2",{style:{fontSize:"22px"},children:"All Files"}),(0,re.jsxs)("div",{className:"d-flex justify-content-end align-items-center",children:[(0,re.jsx)(o.A,{className:"solid-button py-1 me-3 font-14",onClick:()=>r(!a),children:"Add"}),(0,re.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,re.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,re.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,re.jsx)("input",{type:"text",placeholder:"Search",value:u,onChange:e=>h(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})]}),a&&(0,re.jsxs)("div",{...b({className:"dropzone d-flex justify-content-center align-items-center flex-column cursor-pointer mb-4"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"16px"},children:[(0,re.jsx)("input",{...y()}),(0,re.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:p?(0,re.jsx)(se.p,{style:{width:"18px",height:"18px"}}):(0,re.jsx)(xe.A,{})}),(0,re.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,re.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]})]}),(0,re.jsx)("div",{style:{height:"300px",overflow:"auto"},children:(0,re.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[!(null!==j&&void 0!==j&&j.isLoading)&&(null===j||void 0===j||null===(t=j.data)||void 0===t?void 0:t.map((e=>{var t;return(0,re.jsxs)("div",{style:{background:"#F2F4F7",padding:"12px",borderRadius:"6px",height:"fit-content",marginBottom:"8px"},className:"d-flex align-items-center justify-content-between gap-4",children:[(0,re.jsxs)(X.N_,{to:`${e.url}`,target:"_blank",className:"d-flex align-items-center gap-2",children:[(0,A.I)(null===e||void 0===e||null===(t=e.key)||void 0===t?void 0:t.split(".").pop(),28),(0,re.jsxs)("div",{className:"font-14 d-flex flex-column",style:{width:"200px",color:"#344054"},children:[(0,re.jsx)("div",{title:null===e||void 0===e?void 0:e.key,className:"ellipsis-width",children:null===e||void 0===e?void 0:e.key}),(0,re.jsx)("small",{children:(0,ye.v)(null===e||void 0===e?void 0:e.size)})]})]}),(0,re.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>(async e=>{C.mutate(e)})(null===e||void 0===e?void 0:e.key),style:{background:"#FEE4E2",borderRadius:"200px",width:"30px",height:"30px"},children:null!==C&&void 0!==C&&C.isPending&&(null===C||void 0===C?void 0:C.variables)===(null===e||void 0===e?void 0:e.key)?(0,re.jsx)(se.p,{style:{width:"16px",height:"16px"}}):(0,re.jsx)(ve.A,{size:16,color:"#F04438",style:{cursor:"pointer"}})})]},null===e||void 0===e?void 0:e.key)}))),(null===j||void 0===j?void 0:j.isLoading)&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(fe.E,{width:"300px",height:57}),(0,re.jsx)(fe.E,{width:"300px",height:57}),(0,re.jsx)(fe.E,{width:"300px",height:57})]})]})})]}),(0,re.jsx)("div",{className:"CustonCloseModalBottom",children:(0,re.jsx)("button",{className:"but",onClick:g,children:"Close"})})]})]})};const we=s.p+"static/media/googleReviewIcon.0184cc6ef401c44935cf67effccb9dd0.svg",Ne=e=>{var t;let{clientId:s,projectId:i}=e;const[,n]=(0,l.useState)({}),[a,r]=(0,l.useState)(!1),d=(0,ce.I)({queryKey:["getClientById",s],queryFn:()=>(0,ue.EZ)(s),enabled:!!s,retry:1}),c=(0,Q.n)({mutationFn:e=>(0,m.jy)(i,"google-review",e),onSuccess:()=>{r(!1),oe.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),oe.oR.error("Failed to send email. Please try again.")}});return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(o.A,{className:"googleBut googleActive",onClick:()=>r(!0),children:["Review  ",(0,re.jsx)("img",{src:we,alt:"GoogleReview"})]}),(0,re.jsx)(me.A,{show:a,mutation:c,isLoading:!1,setShow:r,setPayload:n,contactPersons:(null===d||void 0===d||null===(t=d.data)||void 0===t?void 0:t.contact_persons)||[],defaultTemplateId:"Google Review"})]})};var Ae=s(46291),_e=s(77918),Se=s(75758),Fe=s(88060),ke=s(8868),Ee=s(28676),$e=s(74532),Ie=s(72052),Te=s(18226);const Le={headerTitle:"send-invoice_headerTitle__YBmdt",customLabel:"send-invoice_customLabel__0D26B",templateInfo:"send-invoice_templateInfo__osqvZ",bag:"send-invoice_bag__VXoPF",lable:"send-invoice_lable__hDm-2",dropdownSelect:"send-invoice_dropdownSelect__y4YWM",autoCompleteBox:"send-invoice_autoCompleteBox__sVyzX",AutoComplete:"send-invoice_AutoComplete__cCiBx",bcc:"send-invoice_bcc__KYSsZ",box:"send-invoice_box__pOjbC",active:"send-invoice_active__hBlO9",inputBox:"send-invoice_inputBox__gIZLk"};var De=s(36166);const Be=(0,re.jsxs)("span",{className:"ql-formats",children:[(0,re.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,re.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,re.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,re.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,re.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,re.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,re.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,re.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,re.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,re.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,re.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,re.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,re.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,re.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),Re=e=>{var t,s,i,n;let{show:a,setShow:r,contactPersons:d,setPayload:c,isLoading:h,create:p,projectId:x,projectCardData:v,isCreated:g}=e;const j=(0,l.useRef)(null),f=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[b,y]=(0,l.useState)(""),[C,w]=(0,l.useState)([]),[N,A]=(0,l.useState)([]),[_,S]=(0,l.useState)([]),[F,k]=(0,l.useState)(null),[E,$]=(0,l.useState)(null),[I,T]=(0,l.useState)(null),[L,D]=(0,l.useState)({}),[B,R]=(0,l.useState)([]),H=(0,l.useRef)(null),P=(0,l.useRef)(null),M=(0,l.useRef)(null),[z,O]=(0,l.useState)(!1),[V,U]=(0,l.useState)(!1),q=()=>r(!1),Z=(0,l.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),G=(0,l.useCallback)((e=>!e||0===e.length||e.every((e=>Z(e)))),[Z]),W=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>!Z(e))):[]),[Z]),J=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>Z(e))):[]),[Z]),K=(0,l.useCallback)((()=>{let e=!1;if(C.length>0){const t=W(C);t.length>0&&(console.log("Found invalid TO emails:",t),w(J(C)),e=!0)}if(N.length>0){const t=W(N);t.length>0&&(console.log("Found invalid CC emails:",t),A(J(N)),e=!0)}if(_.length>0){const t=W(_);t.length>0&&(console.log("Found invalid BCC emails:",t),S(J(_)),e=!0)}return!e}),[C,N,_,W,J]),[Y,X]=(0,l.useState)(null),ee=(0,ce.I)({queryKey:["emailTemplate"],queryFn:he.SQ}),te=(0,ce.I)({queryKey:["getSignatureTemplates"],queryFn:he.AO}),ae=(0,ce.I)({queryKey:["getOutgoingEmail"],queryFn:he.hx}),de=(0,ce.I)({queryKey:["emailQuery",Y],queryFn:()=>(0,he.hS)(Y),enabled:!!Y,retry:1});(0,l.useEffect)((()=>{var e,t,s;null!==ae&&void 0!==ae&&ae.data&&(null!==ae&&void 0!==ae&&null!==(e=ae.data)&&void 0!==e&&e.outgoing_email&&null!==ae&&void 0!==ae&&null!==(t=ae.data)&&void 0!==t&&t.outgoing_email_verified?y(null===ae||void 0===ae||null===(s=ae.data)||void 0===s?void 0:s.outgoing_email):y("no-reply@memate.com.au"))}),[de,ae]);const ue=(0,Q.n)({mutationFn:e=>g?(0,De.LG)(x,e):(0,m.fi)(x,e),onSuccess:()=>{q(),v(),oe.oR.success("Invoice created and send successfully.")},onError:e=>{console.error("Error creating task:",e),oe.oR.error("Failed to create and send invoice. Please try again.")}}),me=e=>{var t,s;const l=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=null===(s=d.map((e=>e.email)))||void 0===s?void 0:s.filter((e=>e));i=i.filter((e=>!C.includes(e))),i=i.filter((e=>!N.includes(e))),i=i.filter((e=>!_.includes(e))),i=i.filter((e=>e.toLowerCase().includes(l))),R(i)},pe=()=>{me(),H.current&&H.current.show()},xe=()=>{me(),P.current&&P.current.show()},ve=()=>{me(),M.current&&M.current.show()};return(0,l.useEffect)((()=>{if(null!==d&&void 0!==d&&d.length){var e;let t=null===(e=d.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));R(t)}}),[d]),(0,l.useEffect)((()=>{if(C.length>0){const e=W(C);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const t=J(C);w(t)}}}),[C,W,J]),(0,l.useEffect)((()=>{if(N.length>0){const e=W(N);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const t=J(N);A(t)}}}),[N,W,J]),(0,l.useEffect)((()=>{if(_.length>0){const e=W(_);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const t=J(_);S(t)}}}),[_,W,J]),(0,l.useEffect)((()=>{c((e=>({...e,subject:F,email_body:E,from_email:b,to:null===C||void 0===C?void 0:C.toString(),...N.length>0&&{cc:N.toString()},..._.length>0&&{bcc:_.toString()},...I&&{signature:I}})))}),[F,E,b,C,N,_,I,c]),(0,l.useEffect)((()=>{var e,t;null!==te&&void 0!==te&&te.data&&T(null===te||void 0===te||null===(e=te.data)||void 0===e||null===(t=e.find((e=>e.id===f.email_signature)))||void 0===t?void 0:t.id)}),[null===te||void 0===te?void 0:te.data,f.email_signature]),(0,l.useEffect)((()=>{var e,t;$((null===de||void 0===de||null===(e=de.data)||void 0===e?void 0:e.body)||""),k(null===de||void 0===de||null===(t=de.data)||void 0===t?void 0:t.subject),D((e=>({...e,subject:!1}))),D((e=>({...e,text:!1})))}),[null===de||void 0===de?void 0:de.data]),(0,l.useEffect)((()=>{if(null!==ee&&void 0!==ee&&ee.data){var e,t;const s=g?null===ee||void 0===ee||null===(e=ee.data)||void 0===e?void 0:e.find((e=>"Invoice"===e.type)):null===ee||void 0===ee||null===(t=ee.data)||void 0===t?void 0:t.find((e=>"Invoice"===e.type));X(null===s||void 0===s?void 0:s.id)}}),[null===ee||void 0===ee?void 0:ee.data,g]),(0,re.jsxs)(ie.A,{show:a,centered:!0,onHide:q,className:"invoice-form",size:"lg",children:[(0,re.jsx)(ie.A.Header,{closeButton:!0,children:(0,re.jsx)("div",{className:`${Le.modalHeader}`,children:(0,re.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,re.jsxs)("span",{className:`white-space-nowrap mt-2 mb-2 ${Le.headerTitle}`,children:[g?"Resend":"Send"," a Invoice"]})})})}),(0,re.jsxs)(ie.A.Body,{children:[(0,re.jsxs)(ne.A,{children:[(0,re.jsxs)(le.A,{sm:6,className:"mb-3",children:[(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"FROM"}),(0,re.jsx)(Fe.m,{options:ae&&(null===ae||void 0===ae?void 0:ae.data)&&[{value:null===ae||void 0===ae||null===(t=ae.data)||void 0===t?void 0:t.outgoing_email,label:`${null===ae||void 0===ae||null===(s=ae.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{y(e.value),D((e=>({...e,from:!1})))},value:b,filterInputAutoFocus:!0})]}),(null===L||void 0===L?void 0:L.from)&&(0,re.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,re.jsx)(le.A,{sm:6,className:"mb-3",children:(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"Templates"}),(0,re.jsx)(Fe.m,{options:ee&&(null===(i=ee.data)||void 0===i?void 0:i.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{X(e.value)},value:Y,loading:null===ee||void 0===ee?void 0:ee.isFetching,filterInputAutoFocus:!0}),(0,re.jsx)("div",{className:Le.templateInfo,onClick:e=>j.current.toggle(e),children:(0,re.jsx)(_e.A,{size:16,color:"#737374ff"})}),(0,re.jsxs)(Te.j,{ref:j,children:[(0,re.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,re.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,re.jsx)("br",{})," Profile Settings > Templates > Email",(0,re.jsx)("br",{})," Templates."]})]})]})})]}),(0,re.jsxs)(ne.A,{children:[(0,re.jsxs)(le.A,{sm:12,className:"mb-3",children:[(0,re.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,re.jsxs)("div",{style:{position:"relative"},className:Le.autoCompleteBox,children:[(0,re.jsx)("div",{style:{width:"50px"},className:Le.bag}),(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"TO"}),(0,re.jsx)(Se.j,{ref:H,value:C,completeMethod:me,onChange:e=>{w(e.value),D((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:B,onClick:pe,onFocus:pe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>Z(e)));w((e=>[...new Set([...e,...l])])),l.length===s.length&&l.length>0&&D((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(Z(t)?(w((e=>[...new Set([...e,t])])),D((e=>({...e,to:!1,toInvalid:!1})))):D((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,re.jsx)(o.A,{className:(0,u.A)(Le.box,{[Le.active]:z}),onClick:()=>{O(!z),A([])},children:"CC"}),(0,re.jsx)(o.A,{className:(0,u.A)(Le.box,{[Le.active]:V}),onClick:()=>{U(!V),S([])},children:"BCC"})]}),(null===L||void 0===L?void 0:L.to)&&!(null!==L&&void 0!==L&&L.toInvalid)&&(0,re.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===L||void 0===L?void 0:L.toInvalid)&&(0,re.jsxs)("div",{children:[(0,re.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===L||void 0===L?void 0:L.invalidToEmails)&&L.invalidToEmails.length>0&&(0,re.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",L.invalidToEmails.join(", ")]})]})]}),z&&(0,re.jsxs)(le.A,{sm:6,className:"mb-3",children:[(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("div",{style:{width:"50px"},className:Le.bag}),(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"CC"}),(0,re.jsx)(Se.j,{ref:P,value:N,completeMethod:me,onChange:e=>{A(e.value),D((e=>({...e,cc:!1})))},multiple:!0,suggestions:B,onClick:xe,onFocus:xe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>Z(e)));A((e=>[...new Set([...e,...l])])),l.length===s.length&&D((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(Z(t)?(A((e=>[...new Set([...e,t])])),D((e=>({...e,cc:!1})))):D((e=>({...e,cc:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===L||void 0===L?void 0:L.cc)&&(0,re.jsxs)("div",{children:[(0,re.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===L||void 0===L?void 0:L.invalidCcEmails)&&L.invalidCcEmails.length>0&&(0,re.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",L.invalidCcEmails.join(", ")]})]})]}),V&&(0,re.jsxs)(le.A,{sm:6,className:"mb-3",children:[(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("div",{style:{width:"60px"},className:Le.bag}),(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"BCC"}),(0,re.jsx)(Se.j,{ref:M,value:_,completeMethod:me,onChange:e=>{S(e.value),D((e=>({...e,bcc:!1})))},multiple:!0,suggestions:B,onClick:ve,onFocus:ve,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>Z(e)));S((e=>[...new Set([...e,...l])])),l.length===s.length&&D((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(Z(t)?(S((e=>[...new Set([...e,t])])),D((e=>({...e,bcc:!1})))):D((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,Le.bcc,"w-100"),placeholder:"BCC"})]}),(null===L||void 0===L?void 0:L.bcc)&&(0,re.jsxs)("div",{children:[(0,re.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===L||void 0===L?void 0:L.invalidBccEmails)&&L.invalidBccEmails.length>0&&(0,re.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",L.invalidBccEmails.join(", ")]})]})]}),(0,re.jsxs)(le.A,{sm:12,className:"mb-2",children:[(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("div",{style:{width:"60px"},className:Le.bag}),(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"SUBJECT"}),(0,re.jsxs)(Ee.C,{children:[(0,re.jsx)($e.m,{children:(null===de||void 0===de?void 0:de.isFetching)&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,re.jsx)(Ie.S,{value:F,className:(0,u.A)(Le.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{k(e.target.value),D((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===L||void 0===L?void 0:L.subject)&&(0,re.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,re.jsxs)(le.A,{sm:12,className:"mb-3",children:[(0,re.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,re.jsx)("label",{className:(0,u.A)(Le.lable),children:"Message"}),(0,re.jsx)($e.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===de||void 0===de?void 0:de.isFetching)&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,re.jsx)(ke.K,{style:{minHeight:"150px"},headerTemplate:Be,value:E,placeholder:"Enter a description...",onTextChange:e=>{$(e.htmlValue),D((e=>({...e,text:!1})))}})]}),(null===L||void 0===L?void 0:L.text)&&(0,re.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,re.jsx)(le.A,{sm:12,children:(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"Signature"}),(0,re.jsx)(Fe.m,{options:te&&(null===(n=te.data)||void 0===n?void 0:n.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{T(e.value)},value:I,loading:null===te||void 0===te?void 0:te.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,re.jsxs)(ie.A.Footer,{className:"d-flex justify-content-between",children:[(0,re.jsx)(o.A,{onClick:q,className:"text-button text-danger",children:"Cancel"}),(0,re.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[!g&&(0,re.jsxs)(o.A,{disabled:h,className:"outline-button",onClick:p,children:["Create and Save"," ",h&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,re.jsxs)(o.A,{className:"solid-button",disabled:null===ue||void 0===ue?void 0:ue.isPending,onClick:async()=>{let e=0;D({});if(K()||console.log("Some emails were invalid and have been cleaned"),b||(++e,D((e=>({...e,from:!0})))),0===(null===C||void 0===C?void 0:C.length))++e,D((e=>({...e,to:!0})));else if(!G(C)){++e;const t=W(C);console.log("Invalid TO emails:",t),D((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:t})))}if(N.length>0&&!G(N)){++e;const t=W(N);console.log("Invalid CC emails:",t),D((e=>({...e,cc:!0,invalidCcEmails:t})))}if(_.length>0&&!G(_)){++e;const t=W(_);console.log("Invalid BCC emails:",t),D((e=>({...e,bcc:!0,invalidBccEmails:t})))}F||(++e,D((e=>({...e,subject:!0})))),E||(++e,D((e=>({...e,text:!0})))),e||ue.mutate({subject:F,email_body:E,from_email:b,to:null===C||void 0===C?void 0:C.toString(),...N.length>0&&{cc:N.toString()},..._.length>0&&{bcc:_.toString()},...I&&{signature:I}})},children:[g?"Resend":"Create and Send"," ",(null===ue||void 0===ue?void 0:ue.isPending)&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})},He=e=>{var t;let{clientId:s,projectId:i,isLoading:n,create:a,projectCardData:r,isCreated:d}=e;const[c,u]=(0,l.useState)(!1),[,h]=(0,l.useState)({}),m=(0,ce.I)({queryKey:["id",s],queryFn:()=>(0,ue.EZ)(s),enabled:!!s,retry:1});return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(o.A,{className:"InvoiceAction InvoiceActive me-3",onClick:()=>u(!0),children:[d?"Resend":"Create"," Invoice  ",(0,re.jsx)("img",{src:Ae.A,alt:"Invoices"})]}),(0,re.jsx)(Re,{projectId:i,show:c,create:a,isLoading:n,setShow:u,setPayload:h,contactPersons:(null===m||void 0===m||null===(t=m.data)||void 0===t?void 0:t.contact_persons)||[],projectCardData:r,isCreated:d})]})};var Pe=s(98385);const Me=e=>{let{show:t,setShow:s,project:l,reInitialize:i}=e;const n=l.value;return(0,re.jsx)(re.Fragment,{children:t&&(0,re.jsx)(Pe.A,{show:t,setShow:s,projectId:n,refetch:i})})},ze=e=>{let{project:t,reInitialize:s,projectCardData:i}=e;const[n,o]=(0,l.useState)(!1);return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"linkByttonStyle py-2 border-right pe-5",onClick:()=>o(!0),children:"New Task"}),(0,re.jsx)(Me,{show:n,setShow:o,project:t,reInitialize:s,projectCardData:i})]})};var Oe=s(69767),Ve=s(83570),Ue=s(64967);const qe=[{icon:(0,re.jsx)(V.A,{size:16,color:"#1AB2FF"}),label:"Invoice",value:"invoice"},{icon:(0,re.jsx)(Oe.A,{size:16,color:"#1AB2FF"}),label:"Quote",value:"quote"},{icon:(0,re.jsx)(Ve.A,{size:16,color:"#1AB2FF"}),label:"System",value:"system"},{icon:(0,re.jsx)(z.A,{size:16,color:"#1AB2FF"}),label:"Notes",value:"note"},{icon:(0,re.jsx)(q.A,{size:16,color:"#1AB2FF"}),label:"Email",value:"email"},{icon:(0,re.jsx)(U.A,{size:16,color:"#1AB2FF"}),label:"SMS",value:"sms"},{icon:(0,re.jsx)(O.A,{size:16,color:"#1AB2FF"}),label:"Tasks",value:"task"},{icon:(0,re.jsx)(M.A,{size:16,color:"#1AB2FF"}),label:"Job Created",value:"job"},{icon:(0,re.jsx)(Ue.A,{size:16,color:"#1AB2FF"}),label:"Expense Linked",value:"order"}],Ze=e=>{let{setFilteredHistoryOptions:t}=e;const[s,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)([]);return(0,re.jsxs)("div",{className:"projectCardFilterDropdown",children:[(0,re.jsx)("span",{onClick:()=>i((e=>!e)),children:(0,re.jsx)(c.A,{size:20,color:"#344054"})}),s&&(0,re.jsxs)("div",{className:"dropdown-menuF px-0",children:[(0,re.jsxs)("button",{className:"all p-0 ps-2 pe-2 mx-2 text-left d-flex justify-content-between align-items-center rounded",style:{background:"#F9FAFB",width:"94%"},onClick:()=>{(null===n||void 0===n?void 0:n.length)>0?o([]):o(qe.map((e=>e.value)))},children:[(0,re.jsx)("span",{className:"border-0",style:{background:"transparent"},children:"All"}),qe.length===(null===n||void 0===n?void 0:n.length)&&(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,re.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(0,re.jsx)("ul",{className:"ps-3",children:qe.map((e=>{let{icon:t,label:s,value:l}=e;return(0,re.jsx)("li",{className:n.includes(s)?"active":"",onClick:()=>(e=>{o((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(l),children:(0,re.jsxs)("label",{htmlFor:s,className:"w-100 d-flex justify-content-between align-items-center",children:[(0,re.jsx)("input",{id:s,type:"checkbox",checked:n.includes(l),readOnly:!0,style:{cursor:"pointer",height:"40px"}}),(0,re.jsxs)("span",{className:"border-0",children:[t," ",s]}),n.includes(l)&&(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,re.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]})},s)}))}),(0,re.jsx)("hr",{}),(0,re.jsxs)("div",{className:"dropdown-buttonsF pb-2 px-3",children:[(0,re.jsx)("button",{className:"cancel",onClick:()=>o([]),children:"Cancel"}),(0,re.jsx)("button",{className:"apply",onClick:()=>{t(n),i(!1)},children:"Apply"})]})]})]})};const Ge=s.p+"static/media/OrdersIcon.bb129217463e985edc21ff683898e113.svg";var We=s(34168);const Je=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},Ke=e=>{let{startDate:t,endDate:s}=e;return(0,re.jsxs)(o.A,{className:"dateSelectdTaskBar schedule schActive",style:{minWidth:"160px",minHeight:"46px"},children:[Je(t,s)," ",(0,re.jsx)("img",{src:Ge,alt:"OrdersIcon"})]})},Ye=e=>{let{projectId:t,projectCardData:s,isFetching:i,startDate:n,endDate:a}=e;const[r,d]=(0,l.useState)({startDate:null,endDate:null}),[c,u]=(0,l.useState)(!1),h=(0,l.useRef)(null),p=(0,Q.n)({mutationFn:e=>(0,m.mw)(t,e),onSuccess:async()=>{s(t)},onError:e=>{d({startDate:null,endDate:null}),console.error("Error creating task:",e)}}),x=e=>{h.current&&!h.current.contains(e.target)&&u(!1)};return(0,l.useEffect)((()=>{n&&a&&d({startDate:new Date(1e3*+n),endDate:new Date(1e3*+a)})}),[n,a]),(0,l.useEffect)((()=>(c?document.addEventListener("mousedown",x):document.removeEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)})),[c]),(0,re.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:h,children:[(0,re.jsx)("div",{onClick:()=>u((e=>!e)),style:{cursor:"pointer"},children:null!==r&&void 0!==r&&r.startDate&&null!==r&&void 0!==r&&r.endDate&&!p.isPending?(0,re.jsx)(Ke,{isPending:p.isPending,startDate:r.startDate,endDate:r.endDate}):(0,re.jsx)(o.A,{className:"schedule schActive",style:{minWidth:"201px",minHeight:"46px"},children:p.isPending||i?(0,re.jsx)("div",{className:"dot-flashing"}):(0,re.jsxs)("span",{children:["Schedule Project  ",(0,re.jsx)("img",{src:Ge,alt:"OrdersIcon"})]})})}),c&&(0,re.jsx)("div",{className:"select-date-range",style:{position:"absolute",bottom:"40px",background:"#fff",zIndex:1e3},children:(0,re.jsx)(We.A,{onDataApply:e=>{p.mutate({booking_start:e.startDate,booking_end:e.endDate}),d(e),u(!1)},dateRange:r,onClose:()=>u(!1)})})]})};var Xe=s(66415),Qe=s(79726),et=s(3930),tt=s(35131);s(93066);const st={"#1AB2FF":{bg:"#BAE8FF",border:"#1AB2FF",color:"#0A4766",text:"Blue"},"#4E5BA6":{bg:"#EAECF5",border:"#4E5BA6",color:"#293056",text:"Deep Blue"},"#2970FF":{bg:"#D1E0FF",border:"#2970FF",color:"#0040C1",text:"Dark Blue"},"#FFB258":{bg:"#FFE8CD",border:"#FFB258",color:"#6D471A",text:"Orange"},"#15B79E":{bg:"#CCFBEF",border:"#15B79E",color:"#125D56",text:"Green"},"#66C61C":{bg:"#E3FBCC",border:"#66C61C",color:"#326212",text:"Light Green"},"#7A5AF8":{bg:"#EBE9FE",border:"#7A5AF8",color:"#4A1FB8",text:"Light Purple"},"#D444F1":{bg:"#FBE8FF",border:"#D444F1",color:"#821890",text:"Magenta"},"#F63D68":{bg:"#FFE4E8",border:"#F63D68",color:"#A11043",text:"Pink"},"#FF007F":{bg:"#FFCCE5",border:"#FF007F",color:"#6F0A3C",text:"Soft Pink"},"#FFD700":{bg:"#FFF8D1",border:"#FFD700",color:"#997100",text:"Yellow"},"#6C6C1C":{bg:"#E1E1B8",border:"#6C6C1C",color:"#444403",text:"Dark Yellow"}},lt=e=>{var t,s,i;let{projectId:n,statusOptions:o,custom_status:a}=e;const[r,d]=(0,l.useState)(null),c=(0,Q.n)({mutationFn:e=>(0,m.Np)(n,e),onSuccess:async()=>{},onError:e=>{d(a),console.error("Error creating task:",e)}});return(0,l.useEffect)((()=>{d(a)}),[a]),(0,re.jsx)(Qe.W,{menuButton:(0,re.jsxs)(et.I,{style:{width:"204px",display:"inline-flex",alignItems:"center",justifyContent:"flex-end",padding:"8px 0px",cursor:"pointer",background:"transparent",border:"none",color:"#98A2B3",gap:"10px"},children:[r&&r.title?(0,re.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,re.jsx)(re.Fragment,{children:c.isPending?(0,re.jsx)("div",{className:"dot-flashing"}):(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=st[null===r||void 0===r?void 0:r.color])||void 0===t?void 0:t.border}`}}),(0,re.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:`${null===(s=st[null===r||void 0===r?void 0:r.color])||void 0===s?void 0:s.bg}`},children:[(0,re.jsx)("span",{style:{color:`${null===(i=st[null===r||void 0===r?void 0:r.color])||void 0===i?void 0:i.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===r||void 0===r?void 0:r.title}),(0,re.jsx)("span",{className:"inArrow",children:(0,re.jsx)(Xe.A,{color:"#98A2B3",size:15})})]})]})})}):(0,re.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"h-100",style:{width:"4px",background:"#1D2939"}}),(0,re.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:"#F2F4F7"},children:[(0,re.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:"No Status"}),(0,re.jsx)("span",{className:"inArrow",children:(0,re.jsx)(Xe.A,{color:"#98A2B3",size:15})})]})]})})}),(0,re.jsx)("span",{className:"outArrow",children:(0,re.jsx)(Xe.A,{color:"#98A2B3",size:15})})]}),overflow:"auto",position:"anchor",children:null===o||void 0===o?void 0:o.map((e=>{var t,s,l;return(0,re.jsx)(tt.D,{style:{textAlign:"left"},onClick:()=>{var t;null!==(t=e)&&void 0!==t&&t.id&&(c.mutate({custom_status:null===t||void 0===t?void 0:t.id}),d(t))},children:(0,re.jsxs)("div",{className:"d-flex",style:{width:"163px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:[(0,re.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=st[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.border}`}}),(0,re.jsx)("div",{className:"h-100 d-flex align-items-center",style:{width:"100%",background:`${null===(s=st[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.bg}`},children:(0,re.jsx)("span",{style:{color:`${null===(l=st[null===e||void 0===e?void 0:e.color])||void 0===l?void 0:l.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===e||void 0===e?void 0:e.title})})]})},e.id)}))})};var it=s(17380),nt=s(17803);const ot={phoneInput:"send-sms_phoneInput__Qgh+S",countrySelector:"send-sms_countrySelector__y14UT",customLabel:"send-sms_customLabel__RzF9F",smsUnavailableAlert:"send-sms_smsUnavailableAlert__8Wmw4",smsIcon:"send-sms_smsIcon__mwlTu",twilioStatus:"send-sms_twilioStatus__9LyX9",twilioIcon:"send-sms_twilioIcon__vuhjt",disconnectedBadge:"send-sms_disconnectedBadge__L41qv",smsUnavailableText:"send-sms_smsUnavailableText__iot1y",settingsLink:"send-sms_settingsLink__DYIqa"},at=nt.PhoneNumberUtil.getInstance(),rt=e=>{try{return at.isValidNumber(at.parseAndKeepRawInput(e))}catch(t){return!1}},dt=e=>{var t;let{projectId:s,projectCardData:i}=e;(0,Y.Zp)();const[n,a]=(0,l.useState)(null),[r,d]=(0,l.useState)(!1),[c,h]=(0,l.useState)(!1),[p,x]=(0,l.useState)(""),[v,g]=(0,l.useState)({}),[j,f]=(0,l.useState)(""),b=()=>{d(!1),x(""),f(""),g({}),a(null)},y=(0,ce.I)({queryKey:["getSMSTemplates"],queryFn:he.pJ}),C=(0,ce.I)({queryKey:["smsQuery",n],queryFn:()=>(0,he.Mp)(n),enabled:!!n,retry:1}),w=(0,Q.n)({mutationFn:e=>(0,m.qm)(s,e),onSuccess:()=>{oe.oR.success("SMS send successfully"),b(),i()},onError:e=>{console.error("Error creating expense:",e),oe.oR.error("Failed to send sms. Please try again.")}});return(0,l.useEffect)((()=>{var e;null!==C&&void 0!==C&&null!==(e=C.data)&&void 0!==e&&e.text&&(x(C.data.text),g((e=>({...e,message:!1}))))}),[C.data]),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("div",{className:"linkByttonStyle py-2 border-right text-center ps-0",onClick:()=>{const e=JSON.parse(window.localStorage.getItem("profileData")||"{}");null!==e&&void 0!==e&&e.has_twilio?d(!0):h(!0)},children:"Send SMS"}),(0,re.jsxs)(ie.A,{show:c,onHide:()=>h(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,re.jsxs)(ie.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,re.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,re.jsxs)("span",{children:[(0,re.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,re.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,re.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,re.jsx)("path",{d:"M20.0168 34.3409C20.3324 34.6574 20.4904 35.0981 20.4479 35.5431C20.3524 36.5401 20.1325 37.5778 19.8502 38.5417C21.9425 38.0581 23.2204 37.4972 23.8012 37.2028C24.1309 37.0357 24.5107 36.9963 24.8677 37.092C25.8545 37.3566 26.9061 37.5 28 37.5C33.9934 37.5 38.5 33.2887 38.5 28.5C38.5 23.7113 33.9934 19.5 28 19.5C22.0066 19.5 17.5 23.7113 17.5 28.5C17.5 30.7021 18.426 32.7456 20.0168 34.3409ZM19.2773 40.1984C19.2672 40.2004 19.2571 40.2024 19.247 40.2044C19.1093 40.2315 18.9688 40.2583 18.8257 40.2845C18.625 40.3212 18.419 40.357 18.2076 40.3916C17.9091 40.4405 17.6805 40.1282 17.7985 39.8496C17.8755 39.6676 17.9515 39.4769 18.0255 39.2791C18.0725 39.1535 18.1187 39.025 18.1639 38.8941C18.1658 38.8885 18.1678 38.8828 18.1697 38.8772C18.5413 37.7976 18.8439 36.5567 18.9547 35.4001C17.1146 33.5548 16 31.1413 16 28.5C16 22.701 21.3726 18 28 18C34.6274 18 40 22.701 40 28.5C40 34.299 34.6274 39 28 39C26.7749 39 25.5926 38.8394 24.4793 38.5408C23.7 38.9357 22.0215 39.6545 19.2773 40.1984Z",fill:"#F04438"}),(0,re.jsx)("path",{d:"M22 24.75C22 24.3358 22.3358 24 22.75 24H33.25C33.6642 24 34 24.3358 34 24.75C34 25.1642 33.6642 25.5 33.25 25.5H22.75C22.3358 25.5 22 25.1642 22 24.75ZM22 28.5C22 28.0858 22.3358 27.75 22.75 27.75H33.25C33.6642 27.75 34 28.0858 34 28.5C34 28.9142 33.6642 29.25 33.25 29.25H22.75C22.3358 29.25 22 28.9142 22 28.5ZM22 32.25C22 31.8358 22.3358 31.5 22.75 31.5H28.75C29.1642 31.5 29.5 31.8358 29.5 32.25C29.5 32.6642 29.1642 33 28.75 33H22.75C22.3358 33 22 32.6642 22 32.25Z",fill:"#F04438"})]}),(0,re.jsx)("span",{className:"ms-3",children:"SMS is currently unavailable"})]})}),(0,re.jsx)("button",{className:"CustonCloseModal",onClick:()=>h(!1),children:(0,re.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,re.jsx)(ie.A.Body,{children:(0,re.jsxs)("div",{className:"ContactModel",children:[(0,re.jsxs)("p",{className:ot.smsUnavailableText,children:["SMS functionality is currently unavailable. To use this",(0,re.jsx)("br",{})," feature, please ask your admin to set up a Twilio",(0,re.jsx)("br",{})," account and connect it via ",(0,re.jsx)("span",{className:ot.settingsLink,children:"Settings > Integrations"}),"."]}),(0,re.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",ot.twilioStatus),children:[(0,re.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center",ot.twilioIcon),children:[(0,re.jsx)("img",{src:"/static/media/twilio-logo.c9f32aa9e92765a4deb7.png",style:{width:"50px"}}),(0,re.jsx)("h6",{className:"mb-1",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Twilio"})]}),(0,re.jsxs)("span",{className:(0,u.A)("px-2 py-1",ot.disconnectedBadge),children:["Disconnected \xa0",(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"9",viewBox:"0 0 8 9",fill:"none",children:(0,re.jsx)("circle",{cx:"4",cy:"4.5",r:"3",fill:"#F79009"})})]})]})]})})]}),(0,re.jsxs)(ie.A,{show:r,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:b,animation:!1,children:[(0,re.jsxs)(ie.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,re.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,re.jsxs)("span",{children:[(0,re.jsx)("img",{src:ae,alt:"AddNoteModeIcon"}),"Send SMS"]})}),(0,re.jsx)("button",{className:"CustonCloseModal",onClick:b,children:(0,re.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,re.jsx)(ie.A.Body,{children:(0,re.jsxs)("div",{className:"ContactModel",children:[(0,re.jsxs)(ne.A,{children:[(0,re.jsx)(le.A,{sm:12,className:"mb-3",children:(0,re.jsxs)("div",{style:{position:"relative"},children:[(0,re.jsx)("label",{className:(0,u.A)(ot.customLabel),children:"Templates"}),(0,re.jsx)(Fe.m,{options:y&&(null===(t=y.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.title}`}))))||[],className:(0,u.A)(ot.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{a(e.value)},value:n,loading:null===y||void 0===y?void 0:y.isFetching,filterInputAutoFocus:!0})]})}),(0,re.jsx)(le.A,{children:(0,re.jsxs)("div",{className:"formgroup sendSMSPhone mb-2 mt-0",children:[(0,re.jsxs)("label",{children:["To",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)("div",{className:"inputInfo p-0 "+(v.taskRead?"error-border":"border-0"),children:(0,re.jsx)(it.LR,{defaultCountry:"au",placeholder:"Enter phone number",value:j||"",className:"phoneInput w-100",containerClass:ot.countrySelector,onChange:e=>{f(e),rt(e)&&g((e=>({...e,phone:!1})))}})}),v.phone&&(0,re.jsx)("p",{className:"error-message",children:"Phone is not valid"})]})})]}),(0,re.jsx)(ne.A,{children:(0,re.jsx)(le.A,{children:(0,re.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,re.jsxs)("label",{children:["Message",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsxs)("div",{className:"inputInfo "+(v.description?"error-border":""),style:{position:"relative"},children:[(0,re.jsx)("div",{style:{position:"absolute",right:"10px",top:"15px"},children:(null===C||void 0===C?void 0:C.isFetching)&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,re.jsx)("textarea",{type:"text",name:"Enter a message here...",value:p,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value.slice(0,150);x(t),g((e=>({...e,message:!1})))}})]}),(0,re.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-1",children:[(0,re.jsx)("p",{className:"error-message",children:v.message&&"Description is required"}),(0,re.jsxs)("div",{style:{float:"right",fontSize:"14px",color:"#6c757d"},children:[(null===p||void 0===p?void 0:p.length)||0,"/150"]})]})]})})}),(0,re.jsx)(ne.A,{}),(0,re.jsxs)("div",{className:"popoverbottom  mt-0 pt-4",children:[(0,re.jsx)(o.A,{variant:"outline-danger",onClick:b,children:"Cancel"}),(0,re.jsxs)(o.A,{disabled:null===w||void 0===w?void 0:w.isPending,variant:"primary save d-flex align-items-center gap-2",onClick:()=>{let e={};if(p||(e.message=!0),j&&rt(j)||(e.phone=!0),Object.keys(e).length)return g(e);w.mutate({phone_number:j,message:p})},children:["Send",(null===w||void 0===w?void 0:w.isPending)&&(0,re.jsx)(se.p,{style:{width:"15px",height:"15px"}})]})]})]})})]})]})};var ct=s(29853),ut=s(9634),ht=s(55917),mt=s(85371);const pt="send-to-calendar_calendarButton__wLLgP",xt="send-to-calendar_calendarModal__ZnyeK",vt="send-to-calendar_modalTitle__yfOOC",gt="send-to-calendar_formLabel__eKaq1",jt="send-to-calendar_AutoComplete__iw4uu",ft="send-to-calendar_borderDanger__P-SWh";const bt=s.p+"static/media/calendar.9ebe7da58af479b138e37b33d2affea2.svg",yt=e=>{let{projectId:t,project:s,projectCardData:i}=e;const n=(0,l.useRef)(null),a=JSON.parse(window.localStorage.getItem("profileData")||"{}"),r=localStorage.getItem("access_token"),[d,c]=(0,l.useState)(!1),[h,m]=(0,l.useState)(!1),[p,x]=(0,l.useState)(""),[v,g]=(0,l.useState)(""),[j,f]=(0,l.useState)(""),[b,y]=(0,l.useState)(""),[C,w]=(0,l.useState)(null),[N,A]=(0,l.useState)(null),[_,S]=(0,l.useState)([]),[F,k]=(0,l.useState)(""),[E,$]=(0,l.useState)([]),[I,T]=(0,l.useState)({}),L=(0,ce.I)({queryKey:["getClientById",null===s||void 0===s?void 0:s.client],queryFn:()=>(0,ue.EZ)(null===s||void 0===s?void 0:s.client),enabled:!(null===s||void 0===s||!s.client)&&!!d,retry:1}),D=(0,ce.I)({queryKey:["getOutgoingEmail"],queryFn:he.hx,enabled:!!d}),B=()=>{c(!1),S([]),x(""),g(""),f(""),w(null),A(null),y(""),k("")};(0,l.useEffect)((()=>{null!==s&&void 0!==s&&s.booking_start&&!C&&w(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&!N&&A(new Date(1e3*s.booking_end))}),[s,C,N]);const R=e=>{var t,s;const l=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=((null===(s=L.data)||void 0===s?void 0:s.contact_persons)||[]).map((e=>e.email)).filter((e=>e));i=i.filter((e=>!_.includes(e))),i=i.filter((e=>e.toLowerCase().includes(l))),$(i)},H=()=>{R(),n.current&&n.current.show()};return(0,l.useEffect)((()=>{var e,t,s;null!==D&&void 0!==D&&D.data&&(null!==D&&void 0!==D&&null!==(e=D.data)&&void 0!==e&&e.outgoing_email&&null!==D&&void 0!==D&&null!==(t=D.data)&&void 0!==t&&t.outgoing_email_verified?k(null===D||void 0===D||null===(s=D.data)||void 0===s?void 0:s.outgoing_email):k("no-reply@memate.com.au"))}),[D]),(0,l.useEffect)((()=>{null!==a&&void 0!==a&&a.email&&d&&S([null===a||void 0===a?void 0:a.email])}),[null===a||void 0===a?void 0:a.email,d]),(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(o.A,{disabled:!(null!==s&&void 0!==s&&s.booking_start),className:`calenBut calenActive ${pt}`,onClick:()=>{null!==s&&void 0!==s&&s.reference?x(`${s.reference}`):null!==s&&void 0!==s&&s.number?x(`Project #${s.number}`):x("Project Event"),g((null===s||void 0===s?void 0:s.description)||""),null!==s&&void 0!==s&&s.booking_start&&w(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&A(new Date(1e3*s.booking_end)),c(!0)},children:["Send to Calendar ",(0,re.jsx)("img",{src:bt,alt:"Calendar"})]}),(0,re.jsxs)(ie.A,{show:d,onHide:B,centered:!0,className:xt,children:[(0,re.jsx)(ie.A.Header,{closeButton:!0,children:(0,re.jsx)(ie.A.Title,{className:vt,children:"Send to Calendar"})}),(0,re.jsx)(ie.A.Body,{children:(0,re.jsxs)(ct.A,{onSubmit:async e=>{e.preventDefault(),m(!0);try{if(!(()=>{const e={};return p.trim()||(e.eventTitle="Event title is required"),C||(e.startDate="Start date is required"),N||(e.endDate="End date is required"),C>N&&(e.endDate="End date must be after start date"),0===_.length&&(e.guests="Guests are required"),F||(e.from="From email is required"),v.trim()||(e.eventDescription="Description is required"),!(Object.keys(e).length>0)||(T(e),!1)})())return void m(!1);const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(null===a||void 0===a?void 0:a.email)||"no-reply@memate.com.au";const s=e=>(0,ht.A)(e,"yyyyMMdd'T'HHmmss'Z'"),l=new Date,i=`${Date.now()}@memate.com.au`,n=s(l);let o=v||"Meeting Invitation",r=`<html><body><p>${v||"Meeting Invitation"}</p>`;if(b){const e=(d=b)?d.includes("zoom.us")?"Zoom":d.includes("teams.microsoft.com")?"Microsoft Teams":d.includes("meet.google.com")?"Google Meet":d.includes("webex.com")?"Cisco Webex":"Online Meeting":null;o+=`\n\n${e} Link: ${b}`,r+=`<p><strong>${e} Link:</strong> <a href="${b}">${b}</a></p>`}var d;r+="</body></html>",r=r.replace(/\n/g,"").replace(/\s+/g," ");const c=["BEGIN:VCALENDAR","PRODID:-//MeMate//Calendar//EN","VERSION:2.0","CALSCALE:GREGORIAN","METHOD:REQUEST","BEGIN:VEVENT",`UID:${i}`,`DTSTAMP:${n}`,`SUMMARY:${p}`,`DESCRIPTION:${o.replace(/\n/g,"\\n")}`,`LOCATION:${j||b||""}`,b?`URL:${b}`:"",`DTSTART:${s(C)}`,`DTEND:${s(N)}`,`ORGANIZER;CN=${null!==a&&void 0!==a&&a.first_name&&null!==a&&void 0!==a&&a.last_name?`${a.first_name} ${a.last_name}`:t.split("@")[0]||"MeMate"}:mailto:${t}`].filter((e=>""!==e));return e&&e.length>0&&e.forEach((e=>{let t=e.split("@")[0].replace(/[.]/g," ");t=t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),c.push(`ATTENDEE;CUTYPE=INDIVIDUAL;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;CN=${t}:mailto:${e}`)})),c.push("STATUS:CONFIRMED","SEQUENCE:0","TRANSP:OPAQUE","BEGIN:VALARM","TRIGGER:-PT15M","ACTION:DISPLAY","DESCRIPTION:Reminder","END:VALARM","X-MICROSOFT-CDO-BUSYSTATUS:BUSY","X-MICROSOFT-CDO-IMPORTANCE:1","X-MICROSOFT-DISALLOW-COUNTER:FALSE","X-MICROSOFT-DONOTFORWARDMEETING:FALSE","X-MICROSOFT-CDO-ALLDAYEVENT:FALSE"),b&&(b.includes("meet.google.com")?c.push(`X-GOOGLE-CONFERENCE:${b}`):b.includes("teams.microsoft.com")&&c.push(`X-MICROSOFT-SKYPETEAMSMEETINGURL:${b}`)),c.push(`X-ALT-DESC;FMTTYPE=text/html:${r}`),c.push("END:VEVENT","END:VCALENDAR"),c.join("\r\n")}(_,F),s=new File([e],"invite.ics",{type:"text/calendar"}),l=new FormData;l.append("subject",`Invitation: ${p}`),l.append("email_body",v),l.append("from_email",F),l.append("to",_.toString()),l.append("attachments",s),await je.A.post(`https://app.memate.com.au/api/v1/custom/email/${t}/`,l,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),oe.oR.success("Calendar event created successfully!"),B(),i(t)}catch(s){console.error("Error creating calendar event:",s),oe.oR.error("Failed to create calendar event. Please try again.")}finally{m(!1)}},children:[(0,re.jsxs)(ct.A.Group,{className:"mb-3",children:[(0,re.jsxs)(ct.A.Label,{className:gt,children:["Event Title",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)(ct.A.Control,{type:"text",placeholder:"Enter event title",value:p,onChange:e=>x(e.target.value),className:(0,u.A)("border outline-none",(null===I||void 0===I?void 0:I.eventTitle)&&"border-danger")}),(null===I||void 0===I?void 0:I.eventTitle)&&(0,re.jsx)(ct.A.Text,{className:"error-message",children:I.eventTitle})]}),(0,re.jsxs)(ne.A,{className:"mb-3",children:[(0,re.jsx)(le.A,{children:(0,re.jsxs)(ct.A.Group,{children:[(0,re.jsxs)(ct.A.Label,{className:gt,children:["Start Date & Time",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)(mt.V,{value:C,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{w(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,re.jsx)(ut.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===I||void 0===I?void 0:I.startDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===I||void 0===I?void 0:I.startDate)&&(0,re.jsx)(ct.A.Text,{className:"error-message",children:null===I||void 0===I?void 0:I.startDate})]})}),(0,re.jsx)(le.A,{children:(0,re.jsxs)(ct.A.Group,{children:[(0,re.jsxs)(ct.A.Label,{className:gt,children:["End Date & Time",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)(mt.V,{value:N,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{A(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,re.jsx)(ut.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===I||void 0===I?void 0:I.endDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===I||void 0===I?void 0:I.endDate)&&(0,re.jsx)(ct.A.Text,{className:"error-message",children:null===I||void 0===I?void 0:I.endDate})]})})]}),(0,re.jsxs)(ct.A.Group,{className:"mb-3",children:[(0,re.jsxs)(ct.A.Label,{className:gt,children:["Add Guests",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)(Se.j,{ref:n,value:_,completeMethod:R,onChange:e=>{S(e.value)},multiple:!0,suggestions:E,onClick:H,onFocus:H,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));S((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(S((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(jt,"w-100",(null===I||void 0===I?void 0:I.guests)&&ft),placeholder:"Add guests"}),(null===I||void 0===I?void 0:I.guests)&&(0,re.jsx)(ct.A.Text,{className:"error-message",children:null===I||void 0===I?void 0:I.guests})]}),(0,re.jsxs)(ct.A.Group,{className:"mb-3",children:[(0,re.jsx)(ct.A.Label,{className:gt,children:"Location"}),(0,re.jsx)(ct.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter physical location (optional)",value:j,onChange:e=>f(e.target.value)})]}),(0,re.jsxs)(ct.A.Group,{className:"mb-3",children:[(0,re.jsx)(ct.A.Label,{className:gt,children:"Meeting Link"}),(0,re.jsx)(ct.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter meeting link (Zoom, Teams, etc.)",value:b,onChange:e=>y(e.target.value)})]}),(0,re.jsxs)(ct.A.Group,{className:"mb-3",children:[(0,re.jsxs)(ct.A.Label,{className:gt,children:["Description",(0,re.jsx)("span",{className:"required",children:"*"})]}),(0,re.jsx)(ct.A.Control,{as:"textarea",rows:3,className:(0,u.A)("border outline-none",(null===I||void 0===I?void 0:I.eventDescription)&&"border-danger"),placeholder:"Enter event description",value:v,onChange:e=>g(e.target.value)}),(null===I||void 0===I?void 0:I.eventDescription)&&(0,re.jsx)(ct.A.Text,{className:"error-message",children:null===I||void 0===I?void 0:I.eventDescription})]}),(0,re.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4 border-top pt-4",children:[(0,re.jsx)(o.A,{className:"outline-button",variant:"secondary",onClick:B,children:"Cancel"}),(0,re.jsx)(o.A,{className:"solid-button",variant:"primary",type:"submit",disabled:h,children:h?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Sending..."]}):"Send via Email"})]})]})})]})]})};var Ct=s(42104);const wt="start-chat_chatButton__cwbTm",Nt=e=>{let{projectId:t,project:s}=e;const i=(0,l.useRef)(null),{session:n}=(0,w.As)(),a=(0,Y.Zp)(),r=null===n||void 0===n?void 0:n.desktop_user_id,[d,c]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!1);(0,l.useEffect)((()=>{var e;const t=(0,Ct.io)("https://chat.memate.com.au",{transports:["websocket"],autoConnect:!0});i.current=t,r&&t.emit("register_user",{user_id:r,org_id:null===n||void 0===n||null===(e=n.organization)||void 0===e?void 0:e.id},(e=>{"success"===e.status?(c(!0),console.log("User registered successfully")):oe.oR.error("Failed to connect to chat server")}))}),[r,n]);return(0,re.jsxs)(o.A,{className:wt,disabled:u||!i.current||!d,onClick:()=>{if(r)return i.current?void(i.current&&(h(!0),i.current.emit("create_chat_group",{user_id:r,name:null===s||void 0===s?void 0:s.reference,participants:[],project_id:t,job_id:null},(e=>{console.log("res: ",e),"success"===e.status&&e.chat_group_id?(h(!1),a(`/chat?id=${e.chat_group_id}`)):(h(!1),console.log("Error during creation chat group: ",e),oe.oR.error("Failed to create chat group"))})))):oe.oR.error("Failed to start chat")},children:[u&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Start Chat",(0,re.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,re.jsxs)("g",{opacity:"0.4",children:[(0,re.jsx)("path",{d:"M1.66663 11.3082V6.32484C1.66663 4.02484 3.53329 2.1665 5.83329 2.1665H14.1666C16.4666 2.1665 18.3333 4.02484 18.3333 6.32484V12.1415C18.3333 14.4332 16.4666 16.2915 14.1666 16.2915H12.9166C12.6583 16.2915 12.4083 16.4165 12.25 16.6248L11 18.2832C10.45 19.0165 9.54996 19.0165 8.99996 18.2832L7.74996 16.6248C7.61663 16.4415 7.31663 16.2915 7.08329 16.2915H5.83329C3.53329 16.2915 1.66663 14.4332 1.66663 12.1415V11.3082Z",fill:"#1D2939"}),(0,re.jsx)("path",{d:"M1.66663 11.3082V6.32484C1.66663 4.02484 3.53329 2.1665 5.83329 2.1665H14.1666C16.4666 2.1665 18.3333 4.02484 18.3333 6.32484V12.1415C18.3333 14.4332 16.4666 16.2915 14.1666 16.2915H12.9166C12.6583 16.2915 12.4083 16.4165 12.25 16.6248L11 18.2832C10.45 19.0165 9.54996 19.0165 8.99996 18.2832L7.74996 16.6248C7.61663 16.4415 7.31663 16.2915 7.08329 16.2915H5.83329C3.53329 16.2915 1.66663 14.4332 1.66663 12.1415V11.3082Z",fill:"url(#paint0_linear_16871_70907)"})]}),(0,re.jsx)("path",{d:"M14.1667 7.7915H5.83337C5.49171 7.7915 5.20837 7.50817 5.20837 7.1665C5.20837 6.82484 5.49171 6.5415 5.83337 6.5415H14.1667C14.5084 6.5415 14.7917 6.82484 14.7917 7.1665C14.7917 7.50817 14.5084 7.7915 14.1667 7.7915Z",fill:"#292D32"}),(0,re.jsx)("path",{d:"M14.1667 7.7915H5.83337C5.49171 7.7915 5.20837 7.50817 5.20837 7.1665C5.20837 6.82484 5.49171 6.5415 5.83337 6.5415H14.1667C14.5084 6.5415 14.7917 6.82484 14.7917 7.1665C14.7917 7.50817 14.5084 7.7915 14.1667 7.7915Z",fill:"url(#paint1_linear_16871_70907)"}),(0,re.jsx)("path",{d:"M10.8334 11.9585H5.83337C5.49171 11.9585 5.20837 11.6752 5.20837 11.3335C5.20837 10.9918 5.49171 10.7085 5.83337 10.7085H10.8334C11.175 10.7085 11.4584 10.9918 11.4584 11.3335C11.4584 11.6752 11.175 11.9585 10.8334 11.9585Z",fill:"#292D32"}),(0,re.jsx)("path",{d:"M10.8334 11.9585H5.83337C5.49171 11.9585 5.20837 11.6752 5.20837 11.3335C5.20837 10.9918 5.49171 10.7085 5.83337 10.7085H10.8334C11.175 10.7085 11.4584 10.9918 11.4584 11.3335C11.4584 11.6752 11.175 11.9585 10.8334 11.9585Z",fill:"url(#paint2_linear_16871_70907)"}),(0,re.jsxs)("defs",{children:[(0,re.jsxs)("linearGradient",{id:"paint0_linear_16871_70907",x1:"1.66663",y1:"2.1665",x2:"18.3333",y2:"18.8332",gradientUnits:"userSpaceOnUse",children:[(0,re.jsx)("stop",{stopColor:"#89F7FE"}),(0,re.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]}),(0,re.jsxs)("linearGradient",{id:"paint1_linear_16871_70907",x1:"5.20837",y1:"6.5415",x2:"5.52901",y2:"8.99968",gradientUnits:"userSpaceOnUse",children:[(0,re.jsx)("stop",{stopColor:"#89F7FE"}),(0,re.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]}),(0,re.jsxs)("linearGradient",{id:"paint2_linear_16871_70907",x1:"5.20837",y1:"10.7085",x2:"5.68914",y2:"13.1123",gradientUnits:"userSpaceOnUse",children:[(0,re.jsx)("stop",{stopColor:"#89F7FE"}),(0,re.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]})]})]})]})},At=()=>(0,re.jsxs)("tr",{children:[(0,re.jsx)("td",{children:(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,re.jsx)("td",{children:(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,re.jsx)("td",{children:(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,re.jsx)("td",{children:(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,re.jsx)("td",{children:(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]}),_t={defaultStatus:"job-status_defaultStatus__emAxy",status:"job-status_status__HXyT-",DRAFT:"job-status_DRAFT__HqpDF",OPEN:"job-status_OPEN__yb7zB",ASSIGNED:"job-status_ASSIGNED__0WFAv",CONFIRMED:"job-status_CONFIRMED__iTcji",DECLINED:"job-status_DECLINED__2RC2+",SUBMITTED:"job-status_SUBMITTED__GFRLu",FINISHED:"job-status_FINISHED__RbfR-",IN_PROGRESS:"job-status_IN_PROGRESS__BoR97"},St=e=>{let{status:t,actionStatus:s,published:l}=e;const i=function(e,t){if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return{label:"Draft",className:"DRAFT",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"};if("a"===e&&t)return{label:"In Progress",className:"IN_PROGRESS",color:"#3D5AFE",backColor:"#EEF1FF",borderColor:"#C3CCFF"};return{1:{label:"Open",className:"OPEN",color:"#065b76",backColor:"#ecf7fd",borderColor:"#a9d6ef"},2:{label:"Assigned",className:"ASSIGNED",color:"#520676",backColor:"#f6ecfd",borderColor:"#dda9ef"},3:{label:"Submitted",className:"SUBMITTED",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"},4:{label:"Finished",className:"FINISHED",color:"#29B27C",backColor:"#BBFFE4",borderColor:"#BBFFE4"},6:{label:"Declined",className:"DECLINED",color:"#b42318",backColor:"#fef3f2",borderColor:"#fecdca"},a:{label:"Confirmed",className:"CONFIRMED",color:"#067647",backColor:"#ecfdf3",borderColor:"#a9efc5"}}[e]||{label:e,className:"defaultStatus"}};return(0,re.jsx)("div",{className:(0,u.A)(_t.status,_t[i(t,s,l).className]),children:i(t,s,l).label})};var Ft=s(67046),kt=s(41292),Et=s(96327),$t=s(14834),It=s(58027),Tt=s(62284);const Lt=e=>{var t,s;let{viewShow:i,setViewShow:n,projectId:a,project:r,statusOptions:d,reInitialize:c}=e;const u=(0,Y.Zp)(),h=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[p,x]=(0,l.useState)(!1),[v,g]=(0,l.useState)(!0),[j,f]=(0,l.useState)(null),[b,y]=(0,l.useState)(!1),[C,w]=(0,l.useState)(""),[N,_]=(0,l.useState)([]),[ae,ce]=(0,l.useState)([]),[ue,he]=(0,l.useState)([]),[me,xe]=(0,l.useState)(!1),[ve,ge]=(0,l.useState)(!1),[je,fe]=(0,l.useState)(!1),be=parseFloat(null===j||void 0===j?void 0:j.cost_of_sale)||0,ye=parseFloat(null===j||void 0===j?void 0:j.labor_expense)||0,we=parseFloat(null===j||void 0===j?void 0:j.operating_expense)||0,Ae=parseFloat(be+ye+we).toFixed(2),_e=()=>{n(!1),c()},Se=async e=>{g(!0);try{const t=await(0,m.OE)(e);if("Not found."===(null===t||void 0===t?void 0:t.detail))throw new Error("Project card not found");f(t)}catch(t){console.error("Error fetching project card data:",t),oe.oR.error("Failed to fetch project card data. Please try again."),n(!1),f(null)}finally{g(!1)}},Fe=(0,Q.n)({mutationFn:e=>(0,m.aj)(a,e),onSuccess:()=>{f((e=>({...e,reference:C})))},onError:e=>{console.error("Error creating task:",e)}}),ke=e=>{const t=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(t)} | ${`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}`},Ee=(0,Q.n)({mutationFn:e=>(0,m.jE)(e),onSuccess:e=>{e?u("/sales"):oe.oR.error("Failed to update sendBack to sales. Please try again.")},onError:e=>{console.error("Error updating sendBack to sales:",e),oe.oR.error("Failed to update sendBack to sales. Please try again.")}}),$e=(0,Q.n)({mutationFn:e=>(0,m.ZE)(e),onSuccess:e=>{e?(_e(),oe.oR.success("Order has been successfully declined")):oe.oR.error("Failed to decline the order. Please try again.")},onError:e=>{console.error("Error declining the order:",e),oe.oR.error("Failed to decline the order. Please try again.")}}),Ie=(0,Q.n)({mutationFn:e=>(0,m.yE)(e),onSuccess:e=>{e?(_e(),oe.oR.success("Project has been successfully completed")):oe.oR.error("Failed to complete the project. Please try again.")},onError:e=>{console.error("Error completing the project:",e),oe.oR.error("Failed to complete the project. Please try again.")}}),Te=(0,Q.n)({mutationFn:e=>(0,m.SE)(e),onSuccess:e=>{e?(_e(),Se(a),oe.oR.success("Invoice has been successfully created")):oe.oR.error("Failed to create the invoice. Please try again.")},onError:e=>{console.error("Error creating the invoice:",e),oe.oR.error("Failed to create the invoice. Please try again.")}});(0,l.useEffect)((()=>{if(null!==ue&&void 0!==ue&&ue.length){var e;let t=null===j||void 0===j||null===(e=j.history)||void 0===e?void 0:e.filter((e=>ue.includes(e.type)));ce(t||[])}else ce(null===j||void 0===j?void 0:j.history)}),[ue,null===j||void 0===j?void 0:j.history]),(0,l.useEffect)((()=>{if(j){var e,t;let s=[...null===j||void 0===j||null===(e=j.expenses)||void 0===e?void 0:e.map((e=>({...e,type:"expense"}))),...null===j||void 0===j||null===(t=j.jobs)||void 0===t?void 0:t.map((e=>({...e,type:"job"})))].sort(((e,t)=>parseInt(t.created)-parseInt(e.created)));_(s),ce((null===j||void 0===j?void 0:j.history)||[])}}),[j]),(0,l.useEffect)((()=>{a&&i&&Se(a),window.history.pushState({},"","/management")}),[a,i]);const Le=e=>{var t,s,i,n;let{emailData:o}=e;const[a,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),u=(0,l.useRef)(null),h=(e=>{var t,s,l;const i=e.split("\n"),n=(null===(t=i.find((e=>e.startsWith("Subject:"))))||void 0===t?void 0:t.replace("Subject: ",""))||"",o=(null===(s=i.find((e=>null===e||void 0===e?void 0:e.startsWith("Recipient(s):"))))||void 0===s?void 0:s.replace("Recipient(s): ",""))||[];return{subject:n,recipients:JSON.parse((null===o||void 0===o?void 0:o.length)&&(null===o||void 0===o?void 0:o.replace(/'/g,'"'))),body:null===(l=e.split("Body:")[1])||void 0===l?void 0:l.trim()}})(o),m=null===(t=h.body)||void 0===t||null===(s=t.split(/<\/p>\s*<p>|<br\s*\/?>|\n/))||void 0===s?void 0:s.map(((e,t)=>`<p key=${t}>${null===e||void 0===e?void 0:e.trim()}</p>`)),p=null===m||void 0===m?void 0:m.join("");return(0,l.useEffect)((()=>{if(u.current){const e=u.current.scrollHeight;c(e>90)}}),[p]),(0,re.jsxs)("div",{children:[(0,re.jsxs)("ul",{className:"d-flex flex-column align-items-start",children:[(0,re.jsxs)("li",{className:"font-12",children:[(0,re.jsx)("strong",{className:"font-12",children:"Subject:"}),"\xa0 ",h.subject]}),(0,re.jsxs)("li",{children:[(0,re.jsx)("strong",{className:"font-12",children:"Recipients:"}),"\xa0",(0,re.jsx)("ul",{children:(null===h||void 0===h||null===(i=h.recipients)||void 0===i?void 0:i.length)&&(null===h||void 0===h||null===(n=h.recipients)||void 0===n?void 0:n.map(((e,t)=>(0,re.jsx)("li",{className:"font-12",children:e},t))))})]})]}),(0,re.jsxs)("div",{children:[(0,re.jsx)("div",{ref:u,style:{maxHeight:a?"none":"87px",overflowY:"hidden",overflowX:a?"auto":"hidden"},dangerouslySetInnerHTML:{__html:p}}),d&&(0,re.jsx)("button",{className:"text-button font-12 px-0",onClick:()=>r(!a),children:a?"Show Less":"Load More"})]})]})},De=(0,Q.n)({mutationFn:e=>(0,m.Wb)(a,e),onSuccess:()=>{oe.oR.success("Cost breakdown updated successfully")},onError:e=>{console.error("Error creating task:",e),oe.oR.error("Failed to update cost breakdown"),Se(a)}});return(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(ie.A,{show:i,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"projectCardModel",onHide:_e,animation:!1,enforceFocus:!1,children:[(0,re.jsxs)(ie.A.Header,{className:"mb-0 pb-0 justify-content-between ",children:[(0,re.jsx)("div",{className:"modelHeader",style:{flex:"1",maxWidth:"calc(100% - 350px)"},children:(0,re.jsxs)("ul",{className:"d-flex align-items-center",children:[(0,re.jsxs)("li",{className:"me-1 d-flex align-items-center",children:[(0,re.jsx)("strong",{className:"dollorIcon",style:{background:null!==j&&void 0!==j&&j.invoice_created?"paid"===(null===j||void 0===j?void 0:j.payment_status)?"#F2FDEC":"not_paid"===(null===j||void 0===j?void 0:j.payment_status)?"#FEF3F2":"#FFFAEB":"#F9FAFB"},children:(0,re.jsx)(I.A,{size:13,color:null!==j&&void 0!==j&&j.invoice_created?"paid"===(null===j||void 0===j?void 0:j.payment_status)?"#17B26A":"not_paid"===(null===j||void 0===j?void 0:j.payment_status)?"#F04438":"#B54708":"#667085"})}),v?(0,re.jsx)(S.A,{as:"span",animation:"wave",className:"ms-2 me-2",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",size:"md",style:{width:"120px"}})}):(0,re.jsxs)("span",{className:"cardId text-nowrap",children:[null===j||void 0===j?void 0:j.number," \xa0"]})]}),(0,re.jsxs)("li",{className:"refrencesTag mt-1",style:{width:"calc(100% - 120px)"},children:["Reference:\xa0",v?(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):b?(0,re.jsx)("input",{type:"text",value:C,onChange:e=>{w(e.target.value)},onBlur:async()=>{y(!1),await Fe.mutateAsync({reference:C}),await(0,m.SE)(a)},className:"border rounded w-100",style:{maxWidth:"calc(100% - 120px)"}}):(0,re.jsx)(re.Fragment,{children:Fe.isPending?(0,re.jsx)("div",{className:"dot-flashing ms-5 mt-1"}):(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)("small",{className:"ellipsis-width",style:{color:"#1D2939",fontSize:"16px",maxWidth:"calc(100% - 220px)"},children:[" ",null===j||void 0===j?void 0:j.reference]}),(0,re.jsxs)("span",{children:[" ",(0,re.jsx)($.A,{size:16,color:"#106B99",onClick:()=>{y(!0),w((null===j||void 0===j?void 0:j.reference)||"")},style:{cursor:"pointer"}})]})]})})]})]})}),(0,re.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"15px"},children:[(0,re.jsx)(X.N_,{to:`/api/v1/project-card/${a}/pdf/`,target:"_blank",children:(0,re.jsx)(o.A,{variant:"light",className:"rounded-circle px-2",title:"Project Card",children:(0,re.jsx)(T.A,{color:"#344054",size:20})})}),(0,re.jsx)(X.N_,{to:`/api/v1/sales/${a}/label/`,target:"_blank",title:"Label",children:(0,re.jsx)(o.A,{variant:"light",className:"rounded-circle px-2",children:(0,re.jsx)(L.A,{color:"#344054",size:20})})}),(0,re.jsx)("div",{className:"selectButStatus",children:v?(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):(0,re.jsx)(lt,{projectId:a,statusOptions:d,custom_status:null===j||void 0===j?void 0:j.custom_status})}),(0,re.jsx)("button",{className:"CustonCloseModal",onClick:_e,children:(0,re.jsx)(D.A,{size:24,color:"#667085"})})]})]}),(0,re.jsx)(ie.A.Body,{className:"p-0",children:(0,re.jsxs)("div",{className:"ContactModel",children:[(0,re.jsxs)(ne.A,{className:"text-left mt-0 projectCardMain",children:[(0,re.jsxs)(le.A,{sm:6,className:"orderDiscription",children:[(0,re.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100",children:[(0,re.jsx)("strong",{children:"Order Description"}),(0,re.jsx)(B.A,{size:16,color:"#106B99",onClick:()=>{var e;if(null!==j&&void 0!==j&&null!==(e=j.calculator_descriptions)&&void 0!==e&&e.length){var t;let e=null===j||void 0===j||null===(t=j.calculator_descriptions)||void 0===t?void 0:t.map((e=>`- ${e.description}`)).join("\n");navigator.clipboard.writeText(e),oe.oR.success("Copied to clipboard")}},style:{cursor:"pointer"}})]}),(0,re.jsx)("div",{className:"customScrollBar",children:v?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,re.jsx)(S.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})})]}):(0,re.jsx)("ul",{children:null!==j&&void 0!==j&&null!==(t=j.calculator_descriptions)&&void 0!==t&&t.length?null===j||void 0===j||null===(s=j.calculator_descriptions)||void 0===s?void 0:s.map(((e,t)=>{let{description:s}=e;return(0,re.jsxs)("li",{children:["- ",s]},t)})):(0,re.jsx)("li",{children:"No Description available"})})}),(0,re.jsxs)("div",{className:"currentJobsTable",children:[(0,re.jsx)("h5",{children:"Current Jobs / Expense for this order"}),(0,re.jsxs)(F.A,{responsive:!0,children:[(0,re.jsx)("thead",{style:{position:"sticky",top:"0px",zIndex:9},children:(0,re.jsxs)("tr",{children:[(0,re.jsx)("th",{className:"border-right",children:"#"}),(0,re.jsx)("th",{children:"Reference"}),(0,re.jsx)("th",{children:"Provider"}),(0,re.jsx)("th",{children:"Estimate/Total"}),(0,re.jsx)("th",{children:"Status"})]})}),(0,re.jsx)("tbody",{children:v?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(At,{}),(0,re.jsx)(At,{}),(0,re.jsx)(At,{}),(0,re.jsx)(At,{})]}):null!==N&&void 0!==N&&N.length?null===N||void 0===N?void 0:N.map(((e,t)=>{var s,l,i,n,o,a,r;return(0,re.jsxs)("tr",{children:[(0,re.jsx)("td",{className:"border-right",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,re.jsx)(X.N_,{to:`/work/jobs?jobId=${null===e||void 0===e?void 0:e.id}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number}):(0,re.jsx)(X.N_,{to:`/expenses?expenseId=${null===e||void 0===e?void 0:e.id}&supplierName=${null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.name}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number})}),(0,re.jsx)("td",{children:(0,re.jsx)("div",{className:"ellipsis-width",children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e?void 0:e.reference)||"-":(null===e||void 0===e?void 0:e.invoice_reference)||"-"})}),(0,re.jsx)("td",{children:(0,re.jsx)(k.A,{placement:"top",overlay:(0,re.jsx)(E.A,{className:"TooltipOverlay",id:`tooltip-${top}`,children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.full_name)||"":(null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.name)||""}),children:(0,re.jsx)("div",{className:"mx-auto d-flex align-items-center justify-content-center ps-2",style:{width:"fit-content"},children:"job"===(null===e||void 0===e?void 0:e.type)?(0,re.jsx)(It.h,{has_photo:null===e||void 0===e||null===(n=e.worker)||void 0===n?void 0:n.has_photo,photo:null===e||void 0===e||null===(o=e.worker)||void 0===o?void 0:o.photo,is_business:!1,size:16}):(0,re.jsx)(It.h,{has_photo:null===e||void 0===e||null===(a=e.supplier)||void 0===a?void 0:a.has_photo,photo:null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.photo,is_business:!0,size:16})})},"top")}),(0,re.jsxs)("td",{children:["$",(0,$t.m)(null===e||void 0===e?void 0:e.total)||"-"]}),(0,re.jsx)("td",{className:"status",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,re.jsx)(St,{status:null===e||void 0===e?void 0:e.status,actionStatus:null===e||void 0===e?void 0:e.action_status,published:null===e||void 0===e?void 0:e.published}):(0,re.jsx)("span",{className:null!==e&&void 0!==e&&e.paid?"paid":"unpaid",children:null!==e&&void 0!==e&&e.paid?"Paid":"Not Paid"})})]},e.number||`je-${t}`)})):(0,re.jsx)("tr",{children:(0,re.jsx)("td",{colSpan:5,className:"noDataAvilable text-center",children:" No data available"})})})]})]})]}),(0,re.jsxs)(le.A,{sm:6,className:"projectHistoryCol",children:[(0,re.jsxs)(ne.A,{children:[(0,re.jsxs)(le.A,{className:"tabModelMenu d-flex justify-content-between align-items-center p-0",children:[(0,re.jsx)(de,{projectId:a,projectCardData:Se}),(0,re.jsx)(ze,{project:r,reInitialize:c,projectCardData:()=>Se(a)}),(0,re.jsx)(dt,{projectId:a,projectCardData:()=>Se(a)}),(0,re.jsx)(pe,{clientId:null===j||void 0===j?void 0:j.client,projectId:a,projectCardData:()=>Se(a)})]}),(0,re.jsx)(le.A,{className:"d-flex justify-content-center align-items-center filter",children:(0,re.jsx)(Ze,{setFilteredHistoryOptions:he})})]}),(0,re.jsx)(ne.A,{className:"projectHistoryWrap",children:(0,re.jsxs)(le.A,{className:"p-0",children:[(0,re.jsx)("h3",{children:"Project History"}),v?(0,re.jsx)(re.Fragment,{children:Array.from({length:10},((e,t)=>(0,re.jsx)(S.A,{as:"p",animation:"wave",className:t%2===0?"mb-0 mt-1":"mb-3 mt-1",children:(0,re.jsx)(S.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:t%2===0?"200px":"90%",height:t%2===0?"15px":"10px"}})},`history-key-${t+1}`)))}):(0,re.jsx)("div",{className:"projectHistoryScroll",children:null!==ae&&void 0!==ae&&ae.length?null===ae||void 0===ae?void 0:ae.map(((e,t)=>{let{id:s,type:l,text:i,title:n,created:o,manager:r,links:d}=e;return(0,re.jsxs)("div",{className:"projectHistorygroup",children:[(0,re.jsx)("ul",{children:(0,re.jsx)("li",{children:"quote"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)("div",{className:"d-flex align-items-center",children:[(0,re.jsx)(R.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Quote \xa0"}),"\xa0",(null===d||void 0===d?void 0:d.quote_pdf)&&(0,re.jsx)(X.N_,{to:`${(null===d||void 0===d?void 0:d.quote_pdf)||"#"}`,target:"_blank",children:(0,re.jsx)(H.A,{color:"#FF0000",size:14})}),"\xa0\xa0",a&&"Quote Created"===n&&(0,re.jsx)(X.N_,{to:`/quote/${a}`,target:"_blank",children:(0,re.jsx)(P.A,{color:"#3366CC",size:16})})]})}):"task"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(M.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Task"})]})}):"order"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(M.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Order"})]})}):"note"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(z.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Note"})]})}):"tag"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(O.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Tag"})]})}):"invoice"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)("div",{className:"d-flex align-items-center",children:[(0,re.jsx)(V.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Invoice\xa0"}),"\xa0",(null===d||void 0===d?void 0:d.invoice_pdf)&&(0,re.jsx)(X.N_,{to:`${(null===d||void 0===d?void 0:d.invoice_pdf)||"#"}`,target:"_blank",children:(0,re.jsx)(H.A,{color:"#FF0000",size:14})}),"\xa0\xa0",a&&"Invoice Created"===n&&(0,re.jsx)(X.N_,{to:`/invoice/${a}`,target:"_blank",children:(0,re.jsx)(P.A,{color:"#3366CC",size:16})})]})}):"billing"===l?(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(U.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Billing"})]})}):"email"===l?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(q.A,{size:16,color:"#1AB2FF"})," ",(0,re.jsx)("strong",{children:"\xa0 Email"})]}):""})}),(0,re.jsx)("h5",{style:{whiteSpace:"pre-line"},children:"email"!==l&&n||""}),"email"===l?(0,re.jsx)(Le,{emailData:i}):(0,re.jsx)("h6",{style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:i}}),(0,re.jsxs)("p",{children:[ke(o)," by ",r]})]},`history-${s||t}`)})):(0,re.jsx)("p",{children:"No history available"})})]})})]})]}),(0,re.jsx)(ne.A,{className:"projectCardButWrap",children:(0,re.jsxs)(le.A,{children:[(0,re.jsx)(Ye,{projectId:a,projectCardData:Se,isFetching:v,startDate:+(null===j||void 0===j?void 0:j.booking_start),endDate:+(null===j||void 0===j?void 0:j.booking_end)},a),(0,re.jsxs)(o.A,{className:"expense expActive",onClick:()=>fe(!0),children:["Create Expense ",(0,re.jsx)("img",{src:Et.A,alt:"Expense"})]}),(null===h||void 0===h?void 0:h.has_work_subscription)&&(0,re.jsx)(re.Fragment,{children:(0,re.jsxs)(o.A,{className:"createJob jobActive",onClick:()=>ge(!0),children:["Create a Job ",(0,re.jsx)("img",{src:kt.A,alt:"briefcase"})]})}),(0,re.jsx)(Ne,{clientId:null===j||void 0===j?void 0:j.client,projectId:a}),(0,re.jsx)(Ce,{projectId:a}),(0,re.jsx)(yt,{projectId:a,project:j,projectCardData:Se}),(0,re.jsx)(Nt,{projectId:a,project:j})]})}),(0,re.jsxs)(ne.A,{className:"projectCardCalculation",children:[(0,re.jsxs)(le.A,{className:"proCostSale projectColBg",children:[(0,re.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,re.jsx)("h5",{children:"Cost Of Sale"}),(0,re.jsxs)("p",{children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.cost_of_sale)]})]}),(0,re.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,re.jsx)(Z.A,{size:20,color:"#344054"})})]}),(0,re.jsxs)(le.A,{className:"proLabour projectColBg",children:[(0,re.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,re.jsx)("h5",{children:"Labour"}),(0,re.jsxs)("p",{children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.labor_expense)]})]}),(0,re.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,re.jsx)(Z.A,{size:20,color:"#344054"})})]}),(0,re.jsxs)(le.A,{className:"proOperatingExpense projectColBg",children:[(0,re.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,re.jsx)("h5",{children:"Operating Expense"}),(0,re.jsxs)("p",{children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.operating_expense)]})]}),(0,re.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,re.jsx)("path",{d:"M4.16675 8H15.8334M4.16675 13H15.8334",stroke:"#344054",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,re.jsxs)(le.A,{className:"proRealCost projectColBg",children:[(0,re.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,re.jsx)("h5",{children:"Real Cost"}),(0,re.jsxs)("p",{children:["$",(0,$t.m)(Ae)]})]}),(0,re.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,re.jsx)("span",{className:"font-14",children:"VS"})})]}),(0,re.jsx)(le.A,{className:"proBuget projectColBg",children:(0,re.jsxs)("div",{children:[(0,re.jsx)("h5",{children:"Budget"}),(0,re.jsxs)("p",{children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.budget)]})]})})]}),(0,re.jsxs)(ne.A,{className:"projectCardactionBut",children:[(0,re.jsxs)(le.A,{className:"actionLeftSide",children:[(0,re.jsxs)(o.A,{onClick:()=>{$e.mutate(a)},disabled:!(null!==j&&void 0!==j&&j.can_be_declined)||$e.isPending,className:"declineAction",children:[(0,re.jsx)(G.A,{size:20,color:"#912018"})," Decline Order",$e.isPending&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]}),(0,re.jsxs)(o.A,{disabled:p,className:"duplicateAction",onClick:async()=>{try{if(!a)return oe.oR.error("Project id not found");x(!0),await(0,Ft.CK)(a),u("/sales"),oe.oR.success("Sale has been successfully duplicated")}catch(e){console.error("Error is duplicating:",e),oe.oR.error("Failed to duplicate sale. Please try again.")}finally{x(!1)}},children:[(0,re.jsx)(W.A,{size:20,color:"#0A4766",className:"me-1"}),(0,re.jsx)("span",{style:{position:"relative",top:"2px"},children:"Duplicate"})," ",p&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"6px"}})]}),(0,re.jsxs)(o.A,{disabled:!(null!==j&&void 0!==j&&j.can_be_return),onClick:()=>{!(null!==j&&void 0!==j&&j.can_be_return)||Ee.mutate(a)},className:"sendBackAction",children:[(0,re.jsx)(J.A,{size:20,color:"#344054",opacity:null!==j&&void 0!==j&&j.can_be_return?1:.5}),"Send Back to Sales",Ee.isPending&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]}),(0,re.jsxs)(le.A,{className:"actionRightSide",children:[(0,re.jsx)(He,{clientId:null===j||void 0===j?void 0:j.client,isCreated:null===j||void 0===j?void 0:j.invoice_created,projectId:a,isLoading:null===Te||void 0===Te?void 0:Te.isPending,create:()=>{Te.mutate(a)},projectCardData:()=>Se(a)}),(0,re.jsxs)(o.A,{onClick:()=>Ie.mutate(a),disabled:!(null!==j&&void 0!==j&&j.can_be_completed),className:"CompleteActionBut",children:["Complete & Archive",(null===Ie||void 0===Ie?void 0:Ie.isPending)&&(0,re.jsx)(se.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]})]}),(0,re.jsx)(ne.A,{className:"projectBreakdown px-0 pb-0",children:(0,re.jsxs)(le.A,{sm:12,className:"px-0",children:[(0,re.jsxs)(o.A,{className:"mb-2",onClick:()=>xe(!me),children:[me?"Hide":"Show"," Cost breakdown"]}),me&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsxs)(te.b,{value:(null===j||void 0===j?void 0:j.calculations)||[],showGridlines:!0,className:"border-top",children:[(0,re.jsx)(ee.V,{field:"id",header:"Order",bodyClassName:"text-center",headerClassName:"text-center",style:{width:"60px"},body:(e,t)=>t.rowIndex+1}),(0,re.jsx)(ee.V,{field:"subindex",header:"Department",style:{minWidth:"192px"},body:e=>(0,re.jsx)("div",{className:"ellipsis-width",title:e.subindex,style:{maxWidth:"192px"},children:e.subindex})}),(0,re.jsx)(ee.V,{field:"description",header:"Description",body:e=>{var t;const[s,i]=(0,l.useState)(e.description),[n,o]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{var t;n&&(null===(t=document.getElementById(`cost-breakdown-${e.id}`))||void 0===t||t.focus())}),[n,e.id]),(0,re.jsxs)("div",{className:"d-flex",children:[(0,re.jsx)("textarea",{rows:1,className:"auto-expand",style:{background:"transparent",border:"0px solid #fff",fontSize:"14px",minHeight:"50px"},value:s,id:`cost-breakdown-${e.id}`,onChange:e=>{i(e.target.value)},disabled:!n,onInput:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`},onFocus:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`,e.target.style.border="1px solid #dedede",e.target.style.background="#fff"},onBlur:t=>{t.target.style.height="50px",t.target.style.border="0px solid #fff",t.target.style.background="transparent",((e,t)=>{De.mutate({id:e,description:t})})(e.id,s),o(!1)},onClick:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`}}),null!==De&&void 0!==De&&De.isPending&&(null===De||void 0===De||null===(t=De.variables)||void 0===t?void 0:t.id)===e.id?(0,re.jsx)(se.p,{style:{width:"20px",height:"20px"}}):(0,re.jsx)($.A,{size:16,color:"#106B99",onClick:()=>o(!0),style:{cursor:"pointer",marginLeft:"8px"}})]})},style:{width:"100%"}}),(0,re.jsx)(ee.V,{field:"cost",header:"Cost",style:{width:"100%"},body:e=>`$${(0,$t.m)(e.cost)}`}),(0,re.jsx)(ee.V,{field:"profit_type_value",header:"Markup/Margin",body:e=>`${e.profit_type_value} ${"AMN"===e.profit_type?"AMT $":"MRG"===e.profit_type?"MRG %":"MRK %"}`,style:{width:"100%"}}),(0,re.jsx)(ee.V,{field:"unit_price",header:"Unit Price",style:{width:"100%"},body:e=>`$${(0,$t.m)(e.unit_price)}`}),(0,re.jsx)(ee.V,{field:"quantity",header:"Qty/Unit",style:{width:"100%"}}),(0,re.jsx)(ee.V,{field:"discount",header:"Discount",style:{width:"100%"},body:e=>`${e.discount}%`}),(0,re.jsx)(ee.V,{field:"total",header:"Amount",style:{width:"100%"},body:e=>`$${(0,$t.m)(e.total)}`})]}),(0,re.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-end gap-4",style:{background:"#EBF8FF",padding:"8px 24px 8px 40px"},children:[(0,re.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,re.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Sub Total"}),(0,re.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.sub_total)]})]}),(0,re.jsx)("div",{children:(0,re.jsx)(Z.A,{size:20,color:"#106B99"})}),(0,re.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,re.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Tax"}),(0,re.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.gst)]})]}),(0,re.jsx)("div",{children:(0,re.jsx)("div",{children:(0,re.jsx)(K.A,{size:20,color:"#106B99",style:{transform:"rotate(90deg)"}})})}),(0,re.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,re.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Total Invoice Amount"}),(0,re.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,$t.m)(null===j||void 0===j?void 0:j.total)]})]})]})]})]})})]})})]}),(0,re.jsx)(A.A,{visible:ve,setVisible:ge,setRefetch:()=>Se(a),jobProjectId:ve?null===r||void 0===r?void 0:r.value:"",projectReference:ve?null===r||void 0===r?void 0:r.reference:""}),(0,re.jsx)(Tt.A,{visible:je,setVisible:fe,setRefetch:()=>Se(a),expenseProjectId:null===r||void 0===r?void 0:r.value,projectReference:null===r||void 0===r?void 0:r.reference})]})};var Dt=s(72796);const Bt=e=>{let{view:t,setView:s,taskId:i,setTaskId:n,reInitialize:o}=e;const{isFetching:a,data:r,refetch:d}=(0,ce.I)({queryKey:["task",i],queryFn:()=>(0,Dt.dd)(i),enabled:!!i,retry:1});return(0,l.useEffect)((()=>{i&&d({cancelRefetch:!1})}),[i,d]),(0,re.jsx)(re.Fragment,{children:t&&(0,re.jsx)(Pe.A,{show:t,setShow:s,taskId:i,setTaskId:n,defaultValue:r,refetch:o})})},Rt="calender";const Ht=function(){const{session:e}=(0,w.As)(),t=(null===e||void 0===e?void 0:e.has_work_subscription)||!1,s=(0,l.useRef)(null),{trialHeight:i}=(0,N.$)(),[p,x]=(0,l.useState)(""),[v,g]=(0,l.useState)([]),[j,f]=(0,l.useState)(!1),[S,F]=(0,l.useState)(!1),[k,E]=(0,l.useState)(!1),[$,I]=(0,l.useState)(!1),[T,L]=(0,l.useState)([]),[D,B]=(0,l.useState)(null),[R,H]=(0,l.useState)(null),[P,M]=(0,l.useState)({}),[z,O]=(0,l.useState)(""),[V,U]=(0,l.useState)(""),[q,Z]=(0,l.useState)(""),[G,W]=(0,l.useState)(!1),[J,K]=(0,l.useState)(null),[Y,X]=(0,l.useState)({visible:!1,jobId:null}),[Q,ee]=(0,l.useState)(!1),[te,se]=(0,l.useState)([]),le=window.location.href,ie=new URL(le),ne=new URLSearchParams(ie.search),oe=ne.get("unique_id");if(oe&&!R){H(oe);const e=ne.get("reference"),t=ne.get("number"),s=ne.get("value");M({number:t||"",reference:e,value:s}),E(!0)}function ae(e){let t=arguments.length>2?arguments[2]:void 0;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){"job"===t.type?X({visible:!0,jobId:t.job.id}):(H(e),M(t),E(!0))}else B(e),F(!0)}(0,l.useEffect)((()=>{(async()=>{try{const e=await(0,C.ic)();L([...e])}catch(e){console.error("Error fetching project status data:",e)}})()}),[]),(0,l.useEffect)((()=>{const e=e=>{if(!(e.target instanceof HTMLSelectElement)){if(e.target.closest(".createJobButton")){const t=e.target.getAttribute("project-id");K(t),W(!0)}if(e.target.closest(".job-resource-child")){const t=e.target.closest(".job-resource-child").getAttribute("job-id");X({visible:!0,jobId:t})}if(e.target.closest(".create-task-button")){const t=e.target.getAttribute("number"),s=e.target.getAttribute("reference"),l=e.target.getAttribute("project-id");M({number:t,reference:s,value:l}),f(!0)}else if(e.target.closest(".task-list")){const t=e.target.closest(".task-list").getAttribute("task-id");console.log("task-list: ....",t),t&&ae(t)}else if(e.target.closest(".project-content")){const t=e.target.closest(".project-content").getAttribute("unique-id"),s=e.target.closest(".project-content").getAttribute("number"),l=e.target.closest(".project-content").getAttribute("reference"),i=e.target.closest(".project-content").getAttribute("project-id");console.log("uniqueId: ....",t),H(t),M({number:s,reference:l,value:i}),E(!0)}}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]);const de=async()=>{try{I(!0);const e=await(0,m.Mv)();g(e),p?ue(p,e):b(e,t),I(!1)}catch(e){console.error("Error initializing DayPilot:",e)}};(0,l.useEffect)((()=>{const e=document.createElement("script");e.src="/daypilot-all.min.js",e.id="daypilot-script-ele";const s=()=>{console.error("Failed to load DayPilot script.")},l=async()=>{try{const e=await(0,m.Mv)(),s=await(async()=>{try{const e=await(0,C.sq)();return se(e),e}catch(e){return console.error("Error fetching holidays:",e),[]}})();console.log("1holidays: ",s),g(e),y(Rt,e,ae,de,t,s)}catch(e){console.error("Error initializing DayPilot:",e)}};return e.addEventListener("error",s),e.addEventListener("load",l),document.body.appendChild(e),()=>{e.removeEventListener("error",s),e.removeEventListener("load",l),document.body.contains(e)&&document.body.removeChild(e)}}),[]);const ce=()=>{console.log("handleViewTask: ")};(0,l.useEffect)((()=>{const e=document.querySelector(".task-list");if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.addEventListener("click",ce())}return()=>{if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.removeEventListener("click",ce)}}}),[]);const ue=(e,l)=>{const i=l||v;s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{b(i.filter((t=>{var s,l,i,n,o,a;return!!(null!==t&&void 0!==t&&null!==(s=t.number)&&void 0!==s&&null!==(l=s.toLowerCase())&&void 0!==l&&l.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(i=t.reference)&&void 0!==i&&null!==(n=i.toLowerCase())&&void 0!==n&&n.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(o=t.client)&&void 0!==o&&null!==(a=o.name.toLowerCase())&&void 0!==a&&a.includes((null===e||void 0===e?void 0:e.toLowerCase())||""))}))||[],t)}),600)},he=(0,l.useCallback)((()=>{let e=[...v];if("Not Invoiced"===z?e=e.filter((e=>!e.is_invoice_created)):"Not Booked"===z?e=e.filter((e=>!e.booking_start)):"Not Paid"===z&&(e=e.filter((e=>"PAID"!==e.paid))),"Date Due"===V?e.sort(((e,t)=>new Date(1e3*e.booking_end)-new Date(1e3*t.booking_end))):"Date Accepted"===V?e.sort(((e,t)=>new Date(1e3*e.booking_start)-new Date(1e3*t.booking_start))):"Job Number"===V?e.sort(((e,t)=>e.number.localeCompare(t.number))):"Order Status"===V&&e.sort(((e,t)=>{var s,l;return((null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.title)||"").localeCompare((null===t||void 0===t||null===(l=t.custom_status)||void 0===l?void 0:l.title)||"")})),(null===q||void 0===q?void 0:q.length)>0){const t=q.map((e=>e.id));e=e.filter((e=>{var s;return t.includes(null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.id)}))}p&&(e=e.filter((e=>{var t,s,l,i,n,o;return!!(null!==e&&void 0!==e&&null!==(t=e.number)&&void 0!==t&&null!==(s=t.toLowerCase())&&void 0!==s&&s.includes((null===p||void 0===p?void 0:p.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(l=e.reference)&&void 0!==l&&null!==(i=l.toLowerCase())&&void 0!==i&&i.includes((null===p||void 0===p?void 0:p.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(n=e.client)&&void 0!==n&&null!==(o=n.name.toLowerCase())&&void 0!==o&&o.includes((null===p||void 0===p?void 0:p.toLowerCase())||""))}))),b(e,t)}),[v,z,V,p,t,q]);(0,l.useEffect)((()=>{he()}),[z,V,p,he,q]);const me=e=>{O(e)},pe=e=>{U(e)};return(0,re.jsxs)(l.Fragment,{children:[(0,re.jsxs)("div",{className:"topbar bottom-border",style:{padding:"0px 20px",position:"relative"},children:[(0,re.jsxs)("div",{className:"left-side d-flex align-items-center",style:{gap:"12px"},children:[(0,re.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,re.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,re.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,re.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,re.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>{const t=e.target.value;x(t)},className:"border search-resource",style:{borderRadius:"4px",border:"1px solid #D0D5DD",width:"184px",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,re.jsxs)("div",{className:"d-flex gap-1 justify-content-end align-items-center",style:{position:"absolute",left:"4px",top:"56px",zIndex:1e3},children:[(0,re.jsxs)(n.A,{children:[(0,re.jsxs)(n.A.Toggle,{as:o.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,re.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,re.jsx)(r.A,{size:16,color:"#667085",className:"me-1"}),(0,re.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:V,children:V||(0,re.jsx)("span",{style:{color:"#667085"},children:"Sort By"})})]}),V&&(0,re.jsx)("span",{onClick:e=>{e.stopPropagation(),pe("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,re.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,re.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,re.jsxs)(n.A.Menu,{children:[(0,re.jsx)(n.A.Item,{eventKey:"Date Due",active:"Date Due"===V,onClick:()=>pe("Date Due"),children:"Date Due"},"Date Due"),(0,re.jsx)(n.A.Item,{eventKey:"Date Accepted",active:"Date Accepted"===V,onClick:()=>pe("Date Accepted"),children:"Date Accepted"},"Date Accepted"),(0,re.jsx)(n.A.Item,{eventKey:"Job Number",active:"Job Number"===V,onClick:()=>pe("Job Number"),children:"Job Number"},"Job Number"),(0,re.jsx)(n.A.Item,{eventKey:"Order Status",active:"Order Status"===V,onClick:()=>pe("Order Status"),children:"Order Status"},"Order Status")]})]}),(0,re.jsxs)(n.A,{children:[(0,re.jsxs)(n.A.Toggle,{as:o.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,re.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,re.jsx)(d.A,{size:16,color:"#667085",className:"me-1"}),(0,re.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:z,children:z||(0,re.jsx)("span",{style:{color:"#667085"},children:"Filter By"})})]}),z&&(0,re.jsx)("span",{onClick:e=>{e.stopPropagation(),me("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,re.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,re.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,re.jsxs)(n.A.Menu,{children:[(0,re.jsx)(n.A.Item,{eventKey:"Not Invoiced",active:"Not Invoiced"===z,onClick:()=>me("Not Invoiced"),children:"Not Invoiced"},"Not Invoiced"),(0,re.jsx)(n.A.Item,{eventKey:"Not Booked",active:"Not Booked"===z,onClick:()=>me("Not Booked"),children:"Not Booked"},"Not Booked"),(0,re.jsx)(n.A.Item,{eventKey:"Not Paid",active:"Not Paid"===z,onClick:()=>me("Not Paid"),children:"Not Paid"},"Not Paid")]})]}),(0,re.jsxs)("div",{style:{position:"relative",maxWidth:"113px"},children:[(0,re.jsx)("div",{style:{position:"absolute",top:"3px",left:"12px",zIndex:1},children:(0,re.jsx)(c.A,{size:20,color:"#667085"})}),(0,re.jsx)(h.K,{value:q,options:T,onChange:e=>Z(e.value),optionLabel:"title",placeholder:"Status",maxSelectedLabels:0,itemTemplate:e=>{var t,s,l;return(0,re.jsx)("div",{className:"d-flex align-items-center gap-2",style:{width:"250px"},children:(0,re.jsx)("div",{className:"w-100 p-2 rounded",style:{background:`${null===(t=st[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.bg}`,borderLeft:`4px solid ${null===(s=st[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.border}`,color:`${null===(l=st[null===e||void 0===e?void 0:e.color])||void 0===l?void 0:l.color}`},children:(0,re.jsx)("span",{className:"ellipsis-width",style:{maxWidth:"250px"},children:e.title})})})},filter:!0,scrollHeight:"400px",display:"chip",showClear:!0,className:"w-100 custom-multiselect management-multiselect",style:{width:"184px",borderRadius:"40px",padding:"2px 8px",paddingLeft:"34px"}})]})]})]}),(0,re.jsx)("div",{className:"featureName",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,re.jsx)("h1",{className:"title mx-0",children:"Project Management"})}),(0,re.jsx)("div",{className:"right-side d-flex align-items-center"})]}),(0,re.jsx)("div",{className:i&&"trial-height-added",children:(0,re.jsx)("div",{id:Rt,children:(0,re.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,re.jsx)(a.A,{animation:"border",role:"status",children:(0,re.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})})}),(0,re.jsx)(Bt,{view:S,setView:F,taskId:D,setTaskId:B,reInitialize:de}),(0,re.jsx)(Me,{show:j,setShow:f,project:P,reInitialize:de}),(0,re.jsx)(Lt,{viewShow:k,setViewShow:E,projectId:R,project:P,statusOptions:T,reInitialize:de},R),(0,re.jsx)(A.A,{visible:G,setVisible:W,setRefetch:de,jobProjectId:J}),(0,re.jsx)(_.A,{visible:null===Y||void 0===Y?void 0:Y.visible,jobId:null===Y||void 0===Y?void 0:Y.jobId,setVisible:e=>X((t=>({...t,visible:e}))),setRefetch:de,editMode:Q,setEditMode:ee}),$&&(0,re.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,re.jsx)(a.A,{animation:"border",role:"status",children:(0,re.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})},Pt=()=>(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(i.mg,{children:(0,re.jsx)("title",{children:"MeMate - Management"})}),(0,re.jsx)(Ht,{})]})},44908:(e,t,s)=>{s.d(t,{A:()=>ke});var l=s(65043),i=s(61072),n=s(78602),o=s(14282),a=s(77918),r=s(96141),d=s(544),c=s(60867),u=s(55850),h=s(9634),m=s(93202),p=s(51038),x=s(94819),v=s(89488),g=s(24858),j=s(5293),f=s(35475),b=s(18403),y=s(93747),C=s(86213),w=s(58387),N=s(85371),A=s(55797),_=s(88060),S=s(28676),F=s(74532),k=s(79255),E=s(72052),$=s(27932),I=s(59690),T=s(20288),L=s(1356),D=s(56328),B=s(80899);const R="expenses-form_circledesignstyle__mbb1-",H="expenses-form_out__KMiJx",P="expenses-form_bgGreay__JyrcA",M="expenses-form_lable__PwIbw",z="expenses-form_inputText__juz8k",O="expenses-form_error__BY34l",V="expenses-form_dropdownSelect__9h-UH",U="expenses-form_expensesCreateNew__okukP",q="expenses-form_dividerIcon__9TOjY",Z="expenses-form_expTotalRow__8u8o3",G="expenses-form_CalItem__5I8ic",W="expenses-form_CalItemActive__NBMtY",J="expenses-form_fileBox__vJk+d",K="expenses-form_fileNameBox__Sb+Fy",Y="expenses-form_deleteBox__IPh+B",X="expenses-form_aiProcessingBox__Xslof",Q="expenses-form_aiProcessingSpinner__2Ykt8",ee="expenses-form_aiProcessingText__r+NWH",te="expenses-form_aiSuccessBox__5wZSk",se="expenses-form_aiSuccessText__g6HC8",le="expenses-form_aiNoDataBox__dy9sT",ie="expenses-form_aiNoDataText__fTku6",ne="expenses-form_aiErrorBox__nCorV",oe="expenses-form_aiErrorText__a5YuG",ae="expenses-form_selectButton__z9PXk",re="expenses-form_modal__lciui",de="expenses-form_modalHeader__Kf8rL",ce="expenses-form_headerTitle__2VPHZ",ue="expenses-form_iconStyle__s2Evh";var he=s(10586),me=s(52781);const pe=s.p+"static/media/ai-scan.5a0b826f54cf1e4e72f8.png";var xe=s(27472);const ve=e=>{try{if("object"===typeof e&&null!==e){if(!(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])))return e;{const t=e[0].find((e=>"text"===e[0]));t&&t[1]&&(e=t[1])}}if("string"===typeof e){const t=e.match(/```json\s*([\s\S]*?)\s*```/);if(t&&t[1])return JSON.parse(t[1]);const s=e.indexOf("{"),l=e.lastIndexOf("}");if(-1!==s&&-1!==l){const t=e.substring(s,l+1);return JSON.parse(t)}}return null}catch(t){return console.error("Error extracting AI response data:",t),null}},ge=e=>{if(!e)return null;let t="0.00";e.total_amount&&(t=e.total_amount.replace(/[A-Za-z$,]/g,"").trim());let s="no";!0===e.gst_included?s="in":!1===e.gst_included&&(s="ex");const l=parseFloat(t)||0;let i=l,n=0;return"in"===s?(n=.1*l/1.1,i=l-n):"ex"===s&&(n=.1*i),{invoice_reference:e.invoice_number||"",amount:l.toFixed(2),"gst-calculation":s,gst:"ex"===s,nogst:"no"===s,subtotal:i.toFixed(2),tax:n.toFixed(2),totalAmount:(i+n).toFixed(2),note:e.description||""}};var je=s(14834),fe=s(33296),be=s(58027),ye=s(11281),Ce=(s(66601),s(61427)),we=s(70579);function Ne(e,t){let s;return function(){for(var l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];clearTimeout(s),s=setTimeout((()=>e(...i)),t)}}const Ae=B.Ik({supplier:B.ai().typeError("Supplier must be a valid id").required("Supplier is required"),invoice_reference:B.Yj().required("Invoice reference is required"),date:B.Yj().required("Date is required"),due_date:B.Yj().required("Due date is required").test("is-after-date","Due date must be after the invoice date",(function(e){const{date:t}=this.parent;if(!t||!e)return!0;const s=new Date(t),l=new Date(e);return s.setHours(0,0,0,0),l.setHours(0,0,0,0),l>=s})),amount:B.Yj().required("Amount is required"),nogst:B.zM().required("NOGST must be a boolean"),gst:B.zM().required("GST must be a boolean")}).required(),_e=(0,l.forwardRef)(((e,t)=>{var s,j,A,B,re,de,ce,ue,_e,ke,Ee,$e,Ie,Te,Le;let{onSubmit:De,defaultValues:Be,id:Re,defaultSupplier:He,projectId:Pe}=e;(0,l.useRef)(null);const Me=(0,l.useRef)(null),ze=localStorage.getItem("access_token"),[Oe,Ve]=(0,l.useState)(!1),[Ue,qe]=(0,l.useState)((null===He||void 0===He?void 0:He.id)||""),[Ze,Ge]=(0,l.useState)(He||null),[We,Je]=(0,l.useState)([]),[Ke,Ye]=(0,l.useState)([]),[Xe,Qe]=(0,l.useState)(1),[et,tt]=(0,l.useState)(""),[st,lt]=(0,l.useState)(!0),[it,nt]=(0,l.useState)(!1),[ot,at]=(0,l.useState)(!1),[rt,dt]=(0,l.useState)(!1),[ct,ut]=(0,l.useState)([]),{control:ht,reset:mt,register:pt,handleSubmit:xt,setValue:vt,getValues:gt,watch:jt,setError:ft,trigger:bt,formState:{errors:yt}}=(0,g.mN)({resolver:(0,b.t)(Ae),defaultValues:Be}),{getRootProps:Ct,getInputProps:wt}=(0,v.VB)({maxFiles:1,multiple:!1,accept:{"application/pdf":[".pdf",".png",".jpg",".jpeg"]},maxSize:5242880,onDrop:e=>{const t=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0})));Ye((()=>[...t])),St(t,!1)}}),{getRootProps:Nt,getInputProps:At}=(0,v.VB)({maxFiles:1,multiple:!1,accept:{"application/pdf":[".pdf",".png",".jpg",".jpeg"]},maxSize:5242880,onDrop:e=>{const t=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0,aiAnalysis:!0})));Ye((()=>[...t])),St(t,!0)}}),_t=async(e,t)=>C.A.put(t,e,{headers:{"Content-Type":""},onUploadProgress:s=>{const l=Math.round(s.loaded/s.total*100);Ye((s=>s.map((s=>s.name===e.name?Object.assign(s,{progress:l,url:t}):s))))}}).catch((s=>{console.log("err: ",s),Ye((s=>s.map((s=>s.name===e.name?Object.assign(s,{progress:0,url:t,error:!0}):s))))})),St=async(e,t)=>{if(e.length)for(const i of e)try{const e=await C.A.post("https://app.memate.com.au/api/v1/expenses/file/",{file_name:i.name},{headers:{Authorization:`Bearer ${ze}`}}),{url:l}=e.data;if(!l)return Ye([]),void D.oR.error(`Failed to upload ${i.name}. Please try again.`);await _t(i,l);const n=l.split("?")[0]||"";if(n&&(ut([n]),nt(!0)),!t)return vt("file",n),void Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{progress:100}):e))));if(t){Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{progress:100,aiProcessing:!0}):e)))),D.oR.info("AI is analyzing your document...",{duration:3e3});try{const e=await C.A.post("https://app.memate.com.au/api/v1/expenses/recognize/",{file_url:n},{headers:{Authorization:`Bearer ${ze}`}}),t=ve(null===e||void 0===e?void 0:e.data);if(t){const e=ge(t);e?(vt("file",n),Object.entries(e).forEach((e=>{let[t,s]=e;vt(t,s)})),bt(["invoice_reference","amount","gst","nogst"]),D.oR.success("Form prefilled with invoice data"),Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{aiProcessing:!1,aiSuccess:!0}):e))))):(Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),D.oR.warning("No invoice data could be extracted from the document"))}else Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),D.oR.warning("No invoice data could be extracted from the document")}catch(s){console.error("Error during AI recognition:",s),Ye((e=>e.map((e=>e.name===i.name?Object.assign(e,{aiProcessing:!1,aiError:!0}):e)))),D.oR.error("Failed to analyze the document. Please try again.")}}}catch(l){console.error("Error uploading file:",i.name,l),D.oR.error(`Failed to upload ${i.name}. Please try again.`)}},Ft=Ne((e=>{var t;const s=(null===e||void 0===e||null===(t=e.filter)||void 0===t?void 0:t.toLowerCase())||"";tt(s)}),300);(0,l.useEffect)((()=>{Qe(1)}),[et,rt]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,me.Jj)(Xe,25,et,"name");if(1===Xe){if(Ue){const t=e.results.filter((e=>e.id!==Ue));return Je([Ze,...t])}Je(e.results)}else{var t;if((null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t.length)>0){let t=e.results;Ue&&(t=[Ze,...e.results]),Je((e=>{let s=e;Ue&&(s=[...e,Ze]);const l=new Set(s.map((e=>e.id))),i=t.filter((e=>!l.has(e.id)));return[...e,...i]}))}}lt(e.count!==We.length)})()}),[Xe,et,Ue,Ze,rt]),(0,l.useEffect)((()=>{if(We.length>0&&st){const e=setTimeout((()=>{const e=document.querySelector(".supplier-dropdown .p-dropdown-items li.p-dropdown-item:last-child");console.log("lastRow: ",e),e&&(Me.current=new IntersectionObserver((e=>{e[0].isIntersecting&&(Qe((e=>e+1)),console.log("entries[0].isIntersecting: ",e[0].isIntersecting))})),Me.current.observe(e))}),1e3);return()=>{clearTimeout(e),Me.current&&Me.current.disconnect()}}}),[We,st]);const kt=e=>{if(e){const t=parseFloat(gt("amount"))||0,{subtotal:s,calculatedTax:l,totalAmount:i}=((e,t)=>{let s=0,l=0;return"ex"===t?(l=e,s=.1*l):"in"===t?(s=.1*e/1.1,l=e-s):(l=e,s=0),{subtotal:l.toFixed(2),calculatedTax:s.toFixed(2),totalAmount:(parseFloat(l)+parseFloat(s)).toFixed(2)}})(t,e);vt("tax",l),vt("subtotal",s),vt("totalAmount",i),vt("nogst","no"===e),vt("gst","ex"===e),bt(["gst"])}},Et=(0,y.I)({queryKey:["getXeroCodesList"],queryFn:he.JP}),$t=(0,y.I)({queryKey:["getProjectsList"],queryFn:he.Bu}),It=["Assign to project","Assign to timeframe"],[Tt,Lt]=(0,l.useState)((null===Be||void 0===Be?void 0:Be.option)||It[0]),Dt=jt("order");(0,l.useEffect)((()=>{Dt&&bt(["order"])}),[Dt]);const Bt=jt("type"),Rt=()=>{"Assign to project"!==Tt||Dt||ft("order",{type:"manual",message:"Order is required"}),"Assign to timeframe"!==Tt||Bt||ft("type",{type:"manual",message:"Type is required"})};(0,l.useEffect)((()=>{Object.keys(yt).length>0&&Rt()}),[yt]),(0,l.useEffect)((()=>{"Assign to timeframe"===Tt?(vt("order",""),null!==Be&&void 0!==Be&&Be.type&&vt("type",null===Be||void 0===Be?void 0:Be.type)):"Assign to project"===Tt&&(vt("type",""),null!==Be&&void 0!==Be&&Be.order&&vt("order",null===Be||void 0===Be?void 0:Be.order)),vt("option",Tt)}),[Tt]),(0,l.useEffect)((()=>{null!==Be&&void 0!==Be&&Be.option&&Lt(null===Be||void 0===Be?void 0:Be.option)}),[null===Be||void 0===Be?void 0:Be.option]);(0,l.useEffect)((()=>{Pe&&vt("order",+Pe)}),[Pe]),(0,l.useEffect)((()=>{Re||vt("gst-calculation","in")}),[]),(0,l.useEffect)((()=>{var e,t;if(Ue&&vt("supplier",+Ue),Ue&&bt(["supplier"]),null!==Ze&&void 0!==Ze&&null!==(e=Ze.service)&&void 0!==e&&e.code&&null!==Et&&void 0!==Et&&null!==(t=Et.data)&&void 0!==t&&t.length){var s;let e=null===Et||void 0===Et||null===(s=Et.data)||void 0===s?void 0:s.find((e=>{var t;return e.code===(null===Ze||void 0===Ze||null===(t=Ze.service)||void 0===t?void 0:t.code)}));null!==e&&void 0!==e&&e.id&&vt("account_code",null===e||void 0===e?void 0:e.id)}else Be.account_code&&vt("account_code",Be.account_code||"")}),[Ue,null===Et||void 0===Et?void 0:Et.data,vt,bt,Be.account_code,null===Ze||void 0===Ze||null===(s=Ze.service)||void 0===s?void 0:s.code]);const Ht=(0,we.jsx)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0 w-100",style:{borderBottom:"1px solid #EAECF0",padding:"4px 10px 24px 0px"},children:(0,we.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,we.jsx)("div",{className:R,children:(0,we.jsx)("div",{className:H,children:(0,we.jsx)(a.A,{size:24,color:"#17B26A"})})}),(0,we.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Document Preview"})]})});(0,l.useEffect)((()=>{null!==Be&&void 0!==Be&&Be.file&&(ut([null===Be||void 0===Be?void 0:Be.file]),nt(!0))}),[null===Be||void 0===Be?void 0:Be.file]);return(0,we.jsxs)("div",{children:[(0,we.jsxs)("form",{ref:t,onSubmit:xt((e=>{Rt(),Object.keys(yt).length>0?console.log("Validation errors:",yt):De(e,mt)})),children:[(0,we.jsxs)(i.A,{className:(0,w.A)(P,"pt-3"),children:[(0,we.jsx)(n.A,{sm:8,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mb-3",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Supplier",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsx)("input",{type:"hidden",...pt("supplier")}),(0,we.jsx)(_.m,{value:Ue,options:We,optionLabel:"name",optionValue:"id",onChange:e=>{qe(+e.value);let t=We.find((t=>t.id===e.value));Ge(t||{})},itemTemplate:e=>(0,we.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,we.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,we.jsx)(be.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,we.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}),valueTemplate:e=>Ue?(0,we.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,we.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,we.jsx)(be.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,we.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}):null,className:(0,w.A)(V,"dropdown-height-fixed",{[O]:null===yt||void 0===yt?void 0:yt.supplier}),panelClassName:"supplier-dropdown",style:{height:"46px"},scrollHeight:"350px",placeholder:"Search for supplier",filter:!0,onFilter:Ft,filterInputAutoFocus:!0}),yt.supplier&&(0,we.jsx)("p",{className:"error-message",children:yt.supplier.message})]})}),(0,we.jsx)(n.A,{sm:4,children:(0,we.jsx)("div",{className:"d-flex justify-content-end text-md-end flex-column gap-1 mt-3 pt-3 mb-3",children:(0,we.jsxs)(o.A,{className:U,onClick:()=>at(!0),children:["Create New Supplier",(0,we.jsx)(r.A,{size:24,color:"#475467"})]})})}),(0,we.jsx)(n.A,{sm:12,className:"mb-4",children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Invoice/#Ref",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsxs)(S.C,{children:[(0,we.jsx)(F.m,{children:(null===yt||void 0===yt?void 0:yt.invoice_reference)&&(0,we.jsx)("img",{src:xe.A,className:"mb-3"})}),(0,we.jsx)(E.S,{...pt("invoice_reference"),className:(0,w.A)(z,{[O]:yt.invoice_reference}),placeholder:"Enter invoice reference"})]}),(null===yt||void 0===yt?void 0:yt.invoice_reference)&&(0,we.jsx)("p",{className:"error-message",children:null===(j=yt.invoice_reference)||void 0===j?void 0:j.message})]})}),(0,we.jsxs)(n.A,{sm:12,children:[(0,we.jsxs)(i.A,{children:[(0,we.jsxs)(n.A,{sm:6,children:[(0,we.jsx)("label",{className:(0,w.A)(M),children:"Upload Only"}),(0,we.jsxs)("div",{...Ct({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"5px"},children:[(0,we.jsx)("input",{...wt()}),(0,we.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:(0,we.jsx)(d.A,{size:20,color:"#475467"})}),(0,we.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,we.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,we.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"PDF, SVG, PNG, JPG files \u2022 Max size: 5MB"})]})]}),(0,we.jsxs)(n.A,{sm:6,children:[(0,we.jsx)("label",{className:(0,w.A)(M),children:"Upload & Read With AI"}),(0,we.jsxs)("div",{...Nt({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"5px"},children:[(0,we.jsx)("input",{...At()}),(0,we.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #FFF",background:"#f2f2f2",borderRadius:"8px",marginBottom:"16px"},children:(0,we.jsx)("img",{src:pe,className:"w-100"})}),(0,we.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,we.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,we.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"PDF, PNG, JPG, JPEG files \u2022 Max size: 5MB"})]})]})]}),(0,we.jsxs)("div",{className:"d-flex flex-column",children:[(null===Ke||void 0===Ke?void 0:Ke.length)>0&&(0,we.jsx)("label",{className:(0,w.A)(M,"mt-4 mb-1"),children:"Photo/Document Of The Expense"}),null===Ke||void 0===Ke?void 0:Ke.map(((e,t)=>(0,we.jsxs)("div",{className:J,children:[(0,ye.I)(e.type),(0,we.jsxs)("div",{className:K,children:[(0,we.jsx)("p",{className:"mb-0",children:(null===e||void 0===e?void 0:e.name)||""}),(0,we.jsxs)("p",{className:"mb-0",children:[parseFloat((null===e||void 0===e?void 0:e.size)/1024).toFixed(2)," KB - ",parseInt(null===e||void 0===e?void 0:e.progress)||0,"% uploaded"]})]}),(0,we.jsx)("div",{className:"ms-auto",children:e.error?(0,we.jsx)("div",{className:Y,children:(0,we.jsx)(c.A,{color:"#F04438",size:16})}):e.aiProcessing?(0,we.jsxs)("div",{className:X,children:[(0,we.jsx)("div",{className:Q}),(0,we.jsx)("span",{className:ee,children:"AI analyzing..."})]}):e.aiSuccess?(0,we.jsxs)("div",{className:te,children:[(0,we.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,we.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM7 11.4L3.6 8L5 6.6L7 8.6L11 4.6L12.4 6L7 11.4Z",fill:"#12B76A"})}),(0,we.jsx)("span",{className:se,children:"Data extracted"})]}):e.aiNoData?(0,we.jsxs)("div",{className:le,children:[(0,we.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,we.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM8 12C7.4 12 7 11.6 7 11C7 10.4 7.4 10 8 10C8.6 10 9 10.4 9 11C9 11.6 8.6 12 8 12ZM9 9H7V4H9V9Z",fill:"#F79009"})}),(0,we.jsx)("span",{className:ie,children:"No data found"})]}):e.aiError?(0,we.jsxs)("div",{className:ne,children:[(0,we.jsx)(c.A,{color:"#F04438",size:16}),(0,we.jsx)("span",{className:oe,children:"AI error"})]}):100==e.progress?(0,we.jsx)(u.A,{color:"#12B76A",size:20}):(0,we.jsx)(fe.A,{percentage:parseInt(null===e||void 0===e?void 0:e.progress)||0,size:30,color:"#158ECC"})})]},t)))]})]}),(0,we.jsx)(n.A,{sm:6,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Date",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsx)(g.xI,{name:"date",control:ht,render:e=>{let{field:t}=e;return(0,we.jsx)(N.V,{...t,onChange:e=>{t.onChange(e.value),setTimeout((()=>bt("due_date")),0)},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,we.jsx)(h.A,{color:"#667085",size:20}),className:(0,w.A)(z,{[O]:yt.date},"p-0 outline-none")})}}),(null===yt||void 0===yt?void 0:yt.date)&&(0,we.jsx)("p",{className:"error-message",children:null===(A=yt.date)||void 0===A?void 0:A.message})]})}),(0,we.jsx)(n.A,{sm:6,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Due Date",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsx)(g.xI,{name:"due_date",control:ht,render:e=>{let{field:t}=e;const s=jt("date"),l=s?new Date(s):null;return(0,we.jsx)(N.V,{...t,onChange:e=>{t.onChange(e.value),bt("due_date")},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",locale:"en",showIcon:!0,minDate:l,style:{height:"46px"},icon:(0,we.jsx)(h.A,{color:"#667085",size:20}),className:(0,w.A)(z,{[O]:yt.due_date},"p-0 outline-none")})}}),(null===yt||void 0===yt?void 0:yt.due_date)&&(0,we.jsx)("p",{className:"error-message",children:null===(B=yt.due_date)||void 0===B?void 0:B.message})]})}),(0,we.jsx)(n.A,{sm:6,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Total Amount",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsxs)(S.C,{children:[(0,we.jsx)(k.Y,{prefix:"$",value:jt("amount"),onValueChange:e=>{vt("amount",e.value),kt(gt("gst-calculation"))},onBlur:()=>kt(gt("gst-calculation")),style:{height:"46px",padding:"0px"},className:(0,w.A)(z,{[O]:yt.amount}),placeholder:"$ Enter total amount",maxFractionDigits:2,minFractionDigits:2,inputId:"minmaxfraction"}),(0,we.jsx)(F.m,{children:yt.amount&&(0,we.jsx)("img",{src:xe.A,className:"mb-3"})})]}),(null===yt||void 0===yt?void 0:yt.amount)&&(0,we.jsx)("p",{className:"error-message",children:null===(re=yt.amount)||void 0===re?void 0:re.message})]})}),(0,we.jsx)(n.A,{sm:6,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mb-2",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["GST",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsx)("input",{type:"hidden",...pt("nogst")}),(0,we.jsx)(g.xI,{name:"gst-calculation",control:ht,render:e=>{let{field:t}=e;return(0,we.jsx)(_.m,{...t,options:[{value:"ex",label:"GST Exclusive"},{value:"in",label:"GST Inclusive"},{value:"no",label:"No GST"}]||0,onChange:e=>{t.onChange(e.value),kt(e.value)},className:(0,w.A)(V,"dropdown-height-fixed",{[O]:null===yt||void 0===yt?void 0:yt.gst}),style:{height:"46px"},value:t.value,placeholder:"Select GST",filterInputAutoFocus:!0})}}),(null===yt||void 0===yt?void 0:yt.gst)&&(0,we.jsx)("p",{className:"error-message",children:null===(de=yt.gst)||void 0===de?void 0:de.message})]})})]}),(0,we.jsxs)(i.A,{className:`${Z}`,children:[(0,we.jsxs)(n.A,{className:"d-flex align-items-center justify-content-end",style:{position:"relative"},children:[(0,we.jsx)("div",{className:G,children:(0,we.jsxs)("div",{children:[(0,we.jsx)("span",{children:"Subtotal"}),(0,we.jsxs)("strong",{children:["$",(0,je.m)(jt("subtotal")||"0.00")]})]})}),(0,we.jsx)("div",{className:q,children:(0,we.jsx)(m.A,{color:"#667085",size:20})})]}),(0,we.jsxs)(n.A,{className:"d-flex align-items-center justify-content-end",style:{position:"relative"},children:[(0,we.jsx)("div",{className:G,children:(0,we.jsxs)("div",{children:[(0,we.jsx)("span",{children:"Tax"}),(0,we.jsxs)("strong",{children:["$",(0,je.m)(jt("tax")||"0.00")]})]})}),(0,we.jsx)("div",{className:q,children:(0,we.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",fontWeight:600},children:"="})})]}),(0,we.jsx)(n.A,{style:{position:"relative"},children:(0,we.jsx)("div",{className:`${W} ${G}`,children:(0,we.jsxs)("div",{children:[(0,we.jsx)("span",{children:"Total"}),(0,we.jsxs)("strong",{className:"text-nowrap",children:["$",(0,je.m)(jt("totalAmount")||"0.00")]})]})})})]}),(0,we.jsxs)(i.A,{className:(0,w.A)(P,"customSelectButton"),children:[(0,we.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:(0,we.jsx)(I.J,{value:Tt,className:ae,onChange:e=>Lt(e.value),options:It})}),"Assign to project"===Tt?(0,we.jsx)(n.A,{sm:12,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,we.jsx)(L.m,{position:"top",target:".info-timeinterval"}),(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Link to Project",(0,we.jsx)("span",{className:"required",children:"*"})," ",(0,we.jsx)(p.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Select an existing project to assign expenses and display the exact cost of using this asset."})]}),(0,we.jsx)(g.xI,{name:"order",control:ht,render:e=>{var t;let{field:s}=e;return(0,we.jsx)(_.m,{...s,options:(null===$t||void 0===$t||null===(t=$t.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{s.onChange(e.value)},className:(0,w.A)(V,"dropdown-height-fixed",{[O]:null===yt||void 0===yt?void 0:yt.order}),style:{height:"46px"},value:s.value,loading:null===$t||void 0===$t?void 0:$t.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,scrollHeight:"400px"})}}),(null===yt||void 0===yt?void 0:yt.order)&&(0,we.jsx)("p",{className:"error-message",children:null===(ce=yt.order)||void 0===ce?void 0:ce.message})]})}):(0,we.jsx)(n.A,{sm:12,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,we.jsx)(L.m,{position:"top",target:".info-timeinterval"}),(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Expense time interval",(0,we.jsx)("span",{className:"required",children:"*"})," ",(0,we.jsx)(p.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Selecting this option will categorize the expense under 'Operational Expense' and distribute it evenly over the chosen timeframe."})]}),(0,we.jsx)(g.xI,{name:"type",control:ht,render:e=>{let{field:t}=e;return(0,we.jsx)(_.m,{...t,options:[{value:1,label:"Monthly"},{value:2,label:"Yearly"}],onChange:e=>{t.onChange(e.value)},className:(0,w.A)(V,"dropdown-height-fixed",{[O]:null===yt||void 0===yt?void 0:yt.type}),style:{height:"46px"},value:t.value,placeholder:"Select expense time interval",filterInputAutoFocus:!0})}}),(null===yt||void 0===yt?void 0:yt.type)&&(0,we.jsx)("p",{className:"error-message",children:null===(ue=yt.type)||void 0===ue?void 0:ue.message})]})})]}),(0,we.jsx)(i.A,{className:(0,w.A)(P),children:(0,we.jsx)(n.A,{sm:12,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,we.jsx)("label",{className:(0,w.A)(M),children:"Notes"}),(0,we.jsxs)(S.C,{children:[(0,we.jsx)(F.m,{style:{top:"75%"},children:yt.note&&(0,we.jsx)("img",{src:xe.A,alt:"error-icon"})}),(0,we.jsx)($.Z,{...pt("note"),rows:3,cols:30,className:(0,w.A)(z,{[O]:yt.note}),style:{resize:"none"},placeholder:"Enter a note..."})]}),yt.note&&(0,we.jsx)("p",{className:"error-message",children:yt.note.message})]})})}),(0,we.jsx)(i.A,{className:(0,w.A)(P),children:(0,we.jsx)(n.A,{sm:12,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,we.jsx)("label",{className:(0,w.A)(M),children:"Account Code"}),(0,we.jsx)(g.xI,{name:"account_code",control:ht,render:e=>{var t;let{field:s}=e;return(0,we.jsx)(_.m,{...s,options:[...Et&&(null===Et||void 0===Et||null===(t=Et.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.code}: ${e.name}`}))))||[]]||[],onChange:e=>{s.onChange(e.value)},className:(0,w.A)(V,"dropdown-height-fixed",{[O]:null===yt||void 0===yt?void 0:yt.account_code}),style:{height:"46px"},scrollHeight:"400px",value:s.value,loading:null===Et||void 0===Et?void 0:Et.isFetching,placeholder:"Select account code",filter:!0,filterInputAutoFocus:!0})}}),(null===yt||void 0===yt?void 0:yt.account_code)&&(0,we.jsx)("p",{className:"error-message",children:null===(_e=yt.account_code)||void 0===_e?void 0:_e.message})]})})}),null!==ct&&void 0!==ct&&ct.length?(0,we.jsx)(i.A,{className:(0,w.A)(P),children:(0,we.jsx)(n.A,{sm:12,children:(0,we.jsx)("div",{className:"d-flex flex-column gap-1",children:(0,we.jsxs)("div",{className:"d-flex flex-column",children:[(0,we.jsx)("label",{className:(0,w.A)(M,"mb-2"),children:"Photo/Document Of The Expense"}),ct[0]&&(0,we.jsxs)("div",{className:J,children:[(0,ye.I)((null===(ke=ct[0])||void 0===ke||null===(Ee=ke.split("."))||void 0===Ee?void 0:Ee[(null===($e=ct[0])||void 0===$e?void 0:$e.split(".").length)-1])||""),(0,we.jsxs)("div",{className:K,children:[(0,we.jsx)(f.N_,{className:"linkText",to:ct[0],target:"_blank",children:(0,we.jsx)("p",{className:"mb-0",children:(null===(Ie=ct[0])||void 0===Ie||null===(Te=Ie.split("/"))||void 0===Te?void 0:Te[(null===(Le=ct[0])||void 0===Le?void 0:Le.split("/").length)-1])||""})}),(0,we.jsx)("p",{className:"mb-0"})]}),(0,we.jsx)("div",{className:"ms-auto",children:(0,we.jsx)("div",{className:"d-flex align-items-center justify-content-center",style:{background:"#FEE4E2",borderRadius:"200px",width:"30px",height:"30px"},children:(0,we.jsx)(x.A,{size:16,color:"#F04438",style:{cursor:"pointer"},onClick:()=>{vt("file",""),ut([]),nt(!1)}})})})]})]})})})}):""]}),(0,we.jsx)(T.B,{visible:it&&(null===ct||void 0===ct?void 0:ct.length),header:Ht,position:"right",modal:!1,dismissable:!1,style:{width:"1200px",paddingRight:"720px"},maskClassName:"p-sidebar-mask-document",onHide:()=>nt(!1),children:(0,we.jsx)(Se,{files:ct})}),Oe&&(0,we.jsx)(Fe,{visible:Oe,onHide:()=>Ve(!1)}),ot&&(0,we.jsx)(Ce.A,{visible:ot,setVisible:at,refetch:()=>dt((e=>!e))})]})})),Se=e=>{let{files:t}=e;const[s,i]=(0,l.useState)({}),n=(e,t)=>{i((s=>{var l,i;const n=(null===(l=s[e])||void 0===l?void 0:l.currentPage)||1,o=(null===(i=s[e])||void 0===i?void 0:i.numPages)||1,a=Math.min(Math.max(n+t,1),o);return{...s,[e]:{...s[e],currentPage:a}}}))};return(0,we.jsx)("div",{style:{display:"grid",gap:"2rem"},children:t.map(((e,t)=>{if(/\.(jpeg|jpg|png|webp|gif|svg)$/i.test(e))return(0,we.jsx)("img",{src:e,alt:`preview-${t}`,style:{maxWidth:"100%",maxHeight:"400px",border:"1px solid #ccc"}},t);if((e=>/\.pdf$/i.test(e))(e)){const l=s[e]||{},{numPages:o=null,currentPage:a=1}=l;return(0,we.jsxs)("div",{style:{border:"1px solid #ccc",padding:"1rem",maxWidth:"420px"},children:[(0,we.jsx)(j.yo,{file:e,onLoadSuccess:t=>((e,t)=>{let{numPages:s}=t;i((t=>({...t,[e]:{...t[e],numPages:s,currentPage:1}})))})(e,t),onLoadError:e=>console.error("PDF load error:",e),children:(0,we.jsx)(j.YW,{pageNumber:a,width:400})}),o&&(0,we.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"1rem",gap:"1rem"},children:[(0,we.jsx)("button",{className:"outline-button px-2",style:{height:"30px"},onClick:()=>n(e,-1),disabled:a<=1,children:"\u2039"}),(0,we.jsxs)("span",{children:[a," of ",o]}),(0,we.jsx)("button",{className:"outline-button px-2",style:{height:"30px"},onClick:()=>n(e,1),disabled:a>=o,children:"\u203a"})]})]},t)}return(0,we.jsxs)("p",{children:["Unsupported file type: ",e]},t)}))})},Fe=l.memo((e=>{var t;let{visible:s,onHide:a,defaultValues:d={}}=e;const c=(0,l.useRef)(null),[u,h]=(0,l.useState)((null===(t=d.supplier)||void 0===t?void 0:t.id)||""),[m,p]=(0,l.useState)(d.supplier||null),[x,v]=(0,l.useState)([]),[g,j]=(0,l.useState)(1),[b,y]=(0,l.useState)(""),[C,N]=(0,l.useState)(!0),[S,F]=(0,l.useState)([]),k=Ne((e=>{var t;const s=(null===e||void 0===e||null===(t=e.filter)||void 0===t?void 0:t.toLowerCase())||"";y(s)}),300);(0,l.useEffect)((()=>{j(1)}),[b]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,me.Jj)(g,25,b,"name");if(1===g){if(u){const t=e.results.filter((e=>e.id!==u));return v([m,...t])}v(e.results)}else{var t;if((null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t.length)>0){let t=e.results;u&&(t=[m,...e.results]),v((e=>{let s=e;u&&(s=[...e,m]);const l=new Set(s.map((e=>e.id))),i=t.filter((e=>!l.has(e.id)));return[...e,...i]}))}}N(e.count!==x.length)})()}),[g,b,u,m]),(0,l.useEffect)((()=>{if(x.length>0&&C){const e=setTimeout((()=>{const e=document.querySelector(".supplier-dropdown .p-dropdown-items li.p-dropdown-item:last-child");console.log("lastRow: ",e),e&&(c.current=new IntersectionObserver((e=>{e[0].isIntersecting&&(j((e=>e+1)),console.log("entries[0].isIntersecting: ",e[0].isIntersecting))})),c.current.observe(e))}),1e3);return()=>{clearTimeout(e),c.current&&c.current.disconnect()}}}),[x,C]);const E=(0,we.jsxs)("div",{className:`${de}`,children:[(0,we.jsx)("div",{className:ue,children:(0,we.jsx)("img",{src:pe,alt:"Review Icon"})}),(0,we.jsx)("span",{className:`white-space-nowrap ${ce}`,children:"Review"})]}),$=(0,we.jsx)("div",{className:"d-flex justify-content-end align-items-center gap-3"});return(0,we.jsxs)(A.l,{visible:s,modal:!0,onHide:a,header:E,footer:$,className:`${re} custom-modal`,children:[(0,we.jsxs)(i.A,{className:"mb-2",children:[(0,we.jsx)(n.A,{sm:8,children:(0,we.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,we.jsxs)("label",{className:(0,w.A)(M),children:["Supplier",(0,we.jsx)("span",{className:"required",children:"*"})]}),(0,we.jsx)(_.m,{value:u,options:x,optionLabel:"name",optionValue:"id",onChange:e=>{h(+e.value);let t=x.find((t=>t.id===e.value));p(t||{})},itemTemplate:e=>(0,we.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,we.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,we.jsx)(be.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,we.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}),valueTemplate:e=>u?(0,we.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,we.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,we.jsx)(be.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,we.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}):null,className:(0,w.A)(V,"dropdown-height-fixed"),panelClassName:"supplier-dropdown",style:{height:"46px"},scrollHeight:"350px",placeholder:"Search for supplier",filter:!0,onFilter:k,filterInputAutoFocus:!0})]})}),(0,we.jsx)(n.A,{sm:4,children:(0,we.jsx)("div",{className:"d-flex justify-content-end text-md-end flex-column gap-1 mt-3 pt-3",children:(0,we.jsx)(f.N_,{to:"/suppliers?addNewSupplier=true",target:"_blank",children:(0,we.jsxs)(o.A,{className:U,children:["Create New Supplier",(0,we.jsx)(r.A,{size:24,color:"#475467"})]})})})})]}),(0,we.jsx)("hr",{}),(0,we.jsx)(i.A,{})]})})),ke=_e},46229:(e,t,s)=>{s.d(t,{A:()=>H,Y:()=>R});var l=s(65043),i=s(27498),n=s(46679),o=s(35475),a=s(72018),r=s(75218),d=s(9642),c=s(64824),u=s(36766),h=s(38391),m=s(48417),p=s(14834),x=s(58027),v=s(27734),g=s(99868),j=s(77918),f=s(55797);const b="job-dialog_modal__6ffnW",y="job-dialog_modalHeader__j1WfV",C="job-dialog_headerTitle__sUBzz",w="job-dialog_weekNames__7amIz",N="job-dialog_weekName__H3JqX",A="job-dialog_iconJobstyle__ze7N8";var _=s(1690),S=s(70579);function F(e){let{visible:t,setVisible:s}=e;const l=(0,S.jsxs)("div",{className:`${y}`,children:[(0,S.jsx)("img",{src:_.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,S.jsx)("span",{className:`white-space-nowrap ${C}`,children:"Are you sure you want to stop cycle?"})]}),i=(0,S.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,S.jsx)(a.$,{label:"Stop Cycle",className:"danger-button",onClick:()=>s(!1),autoFocus:!0}),(0,S.jsx)(a.$,{label:"Cancel",className:"outline-button",onClick:()=>s(!1),autoFocus:!0})]});return(0,S.jsx)(f.l,{visible:t,modal:!0,header:l,footer:i,className:`${b} custom-modal`,onHide:()=>{t&&s(!1)},children:(0,S.jsxs)("div",{className:"",children:[(0,S.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,S.jsx)("h6",{style:{fontSize:"18px",color:"#101828",fontWeight:600,marginBottom:"16px"},children:"Job Details"}),(0,S.jsx)("p",{className:"font-14 mb-0",style:{color:"#475467"},children:"Job ID: 031-240003"})]}),(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Job Reference"}),(0,S.jsx)("h6",{style:{fontSize:"16px",color:"#475467",fontWeight:600,marginBottom:"16px"},children:"Enter the detailed quote for the client contract here. Include all relevant "})]})})}function k(e){let{visible:t,setVisible:s}=e;const[i,n]=(0,l.useState)(!1),o=(0,S.jsxs)("div",{className:`${y}`,children:[(0,S.jsx)("b",{className:A,children:(0,S.jsx)(j.A,{size:24,color:"#106B99"})}),(0,S.jsx)("span",{className:`white-space-nowrap ${C}`,children:"Job Details"})]}),d=(0,S.jsx)("div",{children:(0,S.jsx)(a.$,{label:"Stop Cycle",className:"danger-button",onClick:()=>n(!0),autoFocus:!0})});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.l,{visible:t,modal:!1,header:o,footer:d,className:`${b} custom-modal`,onHide:()=>{t&&s(!1)},children:(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Repeat"}),(0,S.jsx)("h6",{className:"font-16",style:{color:"#101828",fontWeight:600,marginBottom:"16px"},children:"Every Week"}),(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Repeat on"}),(0,S.jsxs)("div",{className:`d-flex ${w}`,children:[(0,S.jsx)(r.v,{className:`status ${N}`,label:"Monday"}),(0,S.jsx)(r.v,{className:`status ${N}`,label:"Wednesday"}),(0,S.jsx)(r.v,{className:`status ${N}`,label:"Thursday"})]}),(0,S.jsxs)("div",{className:"d-flex",children:[(0,S.jsxs)("div",{style:{width:"280px"},children:[(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Starts"}),(0,S.jsx)("p",{className:"font-16 mb-0",style:{color:"#101828",fontWeight:600},children:"12 Jul 2025"})]}),(0,S.jsxs)("div",{style:{width:"280px"},children:[(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Ends"}),(0,S.jsx)("p",{className:"font-16 mb-0",style:{color:"#101828",fontWeight:600},children:"12 Jul 2025"})]})]})]})}),(0,S.jsx)(F,{visible:i,setVisible:n})]})}var E=s(47663);const $="show-job-declined_modal__4txtg",I="show-job-declined_modalHeader__1+kdQ",T="show-job-declined_headerTitle__FKgix",L="show-job-declined_iconStyle__A0wYR",D=e=>{let{showDeclined:t,setShowDeclined:s,message:l}=e;const i=(0,S.jsxs)("div",{className:`${I}`,children:[(0,S.jsx)("div",{className:L,children:(0,S.jsx)(E.A,{color:"#F04438",size:16})}),(0,S.jsx)("span",{className:`white-space-nowrap ${T}`,children:"Job Declined"})]});return(0,S.jsx)(f.l,{visible:t,modal:!1,header:i,contentClassName:"border-0 bg-transparent",className:`${$} custom-modal`,onHide:()=>{s(!1)},children:(0,S.jsxs)("div",{className:"",children:[(0,S.jsx)("p",{className:"font-14 mb-1",style:{color:"#667085"},children:"Note:"}),(0,S.jsx)("h6",{style:{fontSize:"16px",color:"#475467",fontWeight:600,marginBottom:"16px"},children:l})]})})};var B=s(56008);const R=e=>{try{const t=new Date(1e3*e),s=t.getDate(),l=new Intl.DateTimeFormat("en-US",{month:"short"}).format(t);return`${s} ${l} ${t.getFullYear()}`}catch(t){return console.error("Error formatting date:",t),""}},H=(0,l.forwardRef)(((e,t)=>{let{searchValue:s,setTotal:j,selected:f,setSelected:b,refetch:y,setRefetch:C,createJobVisible:w,isCreateJobVisible:N,isFilterEnabled:A,filters:_}=e;const{trialHeight:F}=(0,m.$)(),E=(0,l.useRef)(null),[$,I]=(0,l.useState)(!1),[T,L]=(0,l.useState)(!1),[H,P]=(0,l.useState)(""),[M,z]=(0,l.useState)({visible:!1,jobId:null}),[O,V]=(0,l.useState)(!1),[U,q]=(0,l.useState)({}),[Z,G]=(0,l.useState)([]),[W,J]=(0,l.useState)(1),[K,Y]=(0,l.useState)({sortField:"id",sortOrder:-1}),[X,Q]=(0,l.useState)({sortField:"id",sortOrder:-1}),[ee,te]=(0,l.useState)(!0),[se,le]=(0,l.useState)(!1),ie=l.useMemo((()=>window.location.href),[]),ne=l.useMemo((()=>new URL(ie)),[ie]),oe=l.useMemo((()=>new URLSearchParams(ne.search)),[ne]);(0,l.useEffect)((()=>{J(1)}),[s,y,_]),(0,l.useEffect)((()=>{oe.get("jobId")&&(z({visible:!0,jobId:oe.get("jobId")}),ne.searchParams.delete("jobId"),window.history.replaceState({},"",ne))}),[oe]),(0,l.useEffect)((()=>{(async()=>{le(!0);let e="";1===(null===X||void 0===X?void 0:X.sortOrder)?e=`${X.sortField}`:-1===(null===X||void 0===X?void 0:X.sortOrder)&&(e=`-${X.sortField}`);const t=await(0,h.Gj)(W,25,s,e,_);var l;(j((()=>(null===t||void 0===t?void 0:t.count)||0)),1===W)?G(t.results):(null===t||void 0===t||null===(l=t.results)||void 0===l?void 0:l.length)>0&&G((e=>{const s=new Set(e.map((e=>e.id))),l=t.results.filter((e=>!s.has(e.id)));return[...e,...l]}));Y(X),te(t.count!==Z.length),le(!1)})()}),[W,s,X,y,_]),(0,l.useEffect)((()=>{if(Z.length>0&&ee){E.current=new IntersectionObserver((e=>{e[0].isIntersecting&&J((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&E.current.observe(e)}return()=>{E.current&&E.current.disconnect()}}),[Z,ee]),(0,l.useEffect)((()=>{N&&(V(!1),z({jobId:null,visible:!1}))}),[N]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(c.b,{ref:t,value:Z,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${F}px - ${A?56:0}px)`,className:"border",selection:f,onSelectionChange:e=>b(e.value),loading:se,loadingIcon:v.A,emptyMessage:(0,S.jsx)(g.A,{isDataExist:!!s}),sortField:null===K||void 0===K?void 0:K.sortField,sortOrder:null===K||void 0===K?void 0:K.sortOrder,onSort:e=>{const{sortField:t,sortOrder:s}=e;Q({sortField:t,sortOrder:s}),J(1)},rowClassName:e=>null!==e&&void 0!==e&&e.deleted?u.A.deletedRow:"",children:[(0,S.jsx)(d.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,S.jsx)(d.V,{field:"number",header:"Job ID",body:e=>(0,S.jsxs)("div",{className:"d-flex gap-2 align-items-center justify-content-center show-on-hover",children:[(0,S.jsxs)("div",{className:"d-flex flex-column",style:{lineHeight:"1.385"},children:[(0,S.jsx)("span",{children:e.number}),(0,S.jsx)("span",{className:"font-12",style:{color:"#98A2B3"},children:R(e.created)})]}),(null===e||void 0===e?void 0:e.is_recurring)&&(0,S.jsx)(i.A,{color:"#158ECC"}),(0,S.jsx)(a.$,{label:"Open",onClick:()=>{w(!1),V(!1),z({jobId:e.id,visible:!0})},className:"primary-text-button ms-3 show-on-hover-element",text:!0})]}),style:{minWidth:"100px"},className:"ps-0",headerClassName:"ps-0",frozen:!0,sortable:!0}),(0,S.jsx)(d.V,{field:"type",header:"Job Type",body:e=>"Fix"===e.type_display&&"Shift"===e.time_type_display?(0,S.jsxs)("div",{className:u.A.type,children:[(0,S.jsx)("div",{className:u.A.shift,children:"Shift"}),(0,S.jsx)("div",{className:u.A.fix,children:"Fix"})]}):"Fix"===e.type_display&&"Time frame"===e.time_type_display?(0,S.jsxs)("div",{className:u.A.type,children:[(0,S.jsx)("div",{className:u.A.timeFrame,children:"Time Frame"}),(0,S.jsx)("div",{className:u.A.fix,children:"Fix"})]}):"Hours"===e.type_display&&"Shift"===e.time_type_display?(0,S.jsxs)("div",{className:u.A.type,children:[(0,S.jsx)("div",{className:u.A.shift,children:"Shift"}),(0,S.jsx)("div",{className:u.A.hours,children:"Hours"})]}):"Hours"===e.type_display&&"Time frame"===e.time_type_display?(0,S.jsxs)("div",{className:u.A.type,children:[(0,S.jsx)("div",{className:u.A.timeFrame,children:"Time Frame"}),(0,S.jsx)("div",{className:u.A.hours,children:"Hours"})]}):"Time Tracker"===e.type_display&&"Time frame"===e.time_type_display?(0,S.jsxs)("div",{className:u.A.type,children:[(0,S.jsx)("div",{className:u.A.timeTracker,children:"Time Tracker"}),(0,S.jsx)("div",{className:u.A.timeFrame2,children:"Time Frame"})]}):"",style:{minWidth:"100px"},bodyClassName:`${u.A.shadowRight}`,headerClassName:`${u.A.shadowRight}`,frozen:!0,sortable:!0}),(0,S.jsx)(d.V,{field:"start_date",header:"Start",body:e=>(0,S.jsx)("span",{style:{color:"#667085"},children:R(e.start_date)}),style:{minWidth:"122px"},sortable:!0}),(0,S.jsx)(d.V,{field:"end_date",header:"Finish",body:e=>(0,S.jsx)("span",{style:{color:"#667085"},children:R(e.end_date)}),style:{minWidth:"122px"},sortable:!0}),(0,S.jsx)(d.V,{field:"worker.firstname",header:"Name A\u2192Z",body:e=>{var t,s,l,i;if("1"===e.status)return(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:`d-flex justify-content-center align-items-center ${u.A.clientName}`,children:(0,S.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 20 20",fill:"none",children:[(0,S.jsx)("path",{d:"M7.14307 6.57171C6.82748 6.57171 6.57164 6.82754 6.57164 7.14314C6.57164 7.45873 6.82748 7.71457 7.14307 7.71457H12.8574C13.1729 7.71457 13.4288 7.45873 13.4288 7.14314C13.4288 6.82754 13.1729 6.57171 12.8574 6.57171H7.14307Z",fill:"#475467"}),(0,S.jsx)("path",{d:"M7.14307 8.85742C6.82748 8.85742 6.57164 9.11326 6.57164 9.42885C6.57164 9.74444 6.82748 10.0003 7.14307 10.0003H10.5716C10.8872 10.0003 11.1431 9.74444 11.1431 9.42885C11.1431 9.11326 10.8872 8.85742 10.5716 8.85742H7.14307Z",fill:"#475467"}),(0,S.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0002 3.14314C11.2626 3.14314 12.2859 2.11979 12.2859 0.857422H15.1431C16.0898 0.857422 16.8574 1.62493 16.8574 2.57171V17.4289C16.8574 18.3756 16.0898 19.1431 15.1431 19.1431H4.85735C3.91058 19.1431 3.14307 18.3756 3.14307 17.4289V2.57171C3.14307 1.62493 3.91058 0.857422 4.85735 0.857422H7.7145C7.7145 2.11979 8.73784 3.14314 10.0002 3.14314ZM10.0002 4.28599C11.493 4.28599 12.763 3.33193 13.2337 2.00028H15.1431C15.4587 2.00028 15.7145 2.25612 15.7145 2.57171V17.4289C15.7145 17.7444 15.4587 18.0003 15.1431 18.0003H4.85735C4.54176 18.0003 4.28592 17.7444 4.28592 17.4289V2.57171C4.28592 2.25612 4.54176 2.00028 4.85735 2.00028H6.76673C7.2374 3.33193 8.50739 4.28599 10.0002 4.28599Z",fill:"#475467"})]})}),"Open Jobs"]});const n=`${null===e||void 0===e||null===(t=e.worker)||void 0===t?void 0:t.first_name} ${null===e||void 0===e||null===(s=e.worker)||void 0===s?void 0:s.last_name}`;return(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:`d-flex justify-content-center align-items-center ${u.A.clientName}`,children:(0,S.jsx)(x.A,{photo:null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.photo,is_business:!1,has_photo:!(null===e||void 0===e||null===(i=e.worker)||void 0===i||!i.photo)||!1})}),n]})},style:{minWidth:"205px"}}),(0,S.jsx)(d.V,{field:"reference",header:"Job Reference",style:{minWidth:"270px"}}),(0,S.jsx)(d.V,{field:"status",header:"Status",body:e=>{const t=e.status;if(!e.published)return(0,S.jsx)(r.v,{className:`status ${u.A.DRAFT} font-14`,label:"Draft"});if("a"===t&&e.action_status)return(0,S.jsx)(r.v,{className:`status ${u.A.IN_PROGRESS} font-14`,label:"In Progress"});switch(t){case"1":return(0,S.jsx)(r.v,{className:`status ${u.A.OPEN} font-14`,label:"Open"});case"2":return(0,S.jsx)(r.v,{className:`status ${u.A.ASSIGNED} font-14`,label:"Assigned"});case"3":return(0,S.jsx)(r.v,{className:`status ${u.A.SUBMITTED} font-14`,label:"Submitted"});case"4":return(0,S.jsx)(r.v,{className:`status ${u.A.FINISHED} font-14`,label:"Finished"});case"6":return(0,S.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,S.jsx)(r.v,{className:`status ${u.A.DECLINED} font-14`,label:"Declined"}),(0,S.jsx)(n.A,{color:"#158ECC",className:"cursor-pointer",onClick:()=>{L(!0),P(e.decline_message)}})]});case"a":return(0,S.jsx)(r.v,{className:`status ${u.A.CONFIRMED} font-14`,label:"Confirmed"});default:return(0,S.jsx)(r.v,{className:`status ${u.A.defaultStatus} font-14`,label:t})}},style:{minWidth:"120px"}}),(0,S.jsx)(d.V,{field:"project.number",header:"Linked To Project",body:e=>{var t,s,l,i,n,a,r,d,c,h;return null!==e&&void 0!==e&&e.project?(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:`d-flex justify-content-center align-items-center ${u.A.clientImg} ${null!==e&&void 0!==e&&null!==(t=e.client)&&void 0!==t&&t.is_business?u.A.square:"rounded-circle"}`,children:(0,S.jsx)(x.A,{photo:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.photo,is_business:(null===e||void 0===e||null===(l=e.client)||void 0===l?void 0:l.is_business)||!1,has_photo:(null===e||void 0===e||null===(i=e.client)||void 0===i?void 0:i.has_photo)||!1})}),(0,S.jsxs)("div",{className:"d-flex flex-column",style:{lineHeight:"1.385"},children:[(0,S.jsx)("span",{children:null===e||void 0===e||null===(n=e.project)||void 0===n?void 0:n.reference}),(0,S.jsxs)("span",{className:"font-12",style:{color:"#98A2B3"},children:[(0,S.jsx)(o.N_,{className:`${u.A.linkToProjectCard}`,to:`/management?unique_id=${null===e||void 0===e||null===(a=e.project)||void 0===a?void 0:a.unique_id}&reference=${null===e||void 0===e||null===(r=e.project)||void 0===r?void 0:r.reference}&number=${null===e||void 0===e||null===(d=e.project)||void 0===d?void 0:d.number}`,children:null===e||void 0===e||null===(c=e.project)||void 0===c?void 0:c.number})," | ",null===e||void 0===e||null===(h=e.client)||void 0===h?void 0:h.name]})]})]}):"-"},style:{minWidth:"105px"}}),(0,S.jsx)(d.V,{field:"time_assigned",header:"Time Assigned",body:e=>(0,S.jsxs)("span",{style:{color:"#667085"},children:[parseFloat(e.time_assigned).toFixed(2),"h"]}),style:{minWidth:"117px"}}),(0,S.jsx)(d.V,{field:"real_time",header:"Real Time",body:e=>{var t;const[s,l,i]=null===e||void 0===e||null===(t=e.real_time)||void 0===t?void 0:t.split(":").map(Number);return(0,S.jsxs)("span",{style:{color:"#667085"},children:[parseFloat(s+l/60+i/3600).toFixed(2),"h"]})},bodyClassName:"text-end",headerClassName:"text-center",style:{minWidth:"88px"}}),(0,S.jsx)(d.V,{field:"variations",header:"Variation",body:e=>(0,S.jsx)("span",{style:{color:"#667085"},children:parseFloat(e.variations||0)<0?`-$${e.variations||0}`:`$${e.variations}`}),style:{minWidth:"88px"},sortable:!0}),(0,S.jsx)(d.V,{field:"total",header:"Total",body:e=>(0,S.jsxs)("span",{style:{color:"#667085"},children:["$",(0,p.m)(e.total||0)]}),style:{minWidth:"105px"},sortable:!0})]}),(0,S.jsx)(k,{visible:$,setVisible:I,jobDetails:U}),(0,S.jsx)(D,{showDeclined:T,setShowDeclined:L,message:H}),(0,S.jsx)(B.A,{visible:null===M||void 0===M?void 0:M.visible,jobId:null===M||void 0===M?void 0:M.jobId,setVisible:e=>z((t=>({...t,visible:e}))),setRefetch:C,editMode:O,setEditMode:V})]})}))},56008:(e,t,s)=>{s.d(t,{A:()=>A});var l=s(65043),i=s(14282),n=s(13846),o=s(65975),a=s(61072),r=s(78602),d=s(56741),c=s(9634),u=s(93257),h=s(73216),m=s(93747),p=s(47097),x=s(58387),v=s(93740),g=s(20288),j=s(56328),f=s(34558),b=s(93137),y=s(38391),C=s(46229),w=s(11281),N=s(70579);const A=e=>{let{visible:t,setVisible:s,jobId:A,setRefetch:_,editMode:S,setEditMode:F}=e;const[k,E]=(0,l.useState)(!1),[$,I]=(0,l.useState)(!1),T=(0,h.Zp)();let L={7:"WEEK",14:"TWO_WEEKS",28:"FOUR_WEEKS",1:"MONTH"};const D=(0,m.I)({queryKey:["jobRead",A],queryFn:()=>(0,y.ax)(A),enabled:!!A,retry:1}),B=null===D||void 0===D?void 0:D.data,R=null===D||void 0===D?void 0:D.isFetching,H=()=>{s(!1),F(!0)},P=e=>{const t=new Date(1e3*+e.start_date),s=(new Date(1e3*+e.end_date)-t)/864e5,l=Number(e.duration)||0;return(s>0?Math.round(l/s*100)/100:0).toFixed(2)},M=(0,p.n)({mutationFn:()=>(0,y.XX)(A),onSuccess:()=>{s(!1),_((e=>!e)),j.oR.success("Job deleted successfully")},onError:e=>{console.error("Error deleting job:",e),j.oR.error("Failed to delete job")}});return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(g.B,{visible:t,position:"right",onHide:()=>s(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{var t,l,h,m,p,g,j,f,y,w;let{closeIconRef:_,hide:S}=e;return(0,N.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"12px"},children:[(0,N.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,N.jsx)("div",{className:b.A.viewBox,children:(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:(0,N.jsx)("path",{d:"M9.75 1.5C8.5076 1.5 7.5 2.50675 7.5 3.74963V4.5H2.25C1.00736 4.5 0 5.50736 0 6.75V18.75C0 19.9926 1.00736 21 2.25 21H21.75C22.9926 21 24 19.9926 24 18.75V6.75C24 5.50736 22.9926 4.5 21.75 4.5H16.5V3.74963C16.5 2.50675 15.4924 1.5 14.25 1.5H9.75ZM9.75 3H14.25C14.6645 3 15 3.33695 15 3.75092V4.5H9V3.74963C9 3.33566 9.33555 3 9.75 3ZM12.5797 13.3716L22.5 10.7262V18.75C22.5 19.1642 22.1642 19.5 21.75 19.5H2.25C1.83579 19.5 1.5 19.1642 1.5 18.75V10.7262L11.4203 13.3716C11.8001 13.4729 12.1999 13.4729 12.5797 13.3716ZM2.25 6H21.75C22.1642 6 22.5 6.33579 22.5 6.75V9.17379L12.1932 11.9223C12.0666 11.956 11.9334 11.956 11.8068 11.9223L1.5 9.17379V6.75C1.5 6.33579 1.83579 6 2.25 6Z",fill:"#079455"})})}),(0,N.jsx)("span",{className:b.A.viewHeading,children:"Job Details"})]}),(0,N.jsx)("span",{children:(0,N.jsx)(i.A,{type:"button",className:"text-button",ref:_,onClick:e=>S(e),children:(0,N.jsx)(d.A,{size:24,color:"#667085"})})})]}),(0,N.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 68px - 102px)",overflow:"auto"},children:[(0,N.jsxs)("div",{className:(0,x.A)("d-flex justify-content-between align-items-center mb-3"),children:[(0,N.jsx)("h1",{className:b.A.heading,children:"Job Details"}),(0,N.jsx)("div",{className:"d-flex align-items-center gap-2",children:(0,N.jsxs)("span",{className:"font-14",children:["Job ID: ",A]})})]}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsxs)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0"),children:[(0,N.jsxs)("div",{className:"form-group mb-3",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Job Reference"}),R?(0,N.jsx)(o.A,{as:"p",animation:"wave",style:{marginBottom:"0px"},children:(0,N.jsx)(o.A,{bg:"secondary",style:{height:"20px",width:"50%",borderRadius:"4px"},size:"lg"})}):(0,N.jsx)("p",{className:(0,x.A)(b.A.text),children:(null===B||void 0===B?void 0:B.short_description)||"-"})]}),(0,N.jsxs)("div",{className:"form-group mb-3",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Job Description"}),R?(0,N.jsx)(o.A,{as:"p",animation:"wave",style:{marginBottom:"0px"},children:(0,N.jsx)(o.A,{bg:"secondary",style:{height:"40px",width:"100%",borderRadius:"4px"},size:"lg"})}):(0,N.jsx)("p",{className:(0,x.A)(b.A.text,!$&&b.A.description,"mb-0"),children:(null===B||void 0===B?void 0:B.long_description)||"-"}),!R&&(null===B||void 0===B||null===(t=B.long_description)||void 0===t?void 0:t.length)>200&&(0,N.jsx)("button",{onClick:()=>I(!$),className:b.A.toggleButton,children:$?"Show Less":"Show More"})]})]})}),(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"Assigned to"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsx)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0 py-4"),children:"1"===(null===B||void 0===B?void 0:B.status)?(0,N.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,N.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,N.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 20 20",fill:"none",children:[(0,N.jsx)("path",{d:"M7.14307 6.57171C6.82748 6.57171 6.57164 6.82754 6.57164 7.14314C6.57164 7.45873 6.82748 7.71457 7.14307 7.71457H12.8574C13.1729 7.71457 13.4288 7.45873 13.4288 7.14314C13.4288 6.82754 13.1729 6.57171 12.8574 6.57171H7.14307Z",fill:"#475467"}),(0,N.jsx)("path",{d:"M7.14307 8.85742C6.82748 8.85742 6.57164 9.11326 6.57164 9.42885C6.57164 9.74444 6.82748 10.0003 7.14307 10.0003H10.5716C10.8872 10.0003 11.1431 9.74444 11.1431 9.42885C11.1431 9.11326 10.8872 8.85742 10.5716 8.85742H7.14307Z",fill:"#475467"}),(0,N.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0002 3.14314C11.2626 3.14314 12.2859 2.11979 12.2859 0.857422H15.1431C16.0898 0.857422 16.8574 1.62493 16.8574 2.57171V17.4289C16.8574 18.3756 16.0898 19.1431 15.1431 19.1431H4.85735C3.91058 19.1431 3.14307 18.3756 3.14307 17.4289V2.57171C3.14307 1.62493 3.91058 0.857422 4.85735 0.857422H7.7145C7.7145 2.11979 8.73784 3.14314 10.0002 3.14314ZM10.0002 4.28599C11.493 4.28599 12.763 3.33193 13.2337 2.00028H15.1431C15.4587 2.00028 15.7145 2.25612 15.7145 2.57171V17.4289C15.7145 17.7444 15.4587 18.0003 15.1431 18.0003H4.85735C4.54176 18.0003 4.28592 17.7444 4.28592 17.4289V2.57171C4.28592 2.25612 4.54176 2.00028 4.85735 2.00028H6.76673C7.2374 3.33193 8.50739 4.28599 10.0002 4.28599Z",fill:"#475467"})]})}),"Open Jobs"]}):(0,N.jsxs)(a.A,{className:(0,x.A)(b.A.chooseUserBox,"flex-nowrap","w-75"),children:[(0,N.jsx)(r.A,{sm:2,className:"p-0",children:R?(0,N.jsx)(o.A,{as:"p",animation:"wave",style:{marginBottom:"0px"},children:(0,N.jsx)(o.A,{bg:"secondary",style:{height:"62px",width:"62px",borderRadius:"50%"},size:"lg"})}):(0,N.jsx)("div",{className:"d-flex justify-content-center align-items-center border",style:{width:"62px",height:"62px",borderRadius:"50%",overflow:"hidden"},children:null!==B&&void 0!==B&&null!==(l=B.worker)&&void 0!==l&&l.has_photo?(0,N.jsx)("img",{src:null===B||void 0===B||null===(h=B.worker)||void 0===h?void 0:h.photo,style:{width:"62px",height:"62px",borderRadius:"50%"}}):(0,N.jsx)("span",{className:"font-16",children:null===B||void 0===B||null===(m=B.worker)||void 0===m?void 0:m.alias})})}),(0,N.jsxs)(r.A,{sm:5,className:"pe-0 ps-0",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.assignedUser,"text-nowrap"),children:R?(0,N.jsx)(o.A,{as:"p",animation:"wave",style:{marginBottom:"0px"},children:(0,N.jsx)(o.A,{bg:"secondary",style:{height:"20px",width:"150px",borderRadius:"4px"},size:"lg"})}):(0,N.jsx)(N.Fragment,{children:(null===B||void 0===B||null===(p=B.worker)||void 0===p?void 0:p.full_name)||"-"})}),(0,N.jsx)("div",{style:{background:"#EBF8FF",border:"1px solid #A3E0FF",borderRadius:"23px",textAlign:"center"},children:"Employee"})]}),(0,N.jsxs)(r.A,{sm:5,className:"",children:[(0,N.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,N.jsx)("div",{style:{width:"16px",height:"16px",background:"#EBF8FF",border:"1px solid #A3E0FF",borderRadius:"23px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:"$"}),R?(0,N.jsx)(o.A,{as:"p",animation:"wave",style:{marginBottom:"0px"},children:(0,N.jsx)(o.A,{bg:"secondary",style:{height:"20px",width:"100px",borderRadius:"4px"},size:"lg"})}):(0,N.jsxs)("span",{children:[(null===B||void 0===B||null===(g=B.worker)||void 0===g?void 0:g.hourly_rate)||"-"," AUD"]})]}),(0,N.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,N.jsx)("div",{style:{width:"16px",height:"16px",background:"#EBF8FF",border:"1px solid #A3E0FF",borderRadius:"23px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,N.jsx)(c.A,{color:"#158ECC",size:16})}),(0,N.jsx)("span",{children:L[null===B||void 0===B||null===(j=B.worker)||void 0===j?void 0:j.payment_cycle]||"-"})]})]})]})})}),(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"Time / Money"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsxs)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0 d-flex flex-column gap-3"),children:[(0,N.jsxs)("div",{className:"d-flex gap-3",children:[(0,N.jsxs)("div",{className:b.A.paymentType,children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Payment Type"}),"2"===(null===B||void 0===B?void 0:B.type)&&(0,N.jsxs)("div",{className:`flex align-items-center ${b.A.RadioButton}`,children:[(0,N.jsx)("input",{type:"radio",id:"fix",value:"2",checked:!0,className:b.A.customRadio}),(0,N.jsx)("label",{htmlFor:"fix",className:(0,x.A)(b.A.radioLabel,b.A.fix),children:"Fix"})]}),"3"===(null===B||void 0===B?void 0:B.type)&&(0,N.jsxs)("div",{className:`flex align-items-center ${b.A.RadioButton}`,children:[(0,N.jsx)("input",{type:"radio",id:"fix",value:"3",checked:!0,className:b.A.customRadio}),(0,N.jsx)("label",{htmlFor:"hours",className:(0,x.A)(b.A.radioLabel,b.A.hours),children:"Hours"})]}),"4"===(null===B||void 0===B?void 0:B.type)&&(0,N.jsxs)("div",{className:`flex align-items-center ${b.A.RadioButton}`,children:[(0,N.jsx)("input",{type:"radio",id:"fix",value:"4",checked:!0,className:b.A.customRadio}),(0,N.jsx)("label",{htmlFor:"timetracker",className:(0,x.A)(b.A.radioLabel,b.A.timetracker),children:"Time Tracker"})]})]}),(0,N.jsxs)("div",{className:"d-flex align-items-center gap-3",children:["2"!==(null===B||void 0===B?void 0:B.type)&&(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Hours"}),(0,N.jsxs)("div",{className:b.A.paymentBox,children:[(0,N.jsx)("div",{className:b.A.dollarBox,children:(0,N.jsx)("span",{style:{fontSize:"14px",color:"#158ECC"},children:"H"})}),null===B||void 0===B?void 0:B.duration]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Payment"}),(0,N.jsxs)("div",{className:b.A.paymentBox,children:[(0,N.jsx)("div",{className:b.A.dollarBox,children:(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,N.jsx)("path",{d:"M4 10.7813C4.14782 12.4484 5.51294 13.6306 7.59107 13.7837V15H8.63448V13.7837C10.9039 13.6051 12.3125 12.3463 12.3125 10.4836C12.3125 8.89307 11.3647 7.97448 9.35617 7.45565L8.63448 7.26853V3.46659C9.75615 3.57716 10.5126 4.18104 10.7039 5.08262H12.1734C12.0082 3.4836 10.6343 2.33536 8.63448 2.20778V1H7.59107V2.23329C5.65207 2.46294 4.32172 3.70474 4.32172 5.38882C4.32172 6.84326 5.28687 7.87242 6.98241 8.3062L7.59107 8.4678V12.4994C6.44332 12.3293 5.65207 11.6999 5.46077 10.7813H4ZM7.39108 6.94532C6.34767 6.68165 5.79119 6.12029 5.79119 5.32928C5.79119 4.38518 6.49549 3.68773 7.59107 3.50061V6.99635L7.39108 6.94532ZM8.98228 8.81652C10.2692 9.13973 10.8343 9.67558 10.8343 10.5857C10.8343 11.6829 10.0083 12.4143 8.63448 12.5249V8.73147L8.98228 8.81652Z",fill:"#158ECC"})})}),null===B||void 0===B?void 0:B.cost," AUD"]})]})]})]}),(0,N.jsxs)("div",{className:"d-flex gap-3",children:[(0,N.jsxs)("div",{className:b.A.paymentType,children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Time"}),"1"===(null===B||void 0===B?void 0:B.time_type)&&(0,N.jsxs)("div",{className:`flex align-items-center ${b.A.RadioButton}`,children:[(0,N.jsx)("input",{type:"radio",id:"shift",value:"1",checked:!0,className:b.A.customRadio}),(0,N.jsx)("label",{htmlFor:"shift",className:(0,x.A)(b.A.radioLabel,b.A.shift),children:"Shift"})]}),"T"===(null===B||void 0===B?void 0:B.time_type)&&(0,N.jsxs)("div",{className:`flex align-items-center ${b.A.RadioButton}`,children:[(0,N.jsx)("input",{type:"radio",id:"shift",value:"T",checked:!0,className:b.A.customRadio}),(0,N.jsx)("label",{htmlFor:"timeframe",className:(0,x.A)(b.A.radioLabel,b.A.timeFrame),children:"Time Frame"})]})]}),(0,N.jsxs)("div",{className:"",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Starts"}),(0,N.jsxs)("div",{className:b.A.paymentBox,children:[(0,N.jsx)("div",{className:b.A.dollarBox,children:(0,N.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[(0,N.jsx)("path",{d:"M8.51496 1.01896C8.34401 1.00635 8.17225 1 8 1V0C8.19685 0 8.39314 0.00726199 8.58852 0.0216722L8.51496 1.01896ZM10.5193 1.46905C10.1985 1.34533 9.86912 1.2454 9.53371 1.17008L9.75282 0.194382C10.1361 0.280463 10.5126 0.394665 10.8792 0.536055L10.5193 1.46905ZM11.889 2.17971C11.7458 2.08402 11.5994 1.99388 11.4503 1.90939L11.9432 1.0393C12.1136 1.13586 12.2809 1.23888 12.4446 1.34824C12.6082 1.4576 12.7674 1.5727 12.9219 1.69322L12.3066 2.48158C12.1715 2.37612 12.0322 2.27541 11.889 2.17971ZM13.7231 3.96934C13.5252 3.68829 13.3068 3.42218 13.0697 3.17321L13.794 2.48368C14.0649 2.76821 14.3145 3.07233 14.5407 3.39353L13.7231 3.96934ZM14.4672 5.32122C14.4012 5.16208 14.3296 5.00583 14.2526 4.85271L15.1458 4.40311C15.2339 4.5781 15.3157 4.75667 15.391 4.93853C15.4664 5.12039 15.5348 5.30453 15.5962 5.49054L14.6467 5.80423C14.5929 5.64147 14.5331 5.48035 14.4672 5.32122ZM14.9979 7.82822C14.9895 7.48455 14.9557 7.14197 14.8969 6.80326L15.8822 6.63231C15.9494 7.01939 15.988 7.41092 15.9976 7.80367L14.9979 7.82822ZM14.8655 9.36563C14.8991 9.1967 14.9264 9.02699 14.9474 8.85687L15.9398 8.97929C15.9159 9.17372 15.8847 9.36766 15.8463 9.56072C15.8079 9.75378 15.7625 9.94489 15.7102 10.1337L14.7464 9.867C14.7922 9.70179 14.8319 9.53457 14.8655 9.36563ZM13.914 11.745C14.0979 11.4546 14.2602 11.151 14.3995 10.8367L15.3137 11.2419C15.1545 11.6011 14.969 11.9481 14.7588 12.28L13.914 11.745ZM12.9497 12.9497C13.0715 12.828 13.1885 12.702 13.3005 12.5722L14.0577 13.2254C13.9297 13.3737 13.796 13.5177 13.6569 13.6569L12.9497 12.9497Z",fill:"#158ECC"}),(0,N.jsx)("path",{d:"M8 1C6.84885 1 5.71545 1.2839 4.70022 1.82655C3.68499 2.3692 2.81926 3.15386 2.17971 4.11101C1.54017 5.06816 1.14654 6.16827 1.03371 7.31388C0.920876 8.45949 1.09232 9.61525 1.53285 10.6788C1.97337 11.7423 2.66939 12.6808 3.55925 13.4111C4.44911 14.1414 5.50533 14.6409 6.63437 14.8655C7.76341 15.0901 8.93041 15.0327 10.032 14.6986C11.1336 14.3644 12.1358 13.7637 12.9497 12.9497L13.6569 13.6569C12.7266 14.5871 11.5812 15.2736 10.3223 15.6555C9.06332 16.0374 7.72961 16.1029 6.43928 15.8463C5.14895 15.5896 3.94183 15.0187 2.92486 14.1841C1.90788 13.3495 1.11243 12.2769 0.608966 11.0615C0.105504 9.846 -0.0904279 8.52514 0.0385242 7.21586C0.167476 5.90659 0.617333 4.64933 1.34825 3.55544C2.07916 2.46155 3.06857 1.5648 4.22883 0.94463C5.38909 0.324457 6.68439 0 8 0V1Z",fill:"#158ECC"}),(0,N.jsx)("path",{d:"M7.5 3C7.77614 3 8 3.22386 8 3.5V8.70984L11.2481 10.5659C11.4878 10.7029 11.5711 11.0083 11.4341 11.2481C11.2971 11.4878 10.9917 11.5711 10.7519 11.4341L7.25193 9.43412C7.09615 9.3451 7 9.17943 7 9V3.5C7 3.22386 7.22386 3 7.5 3Z",fill:"#158ECC"})]})}),"1"===(null===B||void 0===B?void 0:B.time_type)&&(0,C.Y)(null===B||void 0===B?void 0:B.start_date),"T"===(null===B||void 0===B?void 0:B.time_type)&&(0,N.jsxs)(N.Fragment,{children:[(0,C.Y)(null===B||void 0===B?void 0:B.start_date)," - ",(0,C.Y)(null===B||void 0===B?void 0:B.end_date)," "]})]})]}),"2"===(null===B||void 0===B?void 0:B.type)&&"T"!==(null===B||void 0===B?void 0:B.time_type)?(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Hours"}),(0,N.jsxs)("div",{className:b.A.paymentBox,children:[(0,N.jsx)("div",{className:b.A.dollarBox,children:(0,N.jsx)("span",{style:{fontSize:"14px",color:"#158ECC"},children:"H"})}),null===B||void 0===B?void 0:B.duration]})]}):"1"===(null===B||void 0===B?void 0:B.time_type)||"1"!==(null===B||void 0===B?void 0:B.time_type)&&"4"===(null===B||void 0===B?void 0:B.type)?(0,N.jsxs)("div",{className:"",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Hours"}),(0,N.jsxs)("div",{className:b.A.paymentBox,children:[(0,N.jsx)("div",{className:b.A.dollarBox,children:(0,N.jsx)("span",{style:{fontSize:"14px",color:"#158ECC"},children:"H"})}),P(B)]})]}):null]})]})}),(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"Link to Project"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsxs)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0"),children:[(0,N.jsxs)("div",{className:"form-group mb-3",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Project"}),(0,N.jsxs)("p",{className:(0,x.A)(b.A.text,"d-flex align-items-center gap-1"),children:[(null===B||void 0===B||null===(f=B.project)||void 0===f?void 0:f.number)||"-"," ",(0,N.jsx)(i.A,{className:"text-button p-0",onClick:()=>{var e,t,s;return T(`/management?unique_id=${null===B||void 0===B||null===(e=B.project)||void 0===e?void 0:e.unique_id}&reference=${null===B||void 0===B||null===(t=B.project)||void 0===t?void 0:t.reference}&number=${null===B||void 0===B||null===(s=B.project)||void 0===s?void 0:s.number}`)},children:(0,N.jsx)(u.A,{size:16,color:"#158ECC"})})]})]}),(0,N.jsxs)("div",{className:"form-group mb-3",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Reference"}),(0,N.jsx)("p",{className:(0,x.A)(b.A.text,b.A.description),children:(null===B||void 0===B||null===(y=B.project)||void 0===y?void 0:y.reference)||"-"})]}),(0,N.jsxs)("div",{className:"form-group mb-3",children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel),children:"Description"}),(0,N.jsx)("p",{className:(0,x.A)(b.A.text,b.A.description),children:(null===B||void 0===B||null===(w=B.project)||void 0===w?void 0:w.description)||"-"})]})]})}),(null===B||void 0===B?void 0:B.project_photos)&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"Project Photos"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsx)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0"),children:(0,N.jsx)("div",{className:"d-flex flex-column gap-1",style:{overflowX:"auto"},children:1==(null===B||void 0===B?void 0:B.project_photos)?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel,"d-block"),children:"Before & After"}),(0,N.jsx)("div",{style:{width:"124px",height:"124px",background:"#f0f0f0"}})]}):2==(null===B||void 0===B?void 0:B.project_photos)?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel,"d-block"),children:"In Process"}),(0,N.jsx)("div",{style:{width:"124px",height:"124px",background:"#f0f0f0"}})]}):3==(null===B||void 0===B?void 0:B.project_photos)?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("label",{className:(0,x.A)(b.A.customLabel,"d-block"),children:"All"}),(0,N.jsx)("div",{style:{width:"124px",height:"124px",background:"#f0f0f0"}})]}):null})})})]}),(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"Documents"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsx)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0"),children:(0,N.jsxs)(i.A,{className:"outline-button d-flex gap-2",onClick:()=>E(!0),style:{borderRadius:"40px"},children:["Viw All Documents",(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,N.jsx)("path",{d:"M1.25 4.375C1.25 3.33947 2.08947 2.5 3.125 2.5H6.57992C7.77713 2.5 8.78091 3.19995 9.46927 3.97997C9.98156 4.56048 10.5984 5 11.25 5H16.8759C17.912 5 18.75 5.84003 18.75 6.875V15.625C18.75 16.6605 17.9105 17.5 16.875 17.5H3.125C2.08947 17.5 1.25 16.6605 1.25 15.625V4.375ZM3.125 3.75C2.77982 3.75 2.5 4.02982 2.5 4.375V7.5H17.5V6.875C17.5 6.52926 17.2205 6.25 16.8759 6.25H11.25C10.0451 6.25 9.11184 5.46409 8.53203 4.80706C7.96726 4.16709 7.27657 3.75 6.57992 3.75H3.125ZM17.5 8.75H2.5V15.625C2.5 15.9702 2.77982 16.25 3.125 16.25H16.875C17.2202 16.25 17.5 15.9702 17.5 15.625V8.75Z",fill:"#344054"})})]})})}),(0,N.jsx)("h1",{className:(0,x.A)(b.A.heading,"mb-3"),children:"History"}),(0,N.jsx)(n.A,{className:(0,x.A)(b.A.border,"mb-3"),children:(0,N.jsx)(n.A.Header,{className:(0,x.A)(b.A.background,"border-0"),children:(0,N.jsxs)("table",{className:"w-100 table table-bordered rounded",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Date"}),(0,N.jsx)("td",{children:"User"}),(0,N.jsx)("td",{children:"Status"})]})}),(0,N.jsx)("tbody",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"-"}),(0,N.jsx)("td",{children:"-"}),(0,N.jsx)("td",{children:"-"})]})})]})})})]}),(0,N.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-between gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,N.jsx)("div",{children:(0,N.jsxs)(i.A,{className:"danger-text-button",disabled:M.isPending,onClick:()=>M.mutate(),children:["Delete",M.isPending&&(0,N.jsx)(v.p,{style:{width:"20px",height:"20px"}})]})}),(0,N.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,N.jsx)(i.A,{type:"button",onClick:e=>{e.stopPropagation(),s(!1)},className:"outline-button",children:"Cancel"}),(0,N.jsxs)(i.A,{type:"button",disabled:"3"===(null===B||void 0===B?void 0:B.status)||"a"===(null===B||void 0===B?void 0:B.status),onClick:H,className:"solid-button",style:{minWidth:"75px"},children:["Edit ",!1]})]})]})]})}}),(0,N.jsx)(f.A,{attachments:(null===B||void 0===B?void 0:B.attachments)||[],show:k,setShow:E}),S&&(0,N.jsx)(w.A,{visible:S,setVisible:F,setRefetch:_,isEditMode:!0,jobData:B,jobId:A,refetch:()=>D.refetch()})]})}},61427:(e,t,s)=>{s.d(t,{A:()=>v});var l=s(65043),i=s(14282),n=s(93202),o=s(56741),a=s(73216),r=s(64018),d=s(63712),c=s(20288),u=s(56328);const h="supplier-create_circledesignstyle__RXgvx",m="supplier-create_out__lEI-I";var p=s(1340),x=s(70579);const v=e=>{let{visible:t,setVisible:s,refetch:v}=e;const g=(0,l.useRef)(null),j=new URLSearchParams((0,a.zy)().search).get("addNewSupplier"),[f,b]=(0,l.useState)(!1),[y,C]=(0,l.useState)(null),[w]=(0,l.useState)({contact_persons:[{}],addresses:[{title:"Main Location",country:1}]}),N=async e=>{console.log("data: ",e),(async e=>{console.log("data: ",e);const t=new FormData;t.append("name",e.name),e.email&&t.append("email",e.email),e.website&&t.append("website",e.website),e.abn&&t.append("abn",e.abn);const l=(null===e||void 0===e?void 0:e.phone)&&(0,r.l)(e.phone);if(null!==l&&void 0!==l&&l.nationalNumber&&t.append("phone",e.phone),e.service&&t.append("service",e.service),e.note&&t.append("note",e.note),e.addresses.forEach(((e,s)=>{e.city&&(t.append(`addresses[${s}]address`,e.address),t.append(`addresses[${s}]city`,e.city),t.append(`addresses[${s}]postcode`,e.postcode),t.append(`addresses[${s}]is_main`,e.is_main),t.append(`addresses[${s}]title`,e.title))})),e.contact_persons.forEach(((e,s)=>{if(e.firstname||e.email){t.append(`contact_persons[${s}]firstname`,e.firstname),t.append(`contact_persons[${s}]lastname`,e.lastname),t.append(`contact_persons[${s}]email`,e.email);const l=(null===e||void 0===e?void 0:e.phone)&&(0,r.l)(e.phone);null!==l&&void 0!==l&&l.nationalNumber&&t.append(`contact_persons[${s}]phone`,e.phone),t.append(`contact_persons[${s}]position`,e.position),t.append(`contact_persons[${s}]is_main`,e.is_main)}})),null!==y&&void 0!==y&&y.croppedImageBlob){const e=(0,d.Ak)(6);t.append("photo",null===y||void 0===y?void 0:y.croppedImageBlob,`${e}.jpg`)}try{b(!0);const e=localStorage.getItem("access_token"),l=await fetch("https://app.memate.com.au/api/v1/suppliers/new/",{method:"POST",headers:{Authorization:`Bearer ${e}`},body:t});l.ok?(console.log("response: ",l),u.oR.success("New supplier created successfully"),s(!1),v((e=>!e))):u.oR.error("Failed to create new supplier. Please try again.")}catch(i){u.oR.error("Failed to create new supplier. Please try again.")}finally{b(!1)}})(e)},A=()=>{g.current&&g.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,l.useEffect)((()=>{t||C(null)}),[t]),(0,l.useEffect)((()=>{j&&s(!0)}),[j,s]),(0,x.jsx)(c.B,{visible:t,position:"right",onHide:()=>s(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:t,hide:l}=e;return(0,x.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)("div",{className:h,children:(0,x.jsx)("div",{className:m,children:(0,x.jsx)(n.A,{size:24,color:"#17B26A"})})}),(0,x.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create new Supplier"})]}),(0,x.jsx)("span",{children:(0,x.jsx)(i.A,{type:"button",className:"text-button",ref:t,onClick:e=>l(e),children:(0,x.jsx)(o.A,{size:24,color:"#667085"})})})]}),(0,x.jsx)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:(0,x.jsx)(p.A,{photo:y,setPhoto:C,ref:g,onSubmit:N,defaultValues:w})}),(0,x.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,x.jsx)(i.A,{type:"button",onClick:e=>{e.stopPropagation(),s(!1)},className:"outline-button",children:"Cancel"}),(0,x.jsx)(i.A,{type:"button",disabled:f,onClick:A,className:"solid-button",style:{minWidth:"75px"},children:f?"Loading...":"Save"})]})]})}})}},62284:(e,t,s)=>{s.d(t,{A:()=>g});var l=s(65043),i=s(14282),n=s(93202),o=s(56741),a=s(47097),r=s(93740),d=s(20288),c=s(56328);const u="new-expense-create_circledesignstyle__Ke3sy",h="new-expense-create_out__C1Mi-",m="new-expense-create_expensesEditHead__xr-7V";var p=s(10586),x=s(44908),v=s(70579);const g=e=>{let{visible:t,setVisible:s,setRefetch:g,expenseProjectId:j,projectReference:f}=e;const b=window.location.href,y=new URL(b),C=new URLSearchParams(y.search),[w,N]=(0,l.useState)(null),A=new Date,_=new Date(A);_.setDate(_.getDate()+1);const S=(0,l.useRef)(null),[F,k]=(0,l.useState)({option:"Assign to timeframe",type:2,notification:!1,date:A,due_date:_});(0,l.useEffect)((()=>{const e=C.get("projectId")||j,t=C.get("reference")||f;t&&(k((e=>({...e,invoice_reference:t}))),y.searchParams.delete("reference"),window.history.replaceState({},"",y)),e&&(N(e),k((e=>({...e,option:"Assign to project"}))),y.searchParams.delete("projectId"),window.history.replaceState({},"",y))}),[w,s]);const E=(0,a.n)({mutationFn:e=>(0,p.Rv)(e),onSuccess:e=>{console.log("response: ",e),c.oR.success("Expense created successfully"),T(),g((e=>!e))},onError:e=>{console.error("Error creating expense:",e),c.oR.error("Failed to create expense. Please try again.")}}),$=async e=>{delete e["gst-calculation"],delete e.option,delete e.subtotal,delete e.totalAmount,delete e.tax,e.order||delete e.order,e.type||(e.type=1),e.date&&(e.date=new Date(e.date).toISOString().split("T")[0]),e.due_date&&(e.due_date=new Date(e.due_date).toISOString().split("T")[0]),E.mutate(e)},I=()=>{S.current&&S.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},T=()=>{s(!1),N(null),k({option:"Assign to timeframe",type:2,notification:!1,date:A,due_date:_})};return(0,v.jsx)(d.B,{visible:t,position:"right",onHide:T,modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:t,hide:s}=e;return(0,v.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,v.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,v.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,v.jsx)("div",{className:u,children:(0,v.jsx)("div",{className:h,children:(0,v.jsx)(n.A,{size:24,color:"#17B26A"})})}),(0,v.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create new Expense"})]}),(0,v.jsx)("span",{children:(0,v.jsx)(i.A,{type:"button",className:"text-button",ref:t,onClick:e=>s(e),children:(0,v.jsx)(o.A,{size:24,color:"#667085"})})})]}),(0,v.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:[(0,v.jsx)("div",{className:`d-flex align-items-center mb-2 justify-content-between ${m}`,children:(0,v.jsx)("h5",{children:"Expense Details"})}),(0,v.jsx)(x.A,{ref:S,onSubmit:$,defaultValues:F,projectId:w})]}),(0,v.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,v.jsx)(i.A,{type:"button",onClick:e=>{e.stopPropagation(),T()},className:"outline-button",disabled:E.isPending,children:"Cancel"}),(0,v.jsxs)(i.A,{type:"button",onClick:I,className:"solid-button",style:{minWidth:"70px"},disabled:E.isPending,children:["Save ",E.isPending&&(0,v.jsx)(r.p,{style:{width:"18px",height:"18px"}})]})]})]})}})}},67046:(e,t,s)=>{s.d(t,{CK:()=>m,D7:()=>n,HT:()=>p,Op:()=>d,V3:()=>u,WG:()=>r,cS:()=>a,fW:()=>h,j3:()=>o,oe:()=>c});var l=s(31342);const i="https://app.memate.com.au/api/v1",n=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/sales/new-request/`);return(0,l.f)(s.toString(),t)},o=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/sales/`,s);return await e.text()}catch(l){throw console.error("Profile fetch error:",l),l}},a=async(e,t)=>{const s=new Headers,l=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${l}`),s.append("Content-Type","application/json");const n={method:"PUT",headers:s,body:JSON.stringify({sales_note:t}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/notes/`,n);if(!t.ok){const e=await t.text();throw new Error(`Sales notes update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(o){throw console.error("Sales notes update error:",o),o}},r=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/won/`);return(0,l.f)(s.toString(),t)},d=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/lost/`);return(0,l.f)(s.toString(),t)},c=async(e,t)=>{const s=new Headers,l=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${l}`),s.append("Content-Type","application/json");const n={method:"POST",headers:s,body:JSON.stringify(t),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/contacts/`,n);return t.ok?t:(console.log("Error:",t.status),null)}catch(o){return console.log("Error:",o),null}},u=async(e,t)=>{const s=new Headers,l=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${l}`),s.append("Content-Type","application/json");const n={method:"PUT",headers:s,body:JSON.stringify({lead:t,unique_id:e}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/lead/`,n);if(!t.ok){const e=await t.text();throw new Error(`Sales lead update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(o){throw console.error("Sales lead update error:",o),o}},h=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const l={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},n=await Promise.all([fetch(`${i}/sales/status/won/`,l)]);return await Promise.all(n.map((e=>e.json())))},m=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const l={method:"POST",headers:t,redirect:"follow"},n=await fetch(`${i}/sales/${e}/duplicate/`,l);return(await n.json())[0]},p=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const l={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},n=await Promise.all([fetch(`${i}/sales/status/lost/`,l)]);return await Promise.all(n.map((e=>e.json())))}},72796:(e,t,s)=>{s.d(t,{_x:()=>o,dd:()=>i,mM:()=>n});const l="https://app.memate.com.au/api/v1",i=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"GET",headers:t};try{const t=new URL(`${l}/tasks/${e}/`),s=await fetch(t,i);return await s.json()}catch(n){throw console.error("Tasks fetch error:",n),n}},n=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"DELETE",headers:t,redirect:"follow"};try{const t=new URL(`${l}/tasks/delete/${e}/`);if((await fetch(t,i)).ok)return{message:"Task deleted successfully"};throw new Error("Error during deleting")}catch(n){throw console.error("Tasks fetch error:",n),n}},o=async(e,t)=>{const s=new Headers,i=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${i}`),s.append("Content-Type","application/json");const n={method:"PATCH",headers:s,body:JSON.stringify({finished:t}),redirect:"follow"};try{const t=new URL(`${l}/tasks/complete/${e}/`),s=await fetch(t,n);return await s.json()}catch(o){throw console.error("Tasks fetch error:",o),o}}},79106:(e,t,s)=>{s.d(t,{Af:()=>a,U9:()=>n,aU:()=>d,gg:()=>o,gy:()=>c,lC:()=>r});var l=s(31342);const i="https://app.memate.com.au/api/v1",n=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;const d=(e-1)*t,c=new URL(`${i}/tasks/`);return c.searchParams.append("limit",t),c.searchParams.append("offset",d),s&&c.searchParams.append("search",s),n&&c.searchParams.append("ordering",n),o&&c.searchParams.append("deleted",1),!0===a&&c.searchParams.append("finished",!1),!1===a&&c.searchParams.append("finished",!0),r&&c.searchParams.append("users",r),(0,l.f)(c.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${i}${`/tasks/${e}/`}`);return(0,l.f)(t.toString(),{method:"GET"})},a=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/tasks/new/`);return(0,l.f)(s.toString(),t)},r=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${i}${`/tasks/update/${e}/`}`);return(0,l.f)(n.toString(),s)},d=async()=>{const e=new URL(`${i}/desktop-users/`);return(0,l.f)(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${i}/team/mobile-users/`);return(0,l.f)(e.toString(),{method:"GET"})}},81242:(e,t,s)=>{s.d(t,{A:()=>w});var l=s(65043),i=s(32952),n=s(61072),o=s(78602),a=s(14282),r=s(77918),d=s(93747),c=s(58387),u=s(75758),h=s(88060),m=s(8868),p=s(28676),x=s(74532),v=s(72052),g=s(18226),j=s(93740);const f={headerTitle:"send-email_headerTitle__50KUB",customLabel:"send-email_customLabel__r5xED",templateInfo:"send-email_templateInfo__mWkVT",bag:"send-email_bag__wtdwK",lable:"send-email_lable__+kNCa",dropdownSelect:"send-email_dropdownSelect__RY5w8",autoCompleteBox:"send-email_autoCompleteBox__fWZ7C",AutoComplete:"send-email_AutoComplete__m9YI5",bcc:"send-email_bcc__BwFzl",box:"send-email_box__Zlmer",active:"send-email_active__vEx4h",inputBox:"send-email_inputBox__NpU2b"};var b=s(81047),y=s(70579);const C=(0,y.jsxs)("span",{className:"ql-formats",children:[(0,y.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,y.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,y.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,y.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,y.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,y.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,y.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,y.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,y.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,y.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,y.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,y.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,y.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,y.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),w=e=>{var t,s,w,N;let{show:A,setShow:_,mutation:S,contactPersons:F,setPayload:k,defaultTemplateId:E,isAddingContact:$=!1}=e;const I=(0,l.useRef)(null),T=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[L,D]=(0,l.useState)(""),[B,R]=(0,l.useState)([]),[H,P]=(0,l.useState)([]),[M,z]=(0,l.useState)([]),[O,V]=(0,l.useState)(null),[U,q]=(0,l.useState)(null),[Z,G]=(0,l.useState)(null),[W,J]=(0,l.useState)({}),[K,Y]=(0,l.useState)([]),X=(0,l.useRef)(null),Q=(0,l.useRef)(null),ee=(0,l.useRef)(null),[te,se]=(0,l.useState)(!1),[le,ie]=(0,l.useState)(!1),ne=(0,l.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),oe=(0,l.useCallback)((e=>!e||0===e.length||e.every((e=>ne(e)))),[ne]),ae=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>!ne(e))):[]),[ne]),re=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>ne(e))):[]),[ne]),de=(0,l.useCallback)((()=>{let e=!1;if(B.length>0){const t=ae(B);t.length>0&&(console.log("Found invalid TO emails:",t),R(re(B)),e=!0)}if(H.length>0){const t=ae(H);t.length>0&&(console.log("Found invalid CC emails:",t),P(re(H)),e=!0)}if(M.length>0){const t=ae(M);t.length>0&&(console.log("Found invalid BCC emails:",t),z(re(M)),e=!0)}return!e}),[B,H,M,ae,re]),[ce,ue]=(0,l.useState)(null),he=()=>{_(!1),E||(D([]),R([]),P([]),z([]),V([]),q([]),ue(null))},me=(0,d.I)({queryKey:["emailTemplate"],queryFn:b.SQ,enabled:!!A}),pe=(0,d.I)({queryKey:["getSignatureTemplates"],queryFn:b.AO,enabled:!!A}),xe=(0,d.I)({queryKey:["getOutgoingEmail"],queryFn:b.hx,enabled:!!A}),ve=(0,d.I)({queryKey:["emailQuery",ce],queryFn:()=>(0,b.hS)(ce),enabled:!!ce,retry:1});(0,l.useEffect)((()=>{var e,t,s;null!==xe&&void 0!==xe&&xe.data&&(null!==xe&&void 0!==xe&&null!==(e=xe.data)&&void 0!==e&&e.outgoing_email&&null!==xe&&void 0!==xe&&null!==(t=xe.data)&&void 0!==t&&t.outgoing_email_verified?D(null===xe||void 0===xe||null===(s=xe.data)||void 0===s?void 0:s.outgoing_email):D("no-reply@memate.com.au"));if(!ce&&null!==me&&void 0!==me&&me.data&&E){var l;const e=null===me||void 0===me||null===(l=me.data)||void 0===l?void 0:l.find((e=>e.type===E));e&&ue(null===e||void 0===e?void 0:e.id)}}),[me,xe,E,ce]);const ge=e=>{var t,s;const l=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=null===(s=F.map((e=>e.email)))||void 0===s?void 0:s.filter((e=>e));i=i.filter((e=>!B.includes(e))),i=i.filter((e=>!H.includes(e))),i=i.filter((e=>!M.includes(e))),i=i.filter((e=>e.toLowerCase().includes(l))),Y(i)},je=()=>{ge(),X.current&&X.current.show()},fe=()=>{ge(),Q.current&&Q.current.show()},be=()=>{ge(),ee.current&&ee.current.show()};return(0,l.useEffect)((()=>{if(null!==F&&void 0!==F&&F.length){var e;let t=null===(e=F.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));Y(t)}}),[F]),(0,l.useEffect)((()=>{if(B.length>0){const e=ae(B);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const t=re(B);R(t)}}}),[B,ae,re]),(0,l.useEffect)((()=>{if(H.length>0){const e=ae(H);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const t=re(H);P(t)}}}),[H,ae,re]),(0,l.useEffect)((()=>{if(M.length>0){const e=ae(M);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const t=re(M);z(t)}}}),[M,ae,re]),(0,l.useEffect)((()=>{k((e=>({...e,subject:O,email_body:U,from_email:L,to:null===B||void 0===B?void 0:B.toString(),...H.length>0&&{cc:H.toString()},...M.length>0&&{bcc:M.toString()},...Z&&{signature:Z}})))}),[O,U,L,B,H,M,Z,k]),(0,l.useEffect)((()=>{var e,t;null!==pe&&void 0!==pe&&pe.data&&G(null===pe||void 0===pe||null===(e=pe.data)||void 0===e||null===(t=e.find((e=>e.id===T.email_signature)))||void 0===t?void 0:t.id)}),[null===pe||void 0===pe?void 0:pe.data,T.email_signature]),(0,l.useEffect)((()=>{var e,t;q((null===ve||void 0===ve||null===(e=ve.data)||void 0===e?void 0:e.body)||""),V(null===ve||void 0===ve||null===(t=ve.data)||void 0===t?void 0:t.subject),J((e=>({...e,subject:!1}))),J((e=>({...e,text:!1})))}),[null===ve||void 0===ve?void 0:ve.data]),(0,y.jsxs)(i.A,{show:A,centered:!0,onHide:he,className:"invoice-form",size:"lg",children:[(0,y.jsx)(i.A.Header,{closeButton:!0,children:(0,y.jsx)("div",{className:`${f.modalHeader}`,children:(0,y.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,y.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${f.headerTitle}`,children:"Send email"})})})}),(0,y.jsxs)(i.A.Body,{children:[(0,y.jsxs)(n.A,{children:[(0,y.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"FROM"}),(0,y.jsx)(h.m,{options:xe&&(null===xe||void 0===xe?void 0:xe.data)&&[{value:null===xe||void 0===xe||null===(t=xe.data)||void 0===t?void 0:t.outgoing_email,label:`${null===xe||void 0===xe||null===(s=xe.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{D(e.value),J((e=>({...e,from:!1})))},value:L,filterInputAutoFocus:!0})]}),(null===W||void 0===W?void 0:W.from)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,y.jsx)(o.A,{sm:6,className:"mb-3",children:(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"Templates"}),(0,y.jsx)(h.m,{options:me&&(null===(w=me.data)||void 0===w?void 0:w.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{ue(e.value)},value:ce,loading:null===me||void 0===me?void 0:me.isFetching,filterInputAutoFocus:!0}),(0,y.jsx)("div",{className:f.templateInfo,onClick:e=>I.current.toggle(e),children:(0,y.jsx)(r.A,{size:16,color:"#737374ff"})}),(0,y.jsxs)(g.j,{ref:I,children:[(0,y.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,y.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,y.jsx)("br",{})," Profile Settings > Templates > Email",(0,y.jsx)("br",{})," Templates."]})]})]})})]}),(0,y.jsxs)(n.A,{children:[(0,y.jsxs)(o.A,{sm:12,className:"mb-3",children:[(0,y.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,y.jsxs)("div",{style:{position:"relative"},className:f.autoCompleteBox,children:[(0,y.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"TO"}),(0,y.jsx)(u.j,{ref:X,value:B,completeMethod:ge,onChange:e=>{R(e.value),J((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:K,onClick:je,onFocus:je,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>ne(e)));R((e=>[...new Set([...e,...l])])),l.length===s.length&&l.length>0&&J((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(R((e=>[...new Set([...e,t])])),J((e=>({...e,to:!1,toInvalid:!1})))):J((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,y.jsx)(a.A,{className:(0,c.A)(f.box,{[f.active]:te}),onClick:()=>{se(!te),P([])},children:"CC"}),(0,y.jsx)(a.A,{className:(0,c.A)(f.box,{[f.active]:le}),onClick:()=>{ie(!le),z([])},children:"BCC"})]}),(null===W||void 0===W?void 0:W.to)&&!(null!==W&&void 0!==W&&W.toInvalid)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===W||void 0===W?void 0:W.toInvalid)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===W||void 0===W?void 0:W.invalidToEmails)&&W.invalidToEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",W.invalidToEmails.join(", ")]})]})]}),te&&(0,y.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"CC"}),(0,y.jsx)(u.j,{ref:Q,value:H,completeMethod:ge,onChange:e=>{P(e.value),J((e=>({...e,cc:!1})))},multiple:!0,suggestions:K,onClick:fe,onFocus:fe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>ne(e)));P((e=>[...new Set([...e,...l])])),l.length===s.length&&J((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(P((e=>[...new Set([...e,t])])),J((e=>({...e,cc:!1})))):J((e=>({...e,cc:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===W||void 0===W?void 0:W.cc)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===W||void 0===W?void 0:W.invalidCcEmails)&&W.invalidCcEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",W.invalidCcEmails.join(", ")]})]})]}),le&&(0,y.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"BCC"}),(0,y.jsx)(u.j,{ref:ee,value:M,completeMethod:ge,onChange:e=>{z(e.value),J((e=>({...e,bcc:!1})))},multiple:!0,suggestions:K,onClick:be,onFocus:be,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),l=s.filter((e=>ne(e)));z((e=>[...new Set([...e,...l])])),l.length===s.length&&J((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(z((e=>[...new Set([...e,t])])),J((e=>({...e,bcc:!1})))):J((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,f.bcc,"w-100"),placeholder:"BCC"})]}),(null===W||void 0===W?void 0:W.bcc)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===W||void 0===W?void 0:W.invalidBccEmails)&&W.invalidBccEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",W.invalidBccEmails.join(", ")]})]})]}),(0,y.jsxs)(o.A,{sm:12,className:"mb-2",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"SUBJECT"}),(0,y.jsxs)(p.C,{children:[(0,y.jsx)(x.m,{children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,y.jsx)(v.S,{value:O,className:(0,c.A)(f.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{V(e.target.value),J((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===W||void 0===W?void 0:W.subject)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,y.jsxs)(o.A,{sm:12,className:"mb-3",children:[(0,y.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.lable),children:"Message"}),(0,y.jsx)(x.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,y.jsx)(m.K,{style:{minHeight:"150px"},headerTemplate:C,value:U,placeholder:"Enter a description...",onTextChange:e=>{q(e.htmlValue),J((e=>({...e,text:!1})))}})]}),(null===W||void 0===W?void 0:W.text)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,y.jsx)(o.A,{sm:12,children:(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"Signature"}),(0,y.jsx)(h.m,{options:pe&&(null===(N=pe.data)||void 0===N?void 0:N.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{G(e.value)},value:Z,loading:null===pe||void 0===pe?void 0:pe.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,y.jsxs)(i.A.Footer,{className:"d-flex justify-content-between",children:[(0,y.jsx)("span",{}),(0,y.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,y.jsxs)(a.A,{className:"outline-button",onClick:he,children:["Cancel"," "]}),(0,y.jsxs)(a.A,{disabled:null===S||void 0===S?void 0:S.isPending,className:"solid-button",onClick:async()=>{let e=0;J({});if(de()||console.log("Some emails were invalid and have been cleaned"),L||(++e,J((e=>({...e,from:!0})))),0===(null===B||void 0===B?void 0:B.length))++e,J((e=>({...e,to:!0})));else if(!oe(B)){++e;const t=ae(B);console.log("Invalid TO emails:",t),J((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:t})))}if(H.length>0&&!oe(H)){++e;const t=ae(H);console.log("Invalid CC emails:",t),J((e=>({...e,cc:!0,invalidCcEmails:t})))}if(M.length>0&&!oe(M)){++e;const t=ae(M);console.log("Invalid BCC emails:",t),J((e=>({...e,bcc:!0,invalidBccEmails:t})))}O||(++e,J((e=>({...e,subject:!0})))),U||(++e,J((e=>({...e,text:!0})))),e||S.mutate({subject:O,email_body:U,from_email:L,to:null===B||void 0===B?void 0:B.toString(),...H.length>0&&{cc:H.toString()},...M.length>0&&{bcc:M.toString()},...Z&&{signature:Z}})},children:["Send"," ",((null===S||void 0===S?void 0:S.isPending)||$)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})}},93137:(e,t,s)=>{s.d(t,{A:()=>l});const l={newJobTag:"view-job_newJobTag__EyCAF",border:"view-job_border__KnprQ",borderBottom:"view-job_borderBottom__Ag9Vk",background:"view-job_background__eeiN9",customLabel:"view-job_customLabel__6I5W6",lightText:"view-job_lightText__1nbTX",customText:"view-job_customText__oK3GU",text:"view-job_text__Vqm2T",assignedUser:"view-job_assignedUser__lgKW+",toggleButton:"view-job_toggleButton__wFHGc",description:"view-job_description__0rHSF",chooseUserBox:"view-job_chooseUserBox__hIESK",heading:"view-job_heading__XPFer",paymentType:"view-job_paymentType__BE0T5",typeBorder:"view-job_typeBorder__R7jQm",paymentmain:"view-job_paymentmain__ejYfy",customRadio:"view-job_customRadio__C9Z8H",fix:"view-job_fix__NRFOO",hours:"view-job_hours__s1kVw",timetracker:"view-job_timetracker__ut0cZ",shift:"view-job_shift__2dlSR",timeFrame:"view-job_timeFrame__j+Q-T",radioLabel:"view-job_radioLabel__19vAG",RadioButton:"view-job_RadioButton__F21av",paymentBox:"view-job_paymentBox__PS9jL",dollarBox:"view-job_dollarBox__CmYGa",jobGalleri:"view-job_jobGalleri__Lc+x4",viewBox:"view-job_viewBox__04ZW0",viewHeading:"view-job_viewHeading__rzJVa",defaultStatus:"view-job_defaultStatus__sF7Uc",status:"view-job_status__p9QvE",open:"view-job_open__-y1qk",Accepted:"view-job_Accepted__SPymV",CONFIRMED:"view-job_CONFIRMED__LIoTK",ASSIGN:"view-job_ASSIGN__Rf5vD",NotConfirmed:"view-job_NotConfirmed__hK3lN",COMPLETED:"view-job_COMPLETED__LQaDi",DECLINED:"view-job_DECLINED__JzIeY",MANAGER_DECLINED:"view-job_MANAGER_DECLINED__ZLLTf",finished:"view-job_finished__21gzC",assign:"view-job_assign__uRJ2w",modal:"view-job_modal__9jVc+",modalHeader:"view-job_modalHeader__-AqYp",headerTitle:"view-job_headerTitle__kcd8H",attachmentBox:"view-job_attachmentBox__El24C"}},95753:(e,t,s)=>{s.d(t,{A:()=>r,v:()=>a});var l=s(65043),i=s(22927),n=s(43984),o=s(70579);function a(e){return e>=1048576?(e/1048576).toFixed(1)+" MB":e>=1024?(e/1024).toFixed(1)+" KB":e+" B"}const r=e=>{let{onFileChange:t,styles:s}=e;const[a,r]=(0,l.useState)(!1),d=(0,l.useRef)(),c=(0,l.useRef)(),u=e=>{const t=d.current,s=c.current;if(!t||!s)return;const l=t.contains(e.target),i=s.contains(e.target);l||i||r(!1)};return l.useEffect((()=>(document.addEventListener("click",u),()=>{document.removeEventListener("click",u)})),[]),(0,o.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,o.jsx)("button",{className:s.attachButton,type:"button","aria-label":"Attach file",ref:d,onClick:()=>r((e=>!e)),style:{padding:"6px 6px 6px 8px"},children:(0,o.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M18.0833 8.33333L9.16667 17.25C8.17221 18.2444 6.82407 18.8042 5.41667 18.8042C4.00926 18.8042 2.66112 18.2444 1.66667 17.25C0.672214 16.2556 0.112446 14.9074 0.112446 13.5C0.112446 12.0926 0.672214 10.7444 1.66667 9.75L10.5833 0.833329C11.2486 0.167998 12.1514 -0.149151 13.0833 0.0666624C14.0153 0.282476 14.8056 0.947998 15.25 1.83333C15.6944 2.71866 15.7361 3.75 15.3333 4.66666C14.9306 5.58333 14.1389 6.29166 13.1667 6.5L5.08333 14.5833C4.75 14.9167 4.31944 15.0833 3.83333 15.0833C3.34722 15.0833 2.91667 14.9167 2.58333 14.5833C2.25 14.25 2.08333 13.8194 2.08333 13.3333C2.08333 12.8472 2.25 12.4167 2.58333 12.0833L9.16667 5.5",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}),a&&(0,o.jsxs)("div",{ref:c,className:s.attachmentPopover,style:{position:"absolute",bottom:"40px",left:-200,zIndex:20,minWidth:220,background:"#fff",borderRadius:8,boxShadow:"0 4px 24px rgba(16,24,40,0.18)",padding:10},children:[(0,o.jsxs)("label",{className:s.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,o.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{t(e),r(!1)},accept:".pdf, .doc, .docx, .txt"}),(0,o.jsx)(i.A,{size:16,color:"#667085"}),(0,o.jsx)("span",{className:"font-16",children:"Document"})]}),(0,o.jsxs)("label",{className:s.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,o.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{t(e),r(!1)},accept:"image/*"}),(0,o.jsx)(n.A,{size:16,color:"#667085"}),(0,o.jsx)("span",{className:"font-16",children:"Photo "})]})]})]})}},98385:(e,t,s)=>{s.d(t,{A:()=>B});var l=s(65043),i=s(93202),n=s(56741),o=s(95192),a=s(93747),r=s(47097),d=s(58387),c=s(88060),u=s(93740),h=s(20288),m=s(14282),p=s(78602),x=s(29853),v=s(61072),g=s(56328);const j="create-task_circleDesignStyle__vtKho",f="create-task_out__LG-iY",b="create-task_taskTitleInput__s+lNu",y="create-task_formLabel__04J0h",C="create-task_taskDescriptionInput__RZWSI",w="create-task_projectDropdown__qXb5+";var N=s(10586),A=s(79106),_=s(72796),S=s(57189),F=s(58027),k=s(63040),E=s(34168),$=s(70579);const I=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},T=e=>{let{startDate:t,endDate:s}=e;return(0,$.jsx)("div",{className:"dateSelectdTaskBar",children:I(t,s)})},L=e=>{let{setDateRange:t,dateRange:s}=e;console.log("dateRange: ",s);const[i,n]=(0,l.useState)(!1),o=(0,l.useRef)(null),a=e=>{o.current&&!o.current.contains(e.target)&&n(!1)};return(0,l.useEffect)((()=>(i?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)})),[i]),(0,$.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:o,children:[(0,$.jsx)("div",{onClick:()=>n((e=>!e)),style:{cursor:"pointer"},children:null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate?(0,$.jsx)(T,{startDate:s.startDate,endDate:s.endDate}):(0,$.jsx)("div",{style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},className:"iconStyleCircle d-flex justify-content-center align-items-center iconStyleCircleRight "+(i?"active":""),children:(0,$.jsx)(k.A,{color:i?"#1AB2FF":"#475467",size:14})})}),i&&(0,$.jsx)("div",{className:"select-date-range",style:{position:"absolute",top:"-100px",background:"#fff",zIndex:1e3},children:(0,$.jsx)(E.A,{onDataApply:e=>{t(e),n(!1)},dateRange:s,onClose:()=>n(!1)})})]})},D=e=>{if(!e)return null;return new Date(1e3*+e)},B=e=>{let{show:t,setShow:s,refetch:k,taskId:E,setTaskId:I,defaultValue:T,projectId:B}=e;const R=(0,l.useRef)(null),H=(0,l.useRef)(null),{session:P}=(0,S.As)(),[M,z]=(0,l.useState)(!1),[O,V]=(0,l.useState)(""),[U,q]=(0,l.useState)(""),[Z,G]=(0,l.useState)(""),[W,J]=(0,l.useState)(null),[K,Y]=(0,l.useState)(null),[X,Q]=(0,l.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1});(0,l.useEffect)((()=>{var e,t;E&&T&&(V(null===T||void 0===T?void 0:T.title),q(null===T||void 0===T?void 0:T.description),G(null===T||void 0===T||null===(e=T.project)||void 0===e?void 0:e.id),J(null===T||void 0===T||null===(t=T.user)||void 0===t?void 0:t.id),Y({startDate:D(null===T||void 0===T?void 0:T.from_date),endDate:D(null===T||void 0===T?void 0:T.to_date)}))}),[E,T]);const ee=()=>{V(""),q(""),G(""),J(null),Y(null),z(!1),Q({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},te=(0,a.I)({queryKey:["getProjectsList"],queryFn:N.Bu}),se=(0,a.I)({queryKey:["getUserList"],queryFn:A.aU}),le=(0,a.I)({queryKey:["getMobileUserList"],queryFn:A.gy});(0,l.useEffect)((()=>{t||ee()}),[t]);const ie=(0,r.n)({mutationFn:e=>E?(0,A.lC)(E,e):(0,A.Af)(e),onSuccess:()=>{k(),s(!1),ee(),E&&I(null),g.oR.success(`Task ${E?"updated":"created"} successfully`)},onError:e=>{console.error(`Error ${E?"updating":"creating"} task:`,e),g.oR.error(`Failed to ${E?"update":"create"} client. Please try again.`)}});(0,l.useEffect)((()=>{if(M){Q({taskTitle:!O,description:!U,project:!Z,user:!W,date:!K})}}),[O,U,Z,W,K,M]);const ne=()=>{z(!0);const e={taskTitle:!O,description:!U,project:!Z,user:!W,date:!K};Q(e),e.taskTitle||e.description||e.user||e.date||e.project||ie.mutate({title:O,description:U,project:Z,user:W,from_date:K.startDate,to_date:K.endDate})},oe=(0,r.n)({mutationFn:e=>(0,_.mM)(E),onSuccess:()=>{console.log("Delete success"),s(!1),k()},onError:e=>{console.error("Error creating task:",e)}}),ae=()=>{oe.mutate()},re=()=>{s(!1),ee()};return(0,l.useEffect)((()=>{setTimeout((()=>{H.current&&(H.current.style.height="auto",H.current.style.height=H.current.scrollHeight+"px")}),200)}),[U,E]),(0,l.useEffect)((()=>{B&&G(+B)}),[B]),(0,$.jsx)(h.B,{visible:t,position:"right",onHide:()=>{s(!1)},modal:!1,dismissable:!1,style:{width:"591px",height:"97vh",borderRadius:"10px",marginRight:"10px"},content:e=>{var t,s,l,a,r,h,g,N,A,_;let{closeIconRef:S,hide:k}=e;return(0,$.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,$.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,$.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,$.jsx)("div",{className:j,children:(0,$.jsx)("div",{className:f,children:(0,$.jsx)(i.A,{size:24,color:"#17B26A"})})}),(0,$.jsxs)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:[E?"Update":"Create New"," Task"]})]}),(0,$.jsx)("span",{children:(0,$.jsx)(m.A,{type:"button",className:"text-button",ref:S,onClick:e=>k(e),children:(0,$.jsx)(n.A,{size:24,color:"#667085"})})})]}),(0,$.jsxs)("div",{className:"modal-body",style:{padding:"24px 24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:[(0,$.jsx)(x.A.Control,{type:"text",name:"taskTitle",id:"taskTitle",placeholder:"Enter task title",value:O,onChange:e=>V(e.target.value),className:b}),X.taskTitle&&(0,$.jsx)(x.A.Text,{className:"error-message",children:"Task title is required"}),(0,$.jsxs)(v.A,{className:"mt-3",children:[(0,$.jsx)(p.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,$.jsx)(x.A.Label,{className:y,children:"Assignee"})}),(0,$.jsxs)(p.A,{sm:8,className:"d-flex flex-column justify-content-center",children:[!W&&(0,$.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.show()},style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},children:(0,$.jsx)(o.A,{color:null!==(t=R.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(l=s.element)&&void 0!==l&&l.offsetParent?"#1AB2FF":"#475467",size:18,className:"cursor-pointer"})}),(0,$.jsx)(c.m,{ref:R,options:[{label:"Desktop User",items:(null===se||void 0===se||null===(a=se.data)||void 0===a||null===(r=a.users)||void 0===r||null===(h=r.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===h?void 0:h.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==P&&void 0!==P&&P.has_work_subscription?[{label:"Mobile User",items:(null===le||void 0===le||null===(g=le.data)||void 0===g||null===(N=g.users)||void 0===N||null===(A=N.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===A?void 0:A.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{J(e.value)},valueTemplate:e=>e?(0,$.jsxs)("div",{className:"d-flex gap-2 align-items-center",style:{position:"relative",left:"-10px"},children:[(0,$.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,$.jsx)(F.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}):null,itemTemplate:e=>(0,$.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,$.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,$.jsx)(F.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:W?"fit-content":"0px",height:W?"46px":"0px",zIndex:W?"1":"0",position:"relative",left:W?"-4px":"-60px",top:W?"0px":"-15px"},value:W,dropdownIcon:(0,$.jsx)($.Fragment,{}),collapseIcon:(0,$.jsx)($.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"})]})]}),X.user&&(0,$.jsx)(x.A.Text,{className:"error-message",children:"User is required"}),(0,$.jsxs)(v.A,{className:"mt-3",children:[(0,$.jsx)(p.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,$.jsx)(x.A.Label,{className:y,children:"Due Date"})}),(0,$.jsx)(p.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,$.jsx)(L,{dateRange:K,setDateRange:Y})})]}),X.date&&(0,$.jsx)(x.A.Text,{className:"error-message",children:"Date is required"}),(0,$.jsxs)(v.A,{className:"mt-3",children:[(0,$.jsx)(p.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,$.jsx)(x.A.Label,{className:y,children:"Link to Project"})}),(0,$.jsx)(p.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,$.jsx)(c.m,{options:(null===te||void 0===te||null===(_=te.data)||void 0===_?void 0:_.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{G(e.value)},className:(0,d.A)("outline-none",w),style:{height:"46px",maxWidth:"100%",width:"fit-content"},value:Z,loading:null===te||void 0===te?void 0:te.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0})})]}),X.project&&(0,$.jsx)(x.A.Text,{className:"error-message",children:"Project task is required"}),(0,$.jsxs)(v.A,{className:"mt-3",children:[(0,$.jsx)(p.A,{sm:4,children:(0,$.jsx)(x.A.Label,{className:y,children:"Description"})}),(0,$.jsx)(p.A,{sm:12,children:(0,$.jsx)(x.A.Control,{name:"taskDescription",id:"taskDescription",as:"textarea",placeholder:"Enter a description...",value:U,rows:6,ref:H,onChange:e=>{q(e.target.value)},className:C,onInput:e=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onFocus:()=>{H.current&&(H.current.style.height="auto",H.current.style.height=H.current.scrollHeight+"px")}})})]}),X.description&&(0,$.jsx)(x.A.Text,{className:"error-message",children:"Description is required"})]}),(0,$.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-between gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"80px"},children:[(0,$.jsx)("div",{children:E&&(0,$.jsxs)(m.A,{className:"danger-text-button gap-2",onClick:ae,children:["Delete",oe.isPending&&(0,$.jsx)(u.p,{style:{width:"18px",height:"18px"}})]})}),(0,$.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,$.jsx)(m.A,{type:"button",onClick:re,className:"outline-button",children:"Cancel"}),(0,$.jsxs)(m.A,{type:"button",onClick:ne,className:"solid-button",style:{minWidth:"70px"},disabled:ie.isPending,children:[E?"Update Task":"Create Task"," ",ie.isPending&&(0,$.jsx)(u.p,{style:{width:"18px",height:"18px"}})]})]})]})]})}})}}}]);
//# sourceMappingURL=3076.b496171a.chunk.js.map