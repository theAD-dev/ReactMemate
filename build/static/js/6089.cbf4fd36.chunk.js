"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[6089],{623:(e,t,s)=>{s.d(t,{IY:()=>g,Kh:()=>r,Nh:()=>a,Np:()=>m,SG:()=>u,YC:()=>v,fD:()=>x,hW:()=>d,ic:()=>b,j:()=>c,ms:()=>j,oQ:()=>l,vU:()=>h,yA:()=>y,yi:()=>p});var n=s(63712);const i="https://dev.memate.com.au/api/v1",o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:n={},body:i}=t,o={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...n},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,o);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const n=s.headers.get("Content-Type");if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(l){throw console.error("Fetch API error:",l),l}},l=async()=>{const e=new URL(`${i}/settings/subscriptions/tax-id/`);return o(e.toString(),{method:"GET"})},a=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/subscriptions/tax-id/`);return o(s.toString(),t)},r=async()=>{const e=new URL(`${i}/settings/subscriptions/payment-method/`);return o(e.toString(),{method:"GET"})},d=async()=>{const e=new URL(`${i}/subscriptions/retry/`);return o(e.toString(),{method:"POST"})},c=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/subscriptions/payment-method/`);return o(s.toString(),t)},u=async()=>{const e=new URL(`${i}/settings/organization/region-language/`);return o(e.toString(),{method:"GET"})},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/organization/region-language/`);return o(s.toString(),t)},p=async e=>{console.log("data: ",e),e.id&&delete e.id,e.isNew&&delete e.isNew,e.isChanged&&delete e.isChanged,e.value&&delete e.value;const t={method:"POST",body:e},s=new URL(`${i}/settings/project-statuses/new/`);return o(s.toString(),t)},m=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${i}${`/settings/project-statuses/update/${e}/`}`);return o(n.toString(),s)},x=async e=>{const t=new URL(`${i}${`/settings/project-statuses/delete/${e}/`}`);return o(t.toString(),{method:"DELETE"})},v=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/settings/organization/general/`,s);return await e.json()}catch(n){throw console.error("Profile fetch error:",n),n}},g=async(e,t)=>{const s=new Headers,o=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${o}`);const l=new FormData;if(Object.keys(e).forEach((t=>{l.append(t,e[t])})),null!==t&&void 0!==t&&t.croppedImageBlob){const e=(0,n.Ak)(6);l.append("company_logo",null===t||void 0===t?void 0:t.croppedImageBlob,`${e}.jpg`)}const a={method:"PUT",headers:s,body:l,redirect:"follow"};try{const e=await fetch(`${i}/settings/organization/general/`,a),t=await e.text();return console.log("result>>>>>>>>>>: ",t),t}catch(r){throw console.error("Profile fetch error:",r),r}},j=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/settings/organization/bank/`,s);return await e.text()}catch(n){throw console.error("Profile fetch error:",n),n}},y=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`);const n=new FormData;Object.keys(e).forEach((t=>{n.append(t,e[t])}));const o={method:"PUT",headers:t,body:n,redirect:"follow"};try{const e=await fetch(`${i}/settings/organization/bank/`,o),t=await e.text();return console.log("result: ",t),t}catch(l){throw console.error("Profile fetch error:",l),l}},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/settings/project-statuses/`,s);return await e.json()}catch(n){throw console.error("project fetch error:",n),n}}},6089:(e,t,s)=>{s.r(t),s.d(t,{default:()=>St});var n=s(65043),i=s(49367),o=s(15258),l=s(14282),a=s(27417),r=s(58387),d=s(11520),c=s(79106);let u,h,p;function m(e){return new Date(new Date(e).getTime()-60*new Date(e).getTimezoneOffset()*1e3)}function x(e){const t=[],s=null===e||void 0===e?void 0:e.map((e=>{var s,n,i,o,l;let a=(null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.color)||"rgb(192, 192, 192)",r=null===e||void 0===e||null===(n=e.custom_status)||void 0===n?void 0:n.background,d=null===e||void 0===e||null===(i=e.custom_status)||void 0===i?void 0:i.font;const c=null!==e&&void 0!==e&&null!==(o=e.custom_status)&&void 0!==o&&o.title?`<em style='color:${d}; background:${r}; border: 1px solid ${a};'>${e.custom_status.title}</em>`:"<em style='color: #344054; background: #F2F4F7; border: 1px solid rgba(0, 0, 0, 0.498);' class=\"pb-1\">No status</em>";let u="not-started";return 0===e.jobs_count&&0===e.jobs_count?u="not-started":e.jobs_done===e.jobs_count?u="done":0===e.jobs_done?u="not-done":e.jobs_done&&(u="pending"),t.push({start:m(1e3*+e.booking_start),end:m(1e3*+e.booking_end),id:e.unique_id,cssClass:"job-item",resource:e.unique_id,backColor:r,borderColor:a,tag:{number:e.number,reference:e.reference,value:e.id,type:"job"},text:`<ul class="eventStyleCal">\n        <li>\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <g clip-path="url(#clip0_6815_57879)">\n            <rect width="24" height="24" rx="4" fill="url(#paint0_linear_6815_57879)"/>\n            <g opacity="0.08">\n            <rect x="0.375" y="0.375" width="23.25" height="23.25" rx="3.625" stroke="#101828" stroke-width="0.75"/>\n            </g>\n            <g clip-path="url(#clip1_6815_57879)">\n            <path d="M8.57171 7.28592C8.57171 7.04923 8.76359 6.85735 9.00028 6.85735H9.85742C10.0941 6.85735 10.286 7.04923 10.286 7.28592V8.14307C10.286 8.37976 10.0941 8.57164 9.85742 8.57164H9.00028C8.76359 8.57164 8.57171 8.37976 8.57171 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M11.1431 7.28592C11.1431 7.04923 11.335 6.85735 11.5717 6.85735H12.4289C12.6655 6.85735 12.8574 7.04923 12.8574 7.28592V8.14307C12.8574 8.37976 12.6655 8.57164 12.4289 8.57164H11.5717C11.335 8.57164 11.1431 8.37976 11.1431 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M14.1431 6.85735C13.9064 6.85735 13.7146 7.04923 13.7146 7.28592V8.14307C13.7146 8.37976 13.9064 8.57164 14.1431 8.57164H15.0003C15.237 8.57164 15.4289 8.37976 15.4289 8.14307V7.28592C15.4289 7.04923 15.237 6.85735 15.0003 6.85735H14.1431Z" fill="#667085"/>\n            <path d="M8.57171 9.85735C8.57171 9.62066 8.76359 9.42878 9.00028 9.42878H9.85742C10.0941 9.42878 10.286 9.62066 10.286 9.85735V10.7145C10.286 10.9512 10.0941 11.1431 9.85742 11.1431H9.00028C8.76359 11.1431 8.57171 10.9512 8.57171 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M11.5717 9.42878C11.335 9.42878 11.1431 9.62066 11.1431 9.85735V10.7145C11.1431 10.9512 11.335 11.1431 11.5717 11.1431H12.4289C12.6655 11.1431 12.8574 10.9512 12.8574 10.7145V9.85735C12.8574 9.62066 12.6655 9.42878 12.4289 9.42878H11.5717Z" fill="#667085"/>\n            <path d="M13.7146 9.85735C13.7146 9.62066 13.9064 9.42878 14.1431 9.42878H15.0003C15.237 9.42878 15.4289 9.62066 15.4289 9.85735V10.7145C15.4289 10.9512 15.237 11.1431 15.0003 11.1431H14.1431C13.9064 11.1431 13.7146 10.9512 13.7146 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M9.00028 12.0002C8.76359 12.0002 8.57171 12.1921 8.57171 12.4288V13.2859C8.57171 13.5226 8.76359 13.7145 9.00028 13.7145H9.85742C10.0941 13.7145 10.286 13.5226 10.286 13.2859V12.4288C10.286 12.1921 10.0941 12.0002 9.85742 12.0002H9.00028Z" fill="#667085"/>\n            <path d="M11.1431 12.4288C11.1431 12.1921 11.335 12.0002 11.5717 12.0002H12.4289C12.6655 12.0002 12.8574 12.1921 12.8574 12.4288V13.2859C12.8574 13.5226 12.6655 13.7145 12.4289 13.7145H11.5717C11.335 13.7145 11.1431 13.5226 11.1431 13.2859V12.4288Z" fill="#667085"/>\n            <path d="M14.1431 12.0002C13.9064 12.0002 13.7146 12.1921 13.7146 12.4288V13.2859C13.7146 13.5226 13.9064 13.7145 14.1431 13.7145H15.0003C15.237 13.7145 15.4289 13.5226 15.4289 13.2859V12.4288C15.4289 12.1921 15.237 12.0002 15.0003 12.0002H14.1431Z" fill="#667085"/>\n            <path d="M6.85742 6.00021C6.85742 5.52682 7.24118 5.14307 7.71456 5.14307H16.286C16.7594 5.14307 17.1431 5.52682 17.1431 6.00021V18.0002C17.1431 18.4736 16.7594 18.8574 16.286 18.8574H7.71456C7.24118 18.8574 6.85742 18.4736 6.85742 18.0002V6.00021ZM16.286 6.00021L7.71456 6.00021V18.0002H10.286V15.8574C10.286 15.6207 10.4779 15.4288 10.7146 15.4288H13.286C13.5227 15.4288 13.7146 15.6207 13.7146 15.8574V18.0002H16.286V6.00021Z" fill="#667085"/>\n            </g>\n            </g>\n            <defs>\n            <linearGradient id="paint0_linear_6815_57879" x1="12" y1="0" x2="12" y2="24" gradientUnits="userSpaceOnUse">\n            <stop stop-color="#F9FAFB"/>\n            <stop offset="1" stop-color="#EDF0F3"/>\n            </linearGradient>\n            <clipPath id="clip0_6815_57879">\n            <rect width="24" height="24" rx="4" fill="white"/>\n            </clipPath>\n            <clipPath id="clip1_6815_57879">\n            <rect width="13.7143" height="13.7143" fill="white" transform="translate(5.14307 5.14307)"/>\n            </clipPath>\n            </defs>\n          </svg>\n          &nbsp;\n          <strong style="color: ${d}; font-weight: 400">${e.reference}</strong>\n        </li>\n      </ul>`}),{id:e.unique_id,expanded:p===e.unique_id,name:`<div class="resourceList rowResourceEvent" style="--main-color: ${a};">\n        <ul class="resourceMan">\n          <li>${e.number}</li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                <path d="M5 4C4.72386 4 4.5 4.22386 4.5 4.5C4.5 4.77614 4.72386 5 5 5H11C11.2761 5 11.5 4.77614 11.5 4.5C11.5 4.22386 11.2761 4 11 4H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n                <path d="M4.5 6.5C4.5 6.22386 4.72386 6 5 6H11C11.2761 6 11.5 6.22386 11.5 6.5C11.5 6.77614 11.2761 7 11 7H5C4.72386 7 4.5 6.77614 4.5 6.5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n                <path d="M5 8C4.72386 8 4.5 8.22386 4.5 8.5C4.5 8.77614 4.72386 9 5 9H11C11.2761 9 11.5 8.77614 11.5 8.5C11.5 8.22386 11.2761 8 11 8H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n                <path d="M5 10C4.72386 10 4.5 10.2239 4.5 10.5C4.5 10.7761 4.72386 11 5 11H8C8.27614 11 8.5 10.7761 8.5 10.5C8.5 10.2239 8.27614 10 8 10H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n                <path d="M2 2C2 0.89543 2.89543 0 4 0H12C13.1046 0 14 0.89543 14 2V14C14 15.1046 13.1046 16 12 16H4C2.89543 16 2 15.1046 2 14V2ZM12 1H4C3.44772 1 3 1.44772 3 2V14C3 14.5523 3.44772 15 4 15H12C12.5523 15 13 14.5523 13 14V2C13 1.44772 12.5523 1 12 1Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M11 7.5C11 7.22386 11.2239 7 11.5 7H12.5C12.7761 7 13 7.22386 13 7.5V8.5C13 8.77614 12.7761 9 12.5 9H11.5C11.2239 9 11 8.77614 11 8.5V7.5Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M3.5 0C3.77614 0 4 0.223858 4 0.5V1H12V0.5C12 0.223858 12.2239 0 12.5 0C12.7761 0 13 0.223858 13 0.5V1H14C15.1046 1 16 1.89543 16 3V14C16 15.1046 15.1046 16 14 16H2C0.895431 16 0 15.1046 0 14V3C0 1.89543 0.895431 1 2 1H3V0.5C3 0.223858 3.22386 0 3.5 0ZM2 2C1.44772 2 1 2.44772 1 3V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V3C15 2.44772 14.5523 2 14 2H2Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V5C13.5 5.27614 13.2761 5.5 13 5.5H3C2.72386 5.5 2.5 5.27614 2.5 5V4Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M4 10.7813C4.14782 12.4484 5.51294 13.6306 7.59107 13.7837V15H8.63448V13.7837C10.9039 13.6051 12.3125 12.3463 12.3125 10.4836C12.3125 8.89307 11.3647 7.97448 9.35617 7.45565L8.63448 7.26853V3.46659C9.75615 3.57716 10.5126 4.18104 10.7039 5.08262H12.1734C12.0082 3.4836 10.6343 2.33536 8.63448 2.20778V1H7.59107V2.23329C5.65207 2.46294 4.32172 3.70474 4.32172 5.38882C4.32172 6.84326 5.28687 7.87242 6.98241 8.3062L7.59107 8.4678V12.4994C6.44332 12.3293 5.65207 11.6999 5.46077 10.7813H4ZM7.39108 6.94532C6.34767 6.68165 5.79119 6.12029 5.79119 5.32928C5.79119 4.38518 6.49549 3.68773 7.59107 3.50061V6.99635L7.39108 6.94532ZM8.98228 8.81652C10.2692 9.13973 10.8343 9.67558 10.8343 10.5857C10.8343 11.6829 10.0083 12.4143 8.63448 12.5249V8.73147L8.98228 8.81652Z" \n          fill="${e.is_invoice_created?"PAID"===e.paid?"#17B26A":"NOT PAID"===e.paid?"#F04438":"PARTIAL PAYMENT"===e.paid?"#fedf89":"#F79009":"#667085"}"/>\n            </svg>\n          </li>\n          <li>\n            <span class='${u}'>${e.jobs_done}/${e.jobs_count}</span>\n          </li>\n        </ul>\n        <div class="project-content" unique-id="${e.unique_id}" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}">\n          <span class="small project-content-name" unique-id="${e.unique_id}">${null===e||void 0===e||null===(l=e.client)||void 0===l?void 0:l.name}</span>\n          <h2 class="project-content-name" unique-id="${e.unique_id}">${e.reference}</h2>\n          ${c}\n        </div>\n      </div>`,children:[...e.tasks,{title:"create-task",id:e.number}].map((s=>{var n,i,o;if("create-task"===s.title)return{id:s.id,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${a}; height: ${null!==(i=e.tasks)&&void 0!==i&&i.length?"85px":"65px"}">\n              <button class="create-task-button" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}" style="margin-bottom: ${null!==(o=e.tasks)&&void 0!==o&&o.length?"16px":"6px"}">Create Task\n              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n              </svg>\n              </button> \n            </div>`,minHeight:75,marginBottom:10};t.push({start:m(1e3*+s.from_date),end:m(1e3*+s.to_date),id:s.id,cssClass:"childEvent task-item",resource:s.id,backColor:"#F2F4F7",borderColor:"#F2F4F7",text:s.title,tag:{type:"task",task:s}});const l=s.finished?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n          <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n        </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n          <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n        </svg>';return{id:s.id,name:`<div task-id="${s.id}" class="task-list rowResourceEvent" style="--main-color: ${a}" task-id="${s.id}">\n            <div class="flex">\n              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <g clip-path="url(#clip0_5999_560822)">\n                <rect width="16" height="16" rx="8" fill="url(#paint0_linear_5999_560822)"/>\n                <g opacity="0.08">\n                <rect x="0.375" y="0.375" width="15.25" height="15.25" rx="7.625" stroke="#101828" stroke-width="0.75"/>\n                </g>\n                <path d="M6.57129 6.28585C6.41349 6.28585 6.28557 6.41377 6.28557 6.57157C6.28557 6.72936 6.41349 6.85728 6.57129 6.85728H9.42843C9.58623 6.85728 9.71415 6.72936 9.71415 6.57157C9.71415 6.41377 9.58623 6.28585 9.42843 6.28585H6.57129Z" fill="#475467"/>\n                <path d="M6.57129 7.42871C6.41349 7.42871 6.28557 7.55663 6.28557 7.71443C6.28557 7.87222 6.41349 8.00014 6.57129 8.00014H8.28557C8.44337 8.00014 8.57129 7.87222 8.57129 7.71443C8.57129 7.55663 8.44337 7.42871 8.28557 7.42871H6.57129Z" fill="#475467"/>\n                <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99986 4.57157C8.63104 4.57157 9.14272 4.05989 9.14272 3.42871H10.5713C11.0447 3.42871 11.4284 3.81247 11.4284 4.28585V11.7144C11.4284 12.1878 11.0447 12.5716 10.5713 12.5716H5.42843C4.95505 12.5716 4.57129 12.1878 4.57129 11.7144V4.28585C4.57129 3.81247 4.95505 3.42871 5.42843 3.42871H6.857C6.857 4.05989 7.36868 4.57157 7.99986 4.57157ZM7.99986 5.143C8.74627 5.143 9.38127 4.66596 9.6166 4.00014H10.5713C10.7291 4.00014 10.857 4.12806 10.857 4.28585V11.7144C10.857 11.8722 10.7291 12.0001 10.5713 12.0001H5.42843C5.27064 12.0001 5.14272 11.8722 5.14272 11.7144V4.28585C5.14272 4.12806 5.27064 4.00014 5.42843 4.00014H6.38312C6.61846 4.66596 7.25345 5.143 7.99986 5.143Z" fill="#475467"/>\n                </g>\n                <defs>\n                <linearGradient id="paint0_linear_5999_560822" x1="8" y1="0" x2="8" y2="16" gradientUnits="userSpaceOnUse">\n                <stop stop-color="#F9FAFB"/>\n                <stop offset="1" stop-color="#EDF0F3"/>\n                </linearGradient>\n                <clipPath id="clip0_5999_560822">\n                <rect width="16" height="16" rx="8" fill="white"/>\n                </clipPath>\n                </defs>\n              </svg>\n              <div class="title-description-section">\n                <span class="task-assigner">${null===s||void 0===s||null===(n=s.assigned_to)||void 0===n?void 0:n.name}</span>\n                <span class="task-title">${s.title}</span>\n              </div> \n            </div>\n            <div class="completion-status ${"completed"===l?"completed-class":"incomplete-class"}">\n              ${l}\n            </div>\n          </div>\n          `,minHeight:40,marginBottom:4}}))}}));u.update({resources:s,events:t}),u.onResourceExpand=function(e){p=e.resource.id}}function v(e){try{u&&x(e)}catch(t){console.log(t)}}function g(e,t,s){try{!function(e,t,s){void 0!==typeof window&&Boolean(window.DayPilot)&&(h=window.DayPilot,u=new h.Scheduler(e,{days:365,scale:"Day",separators:[{color:"#48C1FF",width:4}],treeImage:"img/nochildren.png",rowMinHeight:130,eventEndSpec:"Date",durationBarVisible:!1,eventArrangement:"Cascade",eventMoveHandling:"Disabled",eventResizingStartEndEnabled:!0,timeRangeSelectedHandling:"Disabled",treeImageNoChildren:!1,rowHeaderWidth:324,timeHeaders:[{groupBy:"Month",format:"MMMM yyyy"},{groupBy:"Day",format:"d"}],treeEnabled:!0,progressiveRowRendering:!0,treePreventParentUsage:!1,scrollDelayEvents:0,infiniteScrollingEnabled:!0,infiniteScrollingStepDays:100}),u.onBeforeRowHeaderRender=function(e){e.row.cssClass="resourcesRow"},u.onBeforeEventRender=function(e){e.data.areas=[{top:0,left:0,right:0,width:1,cssClass:"childEventborder",text:e.data.text,backColor:e.data.borderColor,fontColor:"#ffffff",horizontalAlignment:"center",style:"border-top-left-radius: 4px; border-bottom-left-radius: 4px; background-color: #0000007f; color: #ffffff; padding: 2px;height: 36px;"}],e.data.text="Event details"},u.onEventClicked=function(e){const t=e.e.id();if(e.div.className.includes("task-item")&&t)s(t,!1);else if(e.div.className.includes("job-item")&&t){const n=e.e.tag();console.log("projectDetails: ",n),s(t,!0,n)}},u.onBeforeCellRender=function(e){6!==e.cell.start.getDayOfWeek()&&0!==e.cell.start.getDayOfWeek()||(e.cell.backColor="#F9FAFB")},u.onEventResize=async function(e){const t=e.e.id(),s=new Date(e.newStart).toISOString(),n=new Date(e.newEnd).toISOString();if("task"===e.e.tag().type){const o=e.e.tag().task;try{await(0,c.lC)(t,{title:o.title,description:o.description,user:o.assigned_to.id,from_date:s,to_date:n}),u.message("The task has been successfully updated.",{cssClass:"success_message"})}catch(i){console.log(i),u.message("An error occurred while updating the task. Please try again.")}}if("job"===e.e.tag().type)try{await(0,d.mw)(t,{booking_start:s,booking_end:n}),u.message("The project schedule has been successfully updated.",{cssClass:"success_message"})}catch(i){console.log(i),u.message("An error occurred while updating the project schedule. Please try again.")}},u.init(),x(t))}(e,t,s)}catch(n){console.log(n)}}var j=s(623),y=s(48417),b=s(65975),f=s(64196),w=s(36097),A=s(10615),C=s(94673),N=s(73898),S=s(38345),F=s(44713),k=s(56741),_=s(41390),E=s(71807),$=s(52572),T=s(72413),B=s(99832),D=s(27066),L=s(38300),I=s(22927),R=s(90991),P=s(33361),M=s(93202),z=s(72970),H=s(88578),U=s(78869),O=s(73216),q=s(35475),V=s(47097),G=s(9642),Z=s(64824),K=s(93740),W=s(78602),J=s(32952),Y=s(61072),Q=s(56328);const X=s.p+"static/media/addNoteModeIcon.43bdc8582f3ef769329a44f15a05fe67.svg";var ee=s(70579);const te=e=>{let{projectId:t,projectCardData:s}=e;const[i,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)(""),[c,u]=(0,n.useState)({description:""}),h=500,p=()=>o(!1),m=(0,V.n)({mutationFn:e=>(0,d.o2)(t,e),onSuccess:()=>{p(),s(t)},onError:e=>{console.error("Error creating note:",e),u((t=>({...t,description:e.message||"Failed to save note. Please try again."})))}}),x=e=>e.trim()?e.length<3?"Note must be at least 3 characters long":e.length>h?"Note must not exceed 500 characters":/^\s+$/.test(e)?"Note cannot contain only whitespace":"":"Note is required";return(0,n.useEffect)((()=>{i||(r(""),u({description:""}))}),[i]),(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"linkByttonStyle py-2 border-right",onClick:()=>o(!0),children:"Add Note"}),(0,ee.jsxs)(J.A,{show:i,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:p,animation:!1,children:[(0,ee.jsxs)(J.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,ee.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,ee.jsxs)("span",{children:[(0,ee.jsx)("img",{src:X,alt:"AddNoteModeIcon"}),"Add Note"]})}),(0,ee.jsx)("button",{className:"CustonCloseModal",onClick:p,children:(0,ee.jsx)(k.A,{size:24,color:"#667085"})})]}),(0,ee.jsx)(J.A.Body,{children:(0,ee.jsx)("div",{className:"ContactModel",children:(0,ee.jsx)(Y.A,{children:(0,ee.jsx)(W.A,{children:(0,ee.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,ee.jsxs)("label",{htmlFor:"note-input",children:["Note ",(0,ee.jsx)("span",{className:"required",children:"*"})]}),(0,ee.jsx)("div",{className:"inputInfo "+(c.description?"error-border":""),children:(0,ee.jsx)("textarea",{id:"note-input",type:"text",name:"note",value:a,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value;r(t);const s=x(t);u((e=>({...e,description:s})))},maxLength:h,rows:4,className:"w-100"})}),(0,ee.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,ee.jsx)("small",{className:c.description?"error-message":"text-muted",children:c.description||`${a.length}/500 characters`})})]})})})})}),(0,ee.jsx)(J.A.Footer,{className:"pt-0",children:(0,ee.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,ee.jsx)(l.A,{variant:"outline-danger",onClick:p,disabled:m.isPending,children:"Cancel"}),(0,ee.jsx)(l.A,{variant:"primary save",onClick:()=>{const e=x(a);e?u((t=>({...t,description:e}))):m.mutate({text:a.trim()})},disabled:m.isPending||!!c.description,children:m.isPending?"Saving...":"Save"})]})})]})]})};var se=s(93747),ne=s(59638),ie=s(81047),oe=s(81242);const le=e=>{var t;let{clientId:s,projectId:i,projectCardData:o}=e;const l=(0,O.Zp)(),[,a]=(0,n.useState)({}),[r,c]=(0,n.useState)(!1),u=(0,se.I)({queryKey:["getOutgoingEmail"],queryFn:ie.hx}),h=(0,se.I)({queryKey:["getClientById",s],queryFn:()=>(0,ne.EZ)(s),enabled:!!s,retry:1}),p=(0,V.n)({mutationFn:e=>(0,d.jy)(i,"",e),onSuccess:()=>{c(!1),o(),Q.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),Q.oR.error("Failed to send email. Please try again.")}});return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"linkByttonStyle py-2 ps-0",onClick:()=>{var e;"no-reply@memate.com.au"!==(null===u||void 0===u||null===(e=u.data)||void 0===e?void 0:e.outgoing_email)?c(!0):l("/settings/integrations?openEmail=true")},children:"Compose Email"}),(0,ee.jsx)(oe.A,{show:r,isLoading:!1,mutation:p,setShow:c,setPayload:a,contactPersons:(null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t.contact_persons)||[],isComposeEmail:!0})]})};const ae=s.p+"static/media/googleReviewIcon.0184cc6ef401c44935cf67effccb9dd0.svg",re=e=>{var t;let{clientId:s,projectId:i}=e;const[,o]=(0,n.useState)({}),[a,r]=(0,n.useState)(!1),c=(0,se.I)({queryKey:["getClientById",s],queryFn:()=>(0,ne.EZ)(s),enabled:!!s,retry:1}),u=(0,V.n)({mutationFn:e=>(0,d.jy)(i,"google-review",e),onSuccess:()=>{r(!1),Q.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),Q.oR.error("Failed to send email. Please try again.")}});return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(l.A,{className:"googleBut googleActive",onClick:()=>r(!0),children:["Google Review  ",(0,ee.jsx)("img",{src:ae,alt:"GoogleReview"})]}),(0,ee.jsx)(oe.A,{show:a,mutation:u,isLoading:!1,setShow:r,setPayload:o,contactPersons:(null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t.contact_persons)||[],defaultTemplateId:"Google Review"})]})};var de=s(46291),ce=s(75758),ue=s(8129),he=s(8868),pe=s(28676),me=s(74532),xe=s(72052);const ve={headerTitle:"send-invoice_headerTitle__YBmdt",customLabel:"send-invoice_customLabel__0D26B",bag:"send-invoice_bag__VXoPF",lable:"send-invoice_lable__hDm-2",dropdownSelect:"send-invoice_dropdownSelect__y4YWM",autoCompleteBox:"send-invoice_autoCompleteBox__sVyzX",AutoComplete:"send-invoice_AutoComplete__cCiBx",bcc:"send-invoice_bcc__KYSsZ",box:"send-invoice_box__pOjbC",active:"send-invoice_active__hBlO9",inputBox:"send-invoice_inputBox__gIZLk"};var ge=s(36166);const je=(0,ee.jsxs)("span",{className:"ql-formats",children:[(0,ee.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,ee.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,ee.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,ee.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,ee.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,ee.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,ee.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,ee.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,ee.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,ee.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,ee.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,ee.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,ee.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,ee.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),ye=e=>{var t,s,i,o;let{show:a,setShow:c,contactPersons:u,setPayload:h,isLoading:p,create:m,projectId:x,projectCardData:v,isCreated:g}=e;const j=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[y,b]=(0,n.useState)(""),[f,w]=(0,n.useState)([]),[A,C]=(0,n.useState)([]),[N,S]=(0,n.useState)([]),[F,k]=(0,n.useState)(null),[_,E]=(0,n.useState)(null),[$,T]=(0,n.useState)(null),[B,D]=(0,n.useState)({}),[L,I]=(0,n.useState)([]),R=(0,n.useRef)(null),P=(0,n.useRef)(null),M=(0,n.useRef)(null),[z,H]=(0,n.useState)(!1),[U,O]=(0,n.useState)(!1),q=()=>c(!1),[G,Z]=(0,n.useState)(null),X=(0,se.I)({queryKey:["emailTemplate"],queryFn:ie.SQ}),te=(0,se.I)({queryKey:["getSignatureTemplates"],queryFn:ie.AO}),ne=(0,se.I)({queryKey:["getOutgoingEmail"],queryFn:ie.hx}),oe=(0,se.I)({queryKey:["emailQuery",G],queryFn:()=>(0,ie.hS)(G),enabled:!!G,retry:1});(0,n.useEffect)((()=>{var e,t,s;null!==ne&&void 0!==ne&&ne.data&&(null!==ne&&void 0!==ne&&null!==(e=ne.data)&&void 0!==e&&e.outgoing_email&&null!==ne&&void 0!==ne&&null!==(t=ne.data)&&void 0!==t&&t.outgoing_email_verified?b(null===ne||void 0===ne||null===(s=ne.data)||void 0===s?void 0:s.outgoing_email):b("no-reply@memate.com.au"))}),[oe,ne]);const le=(0,V.n)({mutationFn:e=>g?(0,ge.LG)(x,e):(0,d.fi)(x,e),onSuccess:()=>{q(),v(),Q.oR.success("Invoice created and send successfully.")},onError:e=>{console.error("Error creating task:",e),Q.oR.error("Failed to create and send invoice. Please try again.")}}),ae=e=>{var t;const s=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let n=u.map((e=>e.email));n=n.filter((e=>!f.includes(e))),n=n.filter((e=>!A.includes(e))),n=n.filter((e=>!N.includes(e))),n=n.filter((e=>e.toLowerCase().includes(s))),I(n)},re=()=>{ae(),R.current&&R.current.show()},de=()=>{ae(),P.current&&P.current.show()},ye=()=>{ae(),M.current&&M.current.show()};return(0,n.useEffect)((()=>{if(null!==u&&void 0!==u&&u.length){let e=u.map((e=>e.email));I(e)}}),[u]),(0,n.useEffect)((()=>{h((e=>({...e,subject:F,email_body:_,from_email:y,to:null===f||void 0===f?void 0:f.toString(),...A.length>0&&{cc:A.toString()},...N.length>0&&{bcc:N.toString()},...$&&{signature:$}})))}),[F,_,y,f,A,N,$,h]),(0,n.useEffect)((()=>{var e,t;null!==te&&void 0!==te&&te.data&&T(null===te||void 0===te||null===(e=te.data)||void 0===e||null===(t=e.find((e=>e.id===j.email_signature)))||void 0===t?void 0:t.id)}),[null===te||void 0===te?void 0:te.data,j.email_signature]),(0,n.useEffect)((()=>{var e,t;E((null===oe||void 0===oe||null===(e=oe.data)||void 0===e?void 0:e.body)||""),k(null===oe||void 0===oe||null===(t=oe.data)||void 0===t?void 0:t.subject),D((e=>({...e,subject:!1}))),D((e=>({...e,text:!1})))}),[null===oe||void 0===oe?void 0:oe.data]),(0,n.useEffect)((()=>{if(null!==X&&void 0!==X&&X.data){var e,t;const s=g?null===X||void 0===X||null===(e=X.data)||void 0===e?void 0:e.find((e=>"Invoice"===e.type)):null===X||void 0===X||null===(t=X.data)||void 0===t?void 0:t.find((e=>"Invoice"===e.type));Z(null===s||void 0===s?void 0:s.id)}}),[null===X||void 0===X?void 0:X.data,g]),(0,ee.jsxs)(J.A,{show:a,centered:!0,onHide:q,className:"invoice-form",size:"lg",children:[(0,ee.jsx)(J.A.Header,{closeButton:!0,children:(0,ee.jsx)("div",{className:`${ve.modalHeader}`,children:(0,ee.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,ee.jsxs)("span",{className:`white-space-nowrap mt-2 mb-2 ${ve.headerTitle}`,children:[g?"Resend":"Send"," a Invoice"]})})})}),(0,ee.jsxs)(J.A.Body,{children:[(0,ee.jsxs)(Y.A,{children:[(0,ee.jsxs)(W.A,{sm:6,className:"mb-3",children:[(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"FROM"}),(0,ee.jsx)(ue.m,{options:ne&&(null===ne||void 0===ne?void 0:ne.data)&&[{value:null===ne||void 0===ne||null===(t=ne.data)||void 0===t?void 0:t.outgoing_email,label:`${null===ne||void 0===ne||null===(s=ne.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,r.A)(ve.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{b(e.value),D((e=>({...e,from:!1})))},value:y})]}),(null===B||void 0===B?void 0:B.from)&&(0,ee.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,ee.jsx)(W.A,{sm:6,className:"mb-3",children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"Templates"}),(0,ee.jsx)(ue.m,{options:X&&(null===(i=X.data)||void 0===i?void 0:i.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,r.A)(ve.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{Z(e.value)},value:G,loading:null===X||void 0===X?void 0:X.isFetching})]})})]}),(0,ee.jsxs)(Y.A,{children:[(0,ee.jsxs)(W.A,{sm:12,className:"mb-3",children:[(0,ee.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,ee.jsxs)("div",{style:{position:"relative"},className:ve.autoCompleteBox,children:[(0,ee.jsx)("div",{style:{width:"50px"},className:ve.bag}),(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"TO"}),(0,ee.jsx)(ce.j,{ref:R,value:f,completeMethod:ae,onChange:e=>{w(e.value),D((e=>({...e,to:!1})))},multiple:!0,suggestions:L,onClick:re,onFocus:re,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));w((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(w((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,r.A)(ve.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,ee.jsx)(l.A,{className:(0,r.A)(ve.box,{[ve.active]:z}),onClick:()=>{H(!z),C([])},children:"CC"}),(0,ee.jsx)(l.A,{className:(0,r.A)(ve.box,{[ve.active]:U}),onClick:()=>{O(!U),S([])},children:"BCC"})]}),(null===B||void 0===B?void 0:B.to)&&(0,ee.jsx)("p",{className:"error-message mb-0",children:"To email is required"})]}),z&&(0,ee.jsx)(W.A,{sm:6,className:"mb-3",children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{width:"50px"},className:ve.bag}),(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"CC"}),(0,ee.jsx)(ce.j,{ref:P,value:A,completeMethod:ae,onChange:e=>{C(e.value)},multiple:!0,suggestions:L,onClick:de,onFocus:de,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));C((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(C((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,r.A)(ve.AutoComplete,"w-100"),placeholder:"CC"})]})}),U&&(0,ee.jsx)(W.A,{sm:6,className:"mb-3",children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{width:"60px"},className:ve.bag}),(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"BCC"}),(0,ee.jsx)(ce.j,{ref:M,value:N,completeMethod:ae,onChange:e=>{S(e.value)},multiple:!0,suggestions:L,onClick:ye,onFocus:ye,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));S((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(S((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,r.A)(ve.AutoComplete,ve.bcc,"w-100"),placeholder:"BCC"})]})}),(0,ee.jsxs)(W.A,{sm:12,className:"mb-2",children:[(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{width:"60px"},className:ve.bag}),(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"SUBJECT"}),(0,ee.jsxs)(pe.C,{children:[(0,ee.jsx)(me.m,{children:(null===oe||void 0===oe?void 0:oe.isFetching)&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,ee.jsx)(xe.S,{value:F,className:(0,r.A)(ve.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{k(e.target.value),D((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===B||void 0===B?void 0:B.subject)&&(0,ee.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,ee.jsxs)(W.A,{sm:12,className:"mb-3",children:[(0,ee.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,ee.jsx)("label",{className:(0,r.A)(ve.lable),children:"Message"}),(0,ee.jsx)(me.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===oe||void 0===oe?void 0:oe.isFetching)&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,ee.jsx)(he.K,{style:{minHeight:"150px"},headerTemplate:je,value:_,placeholder:"Enter a description...",onTextChange:e=>{E(e.htmlValue),D((e=>({...e,text:!1})))}})]}),(null===B||void 0===B?void 0:B.text)&&(0,ee.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,ee.jsx)(W.A,{sm:12,children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("label",{className:(0,r.A)(ve.customLabel),children:"Signature"}),(0,ee.jsx)(ue.m,{options:te&&(null===(o=te.data)||void 0===o?void 0:o.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,r.A)(ve.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{T(e.value)},value:$,loading:null===te||void 0===te?void 0:te.isFetching})]})})]})]}),(0,ee.jsxs)(J.A.Footer,{className:"d-flex justify-content-between",children:[(0,ee.jsx)(l.A,{onClick:q,className:"text-button text-danger",children:"Cancel"}),(0,ee.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[!g&&(0,ee.jsxs)(l.A,{disabled:p,className:"outline-button",onClick:m,children:["Create"," ",p&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,ee.jsxs)(l.A,{className:"solid-button",disabled:null===le||void 0===le?void 0:le.isPending,onClick:async()=>{let e=0;D({}),y||(++e,D((e=>({...e,from:!0})))),0===(null===f||void 0===f?void 0:f.length)&&(++e,D((e=>({...e,to:!0})))),F||(++e,D((e=>({...e,subject:!0})))),_||(++e,D((e=>({...e,text:!0})))),e||le.mutate({subject:F,email_body:_,from_email:y,to:null===f||void 0===f?void 0:f.toString(),...A.length>0&&{cc:A.toString()},...N.length>0&&{bcc:N.toString()},...$&&{signature:$}})},children:[g?"Resend":"Create and Send"," ",(null===le||void 0===le?void 0:le.isPending)&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})},be=e=>{var t;let{clientId:s,projectId:i,isLoading:o,create:a,projectCardData:r,isCreated:d}=e;const[c,u]=(0,n.useState)(!1),[,h]=(0,n.useState)({}),p=(0,se.I)({queryKey:["id",s],queryFn:()=>(0,ne.EZ)(s),enabled:!!s,retry:1});return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(l.A,{className:"InvoiceAction InvoiceActive me-3",onClick:()=>u(!0),children:[d?"Resend":"Create"," Invoice  ",(0,ee.jsx)("img",{src:de.A,alt:"Invoices"})]}),(0,ee.jsx)(ye,{projectId:i,show:c,create:a,isLoading:o,setShow:u,setPayload:h,contactPersons:(null===p||void 0===p||null===(t=p.data)||void 0===t?void 0:t.contact_persons)||[],projectCardData:r,isCreated:d})]})};var fe=s(47994),we=s(51038),Ae=s(66415),Ce=s(95192),Ne=s(73722),Se=s(35470),Fe=s(72796),ke=s(84678),_e=s(58027);const Ee=e=>{var t,s,i,o,a,r;let{show:d,setShow:u,project:h,reInitialize:p,projectCardData:m}=e;const x=(0,n.useRef)(null),[v,g]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),[b,f]=(0,n.useState)(null),[w,A]=(0,n.useState)(null),[C,N]=(0,n.useState)({taskTitle:!1,description:!1,user:!1,date:!1}),S=(0,V.n)({mutationFn:e=>(0,Fe.Nl)(e),onSuccess:()=>{u(!1),g(""),y(""),f(null),A(null),N({taskTitle:!1,description:!1,user:!1,date:!1}),p(),m&&m()},onError:e=>{console.error("Error creating task:",e)}}),F=(0,se.I)({queryKey:["getUserList"],queryFn:c.aU});return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(J.A,{show:d,centered:!0,onHide:()=>u(!1),className:"task-form",children:[(0,ee.jsx)(J.A.Header,{closeButton:!0,children:(0,ee.jsxs)(J.A.Title,{children:[(0,ee.jsx)("img",{src:ke.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,ee.jsx)("span",{className:"modal-task-title",children:"New Task"})]})}),(0,ee.jsxs)(J.A.Body,{children:[(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{children:"Task Title"}),(0,ee.jsxs)(fe.A,{children:[(0,ee.jsx)(Ne.A.Control,{required:!0,type:"text",placeholder:"Enter task title",value:v,onChange:e=>g(e.target.value)}),(0,ee.jsx)(fe.A.Text,{children:(0,ee.jsx)(we.A,{})})]}),C.taskTitle&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Task title is required"})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,ee.jsx)(Ne.A.Label,{children:"Description"}),(0,ee.jsx)(Ne.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:j,onChange:e=>y(e.target.value),required:!0}),C.description&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Description is required"})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-2",children:[(0,ee.jsx)(Ne.A.Label,{children:"Project Task"}),(0,ee.jsxs)(fe.A,{children:[(0,ee.jsx)(Ne.A.Select,{disabled:!0,children:(0,ee.jsxs)("option",{value:h.value,children:[h.reference," (",h.number,")"]})}),(0,ee.jsx)(fe.A.Text,{children:(0,ee.jsx)(Ae.A,{})})]}),!h&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Project task is required"})]})]}),(0,ee.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"20px",borderTop:"1px solid #eaecf0",padding:"12px 30px 8px 20px"},children:[!b&&(0,ee.jsx)(Ce.A,{color:null!==(t=x.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(i=s.element)&&void 0!==i&&i.offsetParent?"#1AB2FF":"#475467",size:22,style:{position:"relative",left:"10px",zIndex:1},onClick:()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.show()},className:"me-3 cursor-pointer"}),(0,ee.jsx)(ue.m,{ref:x,options:(null===F||void 0===F||null===(o=F.data)||void 0===o||null===(a=o.users)||void 0===a||null===(r=a.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===r?void 0:r.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[],onChange:e=>{f(e.value)},valueTemplate:e=>(0,ee.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ee.jsx)(_e.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),itemTemplate:e=>(0,ee.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ee.jsx)(_e.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:b?"fit-content":"0px",height:b?"46px":"0px",zIndex:b?"1":"0",position:"relative",left:b?"0px":"-60px",top:b?"0px":"-15px"},value:b,dropdownIcon:(0,ee.jsx)(ee.Fragment,{}),placeholder:"Select project",filter:!0}),(0,ee.jsx)(Se.A,{dateRange:w,setDateRange:A})]}),(0,ee.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px",padding:"0 30px 8px 30px"},children:[C.user&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"User is required"}),C.date&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Date is required"})]}),(0,ee.jsx)(J.A.Footer,{children:(0,ee.jsx)(l.A,{type:"button",className:"save-button",onClick:()=>{const e={taskTitle:!v,description:!j,user:!b,date:!w};N(e),e.taskTitle||e.description||e.user||e.date||(S.mutate({title:v,description:j,project:h.value,user:b,from_date:w.startDate,to_date:w.endDate}),console.log("Form submitted with:",{taskTitle:v,description:j,user:b,date:w}))},children:S.isPending?"Loading...":"Create Task"})})]})})},$e=e=>{let{project:t,reInitialize:s,projectCardData:i}=e;const[o,l]=(0,n.useState)(!1);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"linkByttonStyle py-2 border-right pe-5",onClick:()=>l(!0),children:"New Task"}),(0,ee.jsx)(Ee,{show:o,setShow:l,project:t,reInitialize:s,projectCardData:i})]})};var Te=s(69767),Be=s(83570),De=s(64967),Le=s(39759);const Ie=[{icon:(0,ee.jsx)(I.A,{size:16,color:"#1AB2FF"}),label:"Invoice",value:"invoice"},{icon:(0,ee.jsx)(Te.A,{size:16,color:"#1AB2FF"}),label:"Quote",value:"quote"},{icon:(0,ee.jsx)(Be.A,{size:16,color:"#1AB2FF"}),label:"System",value:"system"},{icon:(0,ee.jsx)(D.A,{size:16,color:"#1AB2FF"}),label:"Notes",value:"note"},{icon:(0,ee.jsx)(P.A,{size:16,color:"#1AB2FF"}),label:"Email",value:"email"},{icon:(0,ee.jsx)(R.A,{size:16,color:"#1AB2FF"}),label:"SMS",value:"sms"},{icon:(0,ee.jsx)(L.A,{size:16,color:"#1AB2FF"}),label:"Tasks",value:"task"},{icon:(0,ee.jsx)(B.A,{size:16,color:"#1AB2FF"}),label:"Job Created",value:"job"},{icon:(0,ee.jsx)(De.A,{size:16,color:"#1AB2FF"}),label:"Expense Linked",value:"order"}],Re=e=>{let{setFilteredHistoryOptions:t}=e;const[s,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)([]);console.log("tempSelectedOptions: ",o);return(0,ee.jsxs)("div",{className:"projectCardFilterDropdown",children:[(0,ee.jsx)("span",{onClick:()=>i((e=>!e)),children:(0,ee.jsx)(Le.A,{size:20,color:"#344054"})}),s&&(0,ee.jsxs)("div",{className:"dropdown-menuF px-0",children:[(0,ee.jsxs)("button",{className:"all p-0 ps-2 pe-2 mx-2 text-left d-flex justify-content-between align-items-center rounded",style:{background:"#F9FAFB",width:"94%"},onClick:()=>{(null===o||void 0===o?void 0:o.length)>0?l([]):l(Ie.map((e=>e.value)))},children:[(0,ee.jsx)("span",{className:"border-0",style:{background:"transparent"},children:"All"}),Ie.length===(null===o||void 0===o?void 0:o.length)&&(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,ee.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(0,ee.jsx)("ul",{className:"ps-3",children:Ie.map((e=>{let{icon:t,label:s,value:n}=e;return(0,ee.jsx)("li",{className:o.includes(s)?"active":"",onClick:()=>(e=>{l((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(n),children:(0,ee.jsxs)("label",{htmlFor:s,className:"w-100 d-flex justify-content-between align-items-center",children:[(0,ee.jsx)("input",{id:s,type:"checkbox",checked:o.includes(n),readOnly:!0,style:{cursor:"pointer",height:"40px"}}),(0,ee.jsxs)("span",{className:"border-0",children:[t," ",s]}),o.includes(n)&&(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,ee.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]})},s)}))}),(0,ee.jsx)("hr",{}),(0,ee.jsxs)("div",{className:"dropdown-buttonsF pb-2 px-3",children:[(0,ee.jsx)("button",{className:"cancel",onClick:()=>l([]),children:"Cancel"}),(0,ee.jsx)("button",{className:"apply",onClick:()=>{t(o),i(!1)},children:"Apply"})]})]})]})};var Pe=s(19540),Me=s(34168);const ze=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},He=e=>{let{startDate:t,endDate:s}=e;return(0,ee.jsxs)(l.A,{className:"dateSelectdTaskBar schedule schActive",style:{minWidth:"160px",minHeight:"46px"},children:[ze(t,s)," ",(0,ee.jsx)("img",{src:Pe.A,alt:"OrdersIcon"})]})},Ue=e=>{let{projectId:t,projectCardData:s,isFetching:i,startDate:o,endDate:a}=e;const[r,c]=(0,n.useState)({startDate:null,endDate:null}),[u,h]=(0,n.useState)(!1),p=(0,n.useRef)(null),m=(0,V.n)({mutationFn:e=>(0,d.mw)(t,e),onSuccess:async()=>{s(t)},onError:e=>{c({startDate:null,endDate:null}),console.error("Error creating task:",e)}}),x=e=>{p.current&&!p.current.contains(e.target)&&h(!1)};return(0,n.useEffect)((()=>{o&&a&&c({startDate:new Date(1e3*+o),endDate:new Date(1e3*+a)})}),[o,a]),(0,n.useEffect)((()=>(u?document.addEventListener("mousedown",x):document.removeEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)})),[u]),(0,ee.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:p,children:[(0,ee.jsx)("div",{onClick:()=>h((e=>!e)),style:{cursor:"pointer"},children:null!==r&&void 0!==r&&r.startDate&&null!==r&&void 0!==r&&r.endDate&&!m.isPending?(0,ee.jsx)(He,{isPending:m.isPending,startDate:r.startDate,endDate:r.endDate}):(0,ee.jsx)(l.A,{className:"schedule schActive",style:{minWidth:"201px",minHeight:"46px"},children:m.isPending||i?(0,ee.jsx)("div",{className:"dot-flashing"}):(0,ee.jsxs)("span",{children:["Schedule Project  ",(0,ee.jsx)("img",{src:Pe.A,alt:"OrdersIcon"})]})})}),u&&(0,ee.jsx)("div",{className:"select-date-range",style:{position:"absolute",bottom:"40px",background:"#fff",zIndex:1e3},children:(0,ee.jsx)(Me.A,{onDataApply:e=>{m.mutate({booking_start:e.startDate,booking_end:e.endDate}),c(e),h(!1)},dateRange:r,onClose:()=>h(!1)})})]})};var Oe=s(79726),qe=s(3930),Ve=s(35131);s(93066);const Ge={"#1AB2FF":{bg:"#BAE8FF",border:"#1AB2FF",color:"#0A4766",text:"Blue"},"#4E5BA6":{bg:"#EAECF5",border:"#4E5BA6",color:"#293056",text:"Deep Blue"},"#2970FF":{bg:"#D1E0FF",border:"#2970FF",color:"#0040C1",text:"Dark Blue"},"#FFB258":{bg:"#FFE8CD",border:"#FFB258",color:"#6D471A",text:"Orange"},"#15B79E":{bg:"#CCFBEF",border:"#15B79E",color:"#125D56",text:"Green"},"#66C61C":{bg:"#E3FBCC",border:"#66C61C",color:"#326212",text:"Light Green"},"#7A5AF8":{bg:"#EBE9FE",border:"#7A5AF8",color:"#4A1FB8",text:"Light Purple"},"#D444F1":{bg:"#FBE8FF",border:"#D444F1",color:"#821890",text:"Magenta"},"#F63D68":{bg:"#FFE4E8",border:"#F63D68",color:"#A11043",text:"Pink"},"#FF007F":{bg:"#FFCCE5",border:"#FF007F",color:"#6F0A3C",text:"Soft Pink"},"#FFD700":{bg:"#FFF8D1",border:"#FFD700",color:"#997100",text:"Yellow"},"#6C6C1C":{bg:"#E1E1B8",border:"#6C6C1C",color:"#444403",text:"Dark Yellow"}},Ze=e=>{var t,s,i;let{projectId:o,statusOptions:l,custom_status:a}=e;const[r,c]=(0,n.useState)(null),u=(0,V.n)({mutationFn:e=>(0,d.Np)(o,e),onSuccess:async()=>{},onError:e=>{c(a),console.error("Error creating task:",e)}});return(0,n.useEffect)((()=>{c(a)}),[a]),(0,ee.jsx)(Oe.W,{menuButton:(0,ee.jsxs)(qe.I,{style:{width:"204px",display:"inline-flex",alignItems:"center",justifyContent:"flex-end",padding:"8px 0px",cursor:"pointer",background:"transparent",border:"none",color:"#98A2B3",gap:"10px"},children:[r&&r.title?(0,ee.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,ee.jsx)(ee.Fragment,{children:u.isPending?(0,ee.jsx)("div",{className:"dot-flashing"}):(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=Ge[null===r||void 0===r?void 0:r.color])||void 0===t?void 0:t.border}`}}),(0,ee.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:`${null===(s=Ge[null===r||void 0===r?void 0:r.color])||void 0===s?void 0:s.bg}`},children:[(0,ee.jsx)("span",{style:{color:`${null===(i=Ge[null===r||void 0===r?void 0:r.color])||void 0===i?void 0:i.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===r||void 0===r?void 0:r.title}),(0,ee.jsx)("span",{className:"inArrow",children:(0,ee.jsx)(Ae.A,{color:"#98A2B3",size:15})})]})]})})}):(0,ee.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"h-100",style:{width:"4px",background:"#1D2939"}}),(0,ee.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:"#F2F4F7"},children:[(0,ee.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:"No Status"}),(0,ee.jsx)("span",{className:"inArrow",children:(0,ee.jsx)(Ae.A,{color:"#98A2B3",size:15})})]})]})})}),(0,ee.jsx)("span",{className:"outArrow",children:(0,ee.jsx)(Ae.A,{color:"#98A2B3",size:15})})]}),overflow:"auto",position:"anchor",children:null===l||void 0===l?void 0:l.map((e=>{var t,s,n;return(0,ee.jsx)(Ve.D,{style:{textAlign:"left"},onClick:()=>{var t;null!==(t=e)&&void 0!==t&&t.id&&(u.mutate({custom_status:null===t||void 0===t?void 0:t.id}),c(t))},children:(0,ee.jsxs)("div",{className:"d-flex",style:{width:"163px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:[(0,ee.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=Ge[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.border}`}}),(0,ee.jsx)("div",{className:"h-100 d-flex align-items-center",style:{width:"100%",background:`${null===(s=Ge[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.bg}`},children:(0,ee.jsx)("span",{style:{color:`${null===(n=Ge[null===e||void 0===e?void 0:e.color])||void 0===n?void 0:n.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===e||void 0===e?void 0:e.title})})]})},e.id)}))})};var Ke=s(17380),We=s(17803);const Je={phoneInput:"send-sms_phoneInput__Qgh+S",countrySelector:"send-sms_countrySelector__y14UT",customLabel:"send-sms_customLabel__RzF9F"},Ye=We.PhoneNumberUtil.getInstance(),Qe=e=>{try{return Ye.isValidNumber(Ye.parseAndKeepRawInput(e))}catch(t){return!1}},Xe=e=>{var t;let{projectId:s,projectCardData:i}=e;const o=(0,O.Zp)(),[a,c]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),[p,m]=(0,n.useState)(""),[x,v]=(0,n.useState)({}),[g,j]=(0,n.useState)(""),y=()=>{h(!1),m(""),j(""),v({}),c(null)},b=(0,se.I)({queryKey:["getSMSTemplates"],queryFn:ie.pJ}),f=(0,se.I)({queryKey:["smsQuery",a],queryFn:()=>(0,ie.Mp)(a),enabled:!!a,retry:1}),w=(0,V.n)({mutationFn:e=>(0,d.qm)(s,e),onSuccess:()=>{Q.oR.success("SMS send successfully"),y(),i()},onError:e=>{console.error("Error creating expense:",e),Q.oR.error("Failed to send sms. Please try again.")}});return(0,n.useEffect)((()=>{var e;null!==f&&void 0!==f&&null!==(e=f.data)&&void 0!==e&&e.text&&(m(f.data.text),v((e=>({...e,message:!1}))))}),[f.data]),(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("div",{className:"linkByttonStyle py-2 border-right text-center ps-0",onClick:()=>{const e=JSON.parse(window.localStorage.getItem("profileData")||"{}");null!==e&&void 0!==e&&e.has_twilio?h(!0):o("/settings/integrations?openTwilio=true")},children:"Send SMS"}),(0,ee.jsxs)(J.A,{show:u,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:y,animation:!1,children:[(0,ee.jsxs)(J.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,ee.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,ee.jsxs)("span",{children:[(0,ee.jsx)("img",{src:X,alt:"AddNoteModeIcon"}),"Send SMS"]})}),(0,ee.jsx)("button",{className:"CustonCloseModal",onClick:y,children:(0,ee.jsx)(k.A,{size:24,color:"#667085"})})]}),(0,ee.jsx)(J.A.Body,{children:(0,ee.jsxs)("div",{className:"ContactModel",children:[(0,ee.jsxs)(Y.A,{children:[(0,ee.jsx)(W.A,{sm:12,className:"mb-3",children:(0,ee.jsxs)("div",{style:{position:"relative"},children:[(0,ee.jsx)("label",{className:(0,r.A)(Je.customLabel),children:"Templates"}),(0,ee.jsx)(ue.m,{options:b&&(null===(t=b.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.title}`}))))||[],className:(0,r.A)(Je.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{c(e.value)},value:a,loading:null===b||void 0===b?void 0:b.isFetching})]})}),(0,ee.jsx)(W.A,{children:(0,ee.jsxs)("div",{className:"formgroup sendSMSPhone mb-2 mt-0",children:[(0,ee.jsxs)("label",{children:["To",(0,ee.jsx)("span",{className:"required",children:"*"})]}),(0,ee.jsx)("div",{className:"inputInfo p-0 "+(x.taskRead?"error-border":"border-0"),children:(0,ee.jsx)(Ke.LR,{defaultCountry:"au",placeholder:"Enter phone number",value:g||"",className:"phoneInput w-100",containerClass:Je.countrySelector,onChange:e=>{j(e),Qe(e)&&v((e=>({...e,phone:!1})))}})}),x.phone&&(0,ee.jsx)("p",{className:"error-message",children:"Phone is not valid"})]})})]}),(0,ee.jsx)(Y.A,{children:(0,ee.jsx)(W.A,{children:(0,ee.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,ee.jsxs)("label",{children:["Message",(0,ee.jsx)("span",{className:"required",children:"*"})]}),(0,ee.jsxs)("div",{className:"inputInfo "+(x.description?"error-border":""),style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{position:"absolute",right:"10px",top:"15px"},children:(null===f||void 0===f?void 0:f.isFetching)&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,ee.jsx)("textarea",{type:"text",name:"Enter a message here...",value:p,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value.slice(0,150);m(t),v((e=>({...e,message:!1})))}})]}),(0,ee.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-1",children:[(0,ee.jsx)("p",{className:"error-message",children:x.message&&"Description is required"}),(0,ee.jsxs)("div",{style:{float:"right",fontSize:"14px",color:"#6c757d"},children:[(null===p||void 0===p?void 0:p.length)||0,"/150"]})]})]})})}),(0,ee.jsx)(Y.A,{}),(0,ee.jsxs)("div",{className:"popoverbottom  mt-0 pt-4",children:[(0,ee.jsx)(l.A,{variant:"outline-danger",onClick:y,children:"Cancel"}),(0,ee.jsxs)(l.A,{disabled:null===w||void 0===w?void 0:w.isPending,variant:"primary save d-flex align-items-center gap-2",onClick:()=>{let e={};if(p||(e.message=!0),g&&Qe(g)||(e.phone=!0),Object.keys(e).length)return v(e);w.mutate({phone_number:g,message:p})},children:["Send",(null===w||void 0===w?void 0:w.isPending)&&(0,ee.jsx)(K.p,{style:{width:"15px",height:"15px"}})]})]})]})})]})]})};var et=s(9634),tt=s(86213),st=s(55917),nt=s(85371);const it="send-to-calendar_calendarButton__wLLgP",ot="send-to-calendar_calendarModal__ZnyeK",lt="send-to-calendar_modalTitle__yfOOC",at="send-to-calendar_formLabel__eKaq1",rt="send-to-calendar_AutoComplete__iw4uu";const dt=s.p+"static/media/calendar.9ebe7da58af479b138e37b33d2affea2.svg",ct=e=>{let{projectId:t,project:s,projectCardData:i}=e;const o=(0,n.useRef)(null),a=JSON.parse(window.localStorage.getItem("profileData")||"{}"),d=localStorage.getItem("access_token"),[c,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),[m,x]=(0,n.useState)(""),[v,g]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),[b,f]=(0,n.useState)(""),[w,A]=(0,n.useState)(null),[C,N]=(0,n.useState)(null),[S,F]=(0,n.useState)([]),[k,_]=(0,n.useState)(""),[E,$]=(0,n.useState)([]),T=(0,se.I)({queryKey:["getClientById",null===s||void 0===s?void 0:s.client],queryFn:()=>(0,ne.EZ)(null===s||void 0===s?void 0:s.client),enabled:!(null===s||void 0===s||!s.client)&&!!c,retry:1}),B=(0,se.I)({queryKey:["getOutgoingEmail"],queryFn:ie.hx,enabled:!!c}),D=()=>{u(!1),F([]),x(""),g(""),y(""),A(null),N(null),f(""),_("")};(0,n.useEffect)((()=>{null!==s&&void 0!==s&&s.booking_start&&!w&&A(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&!C&&N(new Date(1e3*s.booking_end))}),[s,w,C]);const L=e=>{var t,s;const n=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=((null===(s=T.data)||void 0===s?void 0:s.contact_persons)||[]).map((e=>e.email));i=i.filter((e=>!S.includes(e))),i=i.filter((e=>e.toLowerCase().includes(n))),$(i)},I=()=>{L(),o.current&&o.current.show()};return(0,n.useEffect)((()=>{var e,t,s;null!==B&&void 0!==B&&B.data&&(null!==B&&void 0!==B&&null!==(e=B.data)&&void 0!==e&&e.outgoing_email&&null!==B&&void 0!==B&&null!==(t=B.data)&&void 0!==t&&t.outgoing_email_verified?_(null===B||void 0===B||null===(s=B.data)||void 0===s?void 0:s.outgoing_email):_("no-reply@memate.com.au"))}),[B]),(0,n.useEffect)((()=>{null!==a&&void 0!==a&&a.email&&c&&F([null===a||void 0===a?void 0:a.email])}),[null===a||void 0===a?void 0:a.email,c]),(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(l.A,{disabled:!(null!==s&&void 0!==s&&s.booking_start),className:`calenBut calenActive ${it}`,onClick:()=>{null!==s&&void 0!==s&&s.reference?x(`${s.reference}`):null!==s&&void 0!==s&&s.number?x(`Project #${s.number}`):x("Project Event"),g((null===s||void 0===s?void 0:s.description)||""),null!==s&&void 0!==s&&s.booking_start&&A(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&N(new Date(1e3*s.booking_end)),u(!0)},children:["Send to Calendar ",(0,ee.jsx)("img",{src:dt,alt:"Calendar"})]}),(0,ee.jsxs)(J.A,{show:c,onHide:D,centered:!0,className:ot,children:[(0,ee.jsx)(J.A.Header,{closeButton:!0,children:(0,ee.jsx)(J.A.Title,{className:lt,children:"Send to Calendar"})}),(0,ee.jsx)(J.A.Body,{children:(0,ee.jsxs)(Ne.A,{onSubmit:async e=>{e.preventDefault(),p(!0);try{if(!(m.trim()?w&&C?w>C?(Q.oR.error("End date must be after start date"),0):0===S.length?(Q.oR.error("At least one guest is required"),0):k||(Q.oR.error("From email is required"),0):(Q.oR.error("Start and end dates are required"),0):(Q.oR.error("Event title is required"),0)))return void p(!1);const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(null===a||void 0===a?void 0:a.email)||"no-reply@memate.com.au";const s=e=>(0,st.A)(e,"yyyyMMdd'T'HHmmss'Z'"),n=new Date,i=`${Date.now()}@memate.com.au`,o=s(n);let l=v||"Meeting Invitation",r=`<html><body><p>${v||"Meeting Invitation"}</p>`;if(b){const e=(d=b)?d.includes("zoom.us")?"Zoom":d.includes("teams.microsoft.com")?"Microsoft Teams":d.includes("meet.google.com")?"Google Meet":d.includes("webex.com")?"Cisco Webex":"Online Meeting":null;l+=`\n\n${e} Link: ${b}`,r+=`<p><strong>${e} Link:</strong> <a href="${b}">${b}</a></p>`}var d;r+="</body></html>",r=r.replace(/\n/g,"").replace(/\s+/g," ");const c=["BEGIN:VCALENDAR","PRODID:-//MeMate//Calendar//EN","VERSION:2.0","CALSCALE:GREGORIAN","METHOD:REQUEST","BEGIN:VEVENT",`UID:${i}`,`DTSTAMP:${o}`,`SUMMARY:${m}`,`DESCRIPTION:${l.replace(/\n/g,"\\n")}`,`LOCATION:${j||b||""}`,b?`URL:${b}`:"",`DTSTART:${s(w)}`,`DTEND:${s(C)}`,`ORGANIZER;CN=${null!==a&&void 0!==a&&a.first_name&&null!==a&&void 0!==a&&a.last_name?`${a.first_name} ${a.last_name}`:t.split("@")[0]||"MeMate"}:mailto:${t}`].filter((e=>""!==e));return e&&e.length>0&&e.forEach((e=>{let t=e.split("@")[0].replace(/[.]/g," ");t=t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),c.push(`ATTENDEE;CUTYPE=INDIVIDUAL;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;CN=${t}:mailto:${e}`)})),c.push("STATUS:CONFIRMED","SEQUENCE:0","TRANSP:OPAQUE","BEGIN:VALARM","TRIGGER:-PT15M","ACTION:DISPLAY","DESCRIPTION:Reminder","END:VALARM","X-MICROSOFT-CDO-BUSYSTATUS:BUSY","X-MICROSOFT-CDO-IMPORTANCE:1","X-MICROSOFT-DISALLOW-COUNTER:FALSE","X-MICROSOFT-DONOTFORWARDMEETING:FALSE","X-MICROSOFT-CDO-ALLDAYEVENT:FALSE"),b&&(b.includes("meet.google.com")?c.push(`X-GOOGLE-CONFERENCE:${b}`):b.includes("teams.microsoft.com")&&c.push(`X-MICROSOFT-SKYPETEAMSMEETINGURL:${b}`)),c.push(`X-ALT-DESC;FMTTYPE=text/html:${r}`),c.push("END:VEVENT","END:VCALENDAR"),c.join("\r\n")}(S,k),s=new File([e],"invite.ics",{type:"text/calendar"}),n=new FormData;n.append("subject",`Invitation: ${m}`),n.append("email_body",v),n.append("from_email",k),n.append("to",S.toString()),n.append("attachments",s),await tt.A.post(`https://dev.memate.com.au/api/v1/custom/email/${t}/`,n,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"multipart/form-data"}}),Q.oR.success("Calendar event created successfully!"),D(),i(t)}catch(s){console.error("Error creating calendar event:",s),Q.oR.error("Failed to create calendar event. Please try again.")}finally{p(!1)}},children:[(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Event Title"}),(0,ee.jsx)(Ne.A.Control,{type:"text",placeholder:"Enter event title",value:m,onChange:e=>x(e.target.value),required:!0,className:"border outline-none"})]}),(0,ee.jsxs)(Y.A,{className:"mb-3",children:[(0,ee.jsx)(W.A,{children:(0,ee.jsxs)(Ne.A.Group,{children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Start Date & Time"}),(0,ee.jsx)(nt.V,{value:w,onChange:e=>{A(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,ee.jsx)(et.A,{color:"#667085",size:20}),className:"w-100 border rounded",appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"})]})}),(0,ee.jsx)(W.A,{children:(0,ee.jsxs)(Ne.A.Group,{children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"End Date & Time"}),(0,ee.jsx)(nt.V,{value:C,onChange:e=>{N(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,ee.jsx)(et.A,{color:"#667085",size:20}),className:"w-100 border rounded",appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"})]})})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Add Guests"}),(0,ee.jsx)(ce.j,{ref:o,value:S,completeMethod:L,onChange:e=>{F(e.value)},multiple:!0,suggestions:E,onClick:I,onFocus:I,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));F((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(F((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,r.A)(rt,"w-100"),placeholder:"Add guests"})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Location"}),(0,ee.jsx)(Ne.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter physical location (optional)",value:j,onChange:e=>y(e.target.value)})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Meeting Link"}),(0,ee.jsx)(Ne.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter meeting link (Zoom, Teams, etc.)",value:b,onChange:e=>f(e.target.value)})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{className:at,children:"Description"}),(0,ee.jsx)(Ne.A.Control,{as:"textarea",rows:3,className:"border outline-none",placeholder:"Enter event description",value:v,onChange:e=>g(e.target.value)})]}),(0,ee.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4 border-top pt-4",children:[(0,ee.jsx)(l.A,{className:"outline-button",variant:"secondary",onClick:D,children:"Cancel"}),(0,ee.jsx)(l.A,{className:"solid-button",variant:"primary",type:"submit",disabled:h,children:h?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Sending..."]}):"Send via Email"})]})]})})]})]})};var ut=s(67046),ht=s(41292),pt=s(96327),mt=s(14834);const xt=e=>{var t;let{viewShow:s,setViewShow:i,projectId:o,project:a,statusOptions:r,reInitialize:c}=e;const u=(0,O.Zp)(),h=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[p,m]=(0,n.useState)(!1),[x,v]=(0,n.useState)(!0),[g,j]=(0,n.useState)(null),[y,X]=(0,n.useState)(!1),[se,ne]=(0,n.useState)(""),[ie,oe]=(0,n.useState)([]),[ae,de]=(0,n.useState)([]),[ce,ue]=(0,n.useState)([]),[he,pe]=(0,n.useState)(!1),me=parseFloat(null===g||void 0===g?void 0:g.cost_of_sale)||0,xe=parseFloat(null===g||void 0===g?void 0:g.labor_expenses)||0,ve=parseFloat(null===g||void 0===g?void 0:g.operating_expense)||0,ge=parseFloat(me+xe+ve).toFixed(2),je=()=>{i(!1),c()},ye=async e=>{v(!0);try{const t=await(0,d.OE)(e);j(t)}catch(t){console.error("Error fetching project card data:",t)}finally{v(!1)}},fe=(0,V.n)({mutationFn:e=>(0,d.aj)(o,e),onSuccess:()=>{j((e=>({...e,reference:se})))},onError:e=>{console.error("Error creating task:",e)}}),we=e=>{const t=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(t)} | ${`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}`},Ae=(0,V.n)({mutationFn:e=>(0,d.jE)(e),onSuccess:e=>{e?u("/sales"):Q.oR.error("Failed to update sendBack to sales. Please try again.")},onError:e=>{console.error("Error updating sendBack to sales:",e),Q.oR.error("Failed to update sendBack to sales. Please try again.")}}),Ce=(0,V.n)({mutationFn:e=>(0,d.ZE)(e),onSuccess:e=>{e?(je(),Q.oR.success("Order has been successfully declined")):Q.oR.error("Failed to decline the order. Please try again.")},onError:e=>{console.error("Error declining the order:",e),Q.oR.error("Failed to decline the order. Please try again.")}}),Ne=(0,V.n)({mutationFn:e=>(0,d.yE)(e),onSuccess:e=>{e?(u("/sales"),Q.oR.success("Project has been successfully completed")):Q.oR.error("Failed to complete the project. Please try again.")},onError:e=>{console.error("Error completing the project:",e),Q.oR.error("Failed to complete the project. Please try again.")}}),Se=(0,V.n)({mutationFn:e=>(0,d.SE)(e),onSuccess:e=>{e?(je(),ye(o),Q.oR.success("Invoice has been successfully created")):Q.oR.error("Failed to create the invoice. Please try again.")},onError:e=>{console.error("Error creating the invoice:",e),Q.oR.error("Failed to create the invoice. Please try again.")}});(0,n.useEffect)((()=>{if(null!==ce&&void 0!==ce&&ce.length){var e;let t=null===g||void 0===g||null===(e=g.history)||void 0===e?void 0:e.filter((e=>ce.includes(e.type)));de(t||[])}else de(null===g||void 0===g?void 0:g.history)}),[ce,null===g||void 0===g?void 0:g.history]),(0,n.useEffect)((()=>{if(g){let e=[...null===g||void 0===g?void 0:g.expenses.map((e=>({...e,type:"expense"}))),...null===g||void 0===g?void 0:g.jobs.map((e=>({...e,type:"job"})))].sort(((e,t)=>parseInt(t.created)-parseInt(e.created)));oe(e),de((null===g||void 0===g?void 0:g.history)||[])}}),[g]),(0,n.useEffect)((()=>{o&&s&&ye(o)}),[o,s]);const Fe=e=>{var t,s,i,o;let{emailData:l}=e;const[a,r]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),u=(0,n.useRef)(null),h=(e=>{var t,s,n;const i=e.split("\n"),o=(null===(t=i.find((e=>e.startsWith("Subject:"))))||void 0===t?void 0:t.replace("Subject: ",""))||"",l=(null===(s=i.find((e=>null===e||void 0===e?void 0:e.startsWith("Recipient(s):"))))||void 0===s?void 0:s.replace("Recipient(s): ",""))||[];return{subject:o,recipients:JSON.parse((null===l||void 0===l?void 0:l.length)&&(null===l||void 0===l?void 0:l.replace(/'/g,'"'))),body:null===(n=e.split("Body:")[1])||void 0===n?void 0:n.trim()}})(l),p=null===(t=h.body)||void 0===t||null===(s=t.split(/<\/p>\s*<p>|<br\s*\/?>|\n/))||void 0===s?void 0:s.map(((e,t)=>`<p key=${t}>${null===e||void 0===e?void 0:e.trim()}</p>`)),m=null===p||void 0===p?void 0:p.join("");return(0,n.useEffect)((()=>{if(u.current){const e=u.current.scrollHeight;c(e>90)}}),[m]),(0,ee.jsxs)("div",{children:[(0,ee.jsxs)("ul",{className:"d-flex flex-column align-items-start",children:[(0,ee.jsxs)("li",{className:"font-12",children:[(0,ee.jsx)("strong",{className:"font-12",children:"Subject:"}),"\xa0 ",h.subject]}),(0,ee.jsxs)("li",{children:[(0,ee.jsx)("strong",{className:"font-12",children:"Recipients:"}),"\xa0",(0,ee.jsx)("ul",{children:(null===h||void 0===h||null===(i=h.recipients)||void 0===i?void 0:i.length)&&(null===h||void 0===h||null===(o=h.recipients)||void 0===o?void 0:o.map(((e,t)=>(0,ee.jsx)("li",{className:"font-12",children:e},t))))})]})]}),(0,ee.jsxs)("div",{children:[(0,ee.jsx)("div",{ref:u,style:{maxHeight:a?"none":"87px",overflowY:"hidden",overflowX:a?"auto":"hidden"},dangerouslySetInnerHTML:{__html:m}}),d&&(0,ee.jsx)("button",{className:"text-button font-12 px-0",onClick:()=>r(!a),children:a?"Show Less":"Load More"})]})]})};return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(J.A,{show:s,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"projectCardModel",onHide:je,animation:!1,children:[(0,ee.jsxs)(J.A.Header,{className:"mb-0 pb-0 justify-content-between ",children:[(0,ee.jsx)("div",{className:"modelHeader",style:{flex:"1",maxWidth:"calc(100% - 350px)"},children:(0,ee.jsxs)("ul",{className:"d-flex align-items-center",children:[(0,ee.jsxs)("li",{className:"me-1 d-flex align-items-center",children:[(0,ee.jsx)("strong",{className:"dollorIcon",style:{background:null!==g&&void 0!==g&&g.invoice_created?"paid"===(null===g||void 0===g?void 0:g.payment_status)?"#F2FDEC":"not_paid"===(null===g||void 0===g?void 0:g.payment_status)?"#FEF3F2":"#FFFAEB":"#F9FAFB"},children:(0,ee.jsx)(C.A,{size:13,color:null!==g&&void 0!==g&&g.invoice_created?"paid"===(null===g||void 0===g?void 0:g.payment_status)?"#17B26A":"not_paid"===(null===g||void 0===g?void 0:g.payment_status)?"#F04438":"#B54708":"#667085"})}),x?(0,ee.jsx)(b.A,{as:"span",animation:"wave",className:"ms-2 me-2",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",size:"md",style:{width:"120px"}})}):(0,ee.jsxs)("span",{className:"cardId text-nowrap",children:[null===g||void 0===g?void 0:g.number," \xa0"]})]}),(0,ee.jsxs)("li",{className:"refrencesTag mt-1",style:{width:"calc(100% - 120px)"},children:["Reference:\xa0",x?(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):y?(0,ee.jsx)("input",{type:"text",value:se,onChange:e=>{ne(e.target.value)},onBlur:async()=>{X(!1),await fe.mutateAsync({reference:se}),await(0,d.SE)(o)},autoFocus:!0,className:"border rounded w-100",style:{maxWidth:"calc(100% - 120px)"}}):(0,ee.jsx)(ee.Fragment,{children:fe.isPending?(0,ee.jsx)("div",{className:"dot-flashing ms-5 mt-1"}):(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)("small",{className:"ellipsis-width",style:{color:"#1D2939",fontSize:"16px",maxWidth:"calc(100% - 220px)"},children:[" ",null===g||void 0===g?void 0:g.reference]}),(0,ee.jsxs)("span",{children:[" ",(0,ee.jsx)(N.A,{size:16,color:"#106B99",onClick:()=>{X(!0),ne((null===g||void 0===g?void 0:g.reference)||"")},style:{cursor:"pointer"}})]})]})})]})]})}),(0,ee.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"15px"},children:[(0,ee.jsx)(q.N_,{to:`/api/v1/project-card/${o}/pdf/`,target:"_blank",children:(0,ee.jsx)(l.A,{variant:"light",className:"rounded-circle px-2",title:"Project Card",children:(0,ee.jsx)(S.A,{color:"#344054",size:20})})}),(0,ee.jsx)(q.N_,{to:`/api/v1/sales/${o}/label/`,target:"_blank",title:"Label",children:(0,ee.jsx)(l.A,{variant:"light",className:"rounded-circle px-2",children:(0,ee.jsx)(F.A,{color:"#344054",size:20})})}),(0,ee.jsx)("div",{className:"selectButStatus",children:x?(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):(0,ee.jsx)(Ze,{projectId:o,statusOptions:r,custom_status:null===g||void 0===g?void 0:g.custom_status})}),(0,ee.jsx)("button",{className:"CustonCloseModal",onClick:je,children:(0,ee.jsx)(k.A,{size:24,color:"#667085"})})]})]}),(0,ee.jsx)(J.A.Body,{className:"p-0",children:(0,ee.jsxs)("div",{className:"ContactModel",children:[(0,ee.jsxs)(Y.A,{className:"text-left mt-0 projectCardMain",children:[(0,ee.jsxs)(W.A,{sm:6,className:"orderDiscription",children:[(0,ee.jsx)("strong",{children:"Order Description"}),(0,ee.jsx)("div",{className:"customScrollBar",children:x?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})})]}):(0,ee.jsx)("ul",{children:null!==g&&void 0!==g&&null!==(t=g.calculator_descriptions)&&void 0!==t&&t.length?g.calculator_descriptions.map(((e,t)=>{let{description:s}=e;return(0,ee.jsxs)("li",{children:["- ",s]},t)})):(0,ee.jsx)("li",{children:"No Description available"})})}),(0,ee.jsxs)("div",{className:"currentJobsTable",children:[(0,ee.jsx)("h5",{children:"Current Jobs / Expense for this order"}),(0,ee.jsxs)(f.A,{responsive:!0,children:[(0,ee.jsx)("thead",{style:{position:"sticky",top:"0px",zIndex:9},children:(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("th",{children:"#"}),(0,ee.jsx)("th",{children:"Reference"}),(0,ee.jsx)("th",{children:"Supplier"}),(0,ee.jsx)("th",{children:"Estimate/Total"}),(0,ee.jsx)("th",{children:"Status"})]})}),(0,ee.jsx)("tbody",{children:x?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:"mb-0",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]})]}):null!==ie&&void 0!==ie&&ie.length?ie.map(((e,t)=>{var s,n,i,o;return(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{children:(null===e||void 0===e?void 0:e.number)||"-"}),(0,ee.jsx)("td",{children:(0,ee.jsx)("div",{className:"ellipsis-width",children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e?void 0:e.reference)||"-":(null===e||void 0===e?void 0:e.invoice_reference)||"-"})}),(0,ee.jsx)("td",{children:(0,ee.jsx)(w.A,{placement:"top",overlay:(0,ee.jsx)(A.A,{className:"TooltipOverlay",id:`tooltip-${top}`,children:(null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.name)||"Job"}),children:(0,ee.jsx)("div",{className:"mx-auto ps-2",title:null===e||void 0===e||null===(n=e.supplier)||void 0===n?void 0:n.name,style:{width:"fit-content"},children:"job"===(null===e||void 0===e?void 0:e.type)?(0,ee.jsx)(_.A,{size:24,color:"#101828"}):(0,ee.jsx)(_e.h,{has_photo:null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.has_photo,photo:null===e||void 0===e||null===(o=e.supplier)||void 0===o?void 0:o.photo,is_business:!0})})},"top")}),(0,ee.jsxs)("td",{children:["$",(0,mt.m)(null===e||void 0===e?void 0:e.total)||"-"]}),(0,ee.jsx)("td",{className:"status",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,ee.jsx)("span",{children:(null===e||void 0===e?void 0:e.status)||"-"}):(0,ee.jsx)("span",{className:null!==e&&void 0!==e&&e.paid?"paid":"unpaid",children:null!==e&&void 0!==e&&e.paid?"Paid":"Not Paid"})})]},e.number||`je-${t}`)})):(0,ee.jsx)("tr",{children:(0,ee.jsx)("td",{colSpan:5,className:"noDataAvilable text-center",children:" No history available"})})})]})]})]}),(0,ee.jsxs)(W.A,{sm:6,className:"projectHistoryCol",children:[(0,ee.jsxs)(Y.A,{children:[(0,ee.jsxs)(W.A,{className:"tabModelMenu d-flex justify-content-between align-items-center p-0",children:[(0,ee.jsx)(te,{projectId:o,projectCardData:ye}),(0,ee.jsx)($e,{project:a,reInitialize:c,projectCardData:()=>ye(o)}),(0,ee.jsx)(Xe,{projectId:o,projectCardData:()=>ye(o)}),(0,ee.jsx)(le,{clientId:null===g||void 0===g?void 0:g.client,projectId:o,projectCardData:()=>ye(o)})]}),(0,ee.jsx)(W.A,{className:"d-flex justify-content-center align-items-center filter",children:(0,ee.jsx)(Re,{setFilteredHistoryOptions:ue})})]}),(0,ee.jsx)(Y.A,{className:"projectHistoryWrap",children:(0,ee.jsxs)(W.A,{className:"p-0",children:[(0,ee.jsx)("h3",{children:"Project History"}),x?(0,ee.jsx)(ee.Fragment,{children:Array.from({length:10},((e,t)=>(0,ee.jsx)(b.A,{as:"p",animation:"wave",className:t%2===0?"mb-0 mt-1":"mb-3 mt-1",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:t%2===0?"200px":"90%",height:t%2===0?"15px":"10px"}})},`history-key-${t+1}`)))}):(0,ee.jsx)("div",{className:"projectHistoryScroll",children:null!==ae&&void 0!==ae&&ae.length?ae.map(((e,t)=>{let{id:s,type:n,text:i,title:l,created:a,manager:r,links:d}=e;return(0,ee.jsxs)("div",{className:"projectHistorygroup",children:[(0,ee.jsx)("ul",{children:(0,ee.jsx)("li",{children:"quote"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)("div",{className:"d-flex align-items-center",children:[(0,ee.jsx)(E.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Quote \xa0"}),"\xa0",(null===d||void 0===d?void 0:d.quote_pdf)&&(0,ee.jsx)(q.N_,{to:`${(null===d||void 0===d?void 0:d.quote_pdf)||"#"}`,target:"_blank",children:(0,ee.jsx)($.A,{color:"#FF0000",size:14})}),"\xa0\xa0",o&&"Quote Created"===l&&(0,ee.jsx)(q.N_,{to:`/quote/${o}`,target:"_blank",children:(0,ee.jsx)(T.A,{color:"#3366CC",size:16})})]})}):"task"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(B.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Task"})]})}):"order"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(B.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Order"})]})}):"note"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(D.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Note"})]})}):"tag"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(L.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Tag"})]})}):"invoice"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)("div",{className:"d-flex align-items-center",children:[(0,ee.jsx)(I.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Invoice\xa0"}),"\xa0",(null===d||void 0===d?void 0:d.invoice_pdf)&&(0,ee.jsx)(q.N_,{to:`${(null===d||void 0===d?void 0:d.invoice_pdf)||"#"}`,target:"_blank",children:(0,ee.jsx)($.A,{color:"#FF0000",size:14})}),"\xa0\xa0",o&&"Invoice Created"===l&&(0,ee.jsx)(q.N_,{to:`/invoice/${o}`,target:"_blank",children:(0,ee.jsx)(T.A,{color:"#3366CC",size:16})})]})}):"billing"===n?(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(R.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Billing"})]})}):"email"===n?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(P.A,{size:16,color:"#1AB2FF"})," ",(0,ee.jsx)("strong",{children:"\xa0 Email"})]}):""})}),(0,ee.jsx)("h5",{style:{whiteSpace:"pre-line"},children:"email"!==n&&l||""}),"email"===n?(0,ee.jsx)(Fe,{emailData:i}):(0,ee.jsx)("h6",{style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:i}}),(0,ee.jsxs)("p",{children:[we(a)," by ",r]})]},`history-${s||t}`)})):(0,ee.jsx)("p",{children:"No history available"})})]})})]})]}),(0,ee.jsx)(Y.A,{className:"projectCardButWrap",children:(0,ee.jsxs)(W.A,{children:[(0,ee.jsx)(Ue,{projectId:o,projectCardData:ye,isFetching:x,startDate:+(null===g||void 0===g?void 0:g.booking_start),endDate:+(null===g||void 0===g?void 0:g.booking_end)},o),(0,ee.jsx)(q.N_,{to:`/expenses?projectId=${null===a||void 0===a?void 0:a.value}`,children:(0,ee.jsxs)(l.A,{className:"expense expActive",children:["Create Expense ",(0,ee.jsx)("img",{src:pt.A,alt:"Expense"})]})}),(null===h||void 0===h?void 0:h.has_work_subscription)&&(0,ee.jsxs)(l.A,{className:"createJob jobActive",children:["Create a Job ",(0,ee.jsx)("img",{src:ht.A,alt:"briefcase"})]}),(0,ee.jsx)(re,{clientId:null===g||void 0===g?void 0:g.client,projectId:o}),(0,ee.jsx)(ct,{projectId:o,project:g,projectCardData:ye})]})}),(0,ee.jsxs)(Y.A,{className:"projectCardCalculation",children:[(0,ee.jsxs)(W.A,{className:"proCostSale projectColBg",children:[(0,ee.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,ee.jsx)("h5",{children:"Cost Of Sale"}),(0,ee.jsxs)("p",{children:["$",(0,mt.m)(null===g||void 0===g?void 0:g.cost_of_sale)]})]}),(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,ee.jsx)(M.A,{size:20,color:"#344054"})})]}),(0,ee.jsxs)(W.A,{className:"proLabour projectColBg",children:[(0,ee.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,ee.jsx)("h5",{children:"Labour"}),(0,ee.jsxs)("p",{children:["$",(0,mt.m)(null===g||void 0===g?void 0:g.labor_expenses)]})]}),(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,ee.jsx)(M.A,{size:20,color:"#344054"})})]}),(0,ee.jsxs)(W.A,{className:"proOperatingExpense projectColBg",children:[(0,ee.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,ee.jsx)("h5",{children:"Operating Expense"}),(0,ee.jsxs)("p",{children:["$",(0,mt.m)(null===g||void 0===g?void 0:g.operating_expense)]})]}),(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,ee.jsx)("path",{d:"M4.16675 8H15.8334M4.16675 13H15.8334",stroke:"#344054",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,ee.jsxs)(W.A,{className:"proRealCost projectColBg",children:[(0,ee.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,ee.jsx)("h5",{children:"Real Cost"}),(0,ee.jsxs)("p",{children:["$",(0,mt.m)(ge)]})]}),(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,ee.jsx)("span",{className:"font-14",children:"VS"})})]}),(0,ee.jsx)(W.A,{className:"proBuget projectColBg",children:(0,ee.jsxs)("div",{children:[(0,ee.jsx)("h5",{children:"Budget"}),(0,ee.jsxs)("p",{children:["$",(0,mt.m)(null===g||void 0===g?void 0:g.budget)]})]})})]}),(0,ee.jsxs)(Y.A,{className:"projectCardactionBut",children:[(0,ee.jsxs)(W.A,{className:"actionLeftSide",children:[(0,ee.jsxs)(l.A,{onClick:()=>{Ce.mutate(o)},disabled:!(null!==g&&void 0!==g&&g.can_be_declined)||Ce.isPending,className:"declineAction",children:[(0,ee.jsx)(z.A,{size:20,color:"#912018"})," Decline Order",Ce.isPending&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]}),(0,ee.jsxs)(l.A,{disabled:p,className:"duplicateAction",onClick:async()=>{try{if(!o)return Q.oR.error("Project id not found");m(!0),await(0,ut.CK)(o),u("/sales"),Q.oR.success("Sale has been successfully duplicated")}catch(e){console.error("Error is duplicating:",e),Q.oR.error("Failed to duplicate sale. Please try again.")}finally{m(!1)}},children:[(0,ee.jsx)(H.A,{size:20,color:"#0A4766",className:"me-1"}),(0,ee.jsx)("span",{style:{position:"relative",top:"2px"},children:"Duplicate"})," ",p&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"6px"}})]}),(0,ee.jsxs)(l.A,{disabled:!(null!==g&&void 0!==g&&g.can_be_return),onClick:()=>{!(null!==g&&void 0!==g&&g.can_be_return)||Ae.mutate(o)},className:"sendBackAction",children:[(0,ee.jsx)(U.A,{size:20,color:"#344054",opacity:null!==g&&void 0!==g&&g.can_be_return?1:.5}),"Send Back to Sales",Ae.isPending&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]}),(0,ee.jsxs)(W.A,{className:"actionRightSide",children:[(0,ee.jsx)(be,{clientId:null===g||void 0===g?void 0:g.client,isCreated:null===g||void 0===g?void 0:g.invoice_created,projectId:o,isLoading:null===Se||void 0===Se?void 0:Se.isPending,create:()=>{Se.mutate(o)},projectCardData:()=>ye(o)}),(0,ee.jsxs)(l.A,{onClick:()=>Ne.mutate(o),disabled:!(null!==g&&void 0!==g&&g.can_be_completed),className:"CompleteActionBut",children:["Complete & Archive",(null===Ne||void 0===Ne?void 0:Ne.isPending)&&(0,ee.jsx)(K.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]})]}),(0,ee.jsx)(Y.A,{className:"projectBreakdown px-0",children:(0,ee.jsxs)(W.A,{className:"px-0",children:[(0,ee.jsxs)(l.A,{onClick:()=>pe(!he),children:[he?"Hide":"Show"," Cost breakdown"]}),he&&(0,ee.jsxs)(Z.b,{value:(null===g||void 0===g?void 0:g.calculations)||[],showGridlines:!0,className:"border-top",children:[(0,ee.jsx)(G.V,{field:"id",header:"Order",bodyClassName:"text-center",headerClassName:"text-center",style:{width:"60px"},body:(e,t)=>t.rowIndex+1}),(0,ee.jsx)(G.V,{field:"subindex",header:"Department",style:{minWidth:"192px"},body:e=>(0,ee.jsx)("div",{className:"ellipsis-width",title:e.subindex,style:{maxWidth:"192px"},children:e.subindex})}),(0,ee.jsx)(G.V,{field:"description",header:"Description",body:e=>(0,ee.jsx)("div",{className:"ellipsis-width",title:e.description,style:{maxWidth:"350px"},children:e.description}),style:{width:"100%"}}),(0,ee.jsx)(G.V,{field:"cost",header:"Cost",style:{width:"100%"},body:e=>`$ ${e.cost}`}),(0,ee.jsx)(G.V,{field:"profit_type_value",header:"Markup/Margin",body:e=>`${e.profit_type_value} ${"AMN"===e.profit_type?"AMT $":"MRG"===e.profit_type?"MRG %":"MRK %"}`,style:{width:"100%"}}),(0,ee.jsx)(G.V,{field:"unit_price",header:"Unit Price",style:{width:"100%"},body:e=>`$ ${e.unit_price}`}),(0,ee.jsx)(G.V,{field:"quantity",header:"Qty/Unit",style:{width:"100%"}}),(0,ee.jsx)(G.V,{field:"discount",header:"Discount",style:{width:"100%"},body:e=>`${e.discount}%`}),(0,ee.jsx)(G.V,{field:"total",header:"Amount",style:{width:"100%"},body:e=>`$ ${e.total}`})]})]})})]})})]})})};var vt=s(33183),gt=s(12532);const jt=e=>{if(!e)return"-";return new Date(1e3*+e)},yt=e=>{var t,s,i,o,a,r,d,u,h,p;let{show:m,setShow:x,data:v,reInitialize:g}=e;const j=(0,n.useRef)(null),y=null===v||void 0===v?void 0:v.id,b={value:null===v||void 0===v||null===(t=v.project)||void 0===t?void 0:t.id,reference:null===v||void 0===v||null===(s=v.project)||void 0===s?void 0:s.reference,number:null===v||void 0===v||null===(i=v.project)||void 0===i?void 0:i.number},[f,w]=(0,n.useState)(v.title||""),[A,C]=(0,n.useState)(v.description||""),[N,S]=(0,n.useState)((null===v||void 0===v||null===(o=v.user)||void 0===o?void 0:o.id)||null),[F,k]=(0,n.useState)({startDate:jt(v.from_date),endDate:jt(v.to_date)}),[_,E]=(0,n.useState)({taskTitle:!1,description:!1,user:!1,date:!1}),$=(0,V.n)({mutationFn:e=>(0,Fe.wW)(e,y),onSuccess:()=>{x(!1),g()},onError:e=>{console.error("Error creating task:",e)}}),T=(0,V.n)({mutationFn:()=>(0,Fe.mM)(y),onSuccess:()=>{console.log("Delete success"),x(!1),g()},onError:e=>{console.error("Error creating task:",e)}}),B=()=>{const e={taskTitle:!f,description:!A,date:!F};E(e),e.taskTitle||e.description||e.user||e.date||(console.log("Form submitted with:",{taskTitle:f,description:A,project:b,user:N,date:F}),$.mutate({title:f,description:A,project:b.value,from_date:F.startDate,to_date:F.endDate,...N&&{user:N}}))},D=(0,se.I)({queryKey:["getUserList"],queryFn:c.aU});return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsx)(Ne.A,{onSubmit:B,children:(0,ee.jsxs)(J.A,{show:m,centered:!0,onHide:()=>x(!1),className:"task-form",children:[(0,ee.jsx)(J.A.Header,{closeButton:!0,children:(0,ee.jsxs)(J.A.Title,{children:[(0,ee.jsx)("img",{src:gt.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,ee.jsx)("span",{className:"modal-task-title",children:"Edit Task"})]})}),(0,ee.jsxs)(J.A.Body,{children:[(0,ee.jsxs)(Ne.A.Group,{className:"mb-2",children:[(0,ee.jsx)(Ne.A.Label,{children:"Project Task"}),(0,ee.jsxs)(fe.A,{children:[(0,ee.jsx)(Ne.A.Select,{disabled:!0,children:(0,ee.jsxs)("option",{value:null===b||void 0===b?void 0:b.value,children:[null===b||void 0===b?void 0:b.reference," (",null===b||void 0===b?void 0:b.number,")"]})}),(0,ee.jsx)(fe.A.Text,{children:(0,ee.jsx)(Ae.A,{})})]}),!b&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Project task is required"})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",children:[(0,ee.jsx)(Ne.A.Label,{children:"Task Title"}),(0,ee.jsxs)(fe.A,{children:[(0,ee.jsx)(Ne.A.Control,{required:!0,type:"text",placeholder:"Enter task title",value:f,onChange:e=>w(e.target.value)}),(0,ee.jsx)(fe.A.Text,{children:(0,ee.jsx)(we.A,{})})]}),_.taskTitle&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Task title is required"})]}),(0,ee.jsxs)(Ne.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,ee.jsx)(Ne.A.Label,{children:"Description"}),(0,ee.jsx)(Ne.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:A,onChange:e=>C(e.target.value),required:!0}),_.description&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Description is required"})]})]}),(0,ee.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"20px",borderTop:"1px solid #eaecf0",padding:"12px 30px 8px 20px"},children:[!N&&(0,ee.jsx)(Ce.A,{color:null!==(a=j.current)&&void 0!==a&&null!==(r=a.panel)&&void 0!==r&&null!==(d=r.element)&&void 0!==d&&d.offsetParent?"#1AB2FF":"#475467",size:22,style:{position:"relative",left:"10px",zIndex:1},onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.show()},className:"me-3 cursor-pointer"}),(0,ee.jsx)(ue.m,{ref:j,options:(null===D||void 0===D||null===(u=D.data)||void 0===u||null===(h=u.users)||void 0===h||null===(p=h.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===p?void 0:p.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[],onChange:e=>{S(e.value)},valueTemplate:e=>(0,ee.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ee.jsx)(_e.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),itemTemplate:e=>(0,ee.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ee.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ee.jsx)(_e.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:N?"fit-content":"0px",height:N?"46px":"0px",zIndex:N?"1":"0",position:"relative",left:N?"0px":"-60px",top:N?"0px":"-15px"},value:N,dropdownIcon:(0,ee.jsx)(ee.Fragment,{}),placeholder:"Select project",filter:!0}),(0,ee.jsx)(Se.A,{dateRange:F,setDateRange:k})]}),(0,ee.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"16px",padding:"0 30px 8px 30px"},children:[_.user&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"User is required"}),_.date&&(0,ee.jsx)(Ne.A.Text,{className:"text-danger",children:"Date is required"})]}),(0,ee.jsxs)(J.A.Footer,{className:"d-flex justify-content-between",children:[(0,ee.jsx)(l.A,{type:"button",className:"delete-button",onClick:()=>{T.mutate()},children:T.isPending?"Loading...":"Delete Task"}),(0,ee.jsx)(l.A,{type:"button",className:"save-button",onClick:B,children:$.isPending?"Loading...":"Save Task"})]})]})})})};var bt=s(42265),ft=s(42052);const wt=()=>(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",size:"lg"})}),(0,ee.jsx)(b.A,{as:"p",animation:"wave",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",style:{height:"80px"},size:"lg"})}),(0,ee.jsx)("table",{className:"task-deatils-table w-100",children:(0,ee.jsxs)("tbody",{children:[(0,ee.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})})]}),(0,ee.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})})]}),(0,ee.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})})]}),(0,ee.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:(0,ee.jsx)(b.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary"})})})]})]})})]}),At=e=>{var t,s;let{view:i,setView:o,taskId:a,setTaskId:r,reInitialize:d}=e;const[c,u]=(0,n.useState)(!1),{isFetching:h,data:p}=(0,se.I)({queryKey:["taskId",a],queryFn:()=>(0,Fe.dd)(a),enabled:!!a,retry:1}),m=(0,V.n)({mutationFn:e=>(0,Fe._x)(a,e),onSuccess:()=>{x(),r(null),d()},onError:e=>{console.error("Error updating task:",e)}}),x=()=>o(!1),v=e=>{var t;if(!e)return"-";return null===(t=new Date(1e3*+e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))||void 0===t?void 0:t.replace(/,/g,"")};return(0,n.useEffect)((()=>{c||r(null)}),[c]),(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(J.A,{show:i,centered:!0,onHide:x,children:[(0,ee.jsx)(J.A.Header,{closeButton:!0,children:(0,ee.jsxs)(J.A.Title,{children:[(0,ee.jsx)("img",{src:ft.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,ee.jsx)("span",{className:"modal-task-title",children:"Task Details"})]})}),(0,ee.jsx)(J.A.Body,{children:h?(0,ee.jsx)(wt,{}):(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)("p",{className:"task-title",children:(null===p||void 0===p?void 0:p.title)||"-"}),(0,ee.jsx)("p",{className:"task-description",children:(null===p||void 0===p?void 0:p.description)||"-"}),(0,ee.jsx)("table",{className:"task-deatils-table",children:(0,ee.jsxs)("tbody",{children:[(0,ee.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Project Task"}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:null!==p&&void 0!==p&&p.project&&p.project.reference?p.project.reference:"-"})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"ID"}),(0,ee.jsx)("td",{style:{paddingBottom:"12px"},children:(null===p||void 0===p?void 0:p.number)||"-"})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Assigned"}),(0,ee.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,ee.jsx)("img",{src:null!==p&&void 0!==p&&null!==(t=p.user)&&void 0!==t&&t.has_photo?null===p||void 0===p?void 0:p.user.photo:bt.A,alt:"img-assigned",style:{width:"24px",height:"24px",borderRadius:"50%"}}),(0,ee.jsx)("span",{children:(null===p||void 0===p||null===(s=p.user)||void 0===s?void 0:s.full_name)||"-"})]})]}),(0,ee.jsxs)("tr",{children:[(0,ee.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Date"}),(0,ee.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,ee.jsx)("span",{children:v(null===p||void 0===p?void 0:p.from_date)}),(0,ee.jsx)(vt.A,{size:20,color:"#475467"}),(0,ee.jsx)("span",{children:v(null===p||void 0===p?void 0:p.to_date)})]})]})]})})]})}),(0,ee.jsx)(J.A.Footer,{children:h?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(b.A,{as:"p",animation:"wave",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",style:{height:"46px",width:"115px",borderRadius:"4px"},size:"lg"})}),(0,ee.jsx)(b.A,{as:"p",animation:"wave",children:(0,ee.jsx)(b.A,{xs:12,bg:"secondary",style:{height:"46px",width:"125px",borderRadius:"4px"},size:"lg"})})]}):(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(l.A,{className:"edit-button",onClick:function(){u(!0),x()},children:"Edit Task"}),null!==p&&void 0!==p&&p.finished?(0,ee.jsx)(l.A,{className:"incomplete-button",onClick:()=>m.mutate(!1),children:m.isPending?(0,ee.jsx)(ee.Fragment,{children:"Loading..."}):(0,ee.jsxs)(ee.Fragment,{children:["Incomplete",(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,ee.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#F04438"})})]})}):(0,ee.jsx)(l.A,{className:"complete-button",onClick:()=>m.mutate(!0),children:m.isPending?(0,ee.jsx)(ee.Fragment,{children:"Loading..."}):(0,ee.jsxs)(ee.Fragment,{children:["Complete",(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,ee.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#17B26A"})})]})})]})})]}),p&&(0,ee.jsx)(yt,{show:c,setShow:u,data:p,reInitialize:d},c)]})},Ct="calender";const Nt=function(){const e=(0,n.useRef)(null),{trialHeight:t}=(0,y.$)(),[s,i]=(0,n.useState)(""),[c,u]=(0,n.useState)([]),[h,p]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),[w,A]=(0,n.useState)(!1),[C,N]=(0,n.useState)([]),[S,F]=(0,n.useState)(null),[k,_]=(0,n.useState)(null),[E,$]=(0,n.useState)({}),[T,B]=(0,n.useState)(""),[D,L]=(0,n.useState)(""),I=window.location.href,R=new URL(I),P=new URLSearchParams(R.search),M=P.get("unique_id");if(M&&!k){_(M);const e=P.get("reference"),t=P.get("number");$({number:t||"",reference:e,value:M}),f(!0)}function z(e){let t=arguments.length>2?arguments[2]:void 0;arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(_(e),$(t),f(!0)):(F(e),x(!0))}(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,j.ic)();N([...e])}catch(e){console.error("Error fetching project status data:",e)}})()}),[]),(0,n.useEffect)((()=>{const e=e=>{if(!(e.target instanceof HTMLSelectElement))if(e.target.closest(".create-task-button")){const t=e.target.getAttribute("number"),s=e.target.getAttribute("reference"),n=e.target.getAttribute("project-id");$({number:t,reference:s,value:n}),p(!0)}else if(e.target.closest(".task-list")){const t=e.target.closest(".task-list").getAttribute("task-id");console.log("task-list: ....",t),t&&z(t)}else if(e.target.closest(".project-content")){const t=e.target.closest(".project-content").getAttribute("unique-id"),s=e.target.closest(".project-content").getAttribute("number"),n=e.target.closest(".project-content").getAttribute("reference"),i=e.target.closest(".project-content").getAttribute("project-id");console.log("uniqueId: ....",t),_(t),$({number:s,reference:n,value:i}),f(!0)}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]),(0,n.useEffect)((()=>{const e=document.createElement("script");e.src="/daypilot-all.min.js",e.id="daypilot-script-ele";const t=()=>{console.error("Failed to load DayPilot script.")},s=async()=>{try{const e=await(0,d.Mv)();u(e),g(Ct,e,z)}catch(e){console.error("Error initializing DayPilot:",e)}};return e.addEventListener("error",t),e.addEventListener("load",s),document.body.appendChild(e),()=>{e.removeEventListener("error",t),e.removeEventListener("load",s),document.body.contains(e)&&document.body.removeChild(e)}}),[]);const H=async()=>{try{A(!0);const e=await(0,d.Mv)();u(e),s?O(s,e):v(e),A(!1)}catch(e){console.error("Error initializing DayPilot:",e)}},U=()=>{console.log("handleViewTask: ")};(0,n.useEffect)((()=>{const e=document.querySelector(".task-list");if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.addEventListener("click",U())}return()=>{if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.removeEventListener("click",U)}}}),[]);const O=(t,s)=>{const n=s||c;e.current&&clearTimeout(e.current),e.current=setTimeout((()=>{v(n.filter((e=>{var s,n,i,o,l,a;return!!(null!==e&&void 0!==e&&null!==(s=e.number)&&void 0!==s&&null!==(n=s.toLowerCase())&&void 0!==n&&n.includes((null===t||void 0===t?void 0:t.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(i=e.reference)&&void 0!==i&&null!==(o=i.toLowerCase())&&void 0!==o&&o.includes((null===t||void 0===t?void 0:t.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(l=e.client)&&void 0!==l&&null!==(a=l.name.toLowerCase())&&void 0!==a&&a.includes((null===t||void 0===t?void 0:t.toLowerCase())||""))}))||[])}),600)},q=(0,n.useCallback)((()=>{let e=[...c];"Not Invoiced"===T?e=e.filter((e=>!e.is_invoice_created)):"Not Booked"===T?e=e.filter((e=>!e.booking_start)):"Not Paid"===T&&(e=e.filter((e=>"PAID"!==e.paid))),"Date Due"===D?e.sort(((e,t)=>new Date(1e3*e.booking_end)-new Date(1e3*t.booking_end))):"Date Accepted"===D?e.sort(((e,t)=>new Date(1e3*e.booking_start)-new Date(1e3*t.booking_start))):"Job Number"===D?e.sort(((e,t)=>e.number.localeCompare(t.number))):"Order Status"===D&&e.sort(((e,t)=>(e.custom_status||"").localeCompare(t.custom_status||""))),s&&(e=e.filter((e=>{var t,n,i,o,l,a;return!!(null!==e&&void 0!==e&&null!==(t=e.number)&&void 0!==t&&null!==(n=t.toLowerCase())&&void 0!==n&&n.includes((null===s||void 0===s?void 0:s.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(i=e.reference)&&void 0!==i&&null!==(o=i.toLowerCase())&&void 0!==o&&o.includes((null===s||void 0===s?void 0:s.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(l=e.client)&&void 0!==l&&null!==(a=l.name.toLowerCase())&&void 0!==a&&a.includes((null===s||void 0===s?void 0:s.toLowerCase())||""))}))),v(e)}),[c,T,D,s]);(0,n.useEffect)((()=>{q()}),[T,D,s,q]);const V=e=>{B(e)},G=e=>{L(e)};return(0,ee.jsxs)(n.Fragment,{children:[(0,ee.jsxs)("div",{className:"topbar bottom-border",style:{padding:"0px 20px",position:"relative"},children:[(0,ee.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,ee.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,ee.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,ee.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,ee.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>{const t=e.target.value;i(t)},className:"border search-resource",style:{borderRadius:"4px",border:"1px solid #D0D5DD",width:"184px",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,ee.jsx)("div",{className:"featureName",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,ee.jsx)("h1",{className:"title mx-0",children:"Management"})}),(0,ee.jsxs)("div",{className:"d-flex gap-2 justify-content-end align-items-center",children:[(0,ee.jsxs)(o.A,{children:[(0,ee.jsx)(o.A.Toggle,{as:l.A,className:(0,r.A)("outline-button mx-auto"),style:{padding:"6px 16px"},children:(0,ee.jsx)("span",{className:"font-14",children:D||"Sort By"})}),(0,ee.jsxs)(o.A.Menu,{children:[(0,ee.jsx)(o.A.Item,{eventKey:"Date Due",active:"Date Due"===D,onClick:()=>G("Date Due"),children:"Date Due"},"Date Due"),(0,ee.jsx)(o.A.Item,{eventKey:"Date Accepted",active:"Date Accepted"===D,onClick:()=>G("Date Accepted"),children:"Date Accepted"},"Date Accepted"),(0,ee.jsx)(o.A.Item,{eventKey:"Job Number",active:"Job Number"===D,onClick:()=>G("Job Number"),children:"Job Number"},"Job Number"),(0,ee.jsx)(o.A.Item,{eventKey:"Order Status",active:"Order Status"===D,onClick:()=>G("Order Status"),children:"Order Status"},"Order Status")]})]}),(0,ee.jsxs)(o.A,{children:[(0,ee.jsx)(o.A.Toggle,{as:l.A,className:(0,r.A)("outline-button mx-auto"),style:{padding:"6px 16px"},children:(0,ee.jsx)("span",{className:"font-14",children:T||"Filter By"})}),(0,ee.jsxs)(o.A.Menu,{children:[(0,ee.jsx)(o.A.Item,{eventKey:"Not Invoiced",active:"Not Invoiced"===T,onClick:()=>V("Not Invoiced"),children:"Not Invoiced"},"Not Invoiced"),(0,ee.jsx)(o.A.Item,{eventKey:"Not Booked",active:"Not Booked"===T,onClick:()=>V("Not Booked"),children:"Not Booked"},"Not Booked"),(0,ee.jsx)(o.A.Item,{eventKey:"Not Paid",active:"Not Paid"===T,onClick:()=>V("Not Paid"),children:"Not Paid"},"Not Paid")]})]})]})]}),(0,ee.jsx)("div",{className:t&&"trial-height-added",children:(0,ee.jsx)("div",{id:Ct,children:(0,ee.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,ee.jsx)(a.A,{animation:"border",role:"status",children:(0,ee.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})})}),(0,ee.jsx)(At,{view:m,setView:x,taskId:S,setTaskId:F,reInitialize:H}),(0,ee.jsx)(Ee,{show:h,setShow:p,project:E,reInitialize:H}),(0,ee.jsx)(xt,{viewShow:b,setViewShow:f,projectId:k,project:E,statusOptions:C,reInitialize:H},k),w&&(0,ee.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,ee.jsx)(a.A,{animation:"border",role:"status",children:(0,ee.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})},St=()=>(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(i.mg,{children:(0,ee.jsx)("title",{children:"MeMate - Management"})}),(0,ee.jsx)(Nt,{})]})},11520:(e,t,s)=>{s.d(t,{Mv:()=>g,Np:()=>l,OE:()=>j,SE:()=>h,ZE:()=>c,aj:()=>a,fi:()=>p,jE:()=>d,jy:()=>m,ky:()=>v,mw:()=>o,o2:()=>r,qm:()=>x,yE:()=>u});const n="https://dev.memate.com.au/api/v1",i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:n={},body:i}=t,o={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...n},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,o);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const n=s.headers.get("Content-Type");if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(l){throw console.error("Fetch API error:",l),l}},o=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/schedule/${e}/`}`);return i(o.toString(),s)},l=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/custom-status/${e}/`}`);return i(o.toString(),s)},a=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/reference/${e}/`}`);return i(o.toString(),s)},r=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/project-card/note/${e}/`}`);return i(o.toString(),s)},d=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/back/`);return i(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/decline/`);return i(s.toString(),t)},u=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/complete/`);return i(s.toString(),t)},h=async e=>{const t=new URL(`${n}${`/invoices/create/${e}/`}`);return i(t.toString(),{method:"POST"})},p=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/invoices/send/${e}/`}`);return i(o.toString(),s)},m=async(e,t,s)=>{let o;o=t?`/custom/email/${e}/${t}/`:`/custom/email/${e}/`;const l={method:"POST",body:s},a=new URL(`${n}${o}`);return i(a.toString(),l)},x=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/sms/${e}/`}`);return i(o.toString(),s)},v=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/resend/quote/${e}/`}`);return i(o.toString(),s)},g=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`),e.append("Content-Type","application/json");const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/management/`,s);return await e.json()}catch(i){throw console.error(i),i}},j=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"GET",headers:t,redirect:"follow"};try{const t=await fetch(`${n}/project-card/${e}/`,i);return await t.json()}catch(o){throw console.error(o),o}}},36166:(e,t,s)=>{s.d(t,{DX:()=>o,H2:()=>a,LG:()=>d,Y4:()=>l,e0:()=>c,r$:()=>r,rf:()=>u});var n=s(31342);const i="https://dev.memate.com.au/api/v1",o=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4?arguments[4]:void 0;const a=(e-1)*t,r=new URL(`${i}/invoices/`);return r.searchParams.append("limit",t),r.searchParams.append("offset",a),s&&r.searchParams.append("search",s),o&&r.searchParams.append("ordering",o),l&&r.searchParams.append("status","not_paid"),(0,n.f)(r.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${i}${`/invoices/view/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"},!1)},a=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/invoices/payment-intent/${e}/`}`);return(0,n.f)(o.toString(),s,!1)},r=async e=>{const t=new URL(`${i}${`/invoices/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},d=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/resend/invoice/${e}/`}`);return(0,n.f)(o.toString(),s)},c=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/invoices/partial-payment/${e}/`}`);return(0,n.f)(o.toString(),s)},u=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/invoices/to-xero/`);return(0,n.f)(s.toString(),t)}},81047:(e,t,s)=>{s.d(t,{AO:()=>m,Ad:()=>w,Bz:()=>E,Hb:()=>u,IT:()=>_,Kb:()=>a,Mp:()=>f,Pf:()=>N,Rh:()=>A,SQ:()=>c,T6:()=>v,UM:()=>y,VQ:()=>k,Xm:()=>d,bd:()=>F,bj:()=>x,gY:()=>g,hS:()=>p,hx:()=>S,iS:()=>l,p4:()=>r,pJ:()=>b,rJ:()=>C,s:()=>h,sB:()=>j,tC:()=>o});var n=s(31342);const i="https://dev.memate.com.au/api/v1",o=async()=>{const e=new URL(`${i}/jobs/templates/`);return(0,n.f)(e.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${i}${`/jobs/templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},a=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/jobs/templates/`);return(0,n.f)(s.toString(),t)},r=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${i}${`/jobs/templates/${e}/`}`);return(0,n.f)(o.toString(),s)},d=async e=>{const t=new URL(`${i}${`/jobs/templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},c=async()=>{const e=new URL(`${i}/settings/templates/email-templates/`);return(0,n.f)(e.toString(),{method:"GET"})},u=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/settings/templates/email-templates/`);return(0,n.f)(s.toString(),t)},h=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${i}${`/settings/templates/email-templates/${e}/`}`);return(0,n.f)(o.toString(),s)},p=async e=>{const t=new URL(`${i}${`/settings/templates/email-templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},m=async()=>{const e=new URL(`${i}/email-signatures/`);return(0,n.f)(e.toString(),{method:"GET"})},x=async e=>{const t=new URL(`${i}${`/email-signatures/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},v=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/email-signatures/`);return(0,n.f)(s.toString(),t)},g=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${i}${`/email-signatures/${e}/`}`);return(0,n.f)(o.toString(),s)},j=async e=>{const t=new URL(`${i}${`/email-signatures/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},y=async e=>{const t=new URL(`${i}${`/settings/email-signatures/default/${e}/`}`);return(0,n.f)(t.toString(),{method:"PUT"})},b=async()=>{const e=new URL(`${i}/sms-templates/`);return(0,n.f)(e.toString(),{method:"GET"})},f=async e=>{const t=new URL(`${i}${`/sms-templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},w=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/sms-templates/`);return(0,n.f)(s.toString(),t)},A=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${i}${`/sms-templates/${e}/`}`);return(0,n.f)(o.toString(),s)},C=async e=>{const t=new URL(`${i}${`/sms-templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},N=async e=>{const t=new URL(`${i}${`/proposals/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},S=async()=>{const e=new URL(`${i}/references/outgoing-email/`);return(0,n.f)(e.toString(),{method:"GET"})},F=async e=>{const t=new URL(`${i}${`/settings/templates/email-templates/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},k=async()=>{const e=new URL(`${i}/settings/proposals/`);return(0,n.f)(e.toString(),{method:"GET"})},_=async e=>{const t=new URL(`${i}${`/settings/proposals/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},E=async e=>{const t=new URL(`${i}${`/settings/proposals/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})}}}]);
//# sourceMappingURL=6089.cbf4fd36.chunk.js.map