"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[6042],{10586:(e,t,s)=>{s.d(t,{$R:()=>r,Bu:()=>a,D3:()=>p,E4:()=>m,JP:()=>l,Rv:()=>d,Wz:()=>u,a_:()=>h,eY:()=>c,ik:()=>x,md:()=>i,oP:()=>g});var n=s(31342);const o="https://dev.memate.com.au/api/v1",i=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4?arguments[4]:void 0;const a=(e-1)*t,r=new URL(`${o}/expenses/`);return r.searchParams.append("limit",t),r.searchParams.append("offset",a),s&&r.searchParams.append("search",s),i&&r.searchParams.append("ordering",i),l&&r.searchParams.append("status","not_paid"),(0,n.f)(r.toString(),{method:"GET"})},l=async()=>{const e=new URL(`${o}/references/xero-codes/`);return(0,n.f)(e.toString(),{method:"GET"})},a=async()=>{const e=new URL(`${o}/references/projects/`);return(0,n.f)(e.toString(),{method:"GET"})},r=async e=>{const t=new URL(`${o}${`/expenses/update/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},d=async e=>{const t={method:"POST",body:e},s=new URL(`${o}/expenses/new/`);return(0,n.f)(s.toString(),t)},c=async(e,t)=>{const s={method:"PUT",body:t},i=new URL(`${o}${`/expenses/update/${e}/`}`);return(0,n.f)(i.toString(),s)},p=async e=>{const t={method:"POST",body:e},s=new URL(`${o}/expenses/paid/`);return(0,n.f)(s.toString(),t)},x=async e=>{const t={method:"POST",body:e},s=new URL(`${o}/expenses/unpaid/`);return(0,n.f)(s.toString(),t)},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${o}/expenses/to-xero/`);return(0,n.f)(s.toString(),t)},u=async e=>{const t=new URL(`${o}${`/expenses/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},m=async e=>{const t={method:"POST",body:e},s=new URL(`${o}/clients/statement/pdf/`);return(0,n.f)(s.toString(),t)},g=async e=>{const t={method:"POST",body:e},s=new URL(`${o}/clients/statement/`);return(0,n.f)(s.toString(),t)}},31342:(e,t,s)=>{s.d(t,{f:()=>n});const n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{method:n="GET",headers:o={},body:i}=t,l=localStorage.getItem("access_token"),a=i instanceof FormData,r={"Content-Type":a?"multipart/form-data":"application/json",...o};s&&(r.Authorization=`Bearer ${l}`);const d={method:n,headers:r,body:a?i:JSON.stringify(i),redirect:"follow"};try{const t=new URL(e),s=await fetch(t,d),n=s.headers.get("Content-Type");if(!s.ok){var c;let e=null;e=n&&n.includes("application/json")?await s.json():await s.text(),401===s.status&&(localStorage.clear(),sessionStorage.clear(),window.location.replace("/login"));const t=new Error((null===(c=e)||void 0===c?void 0:c.message)||`HTTP error! Status: ${s.status}`);throw t.status=s.status,t.data=e,t}if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(p){throw console.error("Fetch API error:",p),p}}},36042:(e,t,s)=>{s.d(t,{A:()=>v});var n=s(65043),o=s(33183),i=s(93747),l=s(47097),a=s(14282),r=s(32952),d=s(65975),c=s(79106),p=s(72796),x=s(42265),h=s(42052),u=s(49726),m=s(70579);const g=()=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary",size:"lg"})}),(0,m.jsx)(d.A,{as:"p",animation:"wave",children:(0,m.jsx)(d.A,{xs:12,bg:"secondary",style:{height:"80px"},size:"lg"})}),(0,m.jsx)("table",{className:"task-deatils-table w-100",children:(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})})]}),(0,m.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})})]}),(0,m.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})})]}),(0,m.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:(0,m.jsx)(d.A,{as:"p",animation:"wave",style:{marginBottom:"4px"},children:(0,m.jsx)(d.A,{xs:12,bg:"secondary"})})})]})]})})]}),v=e=>{var t,s;let{view:v,setView:j,taskId:y,setTaskId:f,reInitialize:w}=e;const[A,b]=(0,n.useState)(!1),{isFetching:k,data:T,refetch:C}=(0,i.I)({queryKey:["taskId",y],queryFn:()=>(0,c.gg)(y),enabled:!!y,retry:1,cacheTime:0}),B=(0,l.n)({mutationFn:e=>(0,p._x)(y,e),onSuccess:()=>{S(),f(null),w(),C()},onError:e=>{console.error("Error updating task:",e)}}),S=()=>j(!1),N=e=>{var t;if(!e)return"-";return null===(t=new Date(1e3*+e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))||void 0===t?void 0:t.replace(/,/g,"")};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.A,{show:v,centered:!0,onHide:S,children:[(0,m.jsx)(r.A.Header,{closeButton:!0,children:(0,m.jsxs)(r.A.Title,{children:[(0,m.jsx)("img",{src:h.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,m.jsx)("span",{className:"modal-task-title",children:"Task Details"})]})}),(0,m.jsx)(r.A.Body,{children:k?(0,m.jsx)(g,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("p",{className:"task-title",children:(null===T||void 0===T?void 0:T.title)||"-"}),(0,m.jsx)("p",{className:"task-description",children:(null===T||void 0===T?void 0:T.description)||"-"}),(0,m.jsx)("table",{className:"task-deatils-table",children:(0,m.jsxs)("tbody",{children:[(0,m.jsxs)("tr",{style:{marginBottom:"12px"},children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Project Task"}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:null!==T&&void 0!==T&&T.project&&T.project.reference?T.project.reference:"-"})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"ID"}),(0,m.jsx)("td",{style:{paddingBottom:"12px"},children:(null===T||void 0===T?void 0:T.number)||"-"})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Assigned"}),(0,m.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[(0,m.jsx)("img",{src:null!==T&&void 0!==T&&null!==(t=T.user)&&void 0!==t&&t.has_photo?null===T||void 0===T?void 0:T.user.photo:x.A,alt:"img-assigned",style:{width:"24px",height:"24px",borderRadius:"50%"}}),(0,m.jsx)("span",{children:(null===T||void 0===T||null===(s=T.user)||void 0===s?void 0:s.full_name)||"-"})]})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{style:{width:"122px",paddingBottom:"12px"},children:"Date"}),(0,m.jsxs)("td",{style:{paddingBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,m.jsx)("span",{children:N(null===T||void 0===T?void 0:T.from_date)}),(0,m.jsx)(o.A,{size:20,color:"#475467"}),(0,m.jsx)("span",{children:N(null===T||void 0===T?void 0:T.to_date)})]})]})]})})]})}),k?(0,m.jsxs)(r.A.Footer,{children:[(0,m.jsx)(d.A,{as:"p",animation:"wave",children:(0,m.jsx)(d.A,{xs:12,bg:"secondary",style:{height:"40px",width:"93px",borderRadius:"4px"},size:"lg"})}),(0,m.jsx)(d.A,{as:"p",animation:"wave",children:(0,m.jsx)(d.A,{xs:12,bg:"secondary",style:{height:"40px",width:"93px",borderRadius:"4px"},size:"lg"})})]}):(0,m.jsxs)(r.A.Footer,{children:[(0,m.jsx)(a.A,{className:"edit-button",onClick:function(){S(),b(!0)},children:"Edit Task"}),null!==T&&void 0!==T&&T.finished?(0,m.jsx)(a.A,{className:"incomplete-button",onClick:()=>B.mutate(!1),children:B.isPending?(0,m.jsx)(m.Fragment,{children:"Loading..."}):(0,m.jsxs)(m.Fragment,{children:["Incomplete",(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,m.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#F04438"})})]})}):(0,m.jsx)(a.A,{className:"complete-button",onClick:()=>B.mutate(!0),children:B.isPending?(0,m.jsx)(m.Fragment,{children:"Loading..."}):(0,m.jsxs)(m.Fragment,{children:["Complete",(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,m.jsx)("path",{d:"M20 10.5C20 16.0228 15.5228 20.5 10 20.5C4.47715 20.5 0 16.0228 0 10.5C0 4.97715 4.47715 0.5 10 0.5C15.5228 0.5 20 4.97715 20 10.5ZM15.0379 6.71209C14.6718 6.34597 14.0782 6.34597 13.7121 6.71209C13.7032 6.72093 13.6949 6.73029 13.6872 6.74013L9.34674 12.2709L6.72985 9.65403C6.36373 9.28791 5.77014 9.28791 5.40402 9.65403C5.0379 10.0201 5.0379 10.6137 5.40402 10.9799L8.71208 14.2879C9.0782 14.654 9.67179 14.654 10.0379 14.2879C10.0461 14.2798 10.0538 14.2712 10.061 14.2622L15.0512 8.02434C15.404 7.65727 15.3995 7.07371 15.0379 6.71209Z",fill:"#17B26A"})})]})})]})]}),(0,m.jsx)(u.A,{show:A,setShow:b,taskId:y,setTaskId:f,defaultValue:T,refetch:w})]})}},49726:(e,t,s)=>{s.d(t,{A:()=>k});var n=s(65043),o=s(47994),i=s(51038),l=s(95192),a=s(93747),r=s(47097),d=s(88060),c=s(14282),p=s(73722),x=s(32952),h=s(56328),u=s(10586),m=s(79106),g=s(72796),v=s(57189),j=s(12532),y=s(84678),f=s(58027),w=s(35470),A=s(70579);const b=e=>{if(!e)return null;return new Date(1e3*+e)},k=e=>{var t,s,k,T,C,B,S,N,L,F;let{show:_,setShow:$,refetch:I,taskId:P,setTaskId:R,defaultValue:E}=e;const U=(0,n.useRef)(null),{session:D}=(0,v.As)(),[q,z]=(0,n.useState)(!1),[G,M]=(0,n.useState)(""),[O,H]=(0,n.useState)(""),[K,Z]=(0,n.useState)(""),[J,V]=(0,n.useState)(null),[W,Y]=(0,n.useState)(null),[Q,X]=(0,n.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1});(0,n.useEffect)((()=>{var e,t;P&&E&&(M(null===E||void 0===E?void 0:E.title),H(null===E||void 0===E?void 0:E.description),Z(null===E||void 0===E||null===(e=E.project)||void 0===e?void 0:e.id),V(null===E||void 0===E||null===(t=E.user)||void 0===t?void 0:t.id),Y({startDate:b(null===E||void 0===E?void 0:E.from_date),endDate:b(null===E||void 0===E?void 0:E.to_date)}))}),[P,E]);const ee=()=>{M(""),H(""),Z(""),V(null),Y(null),z(!1),X({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},te=(0,a.I)({queryKey:["getProjectsList"],queryFn:u.Bu}),se=(0,a.I)({queryKey:["getUserList"],queryFn:m.aU}),ne=(0,a.I)({queryKey:["getMobileUserList"],queryFn:m.gy});(0,n.useEffect)((()=>{_||ee()}),[_]);const oe=(0,r.n)({mutationFn:e=>P?(0,m.lC)(P,e):(0,m.Af)(e),onSuccess:()=>{I(),$(!1),ee(),P&&R(null),h.oR.success(`Task ${P?"updated":"created"} successfully`)},onError:e=>{console.error(`Error ${P?"updating":"creating"} task:`,e),h.oR.error(`Failed to ${P?"update":"create"} client. Please try again.`)}});(0,n.useEffect)((()=>{if(q){X({taskTitle:!G,description:!O,project:!K,user:!J,date:!W})}}),[G,O,K,J,W,q]);const ie=(0,r.n)({mutationFn:e=>(0,g.mM)(P),onSuccess:()=>{console.log("Delete success"),$(!1),I()},onError:e=>{console.error("Error creating task:",e)}});return(0,A.jsxs)(x.A,{show:_,centered:!0,onHide:()=>$(!1),className:"task-form",children:[(0,A.jsx)(x.A.Header,{closeButton:!0,children:(0,A.jsxs)(x.A.Title,{children:[(0,A.jsx)("img",{src:P?j.A:y.A,alt:"task-details",style:{width:"48px",height:"48px"}}),(0,A.jsxs)("span",{className:"modal-task-title",children:[P?"Edit":"New"," Task"]})]})}),(0,A.jsxs)(x.A.Body,{style:{background:"#f9fafb"},children:[(0,A.jsxs)(p.A.Group,{className:"mb-3",children:[(0,A.jsx)(p.A.Label,{children:"Task Title"}),(0,A.jsxs)(o.A,{children:[(0,A.jsx)(p.A.Control,{required:!0,type:"text",placeholder:"Enter task title",value:G,onChange:e=>M(e.target.value)}),(0,A.jsx)(o.A.Text,{children:(0,A.jsx)(i.A,{})})]}),Q.taskTitle&&(0,A.jsx)(p.A.Text,{className:"error-message",children:"Task title is required"})]}),(0,A.jsxs)(p.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,A.jsx)(p.A.Label,{children:"Description"}),(0,A.jsx)(p.A.Control,{as:"textarea",rows:3,placeholder:"Enter a description...",value:O,onChange:e=>H(e.target.value),required:!0}),Q.description&&(0,A.jsx)(p.A.Text,{className:"error-message",children:"Description is required"})]}),(0,A.jsxs)(p.A.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[(0,A.jsx)(p.A.Label,{children:"Project Task"}),(0,A.jsx)(d.m,{options:(null===te||void 0===te||null===(t=te.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{Z(e.value),console.log("e.value: ",e.value)},className:"w-100 outline-none",style:{height:"46px"},value:K,loading:null===te||void 0===te?void 0:te.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0}),Q.project&&(0,A.jsx)(p.A.Text,{className:"error-message",children:"Project task is required"})]})]}),(0,A.jsxs)("div",{className:"d-flex align-items-center border-top px-3 py-2 gap-2",children:[(0,A.jsxs)("div",{className:"d-flex align-items-center gap-4",style:{minWidth:"200px"},children:[!J&&(0,A.jsx)(l.A,{color:null!==(s=U.current)&&void 0!==s&&null!==(k=s.panel)&&void 0!==k&&null!==(T=k.element)&&void 0!==T&&T.offsetParent?"#1AB2FF":"#475467",size:22,style:{position:"relative",left:"10px",zIndex:1},onClick:()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.show()},className:"me-3 cursor-pointer"}),(0,A.jsx)(d.m,{ref:U,options:[{label:"Desktop User",items:(null===se||void 0===se||null===(C=se.data)||void 0===C||null===(B=C.users)||void 0===B||null===(S=B.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===S?void 0:S.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==D&&void 0!==D&&D.has_work_subscription?[{label:"Mobile User",items:(null===ne||void 0===ne||null===(N=ne.data)||void 0===N||null===(L=N.users)||void 0===L||null===(F=L.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===F?void 0:F.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{V(e.value)},valueTemplate:e=>(0,A.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,A.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"0px solid #dedede"},children:(0,A.jsx)(f.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),itemTemplate:e=>(0,A.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,A.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,A.jsx)(f.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:J?"fit-content":"0px",height:J?"46px":"0px",zIndex:J?"1":"0",position:"relative",left:J?"0px":"-60px",top:J?"0px":"-15px"},value:J,dropdownIcon:(0,A.jsx)(A.Fragment,{}),collapseIcon:(0,A.jsx)(A.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items"})]}),(0,A.jsx)(w.A,{dateRange:W,setDateRange:Y})]}),(Q.user||Q.date)&&(0,A.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{gap:"16px",padding:"5px 15px"},children:[(0,A.jsx)("div",{style:{minWidth:"200px"},children:Q.user&&(0,A.jsx)(p.A.Text,{className:"error-message",children:"User is required"})}),Q.date&&(0,A.jsx)(p.A.Text,{className:"error-message",children:"Date is required"})]}),(0,A.jsxs)(x.A.Footer,{className:"d-flex justify-content-between",children:[(0,A.jsx)(c.A,{type:"button",className:"delete-button",onClick:()=>{ie.mutate()},children:ie.isPending?"Loading...":"Delete Task"}),(0,A.jsx)(c.A,{type:"button",className:"save-button",onClick:()=>{z(!0);const e={taskTitle:!G,description:!O,project:!K,user:!J,date:!W};X(e),e.taskTitle||e.description||e.user||e.date||oe.mutate({title:G,description:O,project:K,user:J,from_date:W.startDate,to_date:W.endDate})},children:oe.isPending?"Loading...":(P?"Update":"Create")+" Task"})]})]})}}}]);
//# sourceMappingURL=6042.85d573f3.chunk.js.map