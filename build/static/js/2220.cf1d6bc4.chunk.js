"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[2220],{31342:(e,t,s)=>{s.d(t,{f:()=>r});const r=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{method:r="GET",headers:a={},body:i}=t,n=localStorage.getItem("access_token"),o=i instanceof FormData,l={"Content-Type":o?"multipart/form-data":"application/json",...a};s&&(l.Authorization=`Bearer ${n}`);const c={method:r,headers:l,body:o?i:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,c);if(!s.ok){if(401===s.status&&(window.localStorage.clear(),window.sessionStorage.clear(),window.location.replace("/login")),404===s.status)throw new Error("Not found");throw new Error(`HTTP error! Status: ${s.status}`)}const r=s.headers.get("Content-Type");if(r&&r.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(d){throw console.error("Fetch API error:",d),d}}},32220:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var r=s(65043),a=s(27066),i=s(55850),n=s(49367),o=s(35475),l=s(93747),c=s(72018),d=s(9642),u=s(64824),h=s(55797),m=s(56328);const p={circledesignstyle:"quote_circledesignstyle__3Ladr",out:"quote_out__yoHfT"};var j=s(50565),g=s(45004),x=s(93740);const y="RecurringJobActions_actionButton__Url96",f="RecurringJobActions_actionMenu__LJy6r",v="RecurringJobActions_menuItem__5g-js",b="RecurringJobActions_menuItemText__PFDZG",w="RecurringJobActions_menuItemIcon__yAzDR",N="RecurringJobActions_suspendItem__jwIcc",_="RecurringJobActions_activateItem__GENGy",A="RecurringJobActions_deleteItem__RkzDp",R="RecurringJobActions_disabled__k2fr+";var k=s(31342);const S="https://app.memate.com.au/api/v1";var $=s(70579);const z=e=>{let{jobId:t,status:s,onActionComplete:a}=e;const i=(0,r.useRef)(null),[n,o]=(0,r.useState)(!1),l=[{label:"active"===s?"Pause":"Activate",icon:"active"===s?"pi pi-pause":"pi pi-play",command:"active"===s?async()=>{try{o(!0),await(async e=>{const t=`/settings/projects/recurrings/${e}/pause/`,s={method:"POST",body:JSON.stringify({})},r=new URL(`${S}${t}`);return(0,k.f)(r.toString(),s)})(t),a&&a("pause")}catch(e){console.error("Error pausing recurring job:",e),m.oR.error("Failed to pause recurring job")}finally{o(!1)}}:async()=>{try{o(!0),await(async e=>{const t=`/settings/projects/recurrings/${e}/activate/`,s={method:"POST",body:JSON.stringify({})},r=new URL(`${S}${t}`);return(0,k.f)(r.toString(),s)})(t),a&&a("activate")}catch(e){console.error("Error activating recurring job:",e),m.oR.error("Failed to activate recurring job")}finally{o(!1)}},className:"active"===s?N:_,disabled:n,template:e=>(0,$.jsxs)("div",{className:`${v} ${n?R:""}`,onClick:n?null:e.command,style:{opacity:n?.6:1,cursor:n?"not-allowed":"pointer"},children:[(0,$.jsx)("span",{className:b,children:"active"===s?"Suspend schedule":"Activate schedule"}),(0,$.jsx)("span",{className:w,children:"active"===s?(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,$.jsx)("path",{d:"M5 6.25a1.25 1.25 0 1 1 2.5 0v3.5a1.25 1.25 0 1 1-2.5 0v-3.5zm3.5 0a1.25 1.25 0 1 1 2.5 0v3.5a1.25 1.25 0 1 1-2.5 0v-3.5z"})]}):(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}),(0,$.jsx)("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z"})]})})]})},{label:"Delete",icon:"pi pi-trash",command:async()=>{try{o(!0),await(async e=>{const t=new URL(`${S}/settings/projects/recurrings/${e}/`);return(0,k.f)(t.toString(),{method:"DELETE"})})(t),a&&a("delete")}catch(e){console.error("Error deleting recurring job:",e),m.oR.error("Failed to delete recurring job")}finally{o(!1)}},className:A,disabled:n,template:e=>(0,$.jsxs)("div",{className:`${v} ${n?R:""}`,onClick:n?null:e.command,style:{opacity:n?.6:1,cursor:n?"not-allowed":"pointer"},children:[(0,$.jsx)("span",{className:b,children:"Delete"}),(0,$.jsx)("span",{className:w,children:(0,$.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,$.jsx)("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),(0,$.jsx)("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]})})]})}];return(0,$.jsxs)("div",{className:y,children:[(0,$.jsx)(c.$,{icon:n?(0,$.jsx)(x.p,{style:{width:"18px",height:"18px"}}):(0,$.jsx)(j.A,{size:18,color:n?"#ccc":"#667085"}),className:"m-auto",onClick:e=>{n||(e.stopPropagation(),i.current.toggle(e))},disabled:n,"aria-label":"Actions",style:{backgroundColor:"transparent",border:"none",width:"fit-content",height:"fit-content",cursor:n?"not-allowed":"pointer",opacity:n?.7:1}}),(0,$.jsx)(g.W,{model:n?[]:l,popup:!0,ref:i,className:f,appendTo:document.body})]})};var O=s(48417),V=s(27734);function C(e){return new Date(1e3*+e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}const P={D:"Daily",W:"Weekly",B:"Biweekly",M:"Monthly",L:"Last Day of the Month",Q:"Quarterly",Y:"Yearly"},M=()=>{const{trialHeight:e}=(0,O.$)(),[t,s]=(0,r.useState)(1),[j,g]=(0,r.useState)(!1),[x,y]=(0,r.useState)([]),f=5*(t-1),{data:v,isLoading:b,refetch:w}=(0,l.I)({queryKey:["recurring",5,f],queryFn:()=>(async e=>{let{limit:t,offset:s}=e;const r=new URL(`${S}/settings/projects/recurrings?limit=${t}&offset=${s}`);return(0,k.f)(r.toString(),{method:"GET"})})({limit:5,offset:f}),keepPreviousData:!0});(0,r.useEffect)((()=>{w()}),[t,w]);const{results:N=[],count:_}=v||{},A=Math.ceil(_/5)||1,R=e=>s(e),M=e=>{m.oR.success({delete:"Recurring job deleted successfully",pause:"Recurring job paused successfully",activate:"Recurring job activated successfully"}[e]||"Action completed successfully"),w()},E=(0,$.jsx)("div",{className:`${p.modalHeader}`,children:(0,$.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,$.jsx)("div",{className:p.circledesignstyle,children:(0,$.jsx)("div",{className:p.out,children:(0,$.jsx)(a.A,{size:24,color:"#1AB2FF",className:"mb-0"})})}),(0,$.jsx)("span",{className:`white-space-nowrap ${p.headerTitle}`,children:"Recurring History"})]})}),J=(0,$.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,$.jsx)("span",{}),(0,$.jsx)("div",{className:"d-flex justify-content-end gap-2",children:(0,$.jsx)(c.$,{className:"outline-button",onClick:()=>g(!1),children:"Close"})})]});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(n.mg,{children:(0,$.jsx)("title",{children:"MeMate - Recurring Quotes"})}),(0,$.jsxs)("div",{className:"headSticky",children:[(0,$.jsx)("h1",{children:"Quotes & Jobs"}),(0,$.jsx)("div",{className:"contentMenuTab",children:(0,$.jsxs)("ul",{children:[(0,$.jsx)("li",{className:"menuActive",children:(0,$.jsx)(o.N_,{to:"/settings/quotesjobs/recurring-quotes",children:"Recurring Quotes"})}),(0,$.jsx)("li",{children:(0,$.jsx)(o.N_,{to:"/settings/quotesjobs/recurring-jobs",children:"Recurring Jobs"})})]})})]}),(0,$.jsx)("div",{className:"content_wrap_main",style:{height:`calc(100vh - 150px - ${e}px)`},children:(0,$.jsxs)("div",{className:"listwrapper",children:[(0,$.jsx)("div",{className:"topHeadStyle mb-4 align-items-center",children:(0,$.jsx)("h2",{className:"mb-0",children:"Recurring Quotes"})}),(0,$.jsxs)(u.b,{value:N,showGridlines:!0,tableStyle:{minWidth:"50rem"},children:[(0,$.jsx)(d.V,{header:"Client name",field:"client.name",body:e=>(0,$.jsxs)("div",{className:"d-flex align-items-center justify-content-between show-on-hover",children:[(0,$.jsx)("div",{className:"ellipsis-width",children:e.client.name}),(0,$.jsx)(c.$,{label:"Open",onClick:()=>(e=>{const t=N.find((t=>t.pk===e));y(t.history||[]),g(!0)})(e.pk),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Order Reference",field:"project.reference",body:e=>{var t;return(0,$.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px",fontWeight:600},children:(null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference)||""})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Frequency",field:"frequency",body:e=>P[e.frequency],style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Date started",field:"start_date",body:e=>C(e.start_date),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Occurrences",field:"occurrences",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Processed",field:"processed",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Status",field:"active",body:e=>e.active?(0,$.jsx)(i.A,{size:24,color:"#17B26A"}):"",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Actions",field:"",className:"text-center",body:e=>(0,$.jsx)(z,{jobId:e.pk,status:e.active?"active":"inactive",onActionComplete:M}),style:{width:"auto"}})]}),(0,$.jsxs)("div",{className:"bottomPagenation",children:[(0,$.jsx)("nav",{children:(0,$.jsxs)("ul",{className:"pagination",children:[(0,$.jsx)("li",{className:"page-item "+(1===t?"disabled":""),children:(0,$.jsx)("button",{onClick:()=>R(t-1),className:"page-link",style:{borderRadius:"20px"},disabled:1===t,children:"Previous"})}),(0,$.jsx)("li",{className:"page-item "+(t===A?"disabled":""),children:(0,$.jsx)("button",{onClick:()=>R(t+1),className:"page-link",style:{borderRadius:"20px"},disabled:t===A,children:"Next"})})]})}),(0,$.jsx)("div",{className:"countpage",children:(0,$.jsxs)("p",{children:["Page ",t," of ",A]})})]})]})}),b&&(0,$.jsx)(V.A,{}),(0,$.jsx)(h.l,{visible:j,modal:!0,header:E,footer:J,className:`${p.modal} custom-modal`,onHide:()=>g(!1),children:(0,$.jsxs)(u.b,{value:x||[],showGridlines:!0,tableStyle:{minWidth:"50rem"},children:[(0,$.jsx)(d.V,{header:"#",field:"pk",body:(e,t)=>{let{rowIndex:s}=t;return(0,$.jsx)($.Fragment,{children:s+1})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Date",field:"date",body:e=>C(e.date),style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Project Number",field:"project.number",style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Project Reference",field:"project.reference",body:e=>{var t;return(0,$.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px"},children:(null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference)||""})},style:{width:"auto"}}),(0,$.jsx)(d.V,{header:"Processed",field:"processed",body:e=>e.processed?(0,$.jsx)(i.A,{size:24,color:"#17B26A"}):"",style:{width:"auto"}})]})})]})}},55850:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(65043),a=s(65173),i=s.n(a),n=["color","size","title","className"];function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},o.apply(this,arguments)}function l(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)s=i[r],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}var c=(0,r.forwardRef)((function(e,t){var s=e.color,a=e.size,i=e.title,c=e.className,d=l(e,n);return r.createElement("svg",o({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:a,height:a,fill:s,className:["bi","bi-check-circle-fill",c].filter(Boolean).join(" ")},d),i?r.createElement("title",null,i):null,r.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"}))}));c.propTypes={color:i().string,size:i().oneOfType([i().string,i().number]),title:i().string,className:i().string},c.defaultProps={color:"currentColor",size:"1em",title:null,className:""};const d=c}}]);
//# sourceMappingURL=2220.cf1d6bc4.chunk.js.map