"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[6042],{10586:(e,t,s)=>{s.d(t,{$R:()=>i,Bu:()=>l,D3:()=>u,E4:()=>v,JP:()=>r,Rv:()=>d,Wz:()=>p,a_:()=>h,eY:()=>c,ik:()=>m,md:()=>o,oP:()=>x,sr:()=>g});var n=s(31342);const a="https://app.memate.com.au/api/v1",o=async function(e,t){var s;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;const d=(e-1)*t,c=[];c.push(`limit=${t}`),c.push(`offset=${d}`),o&&c.push(`search=${encodeURIComponent(o)}`),r&&c.push(`ordering=${encodeURIComponent(r)}`),l&&c.push("status=not_paid");let u="";var m;null!==i&&void 0!==i&&i.suppliers&&(u=null===i||void 0===i||null===(m=i.suppliers)||void 0===m?void 0:m.map((e=>e.id)).join(","),console.log("Suppliers filter string:",u),u&&c.push(`suppliers=${u}`));let h="";var p;null!==i&&void 0!==i&&i.departments&&(h=null===i||void 0===i||null===(p=i.departments)||void 0===p?void 0:p.map((e=>e.id)).join(","),h&&c.push(`departments=${h}`));let v="";var x;null!==i&&void 0!==i&&i.status&&1===(null===i||void 0===i||null===(s=i.status)||void 0===s?void 0:s.length)?(console.log("Status filter array:",i.status),null===i||void 0===i||null===(x=i.status)||void 0===x||x.forEach((e=>{console.log("Processing status element:",e),"paid"===(null===e||void 0===e?void 0:e.name)?v="paid":"not_paid"===(null===e||void 0===e?void 0:e.name)&&(v="not_paid")})),v&&(console.log("Applied status filter:",v),c.push(`status=${v}`))):null!==i&&void 0!==i&&i.status&&console.log("Status filter not applied - length:",i.status.length,"values:",i.status);if(null!==i&&void 0!==i&&i.date){var g,f,_,j;const e=null===i||void 0===i||null===(g=i.date[0])||void 0===g||null===(f=g.value)||void 0===f?void 0:f[0];if(e){const t=new Date(e),s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");c.push(`date_after=${s}-${n}-${a}`)}const t=null===i||void 0===i||null===(_=i.date[0])||void 0===_||null===(j=_.value)||void 0===j?void 0:j[1];if(t){const e=new Date(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");c.push(`date_before=${s}-${n}-${a}`)}}const y=`${a}/expenses/?${c.join("&")}`;return console.log("Final expenses API URL:",y),(0,n.f)(y,{method:"GET"})},r=async()=>{const e=new URL(`${a}/references/xero-codes/`);return(0,n.f)(e.toString(),{method:"GET"})},l=async()=>{const e=new URL(`${a}/references/projects/expenses/`);return(0,n.f)(e.toString(),{method:"GET"})},i=async e=>{const t=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},d=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/expenses/new/`);return(0,n.f)(s.toString(),t)},c=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,n.f)(o.toString(),s)},u=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/expenses/paid/`);return(0,n.f)(s.toString(),t)},m=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/expenses/unpaid/`);return(0,n.f)(s.toString(),t)},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${a}/expenses/to-xero/`);return(0,n.f)(s.toString(),t)},p=async e=>{const t=new URL(`${a}${`/expenses/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},v=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/clients/statement/pdf/`);return(0,n.f)(s.toString(),t)},x=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/clients/statement/send/`);return(0,n.f)(s.toString(),t)},g=async(e,t)=>{const s={method:"PUT",body:{code:t}},o=new URL(`${a}${`/suppliers/service-update/${e}/`}`);return(0,n.f)(o.toString(),s)}},10853:(e,t,s)=>{s.d(t,{A:()=>Y});var n=s(65043),a=s(93202),o=s(56741),r=s(95192),l=s(69956),i=s(18091),d=s(28261),c=s(47097),u=s(58387),m=s(88060),h=s(27932),p=s(93740),v=s(20288),x=s(14282),g=s(78602),f=s(29853),_=s(61072),j=s(56328);const y="create-task_circleDesignStyle__vtKho",k="create-task_out__LG-iY",b="create-task_taskTitleInput__s+lNu",w="create-task_formLabel__04J0h",C="create-task_taskDescriptionInput__RZWSI",S="create-task_projectDropdown__qXb5+",N="create-task_messageInputIcons__Cj2vl",A="create-task_attachButton__k6PEF",T="create-task_commentButton__3T-po";var D=s(70579);const L=()=>{const e=(0,n.useRef)();return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)("button",{className:A,type:"button","aria-label":"Attach file",ref:e,style:{padding:"4px"},children:(0,D.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,D.jsx)("path",{d:"M18.0833 8.33333L9.16667 17.25C8.17221 18.2444 6.82407 18.8042 5.41667 18.8042C4.00926 18.8042 2.66112 18.2444 1.66667 17.25C0.672214 16.2556 0.112446 14.9074 0.112446 13.5C0.112446 12.0926 0.672214 10.7444 1.66667 9.75L10.5833 0.833329C11.2486 0.167998 12.1514 -0.149151 13.0833 0.0666624C14.0153 0.282476 14.8056 0.947998 15.25 1.83333C15.6944 2.71866 15.7361 3.75 15.3333 4.66666C14.9306 5.58333 14.1389 6.29166 13.1667 6.5L5.08333 14.5833C4.75 14.9167 4.31944 15.0833 3.83333 15.0833C3.34722 15.0833 2.91667 14.9167 2.58333 14.5833C2.25 14.25 2.08333 13.8194 2.08333 13.3333C2.08333 12.8472 2.25 12.4167 2.58333 12.0833L9.16667 5.5",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})})})};var $=s(10586),R=s(79106),I=s(72796),E=s(57189),U=s(30155),P=s(58027),B=s(63040),F=s(83738);const M=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},z=e=>{let{startDate:t,endDate:s}=e;return(0,D.jsx)("div",{className:"dateSelectdTaskBar",children:M(t,s)})},H=e=>{let{setDateRange:t,dateRange:s}=e;const[a,o]=(0,n.useState)(!1),r=(0,n.useRef)(null),l=e=>{r.current&&!r.current.contains(e.target)&&o(!1)};return(0,n.useEffect)((()=>(a?document.addEventListener("mousedown",l):document.removeEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)})),[a]),(0,D.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:r,children:[(0,D.jsx)("div",{onClick:()=>o((e=>!e)),style:{cursor:"pointer"},children:null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate?(0,D.jsx)(z,{startDate:s.startDate,endDate:s.endDate}):(0,D.jsx)("div",{style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},className:"iconStyleCircle d-flex justify-content-center align-items-center iconStyleCircleRight "+(a?"active":""),children:(0,D.jsx)(B.A,{color:a?"#1AB2FF":"#475467",size:14})})}),a&&(0,D.jsx)("div",{className:"select-date-range",style:{position:"absolute",top:"-100px",background:"#fff",zIndex:1e3},children:(0,D.jsx)(F.s,{onDataApply:e=>{t(e),o(!1)},dateRange:s,onClose:()=>o(!1)})})]})};var W=s(75714);const q={commentsContainer:"task-comments_commentsContainer__9Qiud",commentsHeader:"task-comments_commentsHeader__SxVw0",commentsTitle:"task-comments_commentsTitle__f66k0",commentsList:"task-comments_commentsList__NBm+d",commentItem:"task-comments_commentItem__bv78f",deleteButton:"task-comments_deleteButton__XLlzH",userName:"task-comments_userName__EH9bR",commentTime:"task-comments_commentTime__4eCW6",commentText:"task-comments_commentText__rSHhj",addCommentSection:"task-comments_addCommentSection__-KvEG",avatar:"task-comments_avatar__GZ9fT",loadMoreWrapper:"task-comments_loadMoreWrapper__TLDxd",loadMoreBtn:"task-comments_loadMoreBtn__6oQeF",loading:"task-comments_loading__3LE67",commentAvatar:"task-comments_commentAvatar__Pc8rI",commentHeader:"task-comments_commentHeader__T9R4I",noComments:"task-comments_noComments__xAIGD"},G=e=>{var t,s,n,a,o;return{id:e.id,text:e.comment,created_at:e.created_at,user:{id:null===(t=e.created_by)||void 0===t?void 0:t.id,full_name:null===(s=e.created_by)||void 0===s?void 0:s.full_name,email:null===(n=e.created_by)||void 0===n?void 0:n.email,photo:null===(a=e.created_by)||void 0===a?void 0:a.avatar,role:null===(o=e.created_by)||void 0===o?void 0:o.role}}},O=e=>{const t=new Date,s=new Date(e),n=Math.floor((t-s)/6e4);return n<1?"Just now":n<60?`${n} min ago`:n<1440?`${Math.floor(n/60)} hours ago`:`${Math.floor(n/1440)} days ago`},K=(0,n.forwardRef)(((e,t)=>{let{taskId:s}=e;const{data:a,refetch:o,fetchNextPage:r,hasNextPage:l,isFetchingNextPage:i,isLoading:d}=(0,W.q)({queryKey:["task-comments",s],queryFn:e=>{let{pageParam:t}=e;return t?fetch(t).then((e=>e.json())):(0,R.Lb)(s)},enabled:!!s,getNextPageParam:e=>e.next});(0,n.useImperativeHandle)(t,(()=>({refetchComments:()=>o()})));const u=(0,c.n)({mutationFn:R.Co,onSuccess:()=>{j.oR.success("Comment deleted"),o()},onError:()=>{j.oR.error("Failed to delete comment")}}),m=a?a.pages.slice().flatMap((e=>e.results)).map(G).sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())).reverse():[];if(d)return(0,D.jsx)("div",{className:q.loading,children:"Loading comments\u2026"});if(!m.length)return(0,D.jsx)("div",{className:q.noComments,children:"No comments yet."});return(0,D.jsxs)("div",{className:q.commentsContainer,children:[l&&(0,D.jsx)("div",{className:q.loadMoreWrapper,children:(0,D.jsx)("button",{onClick:r,disabled:i,className:q.loadMoreBtn,children:i?"Loading\u2026":"Load older comments"})}),(0,D.jsx)("div",{className:q.commentsList,children:m.map((e=>{var t,s,n;return(0,D.jsx)("div",{className:q.commentItem,children:(0,D.jsxs)("div",{className:"d-flex gap-3",children:[(0,D.jsx)("div",{className:q.avatar,children:(0,D.jsx)(P.A,{photo:null===(t=e.user)||void 0===t?void 0:t.photo,has_photo:!(null===(s=e.user)||void 0===s||!s.photo),is_business:!1,size:18})}),(0,D.jsxs)("div",{className:"flex-grow-1",style:{width:"calc(100% - 50px)"},children:[(0,D.jsxs)("div",{className:q.header,children:[(0,D.jsx)("span",{className:q.userName,children:null===(n=e.user)||void 0===n?void 0:n.full_name}),(0,D.jsxs)("span",{className:q.commentTime,children:["\xb7 ",O(1e3*e.created_at)]}),(0,D.jsx)("button",{onClick:()=>{return t=e.id,void u.mutate(t);var t},disabled:u.isLoading,className:q.deleteButton,style:{marginLeft:"5px",background:"none",border:"none",color:"#D92D20",cursor:"pointer",fontSize:12},children:"Delete"})]}),(0,D.jsx)("p",{className:q.commentText,children:e.text})]})]})},e.id)}))})]})})),Z=e=>{if(!e)return null;return new Date(1e3*+e)},Y=e=>{let{show:t,setShow:s,refetch:A,taskId:B,setTaskId:F,defaultValue:M,projectId:z}=e;const W=(0,n.useRef)(null),q=(0,n.useRef)(null),G=(0,n.useRef)(null),O=(0,n.useRef)(null),Y=(0,n.useRef)(null),{session:J}=(0,E.As)(),[V,Q]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(!1),[te,se]=(0,n.useState)([]),[ne,ae]=(0,n.useState)(!1),[oe,re]=(0,n.useState)(""),[le,ie]=(0,n.useState)(""),[de,ce]=(0,n.useState)(""),[ue,me]=(0,n.useState)(null),[he,pe]=(0,n.useState)(null),[ve,xe]=(0,n.useState)(""),[ge,fe]=(0,n.useState)(!1),[_e,je]=(0,n.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1});(0,n.useEffect)((()=>{var e,t;B&&M&&(re(null===M||void 0===M?void 0:M.title),ie(null===M||void 0===M?void 0:M.description),ce(null===M||void 0===M||null===(e=M.project)||void 0===e?void 0:e.id),me(null===M||void 0===M||null===(t=M.user)||void 0===t?void 0:t.id),pe({startDate:Z(null===M||void 0===M?void 0:M.from_date),endDate:Z(null===M||void 0===M?void 0:M.to_date)}))}),[B,M]);const ye=()=>{re(""),ie(""),ce(""),me(null),pe(null),xe(""),Q(!1),je({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},ke=(0,d.I)({queryKey:["getProjectsList"],queryFn:$.Bu}),be=(0,d.I)({queryKey:["getUserList"],queryFn:R.aU}),we=(0,d.I)({queryKey:["getMobileUserList"],queryFn:R.gy});(0,n.useEffect)((()=>{t||ye()}),[t]);const Ce=(0,c.n)({mutationFn:e=>B?(0,R.lC)(B,e):(0,R.Af)(e),onSuccess:()=>{A(),s(!1),ye(),B&&F(null),j.oR.success(`Task ${B?"updated":"created"} successfully`)},onError:e=>{console.error(`Error ${B?"updating":"creating"} task:`,e),j.oR.error(`Failed to ${B?"update":"create"} client. Please try again.`)}});(0,n.useEffect)((()=>{if(V){je({taskTitle:!oe,description:!le,project:!de,user:!ue,date:!he})}}),[oe,le,de,ue,he,V]);const Se=()=>{Q(!0);const e={taskTitle:!oe,description:!le,project:!de,user:!ue,date:!he};je(e),e.taskTitle||e.description||e.user||e.date||e.project||Ce.mutate({title:oe,description:le,project:de,user:ue,from_date:he.startDate,to_date:he.endDate})},Ne=(0,c.n)({mutationFn:()=>(0,I.mM)(B),onSuccess:()=>{console.log("Delete success"),s(!1),A()},onError:e=>{console.error("Error creating task:",e)}}),Ae=()=>{Ne.mutate()},Te=()=>{s(!1),ye()},De=(0,c.n)({mutationFn:e=>(0,R.Zi)(B,e),onSuccess:()=>{var e;xe(""),null===(e=G.current)||void 0===e||e.refetchComments(),setTimeout((()=>{Y.current&&Y.current.scrollIntoView({behavior:"smooth",block:"end"})}),1e3)},onError:e=>{console.error("Error adding comment:",e),j.oR.error("Failed to add comment. Please try again.")},onSettled:()=>{fe(!1),setTimeout((()=>{var e;null===(e=O.current)||void 0===e||e.focus()}),0)}}),Le=()=>{var e;if(!ve.trim()&&0===te.length)return void j.oR.error("Add a comment or attach a file");if(!B)return void j.oR.error("Save the task first");fe(!0);const t=te[0]||null;De.mutate({comment:ve.trim(),attachment_url:(null===t||void 0===t?void 0:t.url)||null,attachment_type:(null===t||void 0===t?void 0:t.type)||null,created_by:{role:null===J||void 0===J||null===(e=J.user)||void 0===e?void 0:e.role}}),xe(""),se([])};return(0,n.useEffect)((()=>{setTimeout((()=>{q.current&&(q.current.style.height="auto",q.current.style.height=q.current.scrollHeight+"px")}),200)}),[le,B]),(0,n.useEffect)((()=>{z&&ce(+z)}),[z]),(0,D.jsx)(v.B,{visible:t,position:"right",onHide:()=>{s(!1)},modal:!1,dismissable:!1,style:{width:"591px",height:"97vh",borderRadius:"10px",marginRight:"10px"},content:e=>{var t,s,n,d,c,v,j,A,$,R,I,E;let{closeIconRef:F,hide:M}=e;return(0,D.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,D.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,D.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,D.jsx)("div",{className:y,children:(0,D.jsx)("div",{className:k,children:(0,D.jsx)(a.A,{size:24,color:"#17B26A"})})}),(0,D.jsxs)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:[B?"Update":"Create New"," Task"]})]}),(0,D.jsx)("span",{children:(0,D.jsx)(x.A,{type:"button",className:"text-button",ref:F,onClick:e=>M(e),children:(0,D.jsx)(o.A,{size:24,color:"#667085"})})})]}),(0,D.jsxs)("div",{className:"modal-body",style:{padding:"24px 24px",height:"calc(100vh - 72px - 122px - 100px)",overflow:"auto"},children:[(0,D.jsx)(f.A.Control,{type:"text",name:"taskTitle",id:"taskTitle",placeholder:"Enter task title",value:oe,onChange:e=>re(e.target.value),className:b}),_e.taskTitle&&(0,D.jsx)(f.A.Text,{className:"error-message",children:"Task title is required"}),(0,D.jsxs)(_.A,{className:"mt-3",children:[(0,D.jsx)(g.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,D.jsx)(f.A.Label,{className:w,children:"Assignee"})}),(0,D.jsxs)(g.A,{sm:8,className:"d-flex flex-column justify-content-center",children:[!ue&&(0,D.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>{var e;return null===(e=W.current)||void 0===e?void 0:e.show()},style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},children:(0,D.jsx)(r.A,{color:null!==(t=W.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(n=s.element)&&void 0!==n&&n.offsetParent?"#1AB2FF":"#475467",size:18,className:"cursor-pointer"})}),(0,D.jsx)(m.m,{ref:W,options:[{label:"Desktop User",items:(null===be||void 0===be||null===(d=be.data)||void 0===d||null===(c=d.users)||void 0===c||null===(v=c.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===v?void 0:v.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==J&&void 0!==J&&J.has_work_subscription?[{label:"Mobile User",items:(null===we||void 0===we||null===(j=we.data)||void 0===j||null===(A=j.users)||void 0===A||null===($=A.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===$?void 0:$.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{me(e.value)},valueTemplate:e=>e?(0,D.jsxs)("div",{className:"d-flex gap-2 align-items-center",style:{position:"relative",left:"-10px"},children:[(0,D.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,D.jsx)(P.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}):null,itemTemplate:e=>(0,D.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,D.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,D.jsx)(P.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:ue?"fit-content":"0px",height:ue?"46px":"0px",zIndex:ue?"1":"0",position:"relative",left:ue?"-4px":"-60px",top:ue?"0px":"-15px"},value:ue,dropdownIcon:(0,D.jsx)(D.Fragment,{}),collapseIcon:(0,D.jsx)(D.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"})]})]}),_e.user&&(0,D.jsx)(f.A.Text,{className:"error-message",children:"User is required"}),(0,D.jsxs)(_.A,{className:"mt-3",children:[(0,D.jsx)(g.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,D.jsx)(f.A.Label,{className:w,children:"Due Date"})}),(0,D.jsx)(g.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,D.jsx)(H,{dateRange:he,setDateRange:pe})})]}),_e.date&&(0,D.jsx)(f.A.Text,{className:"error-message",children:"Date is required"}),(0,D.jsxs)(_.A,{className:"mt-3",children:[(0,D.jsx)(g.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,D.jsx)(f.A.Label,{className:w,children:"Link to Project"})}),(0,D.jsx)(g.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,D.jsx)(m.m,{options:(null===ke||void 0===ke||null===(R=ke.data)||void 0===R?void 0:R.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{ce(e.value)},className:(0,u.A)("outline-none",S),style:{height:"46px",maxWidth:"100%",width:"fit-content"},value:de,loading:null===ke||void 0===ke?void 0:ke.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0})})]}),_e.project&&(0,D.jsx)(f.A.Text,{className:"error-message",children:"Project task is required"}),(0,D.jsxs)(_.A,{className:"mt-3",children:[(0,D.jsx)(g.A,{sm:4,children:(0,D.jsx)(f.A.Label,{className:w,children:"Description"})}),(0,D.jsx)(g.A,{sm:12,children:(0,D.jsx)(f.A.Control,{name:"taskDescription",id:"taskDescription",as:"textarea",placeholder:"Enter a description...",value:le,rows:2,ref:q,onChange:e=>{ie(e.target.value)},className:C,onInput:e=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onFocus:()=>{q.current&&(q.current.style.height="auto",q.current.style.height=q.current.scrollHeight+"px")}})})]}),_e.description&&(0,D.jsx)(f.A.Text,{className:"error-message",children:"Description is required"}),B&&(0,D.jsxs)("div",{className:"border-top pt-2 mt-3",children:[(0,D.jsx)(f.A.Label,{className:w,children:"Comments"}),(0,D.jsx)("div",{ref:Y,children:(0,D.jsx)(K,{taskId:B,ref:G})})]})]}),(0,D.jsxs)("div",{className:"modal-footer d-flex flex-column",style:{borderTop:"1px solid var(--Gray-200, #EAECF0)"},children:[(0,D.jsx)("div",{className:"d-flex w-100",style:{padding:"16px 24px"},children:(0,D.jsxs)("div",{className:"d-flex align-items-start gap-3 w-100",children:[(0,D.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"50%",overflow:"hidden",border:"1px solid #EAECF0",flexShrink:0},children:(0,D.jsx)(P.A,{photo:null===J||void 0===J||null===(I=J.user)||void 0===I?void 0:I.photo,has_photo:null===J||void 0===J||null===(E=J.user)||void 0===E?void 0:E.has_photo,is_business:!1,size:23})}),(0,D.jsxs)("div",{className:"position-relative w-100",children:[(0,D.jsx)(h.Z,{ref:O,id:"comment-input",as:"textarea",placeholder:"Add a comment...",rows:2,value:ve,onChange:e=>xe(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Le())},disabled:ge||!B,style:{width:"100%",border:"1px solid #D0D5DD",borderRadius:"8px",padding:"10px 14px",fontSize:"14px",resize:"none",minHeight:"44px",transition:"all 0.2s ease"}}),ne&&(0,D.jsxs)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:1,color:"#17B26A",fontWeight:600},children:[(0,D.jsx)(l.A,{size:32}),(0,D.jsx)("span",{style:{marginLeft:"8px"},children:"Drop files to attach"})]}),(0,D.jsxs)("div",{className:N,children:[(0,D.jsx)(L,{onAttachmentsChange:se,isDragOver:ne,setIsDragOver:ae}),(0,D.jsx)(U.A,{show:X,setShow:ee,setMessage:xe}),(0,D.jsx)(x.A,{onClick:Le,className:(0,u.A)("font-12",T),children:ge?(0,D.jsx)(p.p,{style:{width:"10px",height:"10px"}}):(0,D.jsx)(i.A,{size:10,color:"#fff"})})]})]})]})}),(0,D.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-between gap-3",style:{borderTop:"1px solid var(--Gray-200, #EAECF0)",padding:"12px 14px 6px 14px"},children:[(0,D.jsx)("div",{children:B&&(0,D.jsxs)(x.A,{className:"danger-text-button gap-2",onClick:Ae,children:["Delete",Ne.isPending&&(0,D.jsx)(p.p,{style:{width:"18px",height:"18px"}})]})}),(0,D.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,D.jsx)(x.A,{type:"button",onClick:Te,className:"outline-button",children:"Cancel"}),(0,D.jsxs)(x.A,{type:"button",onClick:Se,className:"solid-button",style:{minWidth:"70px"},disabled:Ce.isPending,children:[B?"Update Task":"Create Task"," ",Ce.isPending&&(0,D.jsx)(p.p,{style:{width:"18px",height:"18px"}})]})]})]})]})]})}})}},30155:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(65043),a=s(58387),o=s(4258),r=s(99724),l=s(70579);const i=e=>{let{show:t,setShow:s,setMessage:i}=e;const d=e=>{const t=document.querySelector(".emoji-picker"),n=document.querySelector(".chat-emoji-button");!t||t.contains(e.target)||n.contains(e.target)||s(!1)};return n.useEffect((()=>(document.addEventListener("click",d),()=>{document.removeEventListener("click",d)})),[]),(0,l.jsxs)("div",{className:"chat-emoji-picker",children:[(0,l.jsx)("button",{type:"button",className:(0,a.A)(r.A.emojiButton,"chat-emoji-button"),onClick:()=>s((e=>!e)),tabIndex:-1,style:{padding:"4px"},children:(0,l.jsxs)("svg",{width:"15",height:"15",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M10 18.3333C14.6024 18.3333 18.3334 14.6024 18.3334 10C18.3334 5.39763 14.6024 1.66667 10 1.66667C5.39765 1.66667 1.66669 5.39763 1.66669 10C1.66669 14.6024 5.39765 18.3333 10 18.3333Z",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M6.66669 11.6667C6.66669 11.6667 7.91669 13.3333 10 13.3333C12.0834 13.3333 13.3334 11.6667 13.3334 11.6667",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M7.5 7.5H7.50833",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M12.5 7.5H12.5083",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})]})}),t&&(0,l.jsx)("div",{className:"emoji-picker",style:{position:"absolute",bottom:"40px",right:0,zIndex:10},children:(0,l.jsx)(o.Ay,{onEmojiClick:e=>{i((t=>t+(e.emoji||""))),s(!1)},theme:"light"})})]})}},36042:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(28261),a=s(79106),o=s(10853),r=s(70579);const l=e=>{let{view:t,setView:s,taskId:l,setTaskId:i,reInitialize:d}=e;const{data:c}=(0,n.I)({queryKey:["taskId",l],queryFn:()=>(0,a.gg)(l),enabled:!!l&&!!t,retry:1,cacheTime:0,staleTime:0});return(0,r.jsx)(r.Fragment,{children:t&&(0,r.jsx)(o.A,{show:t,setShow:s,taskId:l,setTaskId:i,defaultValue:c,refetch:d})})}},72796:(e,t,s)=>{s.d(t,{_x:()=>r,dd:()=>a,mM:()=>o});const n="https://app.memate.com.au/api/v1",a=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const a={method:"GET",headers:t};try{const t=new URL(`${n}/tasks/${e}/`),s=await fetch(t,a);return await s.json()}catch(o){throw console.error("Tasks fetch error:",o),o}},o=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const a={method:"DELETE",headers:t,redirect:"follow"};try{const t=new URL(`${n}/tasks/delete/${e}/`);if((await fetch(t,a)).ok)return{message:"Task deleted successfully"};throw new Error("Error during deleting")}catch(o){throw console.error("Tasks fetch error:",o),o}},r=async(e,t)=>{const s=new Headers,a=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${a}`),s.append("Content-Type","application/json");const o={method:"PATCH",headers:s,body:JSON.stringify({finished:t}),redirect:"follow"};try{const t=new URL(`${n}/tasks/complete/${e}/`),s=await fetch(t,o);return await s.json()}catch(r){throw console.error("Tasks fetch error:",r),r}}},79106:(e,t,s)=>{s.d(t,{Af:()=>l,Co:()=>h,Lb:()=>u,U9:()=>o,Zi:()=>m,aU:()=>d,gg:()=>r,gy:()=>c,lC:()=>i});var n=s(31342);const a="https://app.memate.com.au/api/v1",o=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6?arguments[6]:void 0;const d=(e-1)*t,c=new URL(`${a}/tasks/`);return c.searchParams.append("limit",t),c.searchParams.append("offset",d),s&&c.searchParams.append("search",s),o&&c.searchParams.append("ordering",o),r&&c.searchParams.append("deleted",1),!0===l&&c.searchParams.append("finished",!1),!1===l&&c.searchParams.append("finished",!0),i&&c.searchParams.append("users",i),(0,n.f)(c.toString(),{method:"GET"})},r=async e=>{const t=new URL(`${a}${`/tasks/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},l=async e=>{const t={method:"POST",body:e},s=new URL(`${a}/tasks/new/`);return(0,n.f)(s.toString(),t)},i=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${a}${`/tasks/update/${e}/`}`);return(0,n.f)(o.toString(),s)},d=async()=>{const e=new URL(`${a}/desktop-users/`);return(0,n.f)(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${a}/team/mobile-users/`);return(0,n.f)(e.toString(),{method:"GET"})},u=async e=>{const t=new URL(`${a}${`/tasks/${e}/comments/`}`);return(0,n.f)(t.toString(),{method:"GET"})},m=async(e,t)=>{const s=new URL(`${a}${`/tasks/${e}/comments/`}`);return(0,n.f)(s.toString(),{method:"POST",body:t})},h=async e=>{const t=new URL(`${a}${`/tasks/comments/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})}},83738:(e,t,s)=>{s.d(t,{s:()=>d});var n=s(65043),a=s(58387),o=s(670),r=s(68767),l=s(32370),i=s(70579);const d=e=>{let{onDataApply:t,dateRange:s,onClose:d,className:c=""}=e;const[u,m]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate){const e=s.startDate instanceof Date?s.startDate:new Date(s.startDate),t=s.endDate instanceof Date?s.endDate:new Date(s.endDate);m([e,t])}}),[s]);const h=(0,n.useCallback)((()=>{u&&2===u.length&&u[0]&&u[1]?t({startDate:u[0],endDate:u[1]}):u&&1===u.length&&u[0]&&t({startDate:u[0],endDate:u[0]})}),[u,t]),p=(0,n.useCallback)((()=>{m(null),d&&d()}),[d]),v=(0,n.useCallback)((()=>{const e=new Date;e.setHours(0,0,0,0),m([e,e])}),[]),x=(0,n.useCallback)((()=>{const e=u&&u.length>=1&&u[0];return(0,i.jsxs)("div",{className:"date-range-footer",children:[(0,i.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-today",onClick:v,children:"Today"}),(0,i.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-cancel",onClick:p,children:"Cancel"}),(0,i.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-apply",onClick:h,disabled:!e,children:"Apply"})]})}),[u,v,p,h]),g=(0,n.useCallback)((()=>{var e,t;if(!u||0===u.length)return"Select date range";const s={month:"short",day:"numeric",year:"numeric"},n=(null===(e=u[0])||void 0===e?void 0:e.toLocaleDateString("en-US",s))||"",a=(null===(t=u[1])||void 0===t?void 0:t.toLocaleDateString("en-US",s))||"";return n&&a?`${n} - ${a}`:n?`${n} - Select end date`:"Select date range"}),[u]);return(0,i.jsxs)("div",{className:(0,a.A)("date-range-picker-calendar",c),children:[(0,i.jsx)("div",{className:"date-range-header",children:(0,i.jsx)("span",{className:"date-range-header-text",children:g()})}),(0,i.jsx)(o.V,{value:u,onChange:e=>m(e.value),selectionMode:"range",inline:!0,numberOfMonths:1,locale:"en",dateFormat:"dd M yy",footerTemplate:x,firstDayOfWeek:1,showButtonBar:!1,prevIcon:(0,i.jsx)(r.Y,{}),nextIcon:(0,i.jsx)(l.v,{})})]})}},99724:(e,t,s)=>{s.d(t,{A:()=>n});const n={chatArea:"chat-area_chatArea__LcIUx",chatSidebar:"chat-area_chatSidebar__YWktj",slideIn:"chat-area_slideIn__YYoN5",chatContent:"chat-area_chatContent__uf9lg",chatBodyArea:"chat-area_chatBodyArea__pnfS9",messagesContainer:"chat-area_messagesContainer__jP8AR",dragOver:"chat-area_dragOver__zUubn",loadingContainer:"chat-area_loadingContainer__GABMB",messageInputContainer:"chat-area_messageInputContainer__utwWT",messageInput:"chat-area_messageInput__IlSJP",messageInputIcons:"chat-area_messageInputIcons__hW5ZW",attachButton:"chat-area_attachButton__oHyZF",emojiButton:"chat-area_emojiButton__DtKy-",sendButton:"chat-area_sendButton__ZTAOh",emptyChat:"chat-area_emptyChat__Kcq0J",emptyChatIcon:"chat-area_emptyChatIcon__2jxD+",emptyChatText:"chat-area_emptyChatText__bUdhG",chatMenu:"chat-area_chatMenu__K57W1",attachmentLabel:"chat-area_attachmentLabel__Zt7sR"}}}]);
//# sourceMappingURL=6042.a8ba6f86.chunk.js.map