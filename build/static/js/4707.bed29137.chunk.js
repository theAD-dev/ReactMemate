"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[4707,6731],{568:(e,s,t)=>{t.d(s,{J:()=>n});const n=Object.freeze({CLIENTS:{CREATE:"CREATE_CLIENT",READ:"READ_CLIENT",UPDATE:"UPDATE_CLIENT",DELETE:"DELETE_CLIENT"},SUPPLIERS:{CREATE:"CREATE_SUPPLIER",READ:"READ_SUPPLIER",UPDATE:"UPDATE_SUPPLIER",DELETE:"DELETE_SUPPLIER"},SALES:{},MANAGEMENT:{},PROJECTS:{},STATISTIC:{},EXPENSE:{CREATE:"CREATE_EXPENSE",READ:"READ_EXPENSE",UPDATE:"UPDATE_EXPENSE",DELETE:"DELETE_EXPENSE"},INVOICE:{CREATE:"CREATE_INVOICE",READ:"READ_INVOICE",UPDATE:"UPDATE_INVOICE",DELETE:"DELETE_INVOICE"},SETTINGS:{USERS:{MOBILE_APP:{ADD:"ADD_USER",READ:"READ_USER",UPDATE:"UPDATE_USER",DISCONNECT_USER:"DISCONNECT_USER",RECONNECT_USER:"RECONNECT_USER",SHOW_DISCONNECTED_USERS:"SHOW_DISCONNECTED_USERS",BUY_USER:"BUY_USER"},DESKTOP:{ADD:"ADD_USER",READ:"READ_USER",DELETE:"DELETE_USER",UPDATE:"UPDATE_USER",RESTORE:"RESTORE_USER",SHOW_DELETED_USERS:"SHOW_DELETED_USERS",BUY_USER:"BUY_USER"}}}})},10586:(e,s,t)=>{t.d(s,{$R:()=>i,Bu:()=>l,D3:()=>m,JP:()=>o,Rv:()=>d,Wz:()=>x,a_:()=>p,eY:()=>c,ik:()=>u,md:()=>r});var n=t(31342);const a="https://dev.memate.com.au/api/v1",r=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0;const l=(e-1)*s,i=new URL(`${a}/expenses/`);return i.searchParams.append("limit",s),i.searchParams.append("offset",l),t&&i.searchParams.append("search",t),r&&i.searchParams.append("ordering",r),o&&i.searchParams.append("status","not_paid"),(0,n.f)(i.toString(),{method:"GET"})},o=async()=>{const e=new URL(`${a}/references/xero-codes/`);return(0,n.f)(e.toString(),{method:"GET"})},l=async()=>{const e=new URL(`${a}/references/projects/`);return(0,n.f)(e.toString(),{method:"GET"})},i=async e=>{const s=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,n.f)(s.toString(),{method:"GET"})},d=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/new/`);return(0,n.f)(t.toString(),s)},c=async(e,s)=>{const t={method:"PUT",body:s},r=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,n.f)(r.toString(),t)},m=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/paid/`);return(0,n.f)(t.toString(),s)},u=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/unpaid/`);return(0,n.f)(t.toString(),s)},p=async e=>{const s={method:"PUT",body:e},t=new URL(`${a}/expenses/to-xero/`);return(0,n.f)(t.toString(),s)},x=async e=>{const s=new URL(`${a}${`/expenses/delete/${e}/`}`);return(0,n.f)(s.toString(),{method:"DELETE"})}},14836:(e,s,t)=>{t.d(s,{A:()=>ue});var n=t(65043),a=t(61072),r=t(78602),o=t(14282),l=t(96141),i=t(5881),d=t(60867),c=t(9634),m=t(51038),u=t(89488),p=t(24858),x=t(35475),h=t(18403),E=t(93747),g=t(86213),v=t(58387),f=t(75758),S=t(85371),j=t(54972),N=t(8129),A=t(28676),_=t(74532),T=t(79255),y=t(72052),R=t(27932),b=t(59690),D=t(1356),P=t(56328),I=t(80899);const U="expenses-form_bgGreay__JyrcA",w="expenses-form_lable__PwIbw",C="expenses-form_inputText__juz8k",L="expenses-form_error__BY34l",O="expenses-form_dropdownSelect__9h-UH",$="expenses-form_expensesCreateNew__okukP",B="expenses-form_expTotalRow__8u8o3",F="expenses-form_CalItem__5I8ic",G="expenses-form_CalItemActive__NBMtY",J="expenses-form_autoComplete__xaJgU",M="expenses-form_fileBox__vJk+d",z="expenses-form_fileNameBox__Sb+Fy",q="expenses-form_deleteBox__IPh+B",k="expenses-form_aiProcessingBox__Xslof",V="expenses-form_aiProcessingSpinner__2Ykt8",Y="expenses-form_aiProcessingText__r+NWH",H="expenses-form_aiSuccessBox__5wZSk",W="expenses-form_aiSuccessText__g6HC8",K="expenses-form_aiNoDataBox__dy9sT",X="expenses-form_aiNoDataText__fTku6",Z="expenses-form_aiErrorBox__nCorV",Q="expenses-form_aiErrorText__a5YuG";var ee=t(17030),se=t(10586),te=t(52781),ne=t(27472);const ae=e=>{try{if("object"===typeof e&&null!==e){if(!(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])))return e;{const s=e[0].find((e=>"text"===e[0]));s&&s[1]&&(e=s[1])}}if("string"===typeof e){const s=e.match(/```json\s*([\s\S]*?)\s*```/);if(s&&s[1])return JSON.parse(s[1]);const t=e.indexOf("{"),n=e.lastIndexOf("}");if(-1!==t&&-1!==n){const s=e.substring(t,n+1);return JSON.parse(s)}}return null}catch(s){return console.error("Error extracting AI response data:",s),null}},re=e=>{if(!e)return null;let s="0.00";e.total_amount&&(s=e.total_amount.replace(/[A-Za-z$,]/g,"").trim());let t="no";!0===e.gst_included?t="in":!1===e.gst_included&&(t="ex");const n=parseFloat(s)||0;let a=n,r=0;return"in"===t?(r=.1*n/1.1,a=n-r):"ex"===t&&(r=.1*a),{invoice_reference:e.invoice_number||"",amount:n.toFixed(2),"gst-calculation":t,gst:"ex"===t,nogst:"no"===t,subtotal:a.toFixed(2),tax:r.toFixed(2),totalAmount:(a+r).toFixed(2),note:e.description||""}};var oe=t(14834),le=t(33296),ie=t(58027),de=t(11281),ce=t(70579);const me=I.Ik({supplier:I.ai().typeError("Supplier must be a valid id").required("Supplier is required"),invoice_reference:I.Yj().required("Invoice reference is required"),date:I.Yj().required("Date is required"),due_date:I.Yj().required("Due date is required").test("is-after-date","Due date must be after the invoice date",(function(e){const{date:s}=this.parent;if(!s||!e)return!0;const t=new Date(s),n=new Date(e);return t.setHours(0,0,0,0),n.setHours(0,0,0,0),n>=t})),amount:I.Yj().required("Amount is required"),nogst:I.zM().required("NOGST must be a boolean"),gst:I.zM().required("GST must be a boolean")}).required(),ue=(0,n.forwardRef)(((e,s)=>{var t,I,ue,pe,xe,he,Ee,ge,ve;let{onSubmit:fe,defaultValues:Se,id:je,defaultSupplier:Ne,setVisible:Ae,projectId:_e}=e;const Te=(0,n.useRef)(null),ye=(0,n.useRef)(null),Re=localStorage.getItem("access_token"),[be,De]=(0,n.useState)(Ne||""),[Pe,Ie]=(0,n.useState)([]),[Ue,we]=(0,n.useState)([]),[Ce,Le]=(0,n.useState)(1),[Oe,$e]=(0,n.useState)((null===Ne||void 0===Ne?void 0:Ne.name)||""),[Be,Fe]=(0,n.useState)(!0),[Ge,Je]=(0,n.useState)(!1),{control:Me,reset:ze,register:qe,handleSubmit:ke,setValue:Ve,getValues:Ye,watch:He,setError:We,trigger:Ke,formState:{errors:Xe}}=(0,p.mN)({resolver:(0,h.t)(me),defaultValues:Se}),{getRootProps:Ze,getInputProps:Qe}=(0,u.VB)({maxFiles:1,multiple:!1,onDrop:e=>{const s=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0})));we((()=>[...s])),ss(s)}}),es=async(e,s)=>g.A.put(s,e,{headers:{"Content-Type":""},onUploadProgress:t=>{const n=Math.round(t.loaded/t.total*100);we((t=>t.map((t=>t.name===e.name?Object.assign(t,{progress:n,url:s}):t))))}}).catch((t=>{console.log("err: ",t),we((t=>t.map((t=>t.name===e.name?Object.assign(t,{progress:0,url:s,error:!0}):t))))})),ss=async e=>{if(e.length)for(const n of e)try{const e=await g.A.post("https://dev.memate.com.au/api/v1/expenses/file/",{file_name:n.name},{headers:{Authorization:`Bearer ${Re}`}}),{url:t}=e.data;if(!t)return we([]),void P.oR.error(`Failed to upload ${n.name}. Please try again.`);await es(n,t);const a=t.split("?")[0]||"";Je(!0),we((e=>e.map((e=>e.name===n.name?Object.assign(e,{progress:100,aiProcessing:!0}):e)))),P.oR.info("AI is analyzing your document...",{duration:3e3});try{const e=await g.A.post("https://dev.memate.com.au/api/v1/expenses/recognize/",{file_url:a},{headers:{Authorization:`Bearer ${Re}`}});console.log("aiResponse: ",null===e||void 0===e?void 0:e.data);const s=ae(null===e||void 0===e?void 0:e.data);if(s){const e=re(s);e?(Ve("file",a),Object.entries(e).forEach((e=>{let[s,t]=e;Ve(s,t)})),Ke(["invoice_reference","amount","gst","nogst"]),P.oR.success("Form prefilled with invoice data"),we((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiSuccess:!0}):e))))):(we((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),P.oR.warning("No invoice data could be extracted from the document"))}else we((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),P.oR.warning("No invoice data could be extracted from the document")}catch(s){console.error("Error during AI recognition:",s),we((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiError:!0}):e)))),P.oR.error("Failed to analyze the document. Please try again.")}finally{Je(!1)}}catch(t){console.error("Error uploading file:",n.name,t),P.oR.error(`Failed to upload ${n.name}. Please try again.`)}};(0,n.useEffect)((()=>{Ve("supplier",+(null===be||void 0===be?void 0:be.id)),null!==be&&void 0!==be&&be.id&&Ke(["supplier"])}),[be]);const ts=()=>{Te.current&&Te.current.show();const e=document.querySelector(".p-autocomplete-items li.p-autocomplete-item:last-child");e&&ye.current.observe(e)},ns=function(e,s){let t;return function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];clearTimeout(t),t=setTimeout((()=>e(...a)),s)}}((e=>{var s;const t=(null===e||void 0===e||null===(s=e.query)||void 0===s?void 0:s.toLowerCase())||"";$e(t)}),300);(0,n.useEffect)((()=>{Le(1)}),[Oe]),(0,n.useEffect)((()=>{(async()=>{const e=await(0,te.Jj)(Ce,25,Oe,"name");var s;1===Ce?Ie(e.results):(null===e||void 0===e||null===(s=e.results)||void 0===s?void 0:s.length)>0&&Ie((s=>{const t=new Set(s.map((e=>e.id))),n=e.results.filter((e=>!t.has(e.id)));return[...s,...n]}));Fe(e.count!==Pe.length)})()}),[Ce,Oe]),(0,n.useEffect)((()=>{if(Pe.length>0&&Be){ye.current=new IntersectionObserver((e=>{e[0].isIntersecting&&Le((e=>e+1)),console.log("entries[0].isIntersecting: ",e[0].isIntersecting)}));const e=document.querySelector(".p-autocomplete-items li.p-autocomplete-item:last-child");e&&ye.current.observe(e)}return()=>{ye.current&&ye.current.disconnect()}}),[Pe,Be]);const as=e=>{if(e){const s=parseFloat(Ye("amount"))||0,{subtotal:t,calculatedTax:n,totalAmount:a}=((e,s)=>{let t=0,n=0;return"ex"===s?(n=e,t=.1*n):"in"===s?(t=.1*e/1.1,n=e-t):(n=e,t=0),{subtotal:n.toFixed(2),calculatedTax:t.toFixed(2),totalAmount:(parseFloat(n)+parseFloat(t)).toFixed(2)}})(s,e);Ve("tax",n),Ve("subtotal",t),Ve("totalAmount",a),Ve("nogst","no"===e),Ve("gst","ex"===e),Ke(["gst"])}},rs=(0,E.I)({queryKey:["getXeroCodesList"],queryFn:se.JP}),os=(0,E.I)({queryKey:["getDepartments"],queryFn:ee.ax}),ls=(0,E.I)({queryKey:["getProjectsList"],queryFn:se.Bu}),is=["Assign to order","Assign to timeframe"],[ds,cs]=(0,n.useState)((null===Se||void 0===Se?void 0:Se.option)||is[0]),ms=He("order");(0,n.useEffect)((()=>{ms&&Ke(["order"])}),[ms]);const us=He("type"),ps=()=>{"Assign to order"!==ds||ms||We("order",{type:"manual",message:"Order is required"}),"Assign to timeframe"!==ds||us||We("type",{type:"manual",message:"Type is required"})};(0,n.useEffect)((()=>{Object.keys(Xe).length>0&&ps()}),[Xe]),(0,n.useEffect)((()=>{"Assign to timeframe"===ds?(Ve("order",""),null!==Se&&void 0!==Se&&Se.type&&Ve("type",null===Se||void 0===Se?void 0:Se.type)):"Assign to order"===ds&&(Ve("type",""),null!==Se&&void 0!==Se&&Se.order&&Ve("order",null===Se||void 0===Se?void 0:Se.order)),Ve("option",ds)}),[ds]),(0,n.useEffect)((()=>{null!==Se&&void 0!==Se&&Se.option&&cs(null===Se||void 0===Se?void 0:Se.option)}),[null===Se||void 0===Se?void 0:Se.option]);return(0,n.useEffect)((()=>{_e&&Ve("order",+_e)}),[_e]),(0,n.useEffect)((()=>{je||Ve("gst-calculation","in")}),[]),(0,ce.jsxs)("form",{ref:s,onSubmit:ke((e=>{ps(),Object.keys(Xe).length>0?console.log("Validation errors:",Xe):fe(e,ze)})),children:[(0,ce.jsxs)(a.A,{className:(0,v.A)(U,"pt-3"),children:[(0,ce.jsx)(r.A,{sm:8,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mb-3",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Supplier",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsx)("input",{type:"hidden",...qe("supplier")}),(0,ce.jsx)(f.j,{ref:Te,value:be||"",completeMethod:ns,onChange:e=>{e.value||$e(""),De(e.value)},dropdownAutoFocus:!0,field:"name",suggestions:Pe,itemTemplate:e=>(0,ce.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ce.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ce.jsx)(ie.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.name]}),onClick:ts,onFocus:ts,onBlur:()=>{console.log("blur"),Le(1),$e(""),Fe(!0)},style:{height:"46px"},className:(0,v.A)(J,"w-100",{[L]:Xe.supplier}),placeholder:"Search for supplier"}),Xe.supplier&&(0,ce.jsx)("p",{className:"error-message",children:Xe.supplier.message})]})}),(0,ce.jsx)(r.A,{sm:4,children:(0,ce.jsx)("div",{className:"d-flex justify-content-end text-md-end flex-column gap-1 mt-3 pt-3 mb-3",children:(0,ce.jsx)(x.N_,{to:"/suppliers?addNewSupplier=true",target:"_blank",children:(0,ce.jsxs)(o.A,{className:$,children:["Create New Supplier",(0,ce.jsx)(l.A,{size:24,color:"#475467"})]})})})}),(0,ce.jsxs)(r.A,{sm:12,children:[(0,ce.jsx)("label",{className:(0,v.A)(w),children:"Upload & Read With AI"}),(0,ce.jsxs)("div",{...Ze({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"5px"},children:[(0,ce.jsx)("input",{...Qe()}),(0,ce.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:(0,ce.jsx)(i.A,{})}),(0,ce.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,ce.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,ce.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"PDF files only \u2022 Max size: 5MB"})]}),(0,ce.jsx)("div",{className:"d-flex flex-column gap-3 mb-4",children:null===Ue||void 0===Ue?void 0:Ue.map(((e,s)=>(0,ce.jsxs)("div",{className:M,children:[(0,de.I)(e.type),(0,ce.jsxs)("div",{className:z,children:[(0,ce.jsx)("p",{className:"mb-0",children:(null===e||void 0===e?void 0:e.name)||""}),(0,ce.jsxs)("p",{className:"mb-0",children:[parseFloat((null===e||void 0===e?void 0:e.size)/1024).toFixed(2)," KB - ",parseInt(null===e||void 0===e?void 0:e.progress)||0,"% uploaded"]})]}),(0,ce.jsx)("div",{className:"ms-auto",children:e.error?(0,ce.jsx)("div",{className:q,children:(0,ce.jsx)(d.A,{color:"#F04438",size:16})}):e.aiProcessing?(0,ce.jsxs)("div",{className:k,children:[(0,ce.jsx)("div",{className:V}),(0,ce.jsx)("span",{className:Y,children:"AI analyzing..."})]}):e.aiSuccess?(0,ce.jsxs)("div",{className:H,children:[(0,ce.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ce.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM7 11.4L3.6 8L5 6.6L7 8.6L11 4.6L12.4 6L7 11.4Z",fill:"#12B76A"})}),(0,ce.jsx)("span",{className:W,children:"Data extracted"})]}):e.aiNoData?(0,ce.jsxs)("div",{className:K,children:[(0,ce.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,ce.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM8 12C7.4 12 7 11.6 7 11C7 10.4 7.4 10 8 10C8.6 10 9 10.4 9 11C9 11.6 8.6 12 8 12ZM9 9H7V4H9V9Z",fill:"#F79009"})}),(0,ce.jsx)("span",{className:X,children:"No data found"})]}):e.aiError?(0,ce.jsxs)("div",{className:Z,children:[(0,ce.jsx)(d.A,{color:"#F04438",size:16}),(0,ce.jsx)("span",{className:Q,children:"AI error"})]}):(0,ce.jsx)(le.A,{percentage:parseInt(null===e||void 0===e?void 0:e.progress)||0,size:30,color:"#158ECC"})})]},s)))})]}),(0,ce.jsx)(r.A,{sm:12,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Invoice/#Ref",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsxs)(A.C,{children:[(0,ce.jsx)(_.m,{children:(null===Xe||void 0===Xe?void 0:Xe.invoice_reference)&&(0,ce.jsx)("img",{src:ne.A,className:"mb-3"})}),(0,ce.jsx)(y.S,{...qe("invoice_reference"),className:(0,v.A)(C,{[L]:Xe.invoice_reference}),placeholder:"Enter invoice reference"})]}),(null===Xe||void 0===Xe?void 0:Xe.invoice_reference)&&(0,ce.jsx)("p",{className:"error-message",children:null===(t=Xe.invoice_reference)||void 0===t?void 0:t.message})]})}),(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Date",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsx)(p.xI,{name:"date",control:Me,render:e=>{let{field:s}=e;return(0,ce.jsx)(S.V,{...s,onChange:e=>{s.onChange(e.value),setTimeout((()=>Ke("due_date")),0)},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,ce.jsx)(c.A,{color:"#667085",size:20}),className:(0,v.A)(C,{[L]:Xe.date},"p-0 outline-none")})}}),(null===Xe||void 0===Xe?void 0:Xe.date)&&(0,ce.jsx)("p",{className:"error-message",children:null===(I=Xe.date)||void 0===I?void 0:I.message})]})}),(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Due Date",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsx)(p.xI,{name:"due_date",control:Me,render:e=>{let{field:s}=e;const t=He("date"),n=t?new Date(t):null;return(0,ce.jsx)(S.V,{...s,onChange:e=>{s.onChange(e.value),Ke("due_date")},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,minDate:n,style:{height:"46px"},icon:(0,ce.jsx)(c.A,{color:"#667085",size:20}),className:(0,v.A)(C,{[L]:Xe.due_date},"p-0 outline-none")})}}),(null===Xe||void 0===Xe?void 0:Xe.due_date)&&(0,ce.jsx)("p",{className:"error-message",children:null===(ue=Xe.due_date)||void 0===ue?void 0:ue.message})]})}),(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Total Amount",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsxs)(A.C,{children:[(0,ce.jsx)(T.Y,{prefix:"$",value:He("amount"),onValueChange:e=>{Ve("amount",e.value),as(Ye("gst-calculation"))},onBlur:()=>as(Ye("gst-calculation")),style:{height:"46px",padding:"0px"},className:(0,v.A)(C,{[L]:Xe.amount}),placeholder:"$ Enter total amount",maxFractionDigits:2,minFractionDigits:2,inputId:"minmaxfraction"}),(0,ce.jsx)(_.m,{children:Xe.amount&&(0,ce.jsx)("img",{src:ne.A,className:"mb-3"})})]}),(null===Xe||void 0===Xe?void 0:Xe.amount)&&(0,ce.jsx)("p",{className:"error-message",children:null===(pe=Xe.amount)||void 0===pe?void 0:pe.message})]})}),(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["GST",(0,ce.jsx)("span",{className:"required",children:"*"})]}),(0,ce.jsx)("input",{type:"hidden",...qe("nogst")}),(0,ce.jsx)(p.xI,{name:"gst-calculation",control:Me,render:e=>{let{field:s}=e;return(0,ce.jsx)(N.m,{...s,options:[{value:"ex",label:"GST Exclusive"},{value:"in",label:"GST Inclusive"},{value:"no",label:"No GST"}]||0,onChange:e=>{s.onChange(e.value),as(e.value)},className:(0,v.A)(O,"dropdown-height-fixed",{[L]:null===Xe||void 0===Xe?void 0:Xe.gst}),style:{height:"46px"},value:s.value,placeholder:"Select GST"})}}),(null===Xe||void 0===Xe?void 0:Xe.gst)&&(0,ce.jsx)("p",{className:"error-message",children:null===(xe=Xe.gst)||void 0===xe?void 0:xe.message})]})})]}),(0,ce.jsxs)(a.A,{className:`${B}`,children:[(0,ce.jsx)(r.A,{className:"mb-4",children:(0,ce.jsx)("div",{className:F,children:(0,ce.jsxs)("div",{children:[(0,ce.jsx)("span",{children:"Subtotal"}),(0,ce.jsxs)("strong",{children:["$",(0,oe.m)(He("subtotal")||"0.00")]})]})})}),(0,ce.jsx)(r.A,{className:"mb-4",children:(0,ce.jsx)("div",{className:F,children:(0,ce.jsxs)("div",{children:[(0,ce.jsx)("span",{children:"Tax"}),(0,ce.jsxs)("strong",{children:["$",(0,oe.m)(He("tax")||"0.00")]})]})})}),(0,ce.jsx)(r.A,{className:"mb-4",children:(0,ce.jsx)("div",{className:`${G} ${F}`,children:(0,ce.jsxs)("div",{children:[(0,ce.jsx)("span",{children:"Total"}),(0,ce.jsxs)("strong",{className:"text-nowrap",children:["$",(0,oe.m)(He("totalAmount")||"0.00")]})]})})})]}),(0,ce.jsxs)(a.A,{className:(0,v.A)(U,"customSelectButton"),children:[(0,ce.jsx)(b.J,{value:ds,onChange:e=>cs(e.value),options:is}),"Assign to order"===ds?(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsx)(D.m,{position:"top",target:".info-timeinterval"}),(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Search Project",(0,ce.jsx)("span",{className:"required",children:"*"})," ",(0,ce.jsx)(m.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Selecting this option will categorize the expense under 'Operational Expense' and distribute it evenly over the chosen timeframe."})]}),(0,ce.jsx)(p.xI,{name:"order",control:Me,render:e=>{var s;let{field:t}=e;return(0,ce.jsx)(N.m,{...t,options:(null===ls||void 0===ls||null===(s=ls.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{t.onChange(e.value)},className:(0,v.A)(O,"dropdown-height-fixed",{[L]:null===Xe||void 0===Xe?void 0:Xe.order}),style:{height:"46px"},value:t.value,loading:null===ls||void 0===ls?void 0:ls.isFetching,placeholder:"Select project",filter:!0})}}),(null===Xe||void 0===Xe?void 0:Xe.order)&&(0,ce.jsx)("p",{className:"error-message",children:null===(he=Xe.order)||void 0===he?void 0:he.message})]})}):(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsx)(D.m,{position:"top",target:".info-timeinterval"}),(0,ce.jsxs)("label",{className:(0,v.A)(w),children:["Expense time interval",(0,ce.jsx)("span",{className:"required",children:"*"})," ",(0,ce.jsx)(m.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Selecting this option will categorize the expense under 'Operational Expense' and distribute it evenly over the chosen timeframe."})]}),(0,ce.jsx)(p.xI,{name:"type",control:Me,render:e=>{let{field:s}=e;return(0,ce.jsx)(N.m,{...s,options:[{value:1,label:"Monthly"},{value:2,label:"Yearly"}],onChange:e=>{s.onChange(e.value)},className:(0,v.A)(O,"dropdown-height-fixed",{[L]:null===Xe||void 0===Xe?void 0:Xe.type}),style:{height:"46px"},value:s.value,placeholder:"Select expense time interval"})}}),(null===Xe||void 0===Xe?void 0:Xe.type)&&(0,ce.jsx)("p",{className:"error-message",children:null===(Ee=Xe.type)||void 0===Ee?void 0:Ee.message})]})})]}),(0,ce.jsx)(a.A,{className:(0,v.A)(U),children:(0,ce.jsx)(r.A,{sm:12,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,ce.jsx)("label",{className:(0,v.A)(w),children:"Notes"}),(0,ce.jsxs)(A.C,{children:[(0,ce.jsx)(_.m,{style:{top:"75%"},children:Xe.note&&(0,ce.jsx)("img",{src:ne.A,alt:"error-icon"})}),(0,ce.jsx)(R.Z,{...qe("note"),rows:3,cols:30,className:(0,v.A)(C,{[L]:Xe.note}),style:{resize:"none"},placeholder:"Enter a note..."})]}),Xe.note&&(0,ce.jsx)("p",{className:"error-message",children:Xe.note.message})]})})}),(0,ce.jsxs)(a.A,{className:(0,v.A)(U),children:[(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsx)("label",{className:(0,v.A)(w),children:"Account Code"}),(0,ce.jsx)(p.xI,{name:"account_code",control:Me,render:e=>{var s;let{field:t}=e;return(0,ce.jsx)(N.m,{...t,options:[...rs&&(null===rs||void 0===rs||null===(s=rs.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.code}: ${e.name}`}))))||[]]||[],onChange:e=>{t.onChange(e.value)},className:(0,v.A)(O,"dropdown-height-fixed",{[L]:null===Xe||void 0===Xe?void 0:Xe.account_code}),style:{height:"46px"},scrollHeight:"400px",value:t.value,loading:null===rs||void 0===rs?void 0:rs.isFetching,placeholder:"Select account code",filter:!0})}}),(null===Xe||void 0===Xe?void 0:Xe.account_code)&&(0,ce.jsx)("p",{className:"error-message",children:null===(ge=Xe.account_code)||void 0===ge?void 0:ge.message})]})}),(0,ce.jsx)(r.A,{sm:6,children:(0,ce.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,ce.jsx)("label",{className:(0,v.A)(w),children:"Department"}),(0,ce.jsx)(p.xI,{name:"department",control:Me,render:e=>{var s;let{field:t}=e;return(0,ce.jsx)(N.m,{...t,options:[...os&&(null===os||void 0===os||null===(s=os.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.name}`}))))||[]]||[],onChange:e=>{t.onChange(e.value)},className:(0,v.A)(O,"dropdown-height-fixed",{[L]:null===Xe||void 0===Xe?void 0:Xe.department}),style:{height:"46px"},scrollHeight:"400px",value:t.value,loading:null===os||void 0===os?void 0:os.isFetching,placeholder:"Select department",filter:!0})}}),(null===Xe||void 0===Xe?void 0:Xe.department)&&(0,ce.jsx)("p",{className:"error-message",children:null===(ve=Xe.department)||void 0===ve?void 0:ve.message})]})})]}),(0,ce.jsxs)("div",{className:"flex align-items-center",children:[(0,ce.jsx)(p.xI,{name:"notification",control:Me,render:e=>{let{field:{onChange:s,onBlur:t,value:n,ref:a}}=e;return(0,ce.jsx)(j.S,{inputRef:a,checked:n,onChange:e=>{s(e.checked)},onBlur:t})}}),(0,ce.jsx)("label",{className:"ms-2",style:{position:"relative",top:"1px",color:"#344054",fontWeight:500,fontSize:"14px"},children:"Send Email Notification when paid"})]})]})}))},17030:(e,s,t)=>{t.d(s,{DY:()=>i,Dc:()=>o,MY:()=>v,VL:()=>u,Vn:()=>d,WL:()=>l,_0:()=>h,ax:()=>r,cM:()=>p,jH:()=>E,mL:()=>m,sl:()=>g,tA:()=>c,zw:()=>x});var n=t(31342);const a="https://dev.memate.com.au/api/v1",r=async e=>{const s=new URL(`${a}/references/calc-indexes/`);return 1===e&&s.searchParams.append("all",1),(0,n.f)(s.toString(),{method:"GET"})},o=async e=>{const s=new URL(`${a}${`/references/calculators/${e}/`}`),t=await(0,n.f)(s.toString(),{method:"GET"});return Array.isArray(t)?t.filter((e=>!e.deleted)):t&&!t.deleted?t:null},l=async e=>{const s=new URL(`${a}${`/projects/${e}/`}`);return(0,n.f)(s.toString(),{method:"GET"})},i=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/sales/new-request/`);return(0,n.f)(t.toString(),s)},d=async(e,s)=>{if(!e)throw new Error("No id found");const t={method:"PUT",body:s},r=new URL(`${a}${`/sales/projects/${e}/`}`);return(0,n.f)(r.toString(),t)},c=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/projects/merges/new/`);return(0,n.f)(t.toString(),s)},m=async e=>{const s=new URL(`${a}${`/projects/merges/${e}/delete/`}`);return(0,n.f)(s.toString(),{method:"DELETE"})},u=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/settings/departments/`);return(0,n.f)(t.toString(),s)},p=async(e,s)=>{if(!e)return;const t={method:"PUT",body:s},r=new URL(`${a}${`/settings/departments/update/${e}/`}`);return(0,n.f)(r.toString(),t)},x=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/settings/sub-departments/`);return(0,n.f)(t.toString(),s)},h=async(e,s)=>{if(!e)return;const t={method:"PUT",body:s},r=new URL(`${a}${`/settings/sub-departments/update/${e}/`}`);return(0,n.f)(r.toString(),t)},E=async(e,s)=>{const t={method:"POST",body:s},r=new URL(`${a}${`/references/calculators/${e}/new/`}`);return(0,n.f)(r.toString(),t)},g=async(e,s,t)=>{const r={method:"PUT",body:t},o=new URL(`${a}${`/references/calculators/${e}/update/${s}/`}`);return(0,n.f)(o.toString(),r)},v=async e=>{const s=new URL(`${a}${e}`);return(0,n.f)(s.toString(),{method:"DELETE"})}},20793:(e,s,t)=>{e.exports=t.p+"static/media/NodataImg.ee3ccbdc6b7e66284e17.png"},52781:(e,s,t)=>{t.d(s,{Jj:()=>r,O5:()=>i,Xq:()=>o,xe:()=>l});var n=t(31342);const a="https://dev.memate.com.au/api/v1",r=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;const o=(e-1)*s,l=new URL(`${a}/suppliers/`);return l.searchParams.append("limit",s),l.searchParams.append("offset",o),t&&l.searchParams.append("name",t),r&&l.searchParams.append("ordering",r),(0,n.f)(l.toString(),{method:"GET"})},o=async e=>{const s=new URL(`${a}${`/suppliers/${e}/`}`);return(0,n.f)(s.toString(),{method:"GET"})},l=async function(e,s,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5?arguments[5]:void 0;const i=(s-1)*t,d=new URL(`${a}${`/suppliers/history/${e}/`}`);return d.searchParams.append("limit",t),d.searchParams.append("offset",i),r&&d.searchParams.append("name",r),o&&d.searchParams.append("ordering",o),l&&d.searchParams.append("deleted",1),(0,n.f)(d.toString(),{method:"GET"})},i=async e=>{const s=new URL(`${a}${`/suppliers/${e}/`}`);return(0,n.f)(s.toString(),{method:"DELETE"})}},54967:(e,s,t)=>{t.d(s,{A:()=>i,h:()=>d});var n=t(65043),a=t(44541),r=t(95192);const o="image-avatar_clientImg__-nnRU";var l=t(70579);const i=e=>{let{has_photo:s,photo:t,is_business:o,size:i}=e;const[d,c]=(0,n.useState)(!1),m=o?a.A:r.A;return(0,l.jsx)(l.Fragment,{children:s&&t&&!d?(0,l.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,l.jsx)(m,{color:"#667085",size:i})})},d=e=>{let{has_photo:s,photo:t,is_business:i}=e;const[d,c]=(0,n.useState)(!1),m=i?a.A:r.A;return(0,l.jsx)("div",{className:`d-flex justify-content-center align-items-center ${o} ${i?"":"rounded-circle"}`,style:{overflow:"hidden"},children:s&&t&&!d?(0,l.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,l.jsx)(m,{color:"#667085"})})}},62284:(e,s,t)=>{t.d(s,{A:()=>E});var n=t(65043),a=t(14282),r=t(93202),o=t(56741),l=t(47097),i=t(20288),d=t(56328);const c="new-expense-create_circledesignstyle__Ke3sy",m="new-expense-create_out__C1Mi-",u="new-expense-create_expensesEditHead__xr-7V";var p=t(10586),x=t(14836),h=t(70579);const E=e=>{let{visible:s,setVisible:t,setRefetch:E}=e;const g=window.location.href,v=new URL(g),f=new URLSearchParams(v.search).get("projectId");f&&t(!0);const S=new Date,j=new Date(S);j.setDate(j.getDate()+1);const N=(0,n.useRef)(null),[A]=(0,n.useState)({option:"Assign to order",notification:!1,date:S,due_date:j}),_=(0,l.n)({mutationFn:e=>(0,p.Rv)(e),onSuccess:e=>{console.log("response: ",e),d.oR.success("Expense created successfully"),t(!1),E((e=>!e))},onError:e=>{console.error("Error creating expense:",e),d.oR.error("Failed to create expense. Please try again.")}}),T=async e=>{delete e["gst-calculation"],delete e.option,delete e.subtotal,delete e.totalAmount,delete e.tax,e.order||delete e.order,e.type||(e.type=1),e.date&&(e.date=new Date(e.date).toISOString().split("T")[0]),e.due_date&&(e.due_date=new Date(e.due_date).toISOString().split("T")[0]),_.mutate(e)},y=()=>{N.current&&N.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,h.jsx)(i.B,{visible:s,position:"right",onHide:()=>t(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:n}=e;return(0,h.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,h.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,h.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,h.jsx)("div",{className:c,children:(0,h.jsx)("div",{className:m,children:(0,h.jsx)(r.A,{size:24,color:"#17B26A"})})}),(0,h.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create new Expense"})]}),(0,h.jsx)("span",{children:(0,h.jsx)(a.A,{type:"button",className:"text-button",ref:s,onClick:e=>n(e),children:(0,h.jsx)(o.A,{size:24,color:"#667085"})})})]}),(0,h.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 105px)",overflow:"auto"},children:[(0,h.jsx)("div",{className:`d-flex align-items-center mb-2 justify-content-between ${u}`,children:(0,h.jsx)("h5",{children:"Supplier Details"})}),(0,h.jsx)(x.A,{ref:N,onSubmit:T,defaultValues:A,setVisible:t,projectId:f})]}),(0,h.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,h.jsx)(a.A,{type:"button",onClick:e=>{e.stopPropagation(),t(!1)},className:"outline-button",children:"Cancel"}),(0,h.jsx)(a.A,{type:"button",onClick:y,className:"solid-button",style:{minWidth:"70px"},children:_.isPending?"Loading...":"Save"})]})]})}})}},74737:(e,s,t)=>{t.d(s,{_:()=>o});var n=t(568);const a=Object.freeze({ADMIN:"Admin",LOCATION_MANAGER:"Location Manager",GENERAL_MANAGER:"General Manager",DEVELOPER:"Developer",DESIGNER:"Designers",SMM_PR:"SMM/PR"}),r={[a.ADMIN]:{permissions:[n.J.CLIENTS.CREATE,n.J.CLIENTS.READ,n.J.CLIENTS.UPDATE,n.J.CLIENTS.DELETE,n.J.SUPPLIERS.CREATE,n.J.SUPPLIERS.READ,n.J.SUPPLIERS.UPDATE,n.J.SUPPLIERS.DELETE,n.J.EXPENSE.CREATE,n.J.EXPENSE.READ,n.J.EXPENSE.UPDATE,n.J.EXPENSE.DELETE,n.J.INVOICE.CREATE,n.J.INVOICE.READ,n.J.INVOICE.UPDATE,n.J.INVOICE.DELETE,n.J.SETTINGS.USERS.DESKTOP.ADD,n.J.SETTINGS.USERS.DESKTOP.READ,n.J.SETTINGS.USERS.DESKTOP.DELETE,n.J.SETTINGS.USERS.DESKTOP.UPDATE,n.J.SETTINGS.USERS.DESKTOP.RESTORE,n.J.SETTINGS.USERS.DESKTOP.SHOW_DELETED_USERS,n.J.SETTINGS.USERS.DESKTOP.BUY_USER,n.J.SETTINGS.USERS.MOBILE_APP.ADD,n.J.SETTINGS.USERS.MOBILE_APP.READ,n.J.SETTINGS.USERS.MOBILE_APP.UPDATE,n.J.SETTINGS.USERS.MOBILE_APP.DISCONNECT_USER,n.J.SETTINGS.USERS.MOBILE_APP.RECONNECT_USER,n.J.SETTINGS.USERS.MOBILE_APP.SHOW_DISCONNECTED_USERS,n.J.SETTINGS.USERS.MOBILE_APP.BUY_USER]}},o=function(e,s){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!r[e])return!1;const n=r[e].permissions;return Array.isArray(s)?t?s.every((e=>n.includes(e))):s.some((e=>n.includes(e))):n.includes(s)}},99868:(e,s,t)=>{t.d(s,{A:()=>h});var n=t(65043),a=t(14282),r=t(38294),o=t(35475),l=t(58387);const i="no-data-found-template_noDataBox__HgeT1",d="no-data-found-template_title__P5uV2",c="no-data-found-template_subTitle__zMBB-",m="no-data-found-template_supportext__pHg2P";var u=t(20793),p=t(63919),x=t(70579);const h=e=>{let{isDataExist:s=!0}=e;const[t,h]=(0,n.useState)(!1);return(0,x.jsxs)("div",{className:(0,l.A)(i),children:[(0,x.jsx)("div",{className:"position-relative d-flex flex-column",children:(0,x.jsx)("img",{src:u,alt:"no-data"})}),s?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h2",{className:(0,l.A)(d),children:"There is no results"}),(0,x.jsxs)("p",{className:(0,l.A)(c),children:["The user you are looking for doesn't exist. ",(0,x.jsx)("br",{}),"Here are some helpful links:"]}),(0,x.jsx)(o.N_,{to:"/",children:(0,x.jsxs)(a.A,{className:"outline-button",style:{marginBottom:"32px"},children:[" ",(0,x.jsx)(r.A,{})," Go back"]})}),(0,x.jsx)(o.N_,{onClick:()=>h(!0),to:"#",children:(0,x.jsx)("span",{className:(0,l.A)(m),children:"Support"})})]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("h2",{className:(0,l.A)(d),children:"No historical records yet."})}),(0,x.jsx)(p.A,{setVisible:h,visible:t})]})}}}]);
//# sourceMappingURL=4707.bed29137.chunk.js.map