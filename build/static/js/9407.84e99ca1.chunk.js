"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[9407],{36166:(e,s,t)=>{t.d(s,{DX:()=>l,H2:()=>a,LG:()=>r,Y4:()=>o,e0:()=>c,r$:()=>d,rf:()=>x});var i=t(31342);const n="https://app.memate.com.au/api/v1",l=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0;const a=(e-1)*s,d=new URL(`${n}/invoices/`);return d.searchParams.append("limit",s),d.searchParams.append("offset",a),t&&d.searchParams.append("search",t),l&&d.searchParams.append("ordering",l),o&&d.searchParams.append("status","not_paid"),(0,i.f)(d.toString(),{method:"GET"})},o=async e=>{const s=new URL(`${n}${`/invoices/view/${e}/`}`);return(0,i.f)(s.toString(),{method:"GET"},!1)},a=async(e,s)=>{const t={method:"POST",body:s},l=new URL(`${n}${`/invoices/payment-intent/${e}/`}`);return(0,i.f)(l.toString(),t,!1)},d=async e=>{const s=new URL(`${n}${`/invoices/delete/${e}/`}`);return(0,i.f)(s.toString(),{method:"DELETE"})},r=async(e,s)=>{const t={method:"POST",body:s},l=new URL(`${n}${`/resend/invoice/${e}/`}`);return(0,i.f)(l.toString(),t)},c=async(e,s)=>{const t={method:"POST",body:s},l=new URL(`${n}${`/invoices/partial-payment/${e}/`}`);return(0,i.f)(l.toString(),t)},x=async e=>{const s={method:"PUT",body:e},t=new URL(`${n}/invoices/to-xero/`);return(0,i.f)(t.toString(),s)}},92196:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Ye});var i=t(65043),n=t(18091),l=t(75329),o=t(25725),a=t(39759),d=t(49367),r=t(35475),c=t(47097),x=t(58387),m=t(72018),h=t(2028),u=t(93740),p=t(90818),v=t(56328);const j="invoice_filterBox__36jYC",f="invoice_menu__XnbN-",y="invoice_total__9UXKw",g="invoice_totalCount__5pnjp",b="invoice_totalMoney__B+H00",_="invoice_ellipsis__MToPC",N="invoice_active__g3Bt5",A="invoice_selectedCount__5R4mY",w="invoice_deletedRow__iZM+L",S="invoice_paidRow__+-UAI",C="invoice_unpaidRow__7a9Tr",$="invoice_partialPaidRow__UIQwV",F="invoice_fontStanderdSize__sKilw",R="invoice_paid__8CgVs",k="invoice_plusIcon__paSYh",z="invoice_unpaid__HNSOb",P="invoice_partialPaid__YSX48",I="invoice_status__Zlf8W",D="invoice_inactive__mkKPg",E="invoice_actionButton__vFx0E",T="invoice_shakeText__KJ+lD",B="invoice_allInvoice__T+ods",q="invoice_unpaidInvoice__qngZ9";var W=t(85632),L=t(52572),O=t(72413),V=t(83627),M=t(77918),H=t(15228),U=t(19916),G=t(45463),Z=t(70882),X=t(49095),Y=t(17707),K=t(50565),Q=t(88578),J=t(73728),ee=t(94819),se=t(73216),te=t(41451),ie=t(99367),ne=t(20092),le=t(9642),oe=t(64824),ae=t(76104),de=t(36166),re=t(67046),ce=t(48417),xe=t(14834),me=t(27734),he=t(54967),ue=t(99868),pe=t(13846),ve=t(93257),je=t(55797),fe=t(28676),ye=t(74532),ge=t(79255),be=t(59690);const _e="invoice-partial-payment_modal__Dbqcb",Ne="invoice-partial-payment_modalHeader__O5yS9",Ae="invoice-partial-payment_border__Iepxr",we="invoice-partial-payment_inputText__CTim0",Se="invoice-partial-payment_error__RZeCG",Ce="invoice-partial-payment_box__r-bzO",$e="invoice-partial-payment_box3__1L6cb",Fe="invoice-partial-payment_box4__Hfap-",Re="invoice-partial-payment_box5__6Wn2j",ke="invoice-partial-payment_box6__cjGiq",ze="invoice-partial-payment_box7__fQGnQ",Pe="invoice-partial-payment_text__vazCt",Ie="invoice-partial-payment_borderTable__rNXbt";var De=t(70579);const Ee=(0,De.jsx)("div",{className:`${Ne}`,children:(0,De.jsx)("div",{className:"d-flex align-items-center gap-2",children:"Confirm Payment"})}),Te=e=>{let{history:s}=e;const t=e=>{const s=new Date(1e3*e);return`${s.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(s)} ${s.getFullYear()}`};return(0,De.jsx)(pe.A,{className:(0,x.A)(Ae,"mb-3 mt-2"),children:(0,De.jsxs)(pe.A.Body,{children:[(0,De.jsx)("h1",{style:{fontSize:"16px"},children:"History"}),(0,De.jsxs)(oe.b,{value:s,className:Ie,showGridlines:!0,children:[(0,De.jsx)(le.V,{field:"",style:{width:"auto"},body:(e,s)=>{let{rowIndex:t}=s;return(0,De.jsxs)(De.Fragment,{children:["#",t+1]})},header:"ID"}),(0,De.jsx)(le.V,{field:"type",style:{width:"150px"},header:"Reference",body:e=>{let s=e.type;return 2===s?(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,De.jsx)(G.A,{size:18}),(0,De.jsx)("span",{children:"Bank"})]}):1===s?(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,De.jsx)(Z.A,{size:18}),(0,De.jsx)("span",{children:"Cash"})]}):3===s?(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,De.jsx)(H.A,{size:18}),(0,De.jsx)("span",{children:"Strip"})]}):4===s?(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,De.jsx)(X.A,{size:18}),(0,De.jsx)("span",{children:"EFTPOS"})]}):void 0}}),(0,De.jsx)(le.V,{field:"deposit",style:{width:"210px",textAlign:"right"},body:e=>(0,De.jsxs)(De.Fragment,{children:["$",(0,xe.m)(null===e||void 0===e?void 0:e.deposit)]}),header:"Amount"}),(0,De.jsx)(le.V,{field:"manager.name",style:{width:"210px"},header:"Manager",body:e=>{var s,t;return(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,De.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden"},children:(0,De.jsx)("img",{src:null===e||void 0===e||null===(s=e.manager)||void 0===s?void 0:s.photo,style:{widows:"24px"}})}),(0,De.jsx)("span",{children:null===e||void 0===e||null===(t=e.manager)||void 0===t?void 0:t.name})]})}}),(0,De.jsx)(le.V,{field:"created",style:{width:"147px"},header:"Created at",body:e=>(0,De.jsx)("span",{children:t(null===e||void 0===e?void 0:e.created)})})]})]})})},Be=e=>{let{show:s,setShow:t,invoice:n,setRefetch:l}=e;const[o,a]=(0,i.useState)(!1),[d,h]=(0,i.useState)(0),[p,j]=(0,i.useState)(2),[f,y]=(0,i.useState)({}),g=[{icon:(0,De.jsx)(G.A,{size:20}),label:"Bank",value:2},{icon:(0,De.jsx)(Z.A,{size:20}),label:"Cash",value:1},{icon:(0,De.jsx)(X.A,{size:20}),label:"EFTPOS",value:4}],b=(0,c.n)({mutationFn:e=>(0,de.e0)(null===n||void 0===n?void 0:n.unique_id,e),onSuccess:()=>{t(!1),l((e=>!e)),v.oR.success("Partial payment is completed successfully.")},onError:e=>{console.error("Failed to payment:",e),v.oR.error("Failed to payment. Please try again.")}});return(0,i.useEffect)((()=>{y({}),h(0),j(2)}),[s]),(0,De.jsxs)(je.l,{visible:s,modal:!0,header:Ee,onHide:t,className:`${_e} custom-modal custom-scroll-integration`,children:[(0,De.jsx)(pe.A,{className:(0,x.A)(Ae,"mb-3"),children:(0,De.jsxs)(pe.A.Body,{children:[(0,De.jsx)("label",{children:"Select Payment Method"}),(0,De.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,De.jsxs)("div",{className:"d-flex flex-column pt-2",children:[(0,De.jsx)(be.J,{className:"rounded",value:p,onChange:e=>j(e.value),itemTemplate:e=>(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[e.icon,e.label]}),optionLabel:"label",options:g}),(null===f||void 0===f?void 0:f.type)&&(0,De.jsx)("p",{className:"error-message mb-0",children:"Payment type is required"})]}),(0,De.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,De.jsx)(r.N_,{to:`${null===n||void 0===n?void 0:n.invoice_url}`,target:"_blank",children:(0,De.jsx)(m.$,{className:"danger-outline-button px-3 py-2",children:(0,De.jsx)(L.A,{color:"#F04438",size:17})})}),(0,De.jsx)(r.N_,{to:`/invoice/${null===n||void 0===n?void 0:n.unique_id}`,target:"_blank",children:(0,De.jsx)(m.$,{className:"info-button px-3 py-2",children:(0,De.jsx)(ve.A,{color:"#158ECC",size:17})})})]})]})]})}),(0,De.jsx)(pe.A,{className:(0,x.A)(Ae,"mb-3"),children:(0,De.jsx)(pe.A.Body,{children:(0,De.jsxs)("div",{className:"d-flex justify-content-between gap-3 align-items-center",children:[(0,De.jsxs)("div",{className:"d-flex flex-column",children:[(0,De.jsx)("label",{className:"mb-2",children:"Enter Amount"}),(0,De.jsxs)(fe.C,{iconPosition:"left",children:[(0,De.jsx)(ye.m,{children:(0,De.jsx)("span",{style:{position:"relative",top:"-4px"},children:"$"})}),(0,De.jsx)(ge.Y,{value:d,onValueChange:e=>h(e.target.value||0),style:{width:"380px",paddingLeft:"30px",padding:"0px 16px"},className:(0,x.A)(we,{[Se]:null===f||void 0===f?void 0:f.deposit}),maxFractionDigits:2,minFractionDigits:2,placeholder:"0.00",inputId:"minmaxfraction"})]}),(null===f||void 0===f?void 0:f.deposit)&&(0,De.jsx)("p",{className:"error-message mb-0",children:"Payment type is required"})]}),(0,De.jsxs)("div",{className:(0,x.A)(Ce,"d-flex flex-column"),onClick:()=>h(parseFloat((null===n||void 0===n?void 0:n.amount)||0).toFixed(2)),children:[(0,De.jsx)("label",{children:"Total invoice"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.amount)||0)]})]}),(0,De.jsxs)("div",{className:(0,x.A)(Ce,"d-flex flex-column"),onClick:()=>h(parseFloat((null===n||void 0===n?void 0:n.to_be_paid)||0).toFixed(2)),children:[(0,De.jsx)("label",{children:"To Be Paid"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.to_be_paid)||0)]})]})]})})}),(0,De.jsx)(pe.A,{className:(0,x.A)(Ae,"mb-3"),children:(0,De.jsx)(pe.A.Body,{children:(0,De.jsxs)("div",{className:"d-flex justify-content-between gap-2 align-items-center",children:[(0,De.jsxs)("div",{className:(0,x.A)($e,"d-flex flex-column text-end"),children:[(0,De.jsx)("label",{children:"Budget"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.budget)||0)]})]}),(0,De.jsxs)("div",{className:(0,x.A)(Fe,"d-flex flex-column text-end"),children:[(0,De.jsx)("label",{children:"Real Cost"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.real_cost)||0)]})]}),(0,De.jsxs)("div",{className:(0,x.A)(Re,"d-flex flex-column text-end"),children:[(0,De.jsx)("label",{children:"Cost Of Sale"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.cost_of_sale)||0)]})]}),(0,De.jsxs)("div",{className:(0,x.A)(ke,"d-flex flex-column text-end"),children:[(0,De.jsx)("label",{children:"Labour"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.labor_expenses)||0)]})]}),(0,De.jsxs)("div",{className:(0,x.A)(ze,"d-flex flex-column text-end"),children:[(0,De.jsx)("label",{children:"Operational Profit"}),(0,De.jsxs)("h1",{className:(0,x.A)(Pe,"mt-2"),children:["$",(0,xe.m)((null===n||void 0===n?void 0:n.profit)||0)]})]})]})})}),(0,De.jsxs)(pe.A,{className:(0,x.A)(Ae,"mb-3"),children:[(0,De.jsxs)(pe.A.Body,{className:"d-flex justify-content-end gap-2",children:[(0,De.jsx)(m.$,{className:"outline-button",onClick:()=>t(!1),children:"Cancel"}),(0,De.jsxs)(m.$,{className:"success-button",disabled:null===b||void 0===b?void 0:b.isPending,onClick:()=>{let e=0;y({}),p||(e++,y((e=>({...e,type:!0})))),d||(e++,y((e=>({...e,deposit:!0})))),e||b.mutate({deposit:d,type:p})},children:["Submit Payment",(null===b||void 0===b?void 0:b.isPending)&&(0,De.jsx)(u.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]}),(0,De.jsx)("div",{className:"mb-2 text-center",style:{borderTop:".5px solid #F2F4F7"},children:(0,De.jsxs)(m.$,{className:"text-button m-auto",onClick:()=>a(!o),children:[o?"Hide":"Show"," History"]})})]}),o&&(0,De.jsx)(Te,{history:(null===n||void 0===n?void 0:n.billing_history)||[]})]})};var qe=t(46632),We=t(93747),Le=t(59638),Oe=t(81242);const Ve=e=>{var s;let{projectId:t,clientId:n,isAction:l}=e;const[o,a]=(0,i.useState)(!1),[d,r]=(0,i.useState)({}),x=(0,We.I)({queryKey:["id",n],queryFn:()=>(0,Le.EZ)(n),enabled:!!n&&!!o,retry:1}),h=(0,c.n)({mutationFn:e=>(0,de.LG)(t,e),onSuccess:()=>{a(!1),v.oR.success("Reminder email sent successfully.")},onError:e=>{console.error("Error sending email:",e),v.oR.error("Failed to send reminder email. Please try again.")}});return(0,De.jsxs)(De.Fragment,{children:[l?(0,De.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:()=>a(!0),children:[(0,De.jsx)(qe.A,{color:"#667085",size:20}),(0,De.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Send Reminder"})]}):(0,De.jsx)(m.$,{label:"Resend",style:{position:"static"},onClick:()=>a(!0),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0}),(0,De.jsx)(Oe.A,{show:o,setShow:a,setPayload:r,mutation:h,contactPersons:(null===x||void 0===x||null===(s=x.data)||void 0===s?void 0:s.contact_persons)||[],projectCardData:()=>{},defaultTemplateId:"Resend Invoice"})]})},Me=e=>{var s;let{projectId:t,clientId:l,isAction:o}=e;const[a,d]=(0,i.useState)(!1),[r,x]=(0,i.useState)({}),h=(0,We.I)({queryKey:["id",l],queryFn:()=>(0,Le.EZ)(l),enabled:!!l&&!!a,retry:1}),u=(0,c.n)({mutationFn:e=>(0,de.LG)(t,e),onSuccess:()=>{d(!1),v.oR.success("Email sent successfully.")},onError:e=>{console.error("Error sending email:",e),v.oR.error("Failed to resent email. Please try again.")}});return(0,De.jsxs)(De.Fragment,{children:[o?(0,De.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:()=>d(!0),children:[(0,De.jsx)(n.A,{color:"#667085",size:20}),(0,De.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Send Invoice"})]}):(0,De.jsx)(m.$,{label:"Resend",style:{position:"static"},onClick:()=>d(!0),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0}),(0,De.jsx)(Oe.A,{show:a,setShow:d,setPayload:x,mutation:u,contactPersons:(null===h||void 0===h||null===(s=h.data)||void 0===s?void 0:s.contact_persons)||[],projectCardData:()=>{},defaultTemplateId:"Invoice"})]})},He=e=>{try{const s=new Date(1e3*e),t=s.getDate(),i=new Intl.DateTimeFormat("en-US",{month:"short"}).format(s);return`${t} ${i} ${s.getFullYear()}`}catch(s){return console.log("error: ",s),""}},Ue=(0,i.forwardRef)(((e,s)=>{let{searchValue:t,setTotal:n,setTotalMoney:l,selected:o,setSelected:a,isShowDeleted:d,refetch:h,setRefetch:p}=e;const j=(0,i.useRef)(null),f=(0,se.Zp)(),{trialHeight:y}=(0,ce.$)(),[g,b]=(0,i.useState)([]),[A,E]=(0,i.useState)(1),[B,q]=(0,i.useState)({sortField:"number",sortOrder:-1}),[pe,ve]=(0,i.useState)({sortField:"number",sortOrder:-1}),[je,fe]=(0,i.useState)(!0),[ye,ge]=(0,i.useState)(!1),[be,_e]=(0,i.useState)(!1),[Ne,Ae]=(0,i.useState)(null);(0,i.useEffect)((()=>{E(1)}),[t,h,d]),(0,i.useEffect)((()=>{(async()=>{ge(!0);let e="";1===(null===pe||void 0===pe?void 0:pe.sortOrder)?e=`${pe.sortField}`:-1===(null===pe||void 0===pe?void 0:pe.sortOrder)&&(e=`-${pe.sortField}`);const s=await(0,de.DX)(A,25,t,e,d);var i;(n((()=>(null===s||void 0===s?void 0:s.count)||0)),l((null===s||void 0===s?void 0:s.total_amount)||0),1===A)?b(s.results):(null===s||void 0===s||null===(i=s.results)||void 0===i?void 0:i.length)>0&&b((e=>{const t=new Set(e.map((e=>e.id))),i=s.results.filter((e=>!t.has(e.id)));return[...e,...i]}));q(pe),fe(s.count!==g.length),ge(!1)})()}),[A,t,pe,h,d]),(0,i.useEffect)((()=>{if(g.length>0&&je){j.current=new IntersectionObserver((e=>{e[0].isIntersecting&&E((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&j.current.observe(e)}return()=>{j.current&&j.current.disconnect()}}),[g,je]);const we=(0,c.n)({mutationFn:e=>(0,de.r$)(e),onSuccess:()=>{v.oR.success("Invoice deleted successfully"),we.reset(),p(!h)},onError:e=>{we.reset(),console.log("error: ",e),v.oR.error("Failed to delete invoice. Please try again.")}}),Se=(0,c.n)({mutationFn:e=>(0,re.CK)(e),onSuccess:()=>{v.oR.success("Project has been successfully duplicated"),Se.reset(),f("/sales")},onError:e=>{we.reset(),console.log("error: ",e),v.oR.error("Failed to duplicate project. Please try again.")}});return(0,De.jsxs)(De.Fragment,{children:[(0,De.jsxs)(oe.b,{ref:s,value:g,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${y}px)`,className:"border",selection:o,onSelectionChange:e=>a(e.value),loading:ye,loadingIcon:me.A,emptyMessage:(0,De.jsx)(ue.A,{isDataExist:!!t||!!d}),sortField:null===B||void 0===B?void 0:B.sortField,sortOrder:null===B||void 0===B?void 0:B.sortOrder,onSort:e=>{const{sortField:s,sortOrder:t}=e;ve({sortField:s,sortOrder:t}),E(1)},rowClassName:e=>null!==e&&void 0!==e&&e.deleted?w:null!==e&&void 0!==e&&e.paid?S:"partial_payment"===(null===e||void 0===e?void 0:e.payment_status)?$:C,children:[(0,De.jsx)(le.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,De.jsx)(le.V,{field:"number",header:"Invoice ID",body:e=>(0,De.jsxs)("div",{className:"d-flex align-items-center gap-2 justify-content-between show-on-hover",children:[(0,De.jsx)("span",{children:e.number}),(0,De.jsx)(m.$,{label:"Open",onClick:()=>f(`/management?unique_id=${e.unique_id}&reference=${null===e||void 0===e?void 0:e.reference}&number=${null===e||void 0===e?void 0:e.number}`),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),headerClassName:"paddingLeftHide",bodyClassName:"paddingLeftHide",style:{minWidth:"100px"},frozen:!0,sortable:!0}),(0,De.jsx)(le.V,{field:"",header:"Invoice",body:e=>(0,De.jsxs)("div",{className:"d-flex align-items-center justify-content-around",children:[(0,De.jsx)(r.N_,{to:`${null===e||void 0===e?void 0:e.invoice_url}`,target:"_blank",children:(0,De.jsx)(L.A,{color:"#FF0000",size:16})}),(0,De.jsx)(r.N_,{to:`/invoice/${e.unique_id}`,target:"_blank",children:(0,De.jsx)(O.A,{color:"#3366CC",size:16})})]}),style:{minWidth:"114px"},frozen:!0}),(0,De.jsx)(le.V,{field:"client.name",header:"Customer A\u2192Z",body:e=>{var s,t,i,n;return(0,De.jsxs)("div",{className:"d-flex align-items-center",children:[(0,De.jsx)(he.h,{has_photo:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.has_photo,photo:null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.photo,is_business:null===e||void 0===e||null===(i=e.client)||void 0===i?void 0:i.is_business}),(0,De.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,De.jsx)("div",{className:`${_}`,children:null===(n=e.client)||void 0===n?void 0:n.name}),e.deleted?(0,De.jsx)(ae.v,{value:"Deleted",style:{height:"22px",width:"59px",borderRadius:"16px",border:"1px solid #FECDCA",background:"#FEF3F2",color:"#912018",fontSize:"12px",fontWeight:500}}):""]})]})},headerClassName:"shadowRight",bodyClassName:"shadowRight",style:{minWidth:"224px"},frozen:!0,sortable:!0}),(0,De.jsx)(le.V,{field:"created",header:"Created on",body:e=>He(e.created),style:{minWidth:"56px"},className:"text-center",sortable:!0}),(0,De.jsx)(le.V,{field:"due_date",header:"Due Date",body:e=>{var s;return(0,De.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-2 show-on-hover",style:{color:"#98A2B3"},children:[e.paid?(0,De.jsxs)("div",{className:`${I} ${N}`,children:[(0,De.jsx)(ne.E,{severity:"success"})," Paid"]}):(0,De.jsxs)("div",{className:`${I} ${D}`,children:["Overdue ",e.overdue," days ",(0,De.jsx)(ne.E,{severity:"danger"})]}),He(e.due_date),(0,De.jsx)(Ve,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.id,isAction:!1})]})},style:{minWidth:"56px"},className:"text-center",sortable:!0}),(0,De.jsx)(le.V,{field:"amount",header:"Amount + GST",body:e=>(0,De.jsx)("div",{className:`d-flex align-items-center justify-content-end ${F}`,children:(0,De.jsxs)("div",{className:"text-dark",children:["$",(0,xe.m)(null===e||void 0===e?void 0:e.amount)]})}),style:{minWidth:"56px",textAlign:"end"}}),(0,De.jsx)(le.V,{field:"to_be_paid",header:"To be paid",body:e=>(0,De.jsx)("div",{className:`d-flex align-items-center justify-content-end show-on-hover ${F}`,children:(0,De.jsxs)("div",{className:"text-dark",children:["$",(0,xe.m)(null===e||void 0===e?void 0:e.to_be_paid)]})}),style:{minWidth:"123px",textAlign:"right"},sortable:!0}),(0,De.jsx)(le.V,{field:"deposit",header:"Deposit/Payment",body:e=>(0,De.jsx)("div",{className:`d-flex align-items-center justify-content-end ${F}`,style:{position:"static"},children:(0,De.jsxs)("div",{className:`${"paid"===e.payment_status?R:"not_paid"!==e.payment_status?z:P}`,children:["$",(0,xe.m)(e.deposit),(0,De.jsx)("span",{onClick:()=>{_e(!0),Ae(e)},className:(0,x.A)(k,"cursor-pointer"),style:{position:"relative",marginLeft:"10px",paddingLeft:"5px"},children:(0,De.jsx)(V.A,{size:12,color:"#079455"})})]})}),style:{minWidth:"114px",textAlign:"left"},sortable:!0}),(0,De.jsx)(le.V,{field:"total_requests",header:"Info",body:e=>{const s=(0,i.useRef)(null),[t,n]=(0,i.useState)(!1),l=(0,te.k)(t,n);return(0,De.jsxs)(i.Fragment,{children:[(0,De.jsx)(M.A,{color:"#667085",size:18,className:"cursor-pointer",ref:s,...l}),(0,De.jsx)("div",{className:"fixedMenu",style:{position:"fixed",top:"40%",left:"40%"},children:(0,De.jsxs)(ie.k,{state:t?"open":"closed",anchorRef:s,onClose:()=>n(!1),menuStyle:{padding:"24px 24px 20px 24px",width:"555px",marginTop:"45px",maxHeight:"100%"},children:[(0,De.jsxs)("div",{className:"d-flex justify-content-between mb-4",children:[(0,De.jsx)("div",{className:"BoxNo",children:(0,De.jsx)("div",{children:(0,De.jsx)(M.A,{color:"#FFFFFF",size:24})})}),(0,De.jsx)(W.A,{onClick:()=>n(!1)})]}),(0,De.jsx)("div",{style:{width:"100%",maxHeight:"500px",overflow:"auto"},children:null===e||void 0===e?void 0:e.billing_history.map(((s,t)=>{var i,n,l;return(0,De.jsxs)("div",{className:"d-flex gap-4 border justify-content-start py-1 px-2 rounded mb-2",style:{width:"fit-content"},children:[(0,De.jsx)("div",{className:"d-flex align-items-center",children:0===(null===s||void 0===s?void 0:s.type)?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("div",{className:"d-flex justify-content-center align-items-center rounded-circle",style:{width:"24px",height:"24px",background:"linear-gradient(180deg, #f9fafb 0%, #edf0f3 100%)",marginRight:"10px"},children:(0,De.jsx)(H.A,{size:14,color:"#98A2B3"})}),(0,De.jsx)("div",{className:"font-14 ellipsis-width text-start",style:{width:"120px",maxWidth:"120px"},children:"Strip"})]}):(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)(he.h,{has_photo:null===s||void 0===s||null===(i=s.manager)||void 0===i?void 0:i.has_photo,photo:null===s||void 0===s||null===(n=s.manager)||void 0===n?void 0:n.photo,is_business:!1}),(0,De.jsx)("div",{className:"font-14 ellipsis-width text-start",style:{width:"120px",maxWidth:"120px"},children:null===s||void 0===s||null===(l=s.manager)||void 0===l?void 0:l.name})]})}),(0,De.jsxs)("div",{className:"d-flex gap-2 align-items-center justify-content-start",children:[(0,De.jsx)(U.A,{color:"#98A2B3",size:14}),(0,De.jsxs)("span",{style:{fontWeight:600,fontSize:16},children:["$",(0,xe.m)(s.deposit)]})]}),(0,De.jsxs)("div",{className:"d-flex gap-2 align-items-center justify-content-start",children:[2===(null===s||void 0===s?void 0:s.type)?(0,De.jsx)(G.A,{size:14,color:"#98A2B3"}):1===s.type?(0,De.jsx)(Z.A,{size:14,color:"#98A2B3"}):4===s.type?(0,De.jsx)(X.A,{size:14,color:"#98A2B3"}):(0,De.jsx)(H.A,{size:14,color:"#98A2B3"}),(0,De.jsx)("div",{className:"border rounded font-12 px-1",children:2===(null===s||void 0===s?void 0:s.type)?"Bank":1===s.type?"Cash":4===s.type?"EFTPOS":"Strip"})]}),(0,De.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,De.jsx)(Y.A,{color:"#98A2B3",size:14}),(0,De.jsx)("div",{className:"font-14",children:He(s.created)})]})]},e.unique_id+t)}))}),e.paid?(0,De.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#ECFDF3"},children:(0,De.jsx)("span",{className:"font-14",style:{color:"#17B26A"},children:"Invoice Paid"})}):"partial_payment"===e.payment_status?(0,De.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#fffaeb"},children:(0,De.jsx)("span",{className:"font-14",style:{color:"#b54708"},children:"Invoice Partialy Paid"})}):(0,De.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#FEF3F2"},children:(0,De.jsx)("span",{className:"font-14",style:{color:"#B42318"},children:"Invoice Due"})})]})})]})},style:{minWidth:"89px",maxWidth:"89px",width:"89px",textAlign:"center"},sortable:!0}),(0,De.jsx)(le.V,{field:"xero",header:"Xero/Myob",body:e=>(0,De.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:"in_progress"===(null===e||void 0===e?void 0:e.xero_status)?(0,De.jsx)("span",{style:{color:"#158ECC"},className:T,children:"xero"}):"completed"===(null===e||void 0===e?void 0:e.xero_status)?(0,De.jsx)("span",{style:{color:"#158ECC"},children:"xero"}):(0,De.jsx)("span",{})}),style:{minWidth:"120px",maxWidth:"120px",width:"120px",textAlign:"center"},sortable:!0}),(0,De.jsx)(le.V,{field:"paid",header:"Actions",body:e=>{var s,t;const n=(0,i.useRef)(null),[l,o]=(0,i.useState)(!1),a=(0,te.k)(l,o);return(0,De.jsxs)(i.Fragment,{children:[(0,De.jsx)(K.A,{size:24,color:"#667085",className:"cursor-pointer",ref:n,...a}),(0,De.jsx)(ie.k,{state:l?"open":"closed",anchorRef:n,onClose:()=>o(!1),className:"threeDots",menuStyle:{padding:"4px",width:"241px",textAlign:"left"},children:(0,De.jsxs)("div",{className:"d-flex flex-column gap-2",children:[(0,De.jsx)(Me,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.id,isAction:!0}),(0,De.jsx)(Ve,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.id,isAction:!0}),(0,De.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:async()=>{await Se.mutateAsync(e.unique_id),o(!1)},children:[(0,De.jsx)(Q.A,{color:"#667085",size:20}),(0,De.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Duplicate project"}),(null===Se||void 0===Se?void 0:Se.variables)===e.unique_id?(0,De.jsx)(u.p,{style:{width:"20px",height:"20px"}}):""]}),(0,De.jsxs)("div",{className:"d-flex align-items-center gap-3 hover-greay px-2 py-2",style:{opacity:.5},children:[(0,De.jsx)(J.A,{color:"#667085",size:20}),(0,De.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Create credit note"})]}),(0,De.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:async()=>{await we.mutateAsync(e.unique_id),o(!1)},children:[(0,De.jsx)(ee.A,{color:"#B42318",size:20}),(0,De.jsx)("span",{style:{color:"#B42318",fontSize:"16px",fontWeight:500},children:"Delete invoice"}),(null===we||void 0===we?void 0:we.variables)===e.unique_id?(0,De.jsx)(u.p,{style:{width:"20px",height:"20px"}}):""]})]})})]})},style:{minWidth:"75px",maxWidth:"75px",width:"75px",textAlign:"center"},bodyStyle:{color:"#667085"}})]}),(0,De.jsx)(Be,{show:be,setShow:()=>_e(!1),setRefetch:p,invoice:Ne})]})})),Ge=Ue;var Ze=t(10586),Xe=t(62284);const Ye=()=>{const e=(0,i.useRef)(null),s=(0,i.useRef)(null),[t]=(0,r.ok)(),_=t.get("isShowUnpaid"),[w,S]=(0,i.useState)(0),[C,$]=(0,i.useState)(0),[F,R]=(0,i.useState)(!1),[k,z]=(0,i.useState)(!1),[P,I]=(0,i.useState)(!!_),[D,T]=(0,i.useState)(null),[W,L,O]=(0,h.d7)("",400),V=((0,c.n)({mutationFn:e=>(0,Ze.D3)(e),onSuccess:()=>{z((e=>!e)),T(null),v.oR.success("Expenses have been successfully marked as paid.")},onError:e=>{console.log("error: ",e),v.oR.error("Failed to mark the expenses as paid. Please try again.")}}),(0,c.n)({mutationFn:e=>(0,de.rf)(e),onSuccess:()=>{z((e=>!e)),T(null),v.oR.success("Invoice successfully sent to Xero!")},onError:e=>{console.log("error: ",e),v.oR.error("Failed to send the invoice to xero. Please try again.")}}));return(0,De.jsxs)("div",{className:"peoples-page",children:[(0,De.jsx)(d.mg,{children:(0,De.jsx)("title",{children:"MeMate - Invoices"})}),(0,De.jsxs)("div",{className:`topbar ${null!==D&&void 0!==D&&D.length?N:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,De.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==D&&void 0!==D&&D.length?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsxs)("h6",{className:A,children:["Selected: ",null===D||void 0===D?void 0:D.length]}),(0,De.jsxs)("div",{className:"filtered-box d-flex align-items-center gap-2",children:[(0,De.jsxs)("button",{className:`outline-button ${E}`,disabled:V.isPending,onClick:()=>{const e=D.map((e=>e.unique_id));V.mutate({ids:e})},children:["Send to Xero/MYOB",V.isPending?(0,De.jsx)(u.p,{style:{width:"20px",height:"20px"}}):(0,De.jsx)(n.A,{color:"#1D2939",size:20})]}),(0,De.jsx)("button",{className:`${j}`,onClick:()=>{return s=!0,void(e.current?e.current.exportCSV({selectionOnly:s}):console.error("DataTable ref is null"));var s},children:(0,De.jsx)(l.A,{})}),(0,De.jsx)("button",{className:`${j}`,onClick:()=>{},children:(0,De.jsx)(o.A,{})})]})]}):(0,De.jsxs)(De.Fragment,{children:[(0,De.jsxs)("div",{className:"filtered-box",children:[(0,De.jsx)("button",{className:`${j}`,children:(0,De.jsx)(a.A,{})}),(0,De.jsx)(p.b,{model:[],className:(0,x.A)(f),popup:!0,ref:s,breakpoint:"767px"})]}),(0,De.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,De.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,De.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,De.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,De.jsx)("input",{type:"text",placeholder:"Search",value:W,onChange:e=>O(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})}),(0,De.jsx)("div",{className:"featureName d-flex align-items-center",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,De.jsx)("h1",{className:"title p-0",children:"Invoices"})}),(0,De.jsxs)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:[(0,De.jsx)(m.$,{className:P?q:B,onClick:()=>{I(!P),"true"===_&&P&&window.history.pushState({},"","/invoices")},children:"Unpaid"}),P&&(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("h1",{className:`${y} mb-0`,children:"Total"}),(0,De.jsxs)("div",{className:`${g}`,children:[w," Invoice"]}),(0,De.jsxs)("h1",{className:b,children:["$",(0,xe.m)(C||0)]})]})]})]}),(0,De.jsx)(Ge,{ref:e,searchValue:L,setTotal:S,setTotalMoney:$,selected:D,setSelected:T,isShowDeleted:P,refetch:k,setRefetch:z}),(0,De.jsx)(Xe.A,{visible:F,setVisible:R,setRefetch:z})]})}}}]);
//# sourceMappingURL=9407.84e99ca1.chunk.js.map