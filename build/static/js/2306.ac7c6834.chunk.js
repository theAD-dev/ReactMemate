"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[2306,6731],{568:(e,t,s)=>{s.d(t,{J:()=>n});const n=Object.freeze({CLIENTS:{CREATE:"CREATE_CLIENT",READ:"READ_CLIENT",UPDATE:"UPDATE_CLIENT",DELETE:"DELETE_CLIENT"},SUPPLIERS:{CREATE:"CREATE_SUPPLIER",READ:"READ_SUPPLIER",UPDATE:"UPDATE_SUPPLIER",DELETE:"DELETE_SUPPLIER"},SALES:{},MANAGEMENT:{},PROJECTS:{},STATISTIC:{},EXPENSE:{CREATE:"CREATE_EXPENSE",READ:"READ_EXPENSE",UPDATE:"UPDATE_EXPENSE",DELETE:"DELETE_EXPENSE"},INVOICE:{CREATE:"CREATE_INVOICE",READ:"READ_INVOICE",UPDATE:"UPDATE_INVOICE",DELETE:"DELETE_INVOICE"},SETTINGS:{SUBSCRIPTION:{BUY_BUSINESS_SUBSCRIPTION:"BUY_BUSINESS_SUBSCRIPTION",CANCEL_BUSINESS_SUBSCRIPTION:"CANCEL_BUSINESS_SUBSCRIPTION",BUY_COMPANY_USER_SUBSCRIPTION:"BUY_COMPANY_USER_SUBSCRIPTION",BUY_WORK_SUBSCRIPTION:"BUY_WORK_SUBSCRIPTION",CANCEL_WORK_SUBSCRIPTION:"CANCEL_WORK_SUBSCRIPTION",ACTIVE_WORK_SUBSCRIPTION:"ACTIVE_WORK_SUBSCRIPTION",BUY_WORK_USER_SUBSCRIPTION:"BUY_WORK_USER_SUBSCRIPTION",BUY_LOCATION_SUBSCRIPTION:"BUY_LOCATION_SUBSCRIPTION",REMOVE_LOCATION_SUBSCRIPTION:"REMOVE_LOCATION_SUBSCRIPTION",ACTIVE_INQUIRIES_SUBSCRIPTION:"ACTIVE_INQUIRIES_SUBSCRIPTION",CANCEL_INQUIRIES_SUBSCRIPTION:"CANCEL_INQUIRIES_SUBSCRIPTION",ACTIVE_ASSETS_SUBSCRIPTION:"ACTIVE_ASSETS_SUBSCRIPTION",CANCEL_ASSETS_SUBSCRIPTION:"CANCEL_ASSETS_SUBSCRIPTION",MANAGE_ASSET_SUBSCRIPTION:"MANAGE_ASSET_SUBSCRIPTION"},USERS:{MOBILE_APP:{ADD:"ADD_USER",READ:"READ_USER",UPDATE:"UPDATE_USER",DISCONNECT_USER:"DISCONNECT_USER",RECONNECT_USER:"RECONNECT_USER",SHOW_DISCONNECTED_USERS:"SHOW_DISCONNECTED_USERS"},DESKTOP:{ADD:"ADD_USER",READ:"READ_USER",DELETE:"DELETE_USER",UPDATE:"UPDATE_USER",RESTORE:"RESTORE_USER",SHOW_DELETED_USERS:"SHOW_DELETED_USERS"}},LOCATION:{ADD:"ADD_LOCATION",READ:"READ_LOCATION",UPDATE:"UPDATE_LOCATION",DELETE:"DELETE_LOCATION"}}})},36166:(e,t,s)=>{s.d(t,{DX:()=>l,H2:()=>r,LG:()=>u,RC:()=>a,Y4:()=>o,de:()=>h,e0:()=>p,ml:()=>c,os:()=>m,r$:()=>d,rf:()=>x});var n=s(31342);const i="https://app.memate.com.au/api/v1",l=async function(e,t){var s;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;const d=(e-1)*t,c=new URL(`${i}/invoices/`);c.searchParams.append("limit",t),c.searchParams.append("offset",d),l&&c.searchParams.append("search",l),o&&c.searchParams.append("ordering",o),a&&c.searchParams.append("status","not_paid");let u="";var p;null!==r&&void 0!==r&&r.client&&(u=null===r||void 0===r||null===(p=r.client)||void 0===p?void 0:p.map((e=>e.id)).join(","));u&&c.searchParams.append("clients",u);let x="";var h;null!==r&&void 0!==r&&r.status&&1===(null===r||void 0===r||null===(s=r.status)||void 0===s?void 0:s.length)&&(null===r||void 0===r||null===(h=r.status)||void 0===h||h.forEach((e=>{"Paid"===(null===e||void 0===e?void 0:e.name)?x="paid":"Not Paid"===(null===e||void 0===e?void 0:e.name)&&(x="not_paid")})));if(x&&c.searchParams.append("status",x),null!==r&&void 0!==r&&r.date){var m,v,S,j;const e=null===r||void 0===r||null===(m=r.date[0])||void 0===m||null===(v=m.value)||void 0===v?void 0:v[0];if(e){const t=new Date(e),s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");c.searchParams.append("create_date_after",`${s}-${n}-${i}`)}const t=null===r||void 0===r||null===(S=r.date[0])||void 0===S||null===(j=S.value)||void 0===j?void 0:j[1];if(t){const e=new Date(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");c.searchParams.append("create_date_before",`${s}-${n}-${i}`)}}return(0,n.f)(c.toString(),{method:"GET"})},o=async e=>{const t=new URL(`${i}${`/invoices/view/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"},!1)},a=async e=>{if(!e)return null;const t=new URL(`${i}${`/invoices/read/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},r=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/invoices/payment-intent/${e}/`}`);return(0,n.f)(l.toString(),s,!1)},d=async e=>{const t=new URL(`${i}${`/invoices/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},c=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/invoices/send/${e}/`}`);return(0,n.f)(l.toString(),s)},u=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/resend/invoice/${e}/`}`);return(0,n.f)(l.toString(),s)},p=async(e,t)=>{const s={method:"POST",body:t},l=new URL(`${i}${`/invoices/partial-payment/${e}/`}`);return(0,n.f)(l.toString(),s)},x=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/invoices/to-xero/`);return(0,n.f)(s.toString(),t)},h=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/pay/`}`);return(0,n.f)(t.toString(),{method:"POST"})},m=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/unpay/`}`);return(0,n.f)(t.toString(),{method:"POST"})}},54929:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$t});var n=s(65043),i=s(18091),l=s(75329),o=s(25725),a=s(49367),r=s(35475),d=s(47097),c=s(72018),u=s(2028),p=s(93740),x=s(56328);const h="invoice_filterBox__36jYC",m="invoice_total__9UXKw",v="invoice_totalCount__5pnjp",S="invoice_totalMoney__B+H00",j="invoice_ellipsis__MToPC",f="invoice_active__g3Bt5",_="invoice_selectedCount__5R4mY",g="invoice_deletedRow__iZM+L",E="invoice_fontStanderdSize__sKilw",N="invoice_paid__8CgVs",y="invoice_unpaid__HNSOb",b="invoice_partialPaid__YSX48",I="invoice_status__Zlf8W",T="invoice_inactive__mkKPg",A="invoice_actionButton__vFx0E",C="invoice_shakeText__KJ+lD",R="invoice_allInvoice__T+ods",w="invoice_unpaidInvoice__qngZ9",P="invoice_payInvoiceButton__AoSIv",O="invoice_onHover__Gg9HO",D="invoice_normal__DF2W5";var $=s(85632),U=s(52572),F=s(72413),B=s(94673),L=s(77918),k=s(15228),z=s(19916),W=s(45463),M=s(70882),G=s(49095),J=s(17707),V=s(50565),H=s(88578),q=s(73728),Y=s(94819),K=s(73216),X=s(90688),Z=s(88120),Q=s(58387),ee=s(20092),te=s(9642),se=s(64824),ne=s(76104),ie=s(36166),le=s(67046),oe=s(57189),ae=s(48417),re=s(568),de=s(74737),ce=s(14834),ue=s(27734),pe=s(54967),xe=s(99868),he=s(13846),me=s(36097),ve=s(10615),Se=s(93257),je=s(71807),fe=s(22927),_e=s(27066),ge=s(33361),Ee=s(87677),Ne=s(64967),ye=s(99832),be=s(93202),Ie=s(70836),Te=s(28261),Ae=s(55797),Ce=s(28676),Re=s(74532),we=s(79255),Pe=s(59690);const Oe="invoice-partial-payment_modal__Dbqcb",De="invoice-partial-payment_modalHeader__O5yS9",$e="invoice-partial-payment_border__Iepxr",Ue="invoice-partial-payment_inputText__CTim0",Fe="invoice-partial-payment_error__RZeCG",Be="invoice-partial-payment_box__r-bzO",Le="invoice-partial-payment_box3__1L6cb",ke="invoice-partial-payment_box4__Hfap-",ze="invoice-partial-payment_box5__6Wn2j",We="invoice-partial-payment_box6__cjGiq",Me="invoice-partial-payment_box8__e1Nzw",Ge="invoice-partial-payment_box7__fQGnQ",Je="invoice-partial-payment_text__vazCt",Ve="invoice-partial-payment_activeTextButton__dpbiX",He="invoice-partial-payment_deactiveTextButton__EpTHf";var qe=s(58027),Ye=s(63965),Ke=s(70579);const Xe=(0,Ke.jsx)("div",{className:`${De}`,children:(0,Ke.jsx)("div",{className:"d-flex align-items-center gap-2",children:"Confirm Payment"})}),Ze={quote:{icon:(0,Ke.jsx)(je.A,{size:16,color:"#1AB2FF"}),label:"Quote"},invoice:{icon:(0,Ke.jsx)(fe.A,{size:16,color:"#1AB2FF"}),label:"Invoice"},note:{icon:(0,Ke.jsx)(_e.A,{size:16,color:"#1AB2FF"}),label:"Note"},email:{icon:(0,Ke.jsx)(ge.A,{size:16,color:"#1AB2FF"}),label:"Email"},job:{icon:(0,Ke.jsx)(Ee.A,{size:16,color:"#1AB2FF"}),label:"Job"},expense:{icon:(0,Ke.jsx)(Ne.A,{size:16,color:"#1AB2FF"}),label:"Expense"},task:{icon:(0,Ke.jsx)(ye.A,{size:16,color:"#1AB2FF"}),label:"Task"},billing:{icon:(0,Ke.jsx)(W.A,{size:16,color:"#1AB2FF"}),label:"Billing"}},Qe=e=>{var t,s;let{emailData:n}=e;const i=(null===n||void 0===n?void 0:n.split("\n"))||[],l=(null===(t=i.find((e=>e.startsWith("Subject:"))))||void 0===t?void 0:t.replace("Subject: ",""))||"",o=(null===(s=i.find((e=>e.startsWith("Recipient(s):"))))||void 0===s?void 0:s.replace("Recipient(s): ",""))||"",a=i.find((e=>e.startsWith("Body:"))),r=a?a.replace("Body:",""):"";return(0,Ke.jsxs)("div",{className:"d-flex flex-column gap-1",children:[l&&(0,Ke.jsxs)("span",{children:[(0,Ke.jsx)("strong",{children:"Subject:"})," ",l]}),o&&(0,Ke.jsxs)("span",{children:[(0,Ke.jsx)("strong",{children:"To:"})," ",o]}),r&&(0,Ke.jsxs)("span",{children:[(0,Ke.jsx)("strong",{children:"Body:"})," ",r]})]})},et=e=>{const t=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(t)} | ${`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}`},tt=e=>{let{history:t,projectId:s}=e;const i=(0,n.useMemo)((()=>null!==t&&void 0!==t&&t.length?[...t].sort(((e,t)=>parseInt(t.created)-parseInt(e.created))):[]),[t]),l=["quote","invoice","note","email","task","billing","job","expense"],o=(e,t,n)=>Ze[e]&&l.includes(e)?(0,Ke.jsx)("ul",{children:(0,Ke.jsx)("li",{children:"quote"===e?(0,Ke.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Ke.jsx)(je.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Quote \xa0"}),"\xa0",(null===t||void 0===t?void 0:t.quote_pdf)&&(0,Ke.jsx)(r.N_,{to:`${(null===t||void 0===t?void 0:t.quote_pdf)||"#"}`,target:"_blank",children:(0,Ke.jsx)(U.A,{color:"#FF0000",size:14})}),"\xa0\xa0",s&&"Quote Created"===n&&(0,Ke.jsx)(r.N_,{to:`/quote/${s}`,target:"_blank",children:(0,Ke.jsx)(F.A,{color:"#3366CC",size:16})})]}):"task"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(ye.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Task"})]}):"note"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(_e.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Note"})]}):"invoice"===e?(0,Ke.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Ke.jsx)(fe.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Invoice\xa0"}),"\xa0",(null===t||void 0===t?void 0:t.invoice_pdf)&&(0,Ke.jsx)(r.N_,{to:`${(null===t||void 0===t?void 0:t.invoice_pdf)||"#"}`,target:"_blank",children:(0,Ke.jsx)(U.A,{color:"#FF0000",size:14})}),"\xa0\xa0",s&&"Invoice Created"===n&&(0,Ke.jsx)(r.N_,{to:`/invoice/${s}`,target:"_blank",children:(0,Ke.jsx)(F.A,{color:"#3366CC",size:16})})]}):"billing"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(W.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Billing"})]}):"email"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(ge.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Email"})]}):"job"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(Ee.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Job"})]}):"expense"===e?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(Ne.A,{size:16,color:"#1AB2FF"})," ",(0,Ke.jsx)("strong",{children:"\xa0 Expense"})]}):null})}):null;return(0,Ke.jsx)(he.A,{className:(0,Q.A)($e,"mb-3 mt-2"),children:(0,Ke.jsxs)(he.A.Body,{children:[(0,Ke.jsx)("h3",{className:"projectHistoryTitle",style:{fontSize:"16px",fontWeight:600,marginBottom:"16px"},children:"History"}),(0,Ke.jsx)("div",{className:"projectHistoryScroll",style:{maxHeight:"400px",overflowY:"auto"},children:null!==i&&void 0!==i&&i.length?i.map(((e,t)=>{let{type:s,text:n,title:i,created:l,manager:a,links:r}=e;return(0,Ke.jsxs)("div",{className:"projectHistorygroup",children:[o(s,r,i),(0,Ke.jsx)("h5",{style:{whiteSpace:"pre-line"},children:"email"!==s&&i||""}),"email"===s?(0,Ke.jsx)(Qe,{emailData:n}):(0,Ke.jsx)("h6",{style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:n}}),(0,Ke.jsxs)("p",{children:[et(l)," by ",a]})]},`history-${t}`)})):(0,Ke.jsx)("p",{className:"text-center text-muted",children:"No history available"})})]})})},st=e=>{let{calculations:t,invoice:s}=e;return console.log("invoice: ",s),(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsxs)(se.b,{value:t||[],showGridlines:!0,className:"border-top",children:[(0,Ke.jsx)(te.V,{field:"id",header:"Order",bodyClassName:"text-center",headerClassName:"text-center",style:{width:"60px"},body:(e,t)=>t.rowIndex+1}),(0,Ke.jsx)(te.V,{field:"subindex",header:"Department",style:{minWidth:"192px"},body:e=>(0,Ke.jsx)("div",{className:"ellipsis-width",title:e.subindex,style:{maxWidth:"192px"},children:e.subindex})}),(0,Ke.jsx)(te.V,{field:"description",header:"Description",style:{minWidth:"300px"},bodyClassName:"ellipsis-width",body:e=>(0,Ke.jsx)("div",{className:"ellipsis-width",title:e.description,style:{maxWidth:"300px"},children:e.description})}),(0,Ke.jsx)(te.V,{field:"cost",header:"Cost",style:{width:"100%"},body:e=>`$${(0,ce.m)(e.cost)}`}),(0,Ke.jsx)(te.V,{field:"profit_type_value",header:"Markup/Margin",body:e=>`${e.profit_type_value} ${"AMN"===e.profit_type?"AMT $":"MRG"===e.profit_type?"MRG %":"MRK %"}`,style:{width:"100%",whiteSpace:"nowrap"}}),(0,Ke.jsx)(te.V,{field:"unit_price",header:"Unit Price",style:{width:"100%"},body:e=>`$${(0,ce.m)(e.unit_price)}`}),(0,Ke.jsx)(te.V,{field:"quantity",header:"Qty/Unit",style:{width:"100%"}}),(0,Ke.jsx)(te.V,{field:"discount",header:"Discount",style:{width:"100%"},body:e=>`${e.discount}%`}),(0,Ke.jsx)(te.V,{field:"total",header:"Amount",style:{width:"100%"},body:e=>`$${(0,ce.m)(e.total)}`})]}),(0,Ke.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-end gap-4",style:{background:"#EBF8FF",padding:"8px 24px 8px 40px"},children:[(0,Ke.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,Ke.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Sub Total"}),(0,Ke.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,ce.m)(null===s||void 0===s?void 0:s.sub_total)]})]}),(0,Ke.jsx)("div",{children:(0,Ke.jsx)(be.A,{size:20,color:"#106B99"})}),(0,Ke.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,Ke.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Tax"}),(0,Ke.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,ce.m)(null===s||void 0===s?void 0:s.gst)]})]}),(0,Ke.jsx)("div",{children:(0,Ke.jsx)("div",{children:(0,Ke.jsx)(Ie.A,{size:20,color:"#106B99",style:{transform:"rotate(90deg)"}})})}),(0,Ke.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,Ke.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Total Invoice Amount"}),(0,Ke.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,ce.m)(null===s||void 0===s?void 0:s.total)]})]})]})]})},nt=e=>{let{jobs:t,expenses:s}=e;const i=(0,n.useMemo)((()=>[...(s||[]).map((e=>({...e,itemType:"expense"}))),...(t||[]).map((e=>({...e,itemType:"job"})))].sort(((e,t)=>parseInt(t.created)-parseInt(e.created)))),[t,s]);return(0,Ke.jsxs)(se.b,{value:i,showGridlines:!0,className:"border-top",children:[(0,Ke.jsx)(te.V,{field:"number",header:"#",body:e=>{var t;return"job"===e.itemType?(0,Ke.jsxs)(r.N_,{to:`/work/jobs?jobId=${null===e||void 0===e?void 0:e.id}`,className:"linkText",target:"_blank",children:["JOB-",null===e||void 0===e?void 0:e.number]}):(0,Ke.jsx)(r.N_,{to:`/expenses?expenseId=${null===e||void 0===e?void 0:e.id}&supplierName=${null===e||void 0===e||null===(t=e.supplier)||void 0===t?void 0:t.name}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number})},bodyClassName:"text-center",headerClassName:"text-center",style:{width:"100px",whiteSpace:"nowrap"}}),(0,Ke.jsx)(te.V,{field:"itemType",header:"Type",body:e=>"job"===e.itemType?(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-1",children:[(0,Ke.jsx)(Ee.A,{size:14,color:"#1AB2FF"}),(0,Ke.jsx)("span",{children:"Job"})]}):(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-1",children:[(0,Ke.jsx)(Ne.A,{size:14,color:"#1AB2FF"}),(0,Ke.jsx)("span",{children:"Expense"})]}),style:{width:"100px"}}),(0,Ke.jsx)(te.V,{field:"reference",header:"Reference",style:{minWidth:"192px"},body:e=>{const t="job"===e.itemType?null===e||void 0===e?void 0:e.reference:null===e||void 0===e?void 0:e.invoice_reference;return(0,Ke.jsx)("div",{className:"ellipsis-width",title:t||"-",style:{maxWidth:"192px"},children:t||"-"})}}),(0,Ke.jsx)(te.V,{field:"provider",header:"Provider",body:e=>{var t,s,n,i,l,o;const a="job"===e.itemType,r=a?null===e||void 0===e||null===(t=e.worker)||void 0===t?void 0:t.full_name:null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.name,d=a?null===e||void 0===e||null===(n=e.worker)||void 0===n?void 0:n.has_photo:null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.has_photo,c=a?null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.photo:null===e||void 0===e||null===(o=e.supplier)||void 0===o?void 0:o.photo;return(0,Ke.jsx)(me.A,{placement:"top",overlay:(0,Ke.jsx)(ve.A,{className:"TooltipOverlay",id:"tooltip-provider",children:r||""}),children:(0,Ke.jsxs)("div",{className:"mr-auto d-flex align-items-center justify-content-center ps-2",style:{width:"fit-content"},children:[(0,Ke.jsx)(qe.h,{has_photo:d,photo:c,is_business:!a,size:16}),(0,Ke.jsx)("div",{className:"ellipsis-width",children:r||"N/A"})]})},"top")},style:{minWidth:"100px",width:"300px",maxWidth:"300px"},bodyClassName:"d-flex justify-content-between"}),(0,Ke.jsx)(te.V,{field:"total",header:"Estimate/Total",body:e=>`$${(0,ce.m)(e.total)}`}),(0,Ke.jsx)(te.V,{field:"status",header:"Status",body:e=>"job"===e.itemType?(0,Ke.jsx)("div",{className:"expenseStatus",children:(0,Ke.jsx)(Ye.A,{status:null===e||void 0===e?void 0:e.status,actionStatus:null===e||void 0===e?void 0:e.action_status,published:null===e||void 0===e?void 0:e.published})}):(0,Ke.jsx)("div",{className:"expenseStatus",children:(0,Ke.jsx)("span",{className:null!==e&&void 0!==e&&e.paid?"paid":"unpaid",children:null!==e&&void 0!==e&&e.paid?"Paid":"Not Paid"})}),style:{width:"120px",minWidth:"120px",maxWidth:"120px"}})]})},it=e=>{var t,s,i,l;let{show:o,setShow:a,invoice:u,setRefetch:h}=e;console.log("invoice: ",u);const[m,v]=(0,n.useState)(!1),[S,j]=(0,n.useState)(!1),[f,_]=(0,n.useState)(!1),[g,E]=(0,n.useState)(0),[N,y]=(0,n.useState)(2),[b,I]=(0,n.useState)({}),T=[{icon:(0,Ke.jsx)(W.A,{size:20}),label:"Bank",value:2},{icon:(0,Ke.jsx)(M.A,{size:20}),label:"Cash",value:1},{icon:(0,Ke.jsx)(G.A,{size:20}),label:"EFTPOS",value:4}],A=(0,d.n)({mutationFn:e=>(0,ie.e0)(null===u||void 0===u?void 0:u.unique_id,e),onSuccess:()=>{a(!1),h((e=>!e)),x.oR.success("Partial payment is completed successfully.")},onError:e=>{console.error("Failed to payment:",e),x.oR.error("Failed to payment. Please try again.")}}),C=(0,Te.I)({queryKey:["invoicePartialHistory",null===u||void 0===u?void 0:u.unique_id],queryFn:()=>(0,ie.RC)(null===u||void 0===u?void 0:u.unique_id),enabled:!(null===u||void 0===u||!u.unique_id),staleTime:0,cacheTime:0});return(0,n.useEffect)((()=>{I({}),E(0),y(2)}),[o]),(0,Ke.jsxs)(Ae.l,{visible:o,modal:!0,header:Xe,onHide:a,className:`${Oe} custom-modal custom-scroll-integration`,children:[(0,Ke.jsx)(he.A,{className:(0,Q.A)($e,"mb-3"),children:(0,Ke.jsxs)(he.A.Body,{children:[(0,Ke.jsx)("label",{children:"Select Payment Method"}),(0,Ke.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,Ke.jsxs)("div",{className:"d-flex flex-column pt-2",children:[(0,Ke.jsx)(Pe.J,{className:"rounded",value:N,onChange:e=>y(e.value),itemTemplate:e=>(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[e.icon,e.label]}),optionLabel:"label",options:T}),(null===b||void 0===b?void 0:b.type)&&(0,Ke.jsx)("p",{className:"error-message mb-0",children:"Payment type is required"})]}),(0,Ke.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,Ke.jsx)(r.N_,{to:`${null===u||void 0===u?void 0:u.invoice_url}`,target:"_blank",children:(0,Ke.jsx)(c.$,{className:"danger-outline-button px-3 py-2",children:(0,Ke.jsx)(U.A,{color:"#F04438",size:17})})}),(0,Ke.jsx)(r.N_,{to:`/invoice/${null===u||void 0===u?void 0:u.unique_id}`,target:"_blank",children:(0,Ke.jsx)(c.$,{className:"info-button px-3 py-2",children:(0,Ke.jsx)(Se.A,{color:"#158ECC",size:17})})})]})]})]})}),(0,Ke.jsx)(he.A,{className:(0,Q.A)($e,"mb-3"),children:(0,Ke.jsx)(he.A.Body,{children:(0,Ke.jsxs)("div",{className:"d-flex justify-content-between gap-3 align-items-center",children:[(0,Ke.jsxs)("div",{className:"d-flex flex-column flex-fill",children:[(0,Ke.jsx)("label",{className:"mb-2",children:"Enter Amount"}),(0,Ke.jsxs)(Ce.C,{className:"w-100",iconPosition:"left",children:[(0,Ke.jsx)(Re.m,{children:(0,Ke.jsx)("span",{style:{position:"relative",top:"-4px"},children:"$"})}),(0,Ke.jsx)(we.Y,{value:g,onValueChange:e=>E(e.target.value||0),style:{width:"100%",minWidth:"420px",padding:"0px 16px"},className:(0,Q.A)(Ue,{[Fe]:null===b||void 0===b?void 0:b.deposit}),maxFractionDigits:2,minFractionDigits:2,placeholder:"0.00",inputId:"minmaxfraction"})]}),(null===b||void 0===b?void 0:b.deposit)&&(0,Ke.jsx)("p",{className:"error-message mb-0",children:"Payment type is required"})]}),(0,Ke.jsxs)("div",{className:(0,Q.A)(Be,"d-flex flex-column flex-fill"),onClick:()=>E(parseFloat((null===u||void 0===u?void 0:u.amount)||0).toFixed(2)),children:[(0,Ke.jsx)("label",{children:"Total invoice"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.amount)||0)]})]}),(0,Ke.jsxs)("div",{className:(0,Q.A)(Be,"d-flex flex-column flex-fill"),onClick:()=>E(parseFloat((null===u||void 0===u?void 0:u.to_be_paid)||0).toFixed(2)),children:[(0,Ke.jsx)("label",{children:"To Be Paid"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.to_be_paid)||0)]})]})]})})}),(0,Ke.jsx)(he.A,{className:(0,Q.A)($e,"mb-3"),children:(0,Ke.jsx)(he.A.Body,{children:(0,Ke.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,Ke.jsxs)("div",{className:(0,Q.A)(Le,"d-flex flex-column text-start justify-content-center"),children:[(0,Ke.jsx)("label",{style:{fontWeight:400},children:"Budget"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.budget)||0)]})]}),(0,Ke.jsxs)("div",{className:"d-flex flex-column",style:{flex:1},children:[(0,Ke.jsxs)("div",{className:(0,Q.A)(ke,"d-flex flex-column align-items-center text-left w-100 h-100"),children:[(0,Ke.jsx)("label",{style:{fontWeight:400},children:"Real Cost"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.real_cost)||0)]})]}),(0,Ke.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Ke.jsxs)("div",{className:(0,Q.A)(ze,"d-flex flex-column text-end flex-fill"),children:[(0,Ke.jsx)("label",{style:{fontWeight:400},children:"Cost Of Sale"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.cost_of_sale)||0)]})]}),(0,Ke.jsxs)("div",{className:(0,Q.A)(We,"d-flex flex-column text-end flex-fill"),children:[(0,Ke.jsx)("label",{children:"Labour"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.labor_expenses)||0)]})]}),(0,Ke.jsxs)("div",{className:(0,Q.A)(Me,"d-flex flex-column text-end flex-fill"),children:[(0,Ke.jsx)("label",{children:"Operating Expense"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.labor_expenses)||0)]})]})]})]}),(0,Ke.jsxs)("div",{className:(0,Q.A)(Ge,"d-flex flex-column text-end justify-content-center"),children:[(0,Ke.jsx)("label",{children:"Operational Profit"}),(0,Ke.jsxs)("h1",{className:(0,Q.A)(Je,"mt-2"),children:["$",(0,ce.m)((null===u||void 0===u?void 0:u.profit)||0)]})]})]})})}),(0,Ke.jsxs)(he.A,{className:(0,Q.A)($e,"mb-3"),children:[(0,Ke.jsxs)(he.A.Body,{className:"d-flex justify-content-end gap-2",children:[(0,Ke.jsx)(c.$,{className:"outline-button",onClick:()=>a(!1),children:"Cancel"}),(0,Ke.jsxs)(c.$,{className:"success-button",disabled:null===A||void 0===A?void 0:A.isPending,onClick:()=>{let e=0;I({}),N||(e++,I((e=>({...e,type:!0})))),g||(e++,I((e=>({...e,deposit:!0})))),e||A.mutate({deposit:g,type:N})},children:["Process Payment",(null===A||void 0===A?void 0:A.isPending)&&(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]}),(0,Ke.jsxs)("div",{className:"mb-2 d-flex justify-content-center text-center",style:{borderTop:".5px solid #F2F4F7",gap:"72px"},children:[(0,Ke.jsxs)(c.$,{className:`${S?Ve:He}`,onClick:()=>{j(!S),v(!1),_(!1)},children:[S?"Hide":"Show"," Expense"]}),(0,Ke.jsxs)(c.$,{className:`${m?Ve:He}`,onClick:()=>{v(!m),j(!1),_(!1)},children:[m?"Hide":"Show"," History"]}),(0,Ke.jsxs)(c.$,{className:`${f?Ve:He}`,onClick:()=>{_(!f),j(!1),v(!1)},style:{minWidth:"182px"},children:[f?"Hide":""," Cost Breakdown"]})]})]}),S&&(0,Ke.jsx)(nt,{jobs:(null===C||void 0===C||null===(t=C.data)||void 0===t?void 0:t.jobs)||[],expenses:(null===C||void 0===C||null===(s=C.data)||void 0===s?void 0:s.expenses)||[]}),m&&(0,Ke.jsx)(tt,{history:(null===C||void 0===C||null===(i=C.data)||void 0===i?void 0:i.history)||[],projectId:null===u||void 0===u?void 0:u.unique_id}),f&&(0,Ke.jsx)(st,{calculations:(null===C||void 0===C||null===(l=C.data)||void 0===l?void 0:l.calculations)||[],invoice:null===C||void 0===C?void 0:C.data})]})};var lt=s(46632),ot=s(59638),at=s(81242);const rt=e=>{var t,s,i;let{projectId:l,clientId:o,isAction:a}=e;const[r,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)({}),m=(0,Te.I)({queryKey:["id",o],queryFn:()=>(0,ot.EZ)(o),enabled:!!o&&!!r,retry:1}),v=[...(null===m||void 0===m||null===(t=m.data)||void 0===t?void 0:t.contact_persons)||[],...null!==m&&void 0!==m&&null!==(s=m.data)&&void 0!==s&&s.email?[{email:null===m||void 0===m||null===(i=m.data)||void 0===i?void 0:i.email}]:[]],S=(0,d.n)({mutationFn:e=>(0,ie.LG)(l,e),onSuccess:()=>{u(!1),x.oR.success("Reminder email sent successfully.")},onError:e=>{console.error("Error sending email:",e),x.oR.error("Failed to send reminder email. Please try again.")}});return(0,Ke.jsxs)(Ke.Fragment,{children:[a?(0,Ke.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:()=>u(!0),children:[(0,Ke.jsx)(lt.A,{color:"#667085",size:20}),(0,Ke.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Send Reminder"})]}):(0,Ke.jsx)(c.$,{label:"Resend",style:{position:"static"},onClick:()=>u(!0),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0}),(0,Ke.jsx)(at.A,{show:r,setShow:u,setPayload:h,mutation:S,contactPersons:v,projectCardData:()=>{},defaultTemplateId:"Resend Invoice"})]})},dt=e=>{var t,s,l;let{projectId:o,clientId:a,isAction:r}=e;const[u,p]=(0,n.useState)(!1),[h,m]=(0,n.useState)({}),v=(0,Te.I)({queryKey:["id",a],queryFn:()=>(0,ot.EZ)(a),enabled:!!a&&!!u,retry:1}),S=[...(null===v||void 0===v||null===(t=v.data)||void 0===t?void 0:t.contact_persons)||[],...null!==v&&void 0!==v&&null!==(s=v.data)&&void 0!==s&&s.email?[{email:null===v||void 0===v||null===(l=v.data)||void 0===l?void 0:l.email}]:[]],j=(0,d.n)({mutationFn:e=>(0,ie.ml)(o,e),onSuccess:()=>{p(!1),x.oR.success("Email sent successfully.")},onError:e=>{console.error("Error sending email:",e),x.oR.error("Failed to resent email. Please try again.")}});return(0,Ke.jsxs)(Ke.Fragment,{children:[r?(0,Ke.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:()=>p(!0),children:[(0,Ke.jsx)(i.A,{color:"#667085",size:20}),(0,Ke.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Send Invoice"})]}):(0,Ke.jsx)(c.$,{label:"Resend",style:{position:"static"},onClick:()=>p(!0),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0}),(0,Ke.jsx)(at.A,{show:u,setShow:p,setPayload:m,mutation:j,contactPersons:S,projectCardData:()=>{},defaultTemplateId:"Invoice"})]})},ct=e=>{try{const t=new Date(1e3*e),s=t.getDate(),n=new Intl.DateTimeFormat("en-US",{month:"short"}).format(t);return`${s} ${n} ${t.getFullYear()}`}catch(t){return console.log("error: ",t),""}},ut=(0,n.forwardRef)(((e,t)=>{let{searchValue:s,setTotal:i,setTotalMoney:l,selected:o,setSelected:a,isShowDeleted:u,refetch:h,setRefetch:m,isFilterEnabled:v,filters:S}=e;const{role:_}=(0,oe.As)(),A=(0,n.useRef)(null),R=(0,K.Zp)(),{trialHeight:w}=(0,ae.$)(),[he,me]=(0,n.useState)([]),[ve,Se]=(0,n.useState)(1),[je,fe]=(0,n.useState)({sortField:"number",sortOrder:-1}),[_e,ge]=(0,n.useState)({sortField:"number",sortOrder:-1}),[Ee,Ne]=(0,n.useState)(!0),[ye,be]=(0,n.useState)(!1),[Ie,Te]=(0,n.useState)(!1),[Ae,Ce]=(0,n.useState)(null);(0,n.useEffect)((()=>{Se(1)}),[s,h,u,S]),(0,n.useEffect)((()=>{(async()=>{be(!0);let e="";1===(null===_e||void 0===_e?void 0:_e.sortOrder)?e=`${_e.sortField}`:-1===(null===_e||void 0===_e?void 0:_e.sortOrder)&&(e=`-${_e.sortField}`);const t=await(0,ie.DX)(ve,25,s,e,u,S);var n;(i((()=>(null===t||void 0===t?void 0:t.count)||0)),l((null===t||void 0===t?void 0:t.total_amount)||0),1===ve)?me(t.results):(null===t||void 0===t||null===(n=t.results)||void 0===n?void 0:n.length)>0&&me((e=>{const s=new Set(e.map((e=>e.id))),n=t.results.filter((e=>!s.has(e.id)));return[...e,...n]}));fe(_e),Ne(t.count!==he.length),be(!1)})()}),[ve,s,_e,h,u,JSON.stringify(S)]),(0,n.useEffect)((()=>{if(he.length>0&&Ee){A.current=new IntersectionObserver((e=>{e[0].isIntersecting&&Se((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&A.current.observe(e)}return()=>{A.current&&A.current.disconnect()}}),[he,Ee]);const Re=(0,d.n)({mutationFn:e=>(0,ie.r$)(e),onSuccess:()=>{x.oR.success("Invoice deleted successfully"),Re.reset(),m(!h)},onError:e=>{Re.reset(),console.log("error: ",e),x.oR.error("Failed to delete invoice. Please try again.")}}),we=(0,d.n)({mutationFn:e=>(0,le.L)(e),onSuccess:()=>{x.oR.success("Project has been successfully duplicated"),we.reset(),R("/sales")},onError:e=>{Re.reset(),console.log("error: ",e),x.oR.error("Failed to duplicate project. Please try again.")}});return(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsxs)(se.b,{ref:t,value:he,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${w}px - ${v?56:0}px)`,className:"border",selection:o,onSelectionChange:e=>a(e.value),loading:ye,loadingIcon:ue.A,emptyMessage:(0,Ke.jsx)(xe.A,{isDataExist:!!s||!!u}),sortField:null===je||void 0===je?void 0:je.sortField,sortOrder:null===je||void 0===je?void 0:je.sortOrder,onSort:e=>{const{sortField:t,sortOrder:s}=e;ge({sortField:t,sortOrder:s}),Se(1)},rowClassName:e=>{let t="";return null!==e&&void 0!==e&&e.deleted&&(t+=g+" "),null!==e&&void 0!==e&&e.unique_id&&(t+=`row-id-${e.unique_id}`),t.trim()},children:[(0,Ke.jsx)(te.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,Ke.jsx)(te.V,{field:"number",header:"Invoice ID",body:e=>(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-2 justify-content-between show-on-hover",children:[(0,Ke.jsxs)("div",{className:"d-flex flex-column",style:{lineHeight:"1.385"},children:[(0,Ke.jsx)("span",{children:e.number}),(0,Ke.jsx)("span",{className:"font-12",style:{color:"#98A2B3"},children:ct(e.created)})]}),(0,Ke.jsx)(c.$,{label:"Open",onClick:()=>R(`/management?unique_id=${e.unique_id}&reference=${null===e||void 0===e?void 0:e.reference}&number=${null===e||void 0===e?void 0:e.number}&value=${e.id}`),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),headerClassName:"paddingLeftHide",bodyClassName:"paddingLeftHide",style:{minWidth:"160px",maxWidth:"160px",width:"160px"},frozen:!0,sortable:!0}),(0,Ke.jsx)(te.V,{field:"",header:"Invoice",body:e=>(0,Ke.jsxs)("div",{className:"d-flex align-items-center justify-content-around",children:[(0,Ke.jsx)(r.N_,{to:`https://app.memate.com.au${null===e||void 0===e?void 0:e.invoice_url}`,target:"_blank",children:(0,Ke.jsx)(U.A,{color:"#FF0000",size:16})}),(0,Ke.jsx)(r.N_,{to:`/invoice/${e.unique_id}`,target:"_blank",children:(0,Ke.jsx)(F.A,{color:"#3366CC",size:16})})]}),style:{minWidth:"114px",maxWidth:"114px",width:"114px"},frozen:!0}),(0,Ke.jsx)(te.V,{field:"client__name",exportField:"client.name",header:"Customer A\u2192Z",body:e=>{var t,s,n,i;return(0,Ke.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Ke.jsx)(pe.Ay,{has_photo:null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.has_photo,photo:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.photo,is_business:null===e||void 0===e||null===(n=e.client)||void 0===n?void 0:n.is_business}),(0,Ke.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,Ke.jsx)("div",{className:`${j}`,children:null===(i=e.client)||void 0===i?void 0:i.name}),e.deleted?(0,Ke.jsx)(ne.v,{value:"Deleted",style:{height:"22px",width:"59px",borderRadius:"16px",border:"1px solid #FECDCA",background:"#FEF3F2",color:"#912018",fontSize:"12px",fontWeight:500}}):""]})]})},headerClassName:"shadowRight",bodyClassName:"shadowRight",style:{minWidth:"295px",maxWidth:"295px",width:"295px"},frozen:!0,sortable:!0}),(0,Ke.jsx)(te.V,{field:"reference",header:"Invoice Reference",style:{minWidth:"250px"}}),(0,Ke.jsx)(te.V,{field:"invoice_due_date",exportField:e=>ct(e.due_date),header:"Due Date",body:e=>{var t;return(0,Ke.jsxs)("div",{className:"d-flex align-items-center justify-content-start gap-2 show-on-hover",style:{color:"#98A2B3"},children:[e.paid?(0,Ke.jsxs)("div",{className:`${I} ${f}`,children:[(0,Ke.jsx)(ee.E,{severity:"success"})," Paid"]}):e.overdue>0?(0,Ke.jsxs)("div",{className:`${I} ${T}`,children:["Overdue ",e.overdue," days ",(0,Ke.jsx)(ee.E,{severity:"danger"})]}):(0,Ke.jsxs)("div",{className:`${I} ${T}`,children:[(0,Ke.jsx)(ee.E,{severity:"warning"})," Not Paid"]}),ct(e.due_date),(0,Ke.jsx)(rt,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.id,isAction:!1})]})},style:{minWidth:"56px"},className:"text-center",sortable:!0}),(0,Ke.jsx)(te.V,{field:"amount",header:"Total invoice",exportField:e=>`$${(0,ce.m)(e.amount)}`,body:e=>(0,Ke.jsx)("div",{className:`d-flex align-items-center justify-content-end ${E}`,children:(0,Ke.jsxs)("div",{className:"text-dark",children:["$",(0,ce.m)(null===e||void 0===e?void 0:e.amount)]})}),style:{minWidth:"56px",textAlign:"end"},sortable:!0}),(0,Ke.jsx)(te.V,{field:"to_be_paid",header:"To be paid",exportField:e=>`$${(0,ce.m)(e.to_be_paid)}`,body:e=>(0,Ke.jsx)("div",{className:`d-flex align-items-center justify-content-end show-on-hover ${E}`,children:(0,Ke.jsx)("div",{className:"text-dark",children:(0,Ke.jsxs)("span",{style:{color:"paid"===e.payment_status?"#98A2B3":"not_paid"===e.payment_status?"#D92D20":"#F79009"},children:["$",(0,ce.m)(null===e||void 0===e?void 0:e.to_be_paid)]})})}),style:{minWidth:"123px",textAlign:"right"},sortable:!0}),(0,Ke.jsx)(te.V,{field:"deposit",header:"Deposit/Payment",exportable:!1,body:e=>{const t="paid"===e.payment_status;return(0,Ke.jsxs)(c.$,{onClick:()=>{Te(!0),Ce(e)},className:(0,Q.A)(P,{[N]:"paid"===e.payment_status,[y]:"not_paid"===e.payment_status,[b]:"not_paid"!==e.payment_status&&"paid"!==e.payment_status}),children:[t?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)("span",{className:D,children:"Pay Invoice"}),(0,Ke.jsx)("span",{className:O,children:"Edit Payment"})]}):"Pay Invoice",(0,Ke.jsx)(B.A,{color:"paid"===e.payment_status?"#17B26A":"not_paid"===e.payment_status?"#D92D20":"#F79009",size:16})]})},style:{minWidth:"114px",maxWidth:"164px",width:"164px",textAlign:"left"}}),(0,Ke.jsx)(te.V,{field:"total_requests",header:"Info",exportable:!1,body:e=>{const t=(0,n.useRef)(null),[s,i]=(0,n.useState)(!1),l=(0,X.k)(s,i);return(0,Ke.jsxs)(n.Fragment,{children:[(0,Ke.jsx)(L.A,{color:"#667085",size:18,className:"cursor-pointer",ref:t,...l}),(0,Ke.jsx)("div",{className:"fixedMenu",style:{position:"fixed",top:"40%",left:"40%"},children:(0,Ke.jsxs)(Z.k,{state:s?"open":"closed",anchorRef:t,onClose:()=>i(!1),menuStyle:{padding:"24px 24px 20px 24px",width:"605px",marginTop:"45px",maxHeight:"100%"},children:[(0,Ke.jsxs)("div",{className:"d-flex justify-content-between mb-4",children:[(0,Ke.jsx)("div",{className:"BoxNo",children:(0,Ke.jsx)("div",{children:(0,Ke.jsx)(L.A,{color:"#FFFFFF",size:24})})}),(0,Ke.jsx)($.A,{onClick:()=>i(!1)})]}),(0,Ke.jsx)("div",{style:{width:"100%",maxHeight:"500px",overflow:"auto"},children:null===e||void 0===e?void 0:e.billing_history.map(((t,s)=>{var n,i,l;return(0,Ke.jsxs)("div",{className:"d-flex gap-4 border justify-content-start py-1 px-2 rounded mb-2 w-100",style:{width:"fit-content"},children:[(0,Ke.jsx)("div",{className:"d-flex align-items-center",children:0===(null===t||void 0===t?void 0:t.type)?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)("div",{className:"d-flex justify-content-center align-items-center rounded-circle",style:{width:"24px",height:"24px",background:"linear-gradient(180deg, #f9fafb 0%, #edf0f3 100%)",marginRight:"10px"},children:(0,Ke.jsx)(k.A,{size:14,color:"#98A2B3"})}),(0,Ke.jsx)("div",{className:"font-14 ellipsis-width text-start",style:{width:"120px",maxWidth:"120px"},children:"Stripe"})]}):(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(pe.Ay,{has_photo:null===t||void 0===t||null===(n=t.manager)||void 0===n?void 0:n.has_photo,photo:null===t||void 0===t||null===(i=t.manager)||void 0===i?void 0:i.photo,is_business:!1}),(0,Ke.jsx)("div",{className:"font-14 ellipsis-width text-start",style:{width:"120px",maxWidth:"120px"},children:null===t||void 0===t||null===(l=t.manager)||void 0===l?void 0:l.name})]})}),(0,Ke.jsxs)("div",{className:"d-flex gap-2 align-items-center justify-content-start",children:[(0,Ke.jsx)(z.A,{color:"#98A2B3",size:14}),(0,Ke.jsxs)("span",{style:{fontWeight:600,fontSize:16},children:["$",(0,ce.m)(t.deposit)]})]}),(0,Ke.jsxs)("div",{className:"d-flex gap-2 align-items-center justify-content-start",children:[2===(null===t||void 0===t?void 0:t.type)?(0,Ke.jsx)(W.A,{size:14,color:"#98A2B3"}):1===t.type?(0,Ke.jsx)(M.A,{size:14,color:"#98A2B3"}):4===t.type?(0,Ke.jsx)(G.A,{size:14,color:"#98A2B3"}):(0,Ke.jsx)(k.A,{size:14,color:"#98A2B3"}),(0,Ke.jsx)("div",{className:"border rounded font-12 px-1",children:2===(null===t||void 0===t?void 0:t.type)?"Bank":1===t.type?"Cash":4===t.type?"EFTPOS":"Stripe"})]}),(0,Ke.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,Ke.jsx)(J.A,{color:"#98A2B3",size:14}),(0,Ke.jsx)("div",{className:"font-14",children:ct(t.created)})]})]},e.unique_id+s)}))}),e.paid?(0,Ke.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#ECFDF3"},children:(0,Ke.jsx)("span",{className:"font-14",style:{color:"#17B26A"},children:"Invoice Paid"})}):"partial_payment"===e.payment_status?(0,Ke.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#fffaeb"},children:(0,Ke.jsx)("span",{className:"font-14",style:{color:"#b54708"},children:"Invoice Partialy Paid"})}):(0,Ke.jsx)("div",{className:"d-flex gap-2 mt-3 justify-content-center align-items-center p-2 rounded",style:{background:"#FEF3F2"},children:(0,Ke.jsx)("span",{className:"font-14",style:{color:"#B42318"},children:"Invoice Due"})})]})})]})},style:{minWidth:"89px",maxWidth:"89px",width:"89px",textAlign:"center"}}),(0,Ke.jsx)(te.V,{field:"xero",header:"Xero/Myob",exportable:!1,body:e=>(0,Ke.jsx)("div",{className:"d-flex align-items-center justify-content-center",children:"in_progress"===(null===e||void 0===e?void 0:e.xero_status)?(0,Ke.jsx)("span",{style:{color:"#158ECC"},className:C,children:"xero"}):"completed"===(null===e||void 0===e?void 0:e.xero_status)?(0,Ke.jsx)("span",{style:{color:"#158ECC"},children:"xero"}):(0,Ke.jsx)("span",{})}),style:{minWidth:"120px",maxWidth:"120px",width:"120px",textAlign:"center"}}),(0,Ke.jsx)(te.V,{field:"paid",header:"Actions",exportField:e=>ct(e.created),exportHeader:"Created at",body:e=>{var t,s;const i=(0,n.useRef)(null),[l,o]=(0,n.useState)(!1),a=(0,X.k)(l,o);return(0,Ke.jsx)(n.Fragment,{children:(0,Ke.jsxs)("div",{style:{position:"relative"},children:[(0,Ke.jsx)(V.A,{size:24,color:"#667085",className:"cursor-pointer",ref:i,...a}),(0,Ke.jsx)(Z.k,{state:l?"open":"closed",anchorRef:i,onClose:()=>o(!1),menuClassName:"action-menu-portal",menuStyle:{padding:"4px",width:"241px",textAlign:"left"},portal:{target:document.body},align:"end",position:"anchor",direction:"bottom",overflow:"auto",children:(0,Ke.jsxs)("div",{className:"d-flex flex-column gap-2",children:[(0,Ke.jsx)(dt,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.id,isAction:!0}),(0,Ke.jsx)(rt,{projectId:e.unique_id,clientId:null===e||void 0===e||null===(s=e.client)||void 0===s?void 0:s.id,isAction:!0}),(0,Ke.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:async()=>{await we.mutateAsync(e.unique_id),o(!1)},children:[(0,Ke.jsx)(H.A,{color:"#667085",size:20}),(0,Ke.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Duplicate project"}),(null===we||void 0===we?void 0:we.variables)===e.unique_id?(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px"}}):""]}),(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-3 hover-greay px-2 py-2",style:{opacity:.5},children:[(0,Ke.jsx)(q.A,{color:"#667085",size:20}),(0,Ke.jsx)("span",{style:{color:"#101828",fontSize:"16px",fontWeight:500},children:"Create credit note"})]}),(0,de._)(_,re.J.INVOICE.DELETE)&&(0,Ke.jsxs)("div",{className:"d-flex align-items-center cursor-pointer gap-3 hover-greay px-2 py-2",onClick:async()=>{await Re.mutateAsync(e.unique_id),o(!1)},children:[(0,Ke.jsx)(Y.A,{color:"#B42318",size:20}),(0,Ke.jsx)("span",{style:{color:"#B42318",fontSize:"16px",fontWeight:500},children:"Delete invoice"}),(null===Re||void 0===Re?void 0:Re.variables)===e.unique_id?(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px"}}):""]})]})})]})})},style:{minWidth:"75px",maxWidth:"75px",width:"75px",textAlign:"center"},bodyStyle:{color:"#667085"}})]}),(0,Ke.jsx)(it,{show:Ie,setShow:()=>Te(!1),setRefetch:m,invoice:Ae})]})})),pt=ut;var xt=s(10586),ht=s(62284),mt=s(14282);const vt=e=>{var t,s,n,i;let{invoices:l}=e;const o=(null===l||void 0===l?void 0:l.length)>0&&(null===(t=l[0])||void 0===t||null===(s=t.client)||void 0===s?void 0:s.name)||"",a=(null===l||void 0===l?void 0:l.length)>0&&(null===(n=l[0])||void 0===n||null===(i=n.client)||void 0===i?void 0:i.id)||"",r=(0,d.n)({mutationFn:e=>(0,xt.E4)(e),onSuccess:e=>{const t=(null===e||void 0===e?void 0:e.pdf_url)||e;t&&window.open(`/invoice/account-statement?pdf=${t}&client=${o}&clientId=${a}`,"_blank")},onError:e=>{console.log("error: ",e),x.oR.error("Failed to download statement. Please try again.")}});return(0,Ke.jsx)(Ke.Fragment,{children:(0,Ke.jsxs)(mt.A,{className:"solid-button font-14",style:{height:"32px"},onClick:()=>{const e=l.map((e=>e.id));r.mutate(e)},children:["Create Statement",(null===r||void 0===r?void 0:r.isPending)&&(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px"}})]})})};var St=s(39759),jt=s(3494),ft=s(38161),_t=s(62812),gt=s(27965),Et=s(54972),Nt=s(5328),yt=s(44621);const bt="invoice-dropdown_filterBox__9P7yU",It="invoice-dropdown_searchBox__0j6at",Tt="invoice-dropdown_supplierDropdownItem__Vwm1I",At="invoice-dropdown_mainTagsWrapper__iqJlf",Ct="invoice-dropdown_tagsInputContainer__wKtvw",Rt="invoice-dropdown_tagItemsWrap__mloI7",wt="invoice-dropdown_tagItemWrap__Lb-P9";s(7245);const Pt=e=>{let{setFilters:t,filter:s}=e;const i=(0,n.useRef)(null),[l,o]=(0,n.useState)(!1),[a,r]=(0,n.useState)("clients"),[d,c]=(0,n.useState)([]),[x,h]=(0,n.useState)(""),[m,v]=(0,n.useState)([null,null]),[S,j]=(0,n.useState)([]),[f,_]=(0,n.useState)(1),[g,E]=(0,n.useState)(null),[N,y]=(0,n.useState)(!0),[b,I,T]=(0,u.d7)("",400),[A,C]=(0,n.useState)(!1);function R(e){if(!e)return"";const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${s}-${t}`}(0,n.useEffect)((()=>{_(1)}),[I]),(0,n.useEffect)((()=>{(async()=>{C(!0);const e=await(0,ot.oo)(f,25,I,"name");if(1===f){if(x){const t=e.results.filter((e=>e.id!==x));return j([...g,...t])}j(e.results)}else{var t;if((null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t.length)>0){let t=e.results;x&&(t=[...g,...e.results]),j((e=>{let s=e;x&&(s=[...e,...g]);const n=new Set(s.map((e=>e.id))),i=t.filter((e=>!n.has(e.id)));return[...e,...i]}))}}y(e.count!==S.length),C(!1)})()}),[f,I,x,g]),(0,n.useEffect)((()=>{if(S.length>0&&N){const e=setTimeout((()=>{const e=document.querySelector(".supplier-dropdown .supplier-dropdown-item:last-child");e&&(i.current=new IntersectionObserver((e=>{e[0].isIntersecting&&_((e=>e+1))})),i.current.observe(e))}),1e3);return()=>{clearTimeout(e),i.current&&i.current.disconnect()}}}),[S,N,l]);const w=e=>{c((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},P=()=>{o(!1),r("clients")},O=()=>{o(!1),null!==g&&void 0!==g&&g.length&&t((e=>({...e,client:[...g]})));const e=d.map((e=>({name:e,value:e})));if(e.length&&t((t=>({...t,status:[...e]}))),m){let e=`${R(m[0])} - ${R(m[1])}`;t((t=>({...t,date:[{name:e,value:m}]})))}};return(0,n.useEffect)((()=>{s.client?s.client&&E(s.client):E(null),s.status?s.status&&c(s.status.map((e=>e.value))):c([]),s.date?s.date&&v(s.date[0].value):v(null)}),[s]),(0,Ke.jsxs)("div",{className:"supplier-filters",children:[(0,Ke.jsx)("button",{className:`${bt}`,onClick:()=>o(!l),children:(0,Ke.jsx)(St.A,{})}),l&&(0,Ke.jsxs)(yt.A,{id:"controlled-tab-example",activeKey:a,onSelect:e=>r(e),className:"filtterBoxWrapper",style:{marginLeft:"5px",marginTop:"5px"},children:[(0,Ke.jsxs)(Nt.A,{eventKey:"clients",title:(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(jt.A,{color:"#667085",size:16}),"Clients"]}),children:[(0,Ke.jsxs)("div",{className:It,children:[(0,Ke.jsx)("div",{style:{position:"absolute",top:"7px",left:"18px"},children:(0,Ke.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,Ke.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,Ke.jsx)("input",{type:"text",placeholder:"Search",value:b,onChange:e=>T(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"260px",border:"1px solid #D0D5DD",color:"#424242",padding:"10px 10px 10px 36px",fontSize:"14px",height:"40px"}})]}),(0,Ke.jsxs)("div",{className:"supplier-dropdown",style:{height:"350px",overflow:"auto",marginLeft:"0px"},children:[null===S||void 0===S?void 0:S.map((e=>(0,Ke.jsxs)("div",{className:(0,Q.A)(Tt,"supplier-dropdown-item"),onClick:()=>E((t=>null!==t&&void 0!==t&&t.some((t=>t.id===e.id))?t.filter((t=>t.id!==e.id)):t?[...t,e]:[e])),children:[(0,Ke.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,Ke.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,Ke.jsx)(qe.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,Ke.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"200px"},children:null===e||void 0===e?void 0:e.name})]}),null!==g&&void 0!==g&&g.some((t=>t.id===e.id))?(0,Ke.jsx)(ft.A,{color:"#1AB2FF",size:20}):null]},e.id))),A&&(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px",color:"#1AB2FF"}})]}),(0,Ke.jsxs)("div",{className:"d-flex justify-content-end gap-2 p-3 border-top",children:[(0,Ke.jsx)(mt.A,{className:"outline-button",style:{width:"115px",padding:"8px 14px"},onClick:P,children:"Cancel"}),(0,Ke.jsx)(mt.A,{className:"solid-button",style:{width:"115px",padding:"8px 14px"},onClick:O,children:"Apply"})]})]}),(0,Ke.jsxs)(Nt.A,{eventKey:"status",title:(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(B.A,{color:"#667085",size:16})," Payment"]}),children:[(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-3 p-2 mb-2",children:[(0,Ke.jsx)(Et.S,{inputId:"paid",checked:null===d||void 0===d?void 0:d.includes("Paid"),onChange:()=>w("Paid")}),(0,Ke.jsx)("label",{htmlFor:"paid",className:"mb-0",children:"Paid"})]}),(0,Ke.jsxs)("div",{className:"d-flex align-items-center gap-3 p-2 mb-2",children:[(0,Ke.jsx)(Et.S,{inputId:"not_paid",checked:null===d||void 0===d?void 0:d.includes("Not Paid"),onChange:()=>w("Not Paid")}),(0,Ke.jsx)("label",{htmlFor:"not_paid",className:"mb-0",children:"Not Paid"})]}),(0,Ke.jsxs)("div",{className:"d-flex justify-content-end gap-2 p-3 border-top",children:[(0,Ke.jsx)(mt.A,{className:"outline-button",style:{width:"115px",padding:"8px 14px"},onClick:P,children:"Cancel"}),(0,Ke.jsx)(mt.A,{className:"solid-button",style:{width:"115px",padding:"8px 14px"},onClick:O,children:"Apply"})]})]}),(0,Ke.jsxs)(Nt.A,{eventKey:"date",title:(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(_t.A,{color:"#667085",size:16})," Date"]}),children:[(0,Ke.jsx)("div",{className:"px-3 pt-2",children:(0,Ke.jsx)(gt.A,{value:m,onChange:v,options:{dateFormat:"Y-m-d",mode:"range",inline:!0}})}),(0,Ke.jsxs)("div",{className:"d-flex justify-content-end gap-2 p-3 border-top",children:[(0,Ke.jsx)(mt.A,{className:"outline-button",style:{width:"115px",padding:"8px 14px"},onClick:P,children:"Cancel"}),(0,Ke.jsx)(mt.A,{className:"solid-button",style:{width:"115px",padding:"8px 14px"},onClick:O,children:"Apply"})]})]})]})]})};var Ot=s(56741);const Dt=e=>{var t,s;let{filter:n,setFilters:i}=e;return(0,Ke.jsx)(Ke.Fragment,{children:(null===(t=Object.keys(n))||void 0===t?void 0:t.length)>0&&(0,Ke.jsx)("div",{className:At,children:null===(s=Object.entries(n))||void 0===s?void 0:s.map((e=>{let[t,s]=e;return(0,Ke.jsx)("div",{children:(null===s||void 0===s?void 0:s.length)>0&&(0,Ke.jsx)("div",{className:Ct,children:(0,Ke.jsxs)("ul",{className:Rt,children:[s.map(((e,l)=>(0,Ke.jsxs)("li",{className:wt,children:[null===e||void 0===e?void 0:e.name,(null===s||void 0===s?void 0:s.length)>1&&(0,Ke.jsx)(mt.A,{variant:"link",size:"sm",style:{marginLeft:"5px",padding:0},onClick:()=>((e,t)=>{const s={...n},l=s[e].filter((e=>e!==t));0===l.length?delete s[e]:s[e]=l,i(s)})(t,e),children:(0,Ke.jsx)(Ot.A,{color:"#F96969",size:15})})]},l))),(0,Ke.jsx)(mt.A,{variant:"link",size:"sm",style:{marginLeft:"0px",padding:0},onClick:()=>(e=>{const t={...n};delete t[e],i(t)})(t),children:(0,Ke.jsx)(Ot.A,{color:"#F96969",size:20})})]})})},t)}))})})},$t=()=>{var e,t;const s=(0,n.useRef)(null),[j,g]=(0,r.ok)(),E=j.get("isShowUnpaid"),N=j.get("search"),y=j.get("targetId"),[b,I]=(0,n.useState)(0),[T,C]=(0,n.useState)(0),[P,O]=(0,n.useState)({}),[D,$]=(0,n.useState)(!1),[U,F]=(0,n.useState)(!1),[B,L]=(0,n.useState)(!1),[k,z]=(0,n.useState)(!!E),[W,M]=(0,n.useState)(null),[G,J,V]=(0,u.d7)("",400),[H,q]=(0,n.useState)(!1),Y=(e,t)=>{if(0===e.length)return void x.oR.error("No data to export");const s=Object.keys(e[0]),n=[s.map((e=>`"${e}"`)).join(","),...e.map((e=>s.map((t=>`"${(e[t]||"").toString().replace(/"/g,'""')}"`)).join(",")))].join("\n"),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(i),o=document.createElement("a");o.href=l,o.download=t,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(l)},K=((0,d.n)({mutationFn:e=>(0,xt.D3)(e),onSuccess:()=>{L((e=>!e)),M(null),x.oR.success("Expenses have been successfully marked as paid.")},onError:e=>{console.log("error: ",e),x.oR.error("Failed to mark the expenses as paid. Please try again.")}}),(0,d.n)({mutationFn:e=>(0,ie.rf)(e),onSuccess:()=>{L((e=>!e)),M(null),x.oR.success("Invoice successfully sent to Xero!")},onError:e=>{console.log("error: ",e),x.oR.error("Failed to send the invoice to xero. Please try again.")}}));return(0,n.useEffect)((()=>{if(null!==W&&void 0!==W&&W.length){const e=W.every((e=>{var t,s;return(null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.id)===(null===(s=W[0].client)||void 0===s?void 0:s.id)}));$(e)}else $(!1)}),[W]),(0,n.useEffect)((()=>{N&&y&&(V(N),q(!0))}),[N,y,V]),(0,n.useEffect)((()=>{if(!H||!y||J!==N)return;const e=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return setTimeout((()=>{const t=document.querySelector(`.row-id-${y}`);if(t)(n=t).classList.add("highlight-row"),setTimeout((()=>{const e=n.closest(".p-datatable-wrapper");if(e){const t=n.offsetTop-e.clientHeight/2+n.clientHeight/2;e.scrollTo({top:t,behavior:"smooth"})}}),100),setTimeout((()=>{n.classList.remove("highlight-row"),q(!1);const e=new URLSearchParams(j);e.delete("search"),e.delete("targetId"),g(e,{replace:!0})}),6e3);else{if(!s){const t=e(1500,!0);return()=>clearTimeout(t)}q(!1),console.warn("Target row not found:",y)}var n}),t)},t=e(800);return()=>clearTimeout(t)}),[H,y,J,N,j,g]),(0,Ke.jsxs)("div",{className:"peoples-page",children:[(0,Ke.jsx)(a.mg,{children:(0,Ke.jsx)("title",{children:"MeMate - Invoices"})}),(0,Ke.jsxs)("div",{className:`topbar ${null!==W&&void 0!==W&&W.length?f:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,Ke.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==W&&void 0!==W&&W.length?(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsxs)("h6",{className:_,children:["Selected: ",null===W||void 0===W?void 0:W.length]}),(0,Ke.jsxs)("div",{className:"filtered-box d-flex align-items-center gap-2",children:[(0,Ke.jsxs)("button",{className:`outline-button ${A}`,disabled:K.isPending,onClick:()=>{const e=W.map((e=>e.unique_id));K.mutate({ids:e})},children:["Send to Xero/MYOB",K.isPending?(0,Ke.jsx)(p.p,{style:{width:"20px",height:"20px"}}):(0,Ke.jsx)(i.A,{color:"#1D2939",size:20})]}),(0,Ke.jsx)("button",{className:`${h}`,onClick:()=>(()=>{if(!W||0===W.length)return void x.oR.error("Please select invoices to export");const e=e=>{try{const t=new Date(1e3*e),s=t.getDate();return`${s} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}catch(t){return console.log("error: ",t),""}},t=W.map((t=>{var s;return{"Invoice ID":t.number||"","Created at":t.created?e(t.created):"","Customer A\u2192Z":(null===(s=t.client)||void 0===s?void 0:s.name)||"","Invoice Reference":t.reference||"","Due Date":t.due_date?e(t.due_date):"","Total invoice":t.amount?`$${(0,ce.m)(t.amount)}`:"$0.00","To be paid":t.to_be_paid?`$${(0,ce.m)(t.to_be_paid)}`:"$0.00"}}));Y(t,`invoices_${(new Date).toISOString().split("T")[0]}.csv`)})(),children:(0,Ke.jsx)(l.A,{})}),(0,Ke.jsx)("button",{className:`${h}`,onClick:()=>{if(!W||0===W.length)return void x.oR.error("Please select invoices to print");const e=e=>{try{const t=new Date(1e3*e),s=t.getDate(),n=new Intl.DateTimeFormat("en-US",{month:"short"}).format(t);return`${s} ${n} ${t.getFullYear()}`}catch(t){return console.log("error: ",t),""}},t=window.open("","_blank"),s=W.reduce(((e,t)=>e+(t.amount||0)),0),n=W.reduce(((e,t)=>e+(t.to_be_paid||0)),0);t.document.write(`\n            <html>\n                <head>\n                    <title>&nbsp;</title>\n                    <style>\n                        body { \n                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n                            margin: 20px; \n                            line-height: 1.4;\n                        }\n                        .header { \n                            text-align: center; \n                            margin-bottom: 30px; \n                            border-bottom: 1px solid #dedede;\n                            padding-bottom: 0px;\n                        }\n                        .meta-info { \n                            text-align: right; \n                            margin-bottom: 20px; \n                            color: #666;\n                            font-size: 14px;\n                        }\n                        table { \n                            width: 100%; \n                            border-collapse: collapse; \n                            margin-top: 20px; \n                            font-size: 8px;\n                        }\n                        th, td { \n                            border: 1px solid #ddd; \n                            padding: 10px; \n                            text-align: left; \n                        }\n                        th { \n                            background-color: #f8f9fa; \n                            font-weight: bold;\n                            color: #333;\n                        }\n                        tr:nth-child(even) { \n                            background-color: #f9f9f9; \n                        }\n                        .total-row {\n                            font-weight: bold;\n                            background-color: #e9ecef !important;\n                        }\n                        @media print {\n                            body { margin: 0; }\n                            .no-print { display: none; }\n                            @page {\n                                margin: 0.5in;\n                                size: A4;\n                                @bottom-left {\n                                    content: "Generated on ${(new Date).toLocaleString()}";\n                                    font-size: 8px;\n                                    color: #666;\n                                }\n                                @bottom-right {\n                                    content: "Page " counter(page) " of " counter(pages);\n                                    font-size: 8px;\n                                    color: #666;\n                                }\n                            }\n                        }\n                    </style>\n                </head>\n                <body>\n                    <div class="header">\n                        <h4>Invoices Report</h4>\n                    </div>\n                    <table>\n                        <thead>\n                            <tr>\n                                <th>Invoice ID</th>\n                                <th style="white-space: nowrap;">Created At</th>\n                                <th>Customer</th>\n                                <th>Invoice Reference</th>\n                                <th style="white-space: nowrap;">Due Date</th>\n                                <th>Total Invoice</th>\n                                <th>To be Paid</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${W.map((t=>{var s;return`\n                                <tr>\n                                    <td>${t.number||""}</td>\n                                    <td style="white-space: nowrap;">${t.created?e(t.created):""}</td>\n                                    <td>${(null===(s=t.client)||void 0===s?void 0:s.name)||""}</td>\n                                    <td>${t.reference||""}</td>\n                                    <td style="white-space: nowrap;">${t.due_date?e(t.due_date):""}</td>\n                                    <td>$${(0,ce.m)(t.amount||0)}</td>\n                                    <td>$${(0,ce.m)(t.to_be_paid||0)}</td>\n                                </tr>\n                            `})).join("")}\n                            <tr class="total-row">\n                                <td colspan="5"><strong>Total</strong></td>\n                                <td><strong>$${(0,ce.m)(s)}</strong></td>\n                                <td><strong>$${(0,ce.m)(n)}</strong></td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </body>\n            </html>\n        `),t.document.close(),setTimeout((()=>{t.print(),t.close()}),250)},children:(0,Ke.jsx)(o.A,{})})]})]}):(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)("div",{className:"filtered-box",children:(0,Ke.jsx)(Pt,{setFilters:O,filter:P})}),(0,Ke.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,Ke.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,Ke.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,Ke.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,Ke.jsx)("input",{type:"text",placeholder:"Search",value:G,onChange:e=>V(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})}),(0,Ke.jsx)("div",{className:"featureName d-flex align-items-center",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,Ke.jsx)("h1",{className:"title p-0",children:"Invoices"})}),(0,Ke.jsxs)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:[D&&(0,Ke.jsx)(vt,{invoices:W}),(0,Ke.jsx)(c.$,{className:k?w:R,onClick:()=>{z(!k),"true"===E&&k&&window.history.pushState({},"","/invoices")},children:"Unpaid"}),k&&(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)("h1",{className:`${m} mb-0`,children:"Total"}),(0,Ke.jsxs)("div",{className:`${v}`,children:[b," Invoice"]}),(0,Ke.jsxs)("h1",{className:S,children:["$",(0,ce.m)(T||0)]})]})]})]}),(null===(e=Object.keys(P))||void 0===e?void 0:e.length)>0&&(0,Ke.jsx)(Dt,{filter:P,setFilters:O}),(0,Ke.jsx)(pt,{ref:s,searchValue:J,setTotal:I,setTotalMoney:C,selected:W,setSelected:M,isShowDeleted:k,refetch:B,setRefetch:L,isFilterEnabled:(null===(t=Object.keys(P))||void 0===t?void 0:t.length)>0,filters:P}),(0,Ke.jsx)(ht.A,{visible:U,setVisible:F,setRefetch:L})]})}},54967:(e,t,s)=>{s.d(t,{Ab:()=>r,dg:()=>d,fr:()=>c,Ay:()=>u});var n=s(65043),i=s(44541),l=s(95192);const o="image-avatar_clientImg__-nnRU";var a=s(70579);const r=e=>{let{has_photo:t,photo:s,is_business:o,size:r}=e;const[d,c]=(0,n.useState)(!1),u=o?i.A:l.A;return(0,a.jsx)(a.Fragment,{children:t&&s&&!d?(0,a.jsx)("img",{src:s,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,a.jsx)(u,{color:"#667085",size:r})})},d=e=>{var t,s,i;let{has_photo:l,photo:o,name:r}=e;const[d,c]=(0,n.useState)(!1),u=r&&(null===r||void 0===r||null===(t=r.split(" "))||void 0===t||null===(s=t.map((e=>e[0])))||void 0===s||null===(i=s.join(""))||void 0===i?void 0:i.toUpperCase())||"";return(0,a.jsx)(a.Fragment,{children:l&&o&&!d?(0,a.jsx)("img",{src:o,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):u})},c=e=>{let{name:t,size:s=14}=e;const n=t.split(" ").map((e=>e[0])).join("").toUpperCase();return(0,a.jsx)("span",{style:{fontSize:`${s}px`},children:n})},u=e=>{let{has_photo:t,photo:s,is_business:r}=e;const[d,c]=(0,n.useState)(!1),u=r?i.A:l.A;return(0,a.jsx)("div",{className:`d-flex justify-content-center align-items-center ${o} ${r?"":"rounded-circle"}`,style:{overflow:"hidden"},children:t&&s&&!d?(0,a.jsx)("img",{src:s,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,a.jsx)(u,{color:"#667085"})})}},63965:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(58387);const i={defaultStatus:"job-status_defaultStatus__emAxy",status:"job-status_status__HXyT-",DRAFT:"job-status_DRAFT__HqpDF",OPEN:"job-status_OPEN__yb7zB",ASSIGNED:"job-status_ASSIGNED__0WFAv",CONFIRMED:"job-status_CONFIRMED__iTcji",DECLINED:"job-status_DECLINED__2RC2+",SUBMITTED:"job-status_SUBMITTED__GFRLu",FINISHED:"job-status_FINISHED__RbfR-",IN_PROGRESS:"job-status_IN_PROGRESS__BoR97"};var l=s(70579);const o=e=>{let{status:t,actionStatus:s,published:o}=e;const a=function(e,t){if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return{label:"Draft",className:"DRAFT",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"};if("a"===e&&t)return{label:"In Progress",className:"IN_PROGRESS",color:"#3D5AFE",backColor:"#EEF1FF",borderColor:"#C3CCFF"};return{1:{label:"Open",className:"OPEN",color:"#065b76",backColor:"#ecf7fd",borderColor:"#a9d6ef"},2:{label:"Assigned",className:"ASSIGNED",color:"#520676",backColor:"#f6ecfd",borderColor:"#dda9ef"},3:{label:"Submitted",className:"SUBMITTED",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"},4:{label:"Finished",className:"FINISHED",color:"#29B27C",backColor:"#BBFFE4",borderColor:"#BBFFE4"},6:{label:"Declined",className:"DECLINED",color:"#b42318",backColor:"#fef3f2",borderColor:"#fecdca"},a:{label:"Confirmed",className:"CONFIRMED",color:"#067647",backColor:"#ecfdf3",borderColor:"#a9efc5"}}[e]||{label:e,className:"defaultStatus"}};return(0,l.jsx)("div",{className:(0,n.A)(i.status,i[a(t,s,o).className]),children:a(t,s,o).label})}},67046:(e,t,s)=>{s.d(t,{D7:()=>l,HT:()=>m,L:()=>h,Op:()=>c,Sg:()=>o,V3:()=>p,WG:()=>d,cS:()=>r,fW:()=>x,j3:()=>a,oe:()=>u});var n=s(31342);const i="https://app.memate.com.au/api/v1",l=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/sales/new-request/`);return(0,n.f)(s.toString(),t)},o=async(e,t)=>{const s={method:"POST",body:{managers:t}},l=new URL(`${i}${`/sales/managers/${e}/`}`);return(0,n.f)(l.toString(),s)},a=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/sales/`,s);return await e.text()}catch(n){throw console.error("Profile fetch error:",n),n}},r=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const l={method:"PUT",headers:s,body:JSON.stringify({sales_note:t}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/notes/`,l);if(!t.ok){const e=await t.text();throw new Error(`Sales notes update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(o){throw console.error("Sales notes update error:",o),o}},d=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/won/`);return(0,n.f)(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/lost/`);return(0,n.f)(s.toString(),t)},u=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const l={method:"POST",headers:s,body:JSON.stringify(t),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/contacts/`,l);return t.ok?t:(console.log("Error:",t.status),null)}catch(o){return console.log("Error:",o),null}},p=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const l={method:"PUT",headers:s,body:JSON.stringify({lead:t,unique_id:e}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/lead/`,l);if(!t.ok){const e=await t.text();throw new Error(`Sales lead update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(o){throw console.error("Sales lead update error:",o),o}},x=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},l=await Promise.all([fetch(`${i}/sales/status/won/`,n)]);return await Promise.all(l.map((e=>e.json())))},h=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"POST",headers:t,redirect:"follow"},l=await fetch(`${i}/sales/${e}/duplicate/`,n);return(await l.json())[0]},m=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},l=await Promise.all([fetch(`${i}/sales/status/lost/`,n)]);return await Promise.all(l.map((e=>e.json())))}},74737:(e,t,s)=>{s.d(t,{_:()=>o});var n=s(568);const i=Object.freeze({ADMIN:"Admin",LOCATION_MANAGER:"Location Manager",GENERAL_MANAGER:"General Manager",DEVELOPER:"Developer",DESIGNER:"Designers",SMM_PR:"SMM/PR"}),l={[i.ADMIN]:{permissions:[n.J.CLIENTS.CREATE,n.J.CLIENTS.READ,n.J.CLIENTS.UPDATE,n.J.CLIENTS.DELETE,n.J.SUPPLIERS.CREATE,n.J.SUPPLIERS.READ,n.J.SUPPLIERS.UPDATE,n.J.SUPPLIERS.DELETE,n.J.EXPENSE.CREATE,n.J.EXPENSE.READ,n.J.EXPENSE.UPDATE,n.J.EXPENSE.DELETE,n.J.INVOICE.CREATE,n.J.INVOICE.READ,n.J.INVOICE.UPDATE,n.J.INVOICE.DELETE,n.J.SETTINGS.SUBSCRIPTION.BUY_BUSINESS_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.CANCEL_BUSINESS_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.BUY_COMPANY_USER_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.BUY_WORK_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.CANCEL_WORK_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.ACTIVE_WORK_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.BUY_WORK_USER_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.BUY_LOCATION_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.REMOVE_LOCATION_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.ACTIVE_INQUIRIES_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.CANCEL_INQUIRIES_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.ACTIVE_ASSETS_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.CANCEL_ASSETS_SUBSCRIPTION,n.J.SETTINGS.SUBSCRIPTION.MANAGE_ASSET_SUBSCRIPTION,n.J.SETTINGS.LOCATION.ADD,n.J.SETTINGS.LOCATION.READ,n.J.SETTINGS.LOCATION.UPDATE,n.J.SETTINGS.LOCATION.DELETE,n.J.SETTINGS.USERS.DESKTOP.ADD,n.J.SETTINGS.USERS.DESKTOP.READ,n.J.SETTINGS.USERS.DESKTOP.DELETE,n.J.SETTINGS.USERS.DESKTOP.UPDATE,n.J.SETTINGS.USERS.DESKTOP.RESTORE,n.J.SETTINGS.USERS.DESKTOP.SHOW_DELETED_USERS,n.J.SETTINGS.USERS.MOBILE_APP.ADD,n.J.SETTINGS.USERS.MOBILE_APP.READ,n.J.SETTINGS.USERS.MOBILE_APP.UPDATE,n.J.SETTINGS.USERS.MOBILE_APP.DISCONNECT_USER,n.J.SETTINGS.USERS.MOBILE_APP.RECONNECT_USER,n.J.SETTINGS.USERS.MOBILE_APP.SHOW_DISCONNECTED_USERS]}},o=function(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!l[e])return!1;const n=l[e].permissions;return Array.isArray(t)?s?t.every((e=>n.includes(e))):t.some((e=>n.includes(e))):n.includes(t)}}}]);
//# sourceMappingURL=2306.ac7c6834.chunk.js.map