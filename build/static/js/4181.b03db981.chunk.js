"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[4181],{24572:(e,s,l)=>{function r(e){var s,l={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},r="";for(s in l)for(;e>=l[s];)r+=s,e-=l[s];return r}function n(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})}l.d(s,{Mf:()=>r,i$:()=>i,up:()=>n});const i=(e,s)=>{if(!e)return"-";const l=new Date(1e3*+e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(l)}},31270:(e,s,l)=>{l.r(s),l.d(s,{default:()=>pe});var r=l(65043),n=l(14282),i=l(41978),a=l(25963),t=l(75329),o=l(39759),d=l(49367),c=l(35475),u=l(93747),m=l(58387),h=l(2028);const x={topBarText:"assets_topBarText__CCjbs",subMenuLink:"assets_subMenuLink__BvfXO",activeVehicle:"assets_activeVehicle__kVJaa",filterBox:"assets_filterBox__lJsEJ",menu:"assets_menu__Ei+5U",newButton:"assets_newButton__psPEt",total:"assets_total__yvH5D",totalCount:"assets_totalCount__Z33NL",selectedCount:"assets_selectedCount__MTDL0",title:"assets_title__EAzKr",subTitle:"assets_subTitle__muLbE"};var p=l(72018),v=l(9642),j=l(64824),b=l(76104),f=l(37990),g=l(79106),y=l(48417),_=l(62284),A=l(61072),N=l(78602),S=l(77918),w=l(56741),C=l(93740),k=l(20288);const E={circledesignstyle:"view-vehicle_circledesignstyle__Nszq-",out:"view-vehicle_out__j1z5f",profileBox:"view-vehicle_profileBox__cOvla",box:"view-vehicle_box__Y75Yn",boxLabel:"view-vehicle_boxLabel__5Lr1h",boxLabel2:"view-vehicle_boxLabel2__u0P3b",label:"view-vehicle_label__HVu--",text:"view-vehicle_text__sarFm",ellipsis:"view-vehicle_ellipsis__I7jaL",fontStanderdSize:"view-vehicle_fontStanderdSize__w1n1F",plusIcon:"view-vehicle_plusIcon__czEKi","paid-false":"view-vehicle_paid-false__UjzaG"};var I=l(24572),F=l(14834),D=l(58027),R=l(47097),T=l(56328),V=l(9634),z=l(24858),B=l(18403),q=l(85371),L=l(88060),$=l(28676),M=l(74532),P=l(79255),Y=l(72052),O=l(80899),W=l(61046),U=l(57189),G=l(27472),H=l(70579);const Z=O.Ik({organization:O.ai().required("Organization is required"),registration_number:O.Yj().required("Registration number is required").min(1,"Registration number must be at least 1 character").max(64,"Registration number must be at most 64 characters"),date_of_expiry:O.p6().required("Date of expiry is required").nullable(),make:O.Yj().required("Make is required").max(64,"Make must be at most 64 characters"),model:O.Yj().required("Model is required").max(64,"Model must be at most 64 characters"),year_manufactured:O.ai().required("Year manufactured is required").min(1900,"Year must be at least 1900").max(2100,"Year must be at most 2100"),fuel_type:O.Yj().oneOf(["gasoline","diesel","petrol","hybrid","electric","hydrogen"],"Invalid fuel type"),vin_number:O.Yj().max(64,"VIN number must be at most 64 characters"),engine_number:O.Yj().max(64,"Engine number must be at most 64 characters"),date_of_purchase:O.p6().required("Date of purchase is required").nullable(),purchased_amount:O.ai().required("Purchase amount is required").min(0,"Purchase amount cannot be negative"),odometer_km:O.ai().min(0,"Odometer cannot be negative"),driver:O.ai().nullable(),insurer:O.Yj().required("Insurer is required").max(128,"Insurer must be at most 128 characters"),insurance_policy_number:O.Yj().required("Insurance policy number is required").max(128,"Insurance policy number must be at most 128 characters"),insurance_expiry:O.p6().required("Insurance expiry is required").nullable(),receipt_number:O.Yj().max(128,"Receipt number must be at most 128 characters"),etag:O.Yj().max(64,"Etag must be at most 64 characters"),colour:O.Yj().max(64,"Colour must be at most 64 characters"),body_type:O.Yj().oneOf(["sedan","suv","hatchback","truck","van","other"],"Invalid body type"),trim:O.Yj().max(64,"Trim must be at most 64 characters")}),K=(0,r.forwardRef)(((e,s)=>{var l;let{onSubmit:r,defaultValues:n,vehicleId:i}=e;const{session:a}=(0,U.As)(),t=(0,u.I)({queryKey:["getUserList"],queryFn:g.aU}),{control:o,register:d,handleSubmit:c,formState:{errors:h}}=(0,z.mN)({resolver:(0,B.t)(Z),defaultValues:{organization:(null===a||void 0===a||null===(l=a.organization)||void 0===l?void 0:l.id)||null,odometer_km:0,...n}}),x=[{value:"gasoline",label:"Gasoline"},{value:"diesel",label:"Diesel"},{value:"petrol",label:"Petrol"},{value:"hybrid",label:"Hybrid"},{value:"electric",label:"Electric"},{value:"hydrogen",label:"Hydrogen"}],p=[{value:"sedan",label:"Sedan"},{value:"suv",label:"SUV"},{value:"hatchback",label:"Hatchback"},{value:"truck",label:"Truck"},{value:"van",label:"Van"},{value:"other",label:"Other"}];return(0,H.jsxs)("form",{ref:s,onSubmit:c(r),children:[(0,H.jsxs)(A.A,{children:[(0,H.jsx)(N.A,{sm:6,children:(0,H.jsx)("h2",{className:W.A.sectionTitle,children:"Vehicle Information"})}),(0,H.jsx)(N.A,{sm:6})]}),(0,H.jsxs)(A.A,{className:(0,m.A)(W.A.bgGreay),children:[(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Registration Number ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.registration_number&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("registration_number"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.registration_number}),placeholder:"Enter car registration number"})]}),h.registration_number&&(0,H.jsx)("p",{className:"error-message",children:h.registration_number.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Rego Expiry Date ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsx)(z.xI,{name:"date_of_expiry",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(q.V,{...s,value:s.value?new Date(s.value):null,onChange:e=>s.onChange(e.value),showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,H.jsx)(V.A,{color:"#667085",size:20}),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.date_of_expiry},"p-0 outline-none")})}}),h.date_of_expiry&&(0,H.jsx)("p",{className:"error-message",children:h.date_of_expiry.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Make ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.make&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("make"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.make}),placeholder:"Enter car make"})]}),h.make&&(0,H.jsx)("p",{className:"error-message",children:h.make.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Model ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.model&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("model"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.model}),placeholder:"Enter car model"})]}),h.model&&(0,H.jsx)("p",{className:"error-message",children:h.model.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Year Manufactured ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsx)(z.xI,{name:"year_manufactured",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(q.V,{value:s.value?new Date(s.value,0,1):null,onChange:e=>{const l=e.value?e.value.getFullYear():null;s.onChange(l)},view:"year",dateFormat:"yy",placeholder:"YYYY",showIcon:!0,style:{height:"46px"},icon:(0,H.jsx)(V.A,{color:"#667085",size:20}),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.year_manufactured},"p-0 outline-none"),yearRange:"1900:2100"})}}),h.year_manufactured&&(0,H.jsx)("p",{className:"error-message",children:h.year_manufactured.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Fuel Type"}),(0,H.jsx)(z.xI,{name:"fuel_type",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(L.m,{...s,options:x,onChange:e=>s.onChange(e.value),className:(0,m.A)(W.A.dropdownSelect,"dropdown-height-fixed",{[W.A.error]:h.fuel_type}),style:{height:"46px"},value:s.value,placeholder:"Select fuel type",scrollHeight:"380px"})}}),h.fuel_type&&(0,H.jsx)("p",{className:"error-message",children:h.fuel_type.message})]})}),(0,H.jsx)(N.A,{sm:12,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"VIN Number"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.vin_number&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("vin_number"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.vin_number}),placeholder:"Enter VIN number"})]}),h.vin_number&&(0,H.jsx)("p",{className:"error-message",children:h.vin_number.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Engine Number"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.engine_number&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("engine_number"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.engine_number}),placeholder:"Enter engine number"})]}),h.engine_number&&(0,H.jsx)("p",{className:"error-message",children:h.engine_number.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Date of Purchase ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsx)(z.xI,{name:"date_of_purchase",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(q.V,{...s,value:s.value?new Date(s.value):null,onChange:e=>s.onChange(e.value),showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,H.jsx)(V.A,{color:"#667085",size:20}),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.date_of_purchase},"p-0 outline-none")})}}),h.date_of_purchase&&(0,H.jsx)("p",{className:"error-message",children:h.date_of_purchase.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Purchased Amount ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(z.xI,{name:"purchased_amount",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(P.Y,{prefix:"$",value:s.value,onValueChange:e=>s.onChange(e.value),style:{height:"46px",padding:"0px"},className:(0,m.A)(W.A.inputText,{[W.A.error]:h.purchased_amount}),placeholder:"$ Enter purchase amount",maxFractionDigits:2,minFractionDigits:2})}}),(0,H.jsx)(M.m,{children:h.purchased_amount&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})})]}),h.purchased_amount&&(0,H.jsx)("p",{className:"error-message",children:h.purchased_amount.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Odometer"}),(0,H.jsxs)("div",{className:W.A.inputGroup,children:[(0,H.jsx)(z.xI,{name:"odometer_km",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(P.Y,{value:s.value,onValueChange:e=>s.onChange(e.value),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.odometer_km},"p-0 pe-5"),placeholder:"Enter ODO",useGrouping:!1,min:0,disabled:!!i})}}),(0,H.jsx)("span",{className:W.A.unitText,children:"km"})]}),h.odometer_km&&(0,H.jsx)("p",{className:"error-message",children:h.odometer_km.message})]})})]}),(0,H.jsx)("h2",{className:(0,m.A)(W.A.headingInputs),children:"Responsible Person"}),(0,H.jsx)(A.A,{className:(0,m.A)(W.A.bgGreay),children:(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Person"}),(0,H.jsx)(z.xI,{name:"driver",placeholder:"Select a person",control:o,render:e=>{var s,l,r;let{field:n}=e;const i={...n,options:[{label:"Desktop User",items:(null===t||void 0===t||null===(s=t.data)||void 0===s||null===(l=s.users)||void 0===l||null===(r=l.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===r?void 0:r.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}],onChange:e=>{n.onChange(e.value)},itemTemplate:e=>(0,H.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,H.jsx)(D.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:(0,m.A)(W.A.dropdownSelect,"outline-none",{[W.A.error]:h.driver}),style:{height:"46px"},value:n.value,placeholder:"Select a person",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"};if(n.value){i.options.flatMap((e=>e.items)).find((e=>e.value===n.value))&&(i.valueTemplate=e=>(0,H.jsxs)("div",{className:"d-flex gap-2 align-items-center ps-2",style:{position:"relative",left:"-10px"},children:[(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,H.jsx)(D.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}))}return(0,H.jsx)(L.m,{...i})}}),h.driver&&(0,H.jsx)("p",{className:"error-message",children:h.driver.message})]})})}),(0,H.jsx)("h2",{className:(0,m.A)(W.A.headingInputs),children:"Insurance and Legal Information"}),(0,H.jsxs)(A.A,{className:(0,m.A)(W.A.bgGreay),children:[(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Insurer ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.insurer&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("insurer"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.insurer}),placeholder:"Enter insurer"})]}),h.insurer&&(0,H.jsx)("p",{className:"error-message",children:h.insurer.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Insurance Policy Number ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.insurance_policy_number&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("insurance_policy_number"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.insurance_policy_number}),placeholder:"Enter insurance policy number"})]}),h.insurance_policy_number&&(0,H.jsx)("p",{className:"error-message",children:h.insurance_policy_number.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsxs)("label",{className:(0,m.A)(W.A.lable),children:["Insurance Expiry ",(0,H.jsx)("span",{className:"required",children:"*"})]}),(0,H.jsx)(z.xI,{name:"insurance_expiry",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(q.V,{...s,value:s.value?new Date(s.value):null,onChange:e=>s.onChange(e.value),showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,H.jsx)(V.A,{color:"#667085",size:20}),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.insurance_expiry},"p-0 outline-none")})}}),h.insurance_expiry&&(0,H.jsx)("p",{className:"error-message",children:h.insurance_expiry.message})]})})]}),(0,H.jsx)("h2",{className:(0,m.A)(W.A.headingInputs),children:"Other"}),(0,H.jsxs)(A.A,{className:(0,m.A)(W.A.bgGreay),children:[(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Receipt Number"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.receipt_number&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("receipt_number"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.receipt_number}),placeholder:"Enter invoice number"})]}),h.receipt_number&&(0,H.jsx)("p",{className:"error-message",children:h.receipt_number.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Etag"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.etag&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("etag"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.etag}),placeholder:"Enter car etag"})]}),h.etag&&(0,H.jsx)("p",{className:"error-message",children:h.etag.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Colour"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.colour&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("colour"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.colour}),placeholder:"White"})]}),h.colour&&(0,H.jsx)("p",{className:"error-message",children:h.colour.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Body Type"}),(0,H.jsx)(z.xI,{name:"body_type",control:o,render:e=>{let{field:s}=e;return(0,H.jsx)(L.m,{...s,options:p,onChange:e=>s.onChange(e.value),className:(0,m.A)(W.A.dropdownSelect,"dropdown-height-fixed",{[W.A.error]:h.body_type}),style:{height:"46px"},value:s.value,placeholder:"Select body type",scrollHeight:"380px"})}}),h.body_type&&(0,H.jsx)("p",{className:"error-message",children:h.body_type.message})]})}),(0,H.jsx)(N.A,{sm:6,children:(0,H.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,H.jsx)("label",{className:(0,m.A)(W.A.lable),children:"Trim"}),(0,H.jsxs)($.C,{children:[(0,H.jsx)(M.m,{children:h.trim&&(0,H.jsx)("img",{src:G.A,className:"mb-3"})}),(0,H.jsx)(Y.S,{...d("trim"),className:(0,m.A)(W.A.inputText,{[W.A.error]:h.trim}),placeholder:"Black"})]}),h.trim&&(0,H.jsx)("p",{className:"error-message",children:h.trim.message})]})})]})]})})),X=(0,r.forwardRef)(((e,s)=>{let{vehicle:l,setIsEdit:r,refetch:n,setIsPending:i,handleExternalSubmit:a,setVisible:t,setRefetch:o}=e;const d=(0,R.n)({mutationFn:e=>(0,f.Q3)(null===l||void 0===l?void 0:l.id,e),onMutate:()=>{i&&i(!0)},onSuccess:()=>{T.oR.success("Vehicle updated successfully"),r&&r(!1),t&&t(!1),o&&o((e=>!e)),n&&n(),i&&i(!1)},onError:e=>{var s,l;T.oR.error((null===e||void 0===e||null===(s=e.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||"Failed to update vehicle"),i&&i(!1)}});function c(e){if(!e)return"";return`${(e=new Date(e)).getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const u=l?{organization:l.organization,registration_number:l.registration_number||"",date_of_expiry:l.date_of_expiry?new Date(1e3*l.date_of_expiry):null,make:l.make||"",model:l.model||"",year_manufactured:l.year_manufactured||null,fuel_type:l.fuel_type||"",vin_number:l.vin_number||"",engine_number:l.engine_number||"",date_of_purchase:l.date_of_purchase?new Date(1e3*l.date_of_purchase):null,purchased_amount:l.purchased_amount||null,odometer_km:l.odometer_km||0,driver:l.driver||null,insurer:l.insurer||"",insurance_policy_number:l.insurance_policy_number||"",insurance_expiry:l.insurance_expiry?new Date(1e3*l.insurance_expiry):null,receipt_number:l.receipt_number||"",etag:l.etag||"",colour:l.colour||"",body_type:l.body_type||"",trim:l.trim||"",disabled:l.disabled||!1,is_deleted:l.is_deleted||!1}:{};return(0,H.jsx)(K,{ref:s,vehicleId:null===l||void 0===l?void 0:l.id,onSubmit:e=>{const s={...e,date_of_expiry:c(e.date_of_expiry),date_of_purchase:c(e.date_of_purchase),insurance_expiry:c(e.insurance_expiry)};d.mutate(s)},defaultValues:u,isLoading:d.isPending})})),J=e=>{if(!e)return"-";const s=new Date(1e3*+e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(s)},Q=e=>{let{vehicle:s,drivers:l}=e;const r=l[null===s||void 0===s?void 0:s.driver];return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{className:E.box,children:[(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Registration Number"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.registration_number)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Date Of Expiry"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.date_of_expiry?J(s.date_of_expiry):"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Make"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.make)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Model"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.model)||"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Year Manufactured"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.year_manufactured)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Fuel Type"}),(0,H.jsx)("h4",{className:E.text,children:{gasoline:"Gasoline",diesel:"Diesel",petrol:"Petrol",hybrid:"Hybrid",electric:"Electric",hydrogen:"Hydrogen"}[null===s||void 0===s?void 0:s.fuel_type]||"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"VIN Number"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.vin_number)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Engine Number"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.engine_number)||"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Date of Purchase"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.date_of_purchase?J(s.date_of_purchase):"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Purchased Amount"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.purchased_amount?"$"+(0,I.up)(s.purchased_amount):"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Purchase Odometer"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.purchase_odometer_km?`${s.purchase_odometer_km.toLocaleString()} km`:"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Current Odometer"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.odometer_km?`${s.odometer_km.toLocaleString()} km`:"-"})]})]})]}),(0,H.jsx)("h5",{className:E.boxLabel,children:"Responsible Person"}),(0,H.jsx)("div",{className:E.box,children:l[null===s||void 0===s?void 0:s.driver]?(0,H.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,H.jsx)(D.A,{photo:null===r||void 0===r?void 0:r.photo,has_photo:null===r||void 0===r?void 0:r.has_photo,is_business:!1,size:17})}),null===r||void 0===r?void 0:r.first_name," ",null===r||void 0===r?void 0:r.last_name]}):"-"}),(0,H.jsx)("h5",{className:E.boxLabel,children:"Insurance and Legal Information"}),(0,H.jsxs)("div",{className:E.box,children:[(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Insurer"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.insurer)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Insurance Policy Number"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.insurance_policy_number)||"-"})]})]}),(0,H.jsx)(A.A,{children:(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Insurance Expiry"}),(0,H.jsx)("h4",{className:E.text,children:null!==s&&void 0!==s&&s.insurance_expiry?J(s.insurance_expiry):"-"})]})})]}),(0,H.jsx)("h5",{className:E.boxLabel,children:"Other"}),(0,H.jsxs)("div",{className:E.box,children:[(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Receipt Number"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.receipt_number)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Etag"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.etag)||"-"})]})]}),(0,H.jsxs)(A.A,{children:[(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Colour"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.colour)||"-"})]}),(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Body Type"}),(0,H.jsx)("h4",{className:E.text,children:{sedan:"Sedan",suv:"SUV",hatchback:"Hatchback",truck:"Truck",van:"Van",other:"Other"}[null===s||void 0===s?void 0:s.body_type]||"-"})]})]}),(0,H.jsx)(A.A,{children:(0,H.jsxs)(N.A,{sm:6,children:[(0,H.jsx)("label",{className:E.label,children:"Trim"}),(0,H.jsx)("h4",{className:E.text,children:(null===s||void 0===s?void 0:s.trim)||"-"})]})})]}),(0,H.jsx)("h5",{className:E.boxLabel,children:"Service History"}),(0,H.jsx)(ee,{vehicleId:null===s||void 0===s?void 0:s.id})]})},ee=e=>{let{vehicleId:s}=e;const[l,n]=(0,r.useState)([]),[i,a]=(0,r.useState)(1),[t,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(!1),u=(0,r.useRef)(null),m=(0,r.useRef)(null);(0,r.useEffect)((()=>{(async()=>{if(s){c(!0);try{var e;const r=await(0,f.bX)(s,i,10,"","-date");var l;if(1===i)n((null===r||void 0===r?void 0:r.results)||[]);else(null===r||void 0===r||null===(l=r.results)||void 0===l?void 0:l.length)>0&&n((e=>{const s=new Set(e.map((e=>e.id))),l=r.results.filter((e=>!s.has(e.id)));return[...e,...l]}));o(10===(null===r||void 0===r||null===(e=r.results)||void 0===e?void 0:e.length))}catch(r){console.error("Error fetching services:",r)}finally{c(!1)}}})()}),[s,i]),(0,r.useEffect)((()=>{if(t&&!d)return u.current=new IntersectionObserver((e=>{e[0].isIntersecting&&!d&&a((e=>e+1))})),m.current&&u.current.observe(m.current),()=>{u.current&&u.current.disconnect()}}),[t,d,l]);const h=e=>{if(!e)return"-";const s=new Date(1e3*+e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(s)};return s?(0,H.jsx)("div",{className:E.box,style:{padding:"0",maxHeight:"300px",overflow:"auto"},children:0!==l.length||d?(0,H.jsxs)("div",{children:[l.map(((e,s)=>(0,H.jsxs)("div",{ref:s===l.length-1?m:null,style:{padding:"16px 24px",borderBottom:s<l.length-1?"1px solid #EAECF0":"none"},children:[(0,H.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[(0,H.jsxs)("div",{children:[(0,H.jsxs)("div",{style:{fontWeight:"500",fontSize:"14px",color:"#344054"},children:["ID: ",e.id||"-"]}),(0,H.jsxs)("div",{style:{fontSize:"12px",color:"#98A2B3",marginTop:"4px"},children:["Expense: ",e.number||"-"]})]}),(0,H.jsxs)("div",{style:{fontWeight:"500",fontSize:"14px",color:"#344054"},children:["$",(0,F.m)(e.cost||0)]})]}),(0,H.jsxs)("div",{className:"d-flex gap-3",style:{fontSize:"13px",color:"#667085"},children:[e.odometer_km&&(0,H.jsxs)("div",{children:[(0,H.jsx)("span",{style:{color:"#98A2B3"},children:"Odometer: "}),e.odometer_km.toLocaleString()," km"]}),e.upcoming_date&&(0,H.jsxs)("div",{children:[(0,H.jsx)("span",{style:{color:"#98A2B3"},children:"Next Service: "}),h(e.upcoming_date)]})]}),e.notes&&(0,H.jsxs)("div",{style:{marginTop:"8px",fontSize:"13px",color:"#667085"},children:["Note: ",e.notes]})]},e.id))),d&&(0,H.jsx)("div",{style:{padding:"16px",textAlign:"center"},children:(0,H.jsx)(C.p,{style:{width:"24px",height:"24px"}})})]}):(0,H.jsx)("div",{style:{padding:"24px",textAlign:"center",color:"#98A2B3"},children:"No service history found"})}):null},se=e=>{let{vehicleId:s}=e;const[l,n]=(0,r.useState)([]),[i,a]=(0,r.useState)(1),[t,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(!1),u=(0,r.useRef)(null),m=(0,r.useRef)(null);(0,r.useEffect)((()=>{(async()=>{if(s){c(!0);try{const e=await(0,f.jG)(1,s,i,100,"-id");1===i?n(e||[]):(null===e||void 0===e?void 0:e.length)>0&&n((s=>{const l=new Set(s.map((e=>e.id))),r=e.filter((e=>!l.has(e.id)));return[...s,...r]})),o(100===e.length)}catch(e){console.error("Error fetching linked expenses:",e)}finally{c(!1)}}})()}),[s,i]),(0,r.useEffect)((()=>{if(t&&!d)return u.current=new IntersectionObserver((e=>{e[0].isIntersecting&&!d&&a((e=>e+1))})),m.current&&u.current.observe(m.current),()=>{u.current&&u.current.disconnect()}}),[t,d]);const h=e=>{if(!e)return"-";const s=new Date(1e3*+e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(s)};return s?(0,H.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,H.jsx)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:0!==l.length||d?(0,H.jsxs)(j.b,{value:l,scrollable:!0,scrollHeight:"flex",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"small",rowsPerPageOptions:[10,25,50],paginator:!1,loading:d,emptyMessage:"No linked expenses found",style:{flex:1},className:"border",children:[(0,H.jsx)(v.V,{field:"number",header:"Expense ID",body:e=>{var s;return(0,H.jsxs)("div",{className:"d-flex flex-column",style:{lineHeight:"1.385"},children:[(0,H.jsx)("span",{style:{fontWeight:"400",color:"#667085"},children:(null===(s=e.number)||void 0===s?void 0:s.split("-")[1])||e.number}),(0,H.jsx)("span",{style:{fontSize:"12px",color:"#98A2B3"},children:h(e.created)})]})},style:{minWidth:"140px"}}),(0,H.jsx)(v.V,{field:"supplier.name",header:"Supplier",body:e=>{var s,l,r;return(0,H.jsxs)("div",{className:"d-flex align-items-center",children:[(0,H.jsx)(D.h,{has_photo:null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.has_photo,photo:null===e||void 0===e||null===(l=e.supplier)||void 0===l?void 0:l.photo,is_business:!0,size:16}),(0,H.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,H.jsx)("div",{className:`${E.ellipsis}`,children:null===(r=e.supplier)||void 0===r?void 0:r.name}),e.deleted?(0,H.jsx)(b.v,{value:"Deleted",style:{height:"22px",width:"59px",borderRadius:"16px",border:"1px solid #FECDCA",background:"#FEF3F2",color:"#912018",fontSize:"12px",fontWeight:500}}):""]})]})},style:{minWidth:"180px"}}),(0,H.jsx)(v.V,{field:"invoice_reference",header:"Reference",body:e=>(0,H.jsx)("span",{style:{color:"#667085",fontSize:"14px"},title:e.invoice_reference,children:e.invoice_reference||"-"}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"due_date",header:"Due Date",body:e=>(0,H.jsx)("span",{style:{color:"#667085",fontSize:"14px"},children:h(e.due_date)}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"total",header:"Total",body:e=>(0,H.jsx)("div",{className:`d-flex align-items-center justify-content-end show-on-hover ${E.fontStanderdSize}`,children:(0,H.jsxs)("div",{className:`${e.paid?E["paid-true"]:E["paid-false"]}`,children:["$",(0,F.m)(e.total)]})}),style:{minWidth:"100px",textAlign:"right"}}),(0,H.jsx)(v.V,{field:"account_code",header:"Account Code",body:e=>{var s,l;return(0,H.jsxs)("span",{style:{color:"#667085",fontSize:"14px"},children:[null===(s=e.account_code)||void 0===s?void 0:s.code,":",null===(l=e.account_code)||void 0===l?void 0:l.name]})},style:{minWidth:"150px"}})]}):(0,H.jsxs)("div",{style:{padding:"48px 24px",textAlign:"center",color:"#98A2B3",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1},children:[(0,H.jsx)("div",{style:{fontSize:"14px",marginBottom:"8px"},children:"No linked expenses found"}),(0,H.jsx)("div",{style:{fontSize:"12px",color:"#D0D5DD"},children:"Expenses linked to this vehicle will appear here"})]})}),d&&(0,H.jsx)("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid #EAECF0"},children:(0,H.jsx)(C.p,{style:{width:"24px",height:"24px"}})})]}):null},le=e=>{let{visible:s,setVisible:l,editData:i,onClose:a,setRefetch:t,drivers:o}=e;const d=(0,r.useRef)(null),[c,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1),[p,v]=(0,r.useState)(!0),j=null===i||void 0===i?void 0:i.id,b=(0,u.I)({queryKey:["getVehicle",j],queryFn:()=>(0,f.Dh)(j),enabled:!!j}),g=null===b||void 0===b?void 0:b.data,[y,A]=(0,r.useState)(!1),[N,I]=(0,r.useState)(null),F=()=>{d.current&&d.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(k.B,{visible:s,position:"right",onHide:a,modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:r}=e;return(0,H.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"12px 24px"},children:[(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)("div",{className:E.circledesignstyle,children:(0,H.jsx)("div",{className:E.out,children:(0,H.jsx)(S.A,{size:24,color:"#17B26A"})})}),(0,H.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Vehicle Information"})]}),(0,H.jsx)("span",{children:(0,H.jsx)(n.A,{type:"button",className:"text-button",ref:s,onClick:e=>r(e),children:(0,H.jsx)(w.A,{size:24,color:"#667085"})})})]}),(0,H.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 100px)",overflow:"auto"},children:[!h&&(0,H.jsx)("div",{className:"d-flex align-items-center justify-content-between",children:(0,H.jsx)("h5",{className:E.boxLabel,children:"General Information"})}),g&&!h?(0,H.jsx)(Q,{vehicle:g,drivers:o}):g&&(0,H.jsx)(X,{ref:d,vehicle:g,setVisible:l,setIsEdit:x,refetch:b.refetch,setIsPending:m,handleExternalSubmit:F,setRefetch:t})]}),(0,H.jsx)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:h?(0,H.jsxs)("div",{className:"d-flex align-items-center gap-3",children:[(0,H.jsx)(n.A,{type:"button",onClick:e=>{e.stopPropagation(),x(!1)},className:"outline-button",children:"Cancel"}),(0,H.jsx)(n.A,{type:"button",onClick:F,className:"solid-button",style:{minWidth:"179px"},children:c?(0,H.jsx)(C.p,{style:{width:"20px",height:"20px"}}):"Save Vehicle Details"})]}):(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between gap-3 w-100",children:[(0,H.jsx)(n.A,{type:"button",onClick:()=>{A(!0),I({id:j,type:1})},className:"outline-button",children:"Create Expense"}),(0,H.jsx)(n.A,{type:"button",onClick:e=>{e.stopPropagation(),x(!0)},className:"solid-button",children:"Edit Vehicle"})]})})]})}}),(0,H.jsx)(k.B,{visible:p,header:(0,H.jsx)("div",{style:{borderBottom:"1px solid #EAECF0",width:"100%",padding:"0px 0px 10px 0px"},children:(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2 w-100",children:[(0,H.jsx)("div",{className:E.circledesignstyle,children:(0,H.jsx)("div",{className:E.out,children:(0,H.jsx)(S.A,{size:24,color:"#17B26A"})})}),(0,H.jsx)("span",{style:{color:"#344054",fontSize:"20px",fontWeight:600},children:"Linked Expenses"})]})}),position:"right",modal:!1,dismissable:!1,style:{width:"1200px",paddingRight:"720px"},maskClassName:"p-sidebar-mask-linkedExpense",onHide:()=>v(!1),children:(0,H.jsx)(se,{vehicleId:j})}),y&&(null===N||void 0===N?void 0:N.id)&&(0,H.jsx)(_.A,{visible:y,setVisible:A,setRefetch:t,assetForExpense:N})]})};var re=l(27734),ne=l(99868);const ie=e=>{if(!e)return"-";if(/^\d{4}-\d{2}-\d{2}$/.test(e)){const s=new Date(e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(s)}const s=new Date(1e3*+e);return new Intl.DateTimeFormat("en-AU",{timeZone:"Australia/Sydney",day:"numeric",month:"short",year:"numeric"}).format(s)},ae=(0,r.forwardRef)(((e,s)=>{let{searchValue:l,selected:n,setSelected:i,refetch:a,setRefetch:t}=e;const{trialHeight:o}=(0,y.$)(),d=(0,r.useRef)(null),[m,h]=(0,r.useState)({}),[A,N]=(0,r.useState)([]),[S,w]=(0,r.useState)(1),[C,k]=(0,r.useState)({sortField:"id",sortOrder:-1}),[E,I]=(0,r.useState)({sortField:"id",sortOrder:-1}),[F,R]=(0,r.useState)(!0),[T,V]=(0,r.useState)(!1),[z,B]=(0,r.useState)(!1),[q,L]=(0,r.useState)(null),[$,M]=(0,r.useState)(!1),[P,Y]=(0,r.useState)(null),O=(0,u.I)({queryKey:["getUserList"],queryFn:g.aU}),W=(0,u.I)({queryKey:["getMobileUserList"],queryFn:g.gy});(0,r.useEffect)((()=>{var e,s,l,r;const n={};(null===O||void 0===O||null===(e=O.data)||void 0===e||null===(s=e.users)||void 0===s?void 0:s.length)>0&&O.data.users.forEach((e=>{n[e.id]=e})),(null===W||void 0===W||null===(l=W.data)||void 0===l||null===(r=l.users)||void 0===r?void 0:r.length)>0&&W.data.users.forEach((e=>{n[e.id]=e})),h(n)}),[null===O||void 0===O?void 0:O.data,null===W||void 0===W?void 0:W.data]),(0,r.useEffect)((()=>{w(1)}),[l,a]),(0,r.useEffect)((()=>{(async()=>{V(!0);let e="";1===(null===E||void 0===E?void 0:E.sortOrder)?e=`${E.sortField}`:-1===(null===E||void 0===E?void 0:E.sortOrder)&&(e=`-${E.sortField}`);const s=await(0,f.RN)(S,25,l,e);var r;1===S?(N(s.results),R(s.count>s.results.length)):(null===s||void 0===s||null===(r=s.results)||void 0===r?void 0:r.length)>0?N((e=>{const l=new Set(e.map((e=>e.id))),r=s.results.filter((e=>!l.has(e.id))),n=[...e,...r];return R(s.count>n.length),n})):R(!1);k(E),V(!1)})()}),[S,l,E,a]),(0,r.useEffect)((()=>{if(A.length>0&&F){d.current=new IntersectionObserver((e=>{e[0].isIntersecting&&w((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&d.current.observe(e)}return()=>{d.current&&d.current.disconnect()}}),[A,F]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(j.b,{ref:s,value:A,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${o}px)`,className:"border",selection:n,onSelectionChange:e=>i(e.value),loading:T,loadingIcon:re.A,emptyMessage:(0,H.jsx)(ne.A,{isDataExist:!!l}),sortField:null===C||void 0===C?void 0:C.sortField,sortOrder:null===C||void 0===C?void 0:C.sortOrder,onSort:e=>{const{sortField:s,sortOrder:l}=e;I({sortField:s,sortOrder:l}),w(1)},rowClassName:e=>null!==e&&void 0!==e&&e.deleted?x.deletedRow:"",children:[(0,H.jsx)(v.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",style:{zIndex:2},headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,H.jsx)(v.V,{field:"make",header:"Make",body:e=>(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between show-on-hover",children:[(0,H.jsxs)("div",{className:"d-flex flex-column",style:{lineHeight:"1.385"},children:[(0,H.jsx)("span",{children:e.make||"-"}),(0,H.jsx)("span",{className:"font-12",style:{color:"#98A2B3"},children:ie(e.created_at)})]}),(0,H.jsx)(p.$,{label:"Open",onClick:()=>{B(!0),L({id:null===e||void 0===e?void 0:e.id})},className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),headerClassName:"paddingLeftHide shadowRight",bodyClassName:"paddingLeftHide shadowRight",style:{minWidth:"150px"},sortable:!0,frozen:!0}),(0,H.jsx)(v.V,{field:"model",header:"Model",body:e=>(0,H.jsx)("span",{children:e.model||"-"}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"year_manufactured",header:"Year",body:e=>(0,H.jsx)("span",{children:e.year_manufactured||"-"}),style:{minWidth:"80px"}}),(0,H.jsx)(v.V,{field:"date_of_purchase",header:"Purchase Date",body:e=>(0,H.jsx)("span",{children:ie(e.date_of_purchase)}),style:{minWidth:"80px"}}),(0,H.jsx)(v.V,{field:"registration_number",header:"Rego",body:e=>(0,H.jsx)("span",{children:e.registration_number||"-"}),style:{minWidth:"100px"}}),(0,H.jsx)(v.V,{field:"rego_due",header:"Rego Expiry",body:e=>(0,H.jsx)("span",{children:ie(e.insurance_expiry)}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"driver",header:"Assigned To",body:e=>{const s=m[e.driver];return s?(0,H.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,H.jsx)(D.A,{photo:null===s||void 0===s?void 0:s.photo,has_photo:null===s||void 0===s?void 0:s.has_photo,is_business:!1,size:17})}),null===s||void 0===s?void 0:s.first_name," ",null===s||void 0===s?void 0:s.last_name]}):(0,H.jsx)("span",{children:"-"})},style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"next_service",header:"Next Service",body:e=>(0,H.jsx)("span",{children:ie(e.next_service_date)}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{header:"Service/Expense",body:e=>(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)(c.N_,{to:`/assets/vehicles/${e.id}/service-history`,children:(0,H.jsx)(b.v,{value:"Service",style:{height:"22px",minWidth:"60px",borderRadius:"16px",border:"1px solid #1AB2FF",background:"#EBF8FF",color:"#1AB2FF",fontSize:"12px",fontWeight:500}})}),(0,H.jsx)(b.v,{value:"Expense",onClick:()=>{M(!0),Y({id:e.id,type:1})},style:{height:"22px",minWidth:"60px",borderRadius:"16px",border:"1px solid #f96a94",background:"linear-gradient(135deg, rgba(247, 79, 172, 0.1) 0%, rgba(252, 178, 79, 0.1) 100%), #fff",color:"#f96a94",fontSize:"12px",fontWeight:500,cursor:"pointer"}})]}),style:{minWidth:"80px"}}),(0,H.jsx)(v.V,{field:"current_odometer",header:"Current Odometer",body:e=>(0,H.jsx)("span",{children:e.odometer_km?`${parseInt(e.odometer_km).toLocaleString()} km`:"-"}),style:{minWidth:"130px"}}),(0,H.jsx)(v.V,{field:"days_of_ownership",header:"Days of Ownership",body:e=>(0,H.jsx)("span",{children:e.days_of_ownership||"-"}),style:{minWidth:"140px"}}),(0,H.jsx)(v.V,{field:"per_km_cost",header:"Cost per km",body:e=>(0,H.jsx)("span",{children:e.per_km_cost?`$${parseFloat(e.per_km_cost).toFixed(2)} per km`:"-"}),style:{minWidth:"120px"}}),(0,H.jsx)(v.V,{field:"per_day_expense",header:"Cost per day",body:e=>(0,H.jsx)("span",{children:e.per_day_expense?`$${parseFloat(e.per_day_expense).toFixed(2)} per day`:"-"}),style:{minWidth:"120px"}})]}),z&&(null===q||void 0===q?void 0:q.id)&&(0,H.jsx)(le,{visible:z,setVisible:B,editData:q,setEditData:L,onClose:()=>{B(!1),L(null)},setRefetch:t,drivers:m}),$&&(null===P||void 0===P?void 0:P.id)&&(0,H.jsx)(_.A,{visible:$,setVisible:M,setRefetch:t,assetForExpense:P})]})})),te=ae;var oe=l(20793),de=l(93202);const ce="create-new-vehicle_circledesignstyle__1Zy9g",ue="create-new-vehicle_out__JkUym",me=e=>{let{visible:s,setVisible:l,setRefetch:i}=e;const a=(0,r.useRef)(null),[t]=(0,r.useState)({}),o=(0,R.n)({mutationFn:e=>(0,f.T_)(e),onSuccess:e=>{console.log("response: ",e),T.oR.success("Vehicle created successfully"),l(!1),i((e=>!e))},onError:e=>{console.error("Error creating vehicle:",e),T.oR.error("Failed to create vehicle. Please try again.")}});function d(e){if(!e)return"";return`${(e=new Date(e)).getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const c=async e=>{const s={...e,date_of_expiry:d(e.date_of_expiry),date_of_purchase:d(e.date_of_purchase),insurance_expiry:d(e.insurance_expiry)};o.mutate(s)},u=()=>{a.current&&a.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,H.jsx)(k.B,{visible:s,position:"right",onHide:()=>l(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:r}=e;return(0,H.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,H.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"16px 24px"},children:[(0,H.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,H.jsx)("div",{className:ce,children:(0,H.jsx)("div",{className:ue,children:(0,H.jsx)(de.A,{size:24,color:"#17B26A"})})}),(0,H.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Add new Vehicle"})]}),(0,H.jsx)("span",{children:(0,H.jsx)(n.A,{type:"button",className:"text-button",ref:s,onClick:e=>r(e),children:(0,H.jsx)(w.A,{size:24,color:"#667085"})})})]}),(0,H.jsx)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 105px)",overflow:"auto"},children:(0,H.jsx)(K,{ref:a,onSubmit:c,defaultValues:t})}),(0,H.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,H.jsx)(n.A,{type:"button",onClick:e=>{e.stopPropagation(),l(!1)},className:"outline-button",children:"Cancel"}),(0,H.jsx)(n.A,{type:"button",disabled:o.isPending,onClick:u,className:"solid-button",style:{minWidth:"75px"},children:o.isLoading?(0,H.jsx)(C.p,{style:{width:"20px",height:"20px"}}):"Save"})]})]})}})},he={vehicles:{color:"#17B26A",backgroundColor:"#ecfdf3",icon:(0,H.jsx)(i.A,{color:"#17B26A",size:16,className:"me-2"})},equipment:{color:"#1AB2FF",backgroundColor:"#f0f9ff",icon:(0,H.jsx)(a.A,{color:"#1AB2FF",size:16,className:"me-2"})}},xe=e=>{let{color:s="#000000",size:l=16}=e;return(0,H.jsx)(a.A,{color:s,size:l,className:"me-2"})},pe=()=>{const e=(0,r.useRef)(null),[s,l]=(0,r.useState)(!1),[i,a]=(0,r.useState)(!1),[p,v]=(0,r.useState)(null),[j,b,g]=(0,h.d7)("",400),[y,_]=(0,c.ok)(),A=y.get("type"),N=(0,u.I)({queryKey:["assetCategories"],queryFn:f.UU,staleTime:0}),S=(0,r.useMemo)((()=>{var e,s;const l=(null===N||void 0===N?void 0:N.data)||[];return(null===l||void 0===l||null===(e=l.results)||void 0===e||null===(s=e.filter((e=>e.enabled)))||void 0===s?void 0:s.map((e=>{const s=he[e.asset_slug];return{...e,label:e.asset_name,value:e.id,color:(null===s||void 0===s?void 0:s.color)||"#6B7280",backgroundColor:(null===s||void 0===s?void 0:s.backgroundColor)||"#F3F4F6",icon:(null===s||void 0===s?void 0:s.icon)||(0,H.jsx)(xe,{color:(null===s||void 0===s?void 0:s.color)||"#6B7280"})}})))||[]}),[null===N||void 0===N?void 0:N.data]);(0,r.useEffect)((()=>{if(S.length>0&&!A){const e=S[0];_({type:e.asset_slug})}}),[S,A,_]);const w=S.find((e=>e.asset_slug===A))||S[0];return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(d.mg,{children:(0,H.jsxs)("title",{children:["MeMate - ",(null===w||void 0===w?void 0:w.label)||"Assets"]})}),(0,H.jsxs)("div",{className:`topbar ${null!==p&&void 0!==p&&p.length?x.active:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,H.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==p&&void 0!==p&&p.length?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("h6",{className:x.selectedCount,children:["Selected: ",null===p||void 0===p?void 0:p.length]}),(0,H.jsx)("div",{className:"filtered-box",children:(0,H.jsx)("button",{className:`${x.filterBox}`,onClick:()=>{return s=!0,void(e.current?e.current.exportCSV({selectionOnly:s}):console.error("DataTable ref is null"));var s},children:(0,H.jsx)(t.A,{})})})]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)("div",{className:"filtered-box",children:(0,H.jsx)("button",{className:`${x.filterBox}`,onClick:()=>{},children:(0,H.jsx)(o.A,{size:20})})}),(0,H.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,H.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,H.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,H.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,H.jsx)("input",{type:"text",placeholder:"Search",value:j,onChange:e=>g(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})}),(0,H.jsx)("div",{className:"featureName d-flex align-items-center gap-3",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:S&&S.length>0&&S.map((e=>{const s=A===e.asset_slug||!A&&e===S[0];return(0,H.jsxs)("button",{onClick:()=>{return s=e.asset_slug,_({type:s}),void v(null);var s},className:(0,m.A)("d-flex align-items-center px-2 py-1",x.subMenuLink,{[x.activeVehicle]:s}),style:{backgroundColor:s?e.backgroundColor:"transparent",color:s?e.color:"#6B7280",border:"none",cursor:"pointer",borderRadius:"4px"},children:[r.cloneElement(e.icon,{color:s?e.color:"#6B7280"}),(0,H.jsx)("span",{className:x.topBarText,children:e.label})]},e.id)}))}),(0,H.jsx)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:A&&(0,H.jsxs)(n.A,{onClick:()=>a(!0),className:`${x.newButton}`,children:["New ",(null===w||void 0===w?void 0:w.label)||"Asset"]})})]}),N.isLoading?(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"calc(100vh - 200px)"},children:(0,H.jsx)(re.A,{})}):0===S.length?(0,H.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"calc(100vh - 200px)"},children:(0,H.jsxs)("div",{className:"position-relative d-flex align-items-center flex-column",children:[(0,H.jsx)("img",{src:oe,alt:"no-data",style:{width:"300px",objectFit:"contain"}}),(0,H.jsx)("h2",{className:(0,m.A)(x.title),children:"You have not enabled any assets"}),(0,H.jsx)("p",{className:(0,m.A)(x.subTitle),children:"To use this feature, please enable at least one asset type via Settings > Subscription "})]})}):A&&"vehicles"===A&&w&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(te,{ref:e,searchValue:b,selected:p,setSelected:v,refetch:s,setRefetch:l}),(0,H.jsx)(me,{visible:i,setVisible:a,setRefetch:l})]})]})}},61046:(e,s,l)=>{l.d(s,{A:()=>r});const r={sectionTitle:"vehicle-form_sectionTitle__oCFoK",bgGreay:"vehicle-form_bgGreay__ScM6U",lable:"vehicle-form_lable__61kdI",inputText:"vehicle-form_inputText__4fVSj",error:"vehicle-form_error__aD6HI",headingInputs:"vehicle-form_headingInputs__kPF2t",dropdownSelect:"vehicle-form_dropdownSelect__RSqX8",inputGroup:"vehicle-form_inputGroup__KlaAw","p-inputnumber":"vehicle-form_p-inputnumber__gBeQY","p-inputtext":"vehicle-form_p-inputtext__GQdsO",unitText:"vehicle-form_unitText__wsry3",expensesCreateNew:"vehicle-form_expensesCreateNew__CWBMR"}},79106:(e,s,l)=>{l.d(s,{Af:()=>t,U9:()=>i,aU:()=>d,gg:()=>a,gy:()=>c,lC:()=>o});var r=l(31342);const n="https://app.memate.com.au/api/v1",i=async function(e,s){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],t=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0;const d=(e-1)*s,c=new URL(`${n}/tasks/`);return c.searchParams.append("limit",s),c.searchParams.append("offset",d),l&&c.searchParams.append("search",l),i&&c.searchParams.append("ordering",i),a&&c.searchParams.append("deleted",1),!0===t&&c.searchParams.append("finished",!1),!1===t&&c.searchParams.append("finished",!0),o&&c.searchParams.append("users",o),(0,r.f)(c.toString(),{method:"GET"})},a=async e=>{const s=new URL(`${n}${`/tasks/${e}/`}`);return(0,r.f)(s.toString(),{method:"GET"})},t=async e=>{const s={method:"POST",body:e},l=new URL(`${n}/tasks/new/`);return(0,r.f)(l.toString(),s)},o=async(e,s)=>{const l={method:"PUT",body:s},i=new URL(`${n}${`/tasks/update/${e}/`}`);return(0,r.f)(i.toString(),l)},d=async()=>{const e=new URL(`${n}/desktop-users/`);return(0,r.f)(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${n}/team/mobile-users/`);return(0,r.f)(e.toString(),{method:"GET"})}}}]);
//# sourceMappingURL=4181.b03db981.chunk.js.map