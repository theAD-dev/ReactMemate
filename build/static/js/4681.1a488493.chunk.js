"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[4681],{10586:(e,t,s)=>{s.d(t,{$R:()=>r,Bu:()=>a,D3:()=>u,E4:()=>x,JP:()=>o,Rv:()=>d,Wz:()=>m,a_:()=>p,eY:()=>c,ik:()=>h,md:()=>i,oP:()=>v});var l=s(31342);const n="https://app.memate.com.au/api/v1",i=async function(e,t){var s;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;const d=(e-1)*t,c=[];c.push(`limit=${t}`),c.push(`offset=${d}`),i&&c.push(`search=${encodeURIComponent(i)}`),o&&c.push(`ordering=${encodeURIComponent(o)}`),a&&c.push("status=not_paid");let u="";var h;null!==r&&void 0!==r&&r.suppliers&&(u=null===r||void 0===r||null===(h=r.suppliers)||void 0===h?void 0:h.map((e=>e.id)).join(","),console.log("Suppliers filter string:",u),u&&c.push(`suppliers=${u}`));let p="";var m;null!==r&&void 0!==r&&r.departments&&(p=null===r||void 0===r||null===(m=r.departments)||void 0===m?void 0:m.map((e=>e.id)).join(","),p&&c.push(`departments=${p}`));let x="";var v;null!==r&&void 0!==r&&r.status&&1===(null===r||void 0===r||null===(s=r.status)||void 0===s?void 0:s.length)?(console.log("Status filter array:",r.status),null===r||void 0===r||null===(v=r.status)||void 0===v||v.forEach((e=>{console.log("Processing status element:",e),"paid"===(null===e||void 0===e?void 0:e.name)?x="paid":"not_paid"===(null===e||void 0===e?void 0:e.name)&&(x="not_paid")})),x&&(console.log("Applied status filter:",x),c.push(`status=${x}`))):null!==r&&void 0!==r&&r.status&&console.log("Status filter not applied - length:",r.status.length,"values:",r.status);if(null!==r&&void 0!==r&&r.date){var g,f,j,b;const e=null===r||void 0===r||null===(g=r.date[0])||void 0===g||null===(f=g.value)||void 0===f?void 0:f[0];if(e){const t=new Date(e),s=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");c.push(`date_after=${s}-${l}-${n}`)}const t=null===r||void 0===r||null===(j=r.date[0])||void 0===j||null===(b=j.value)||void 0===b?void 0:b[1];if(t){const e=new Date(t),s=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");c.push(`date_before=${s}-${l}-${n}`)}}const y=`${n}/expenses/?${c.join("&")}`;return console.log("Final expenses API URL:",y),(0,l.f)(y,{method:"GET"})},o=async()=>{const e=new URL(`${n}/references/xero-codes/`);return(0,l.f)(e.toString(),{method:"GET"})},a=async()=>{const e=new URL(`${n}/references/projects/expenses/`);return(0,l.f)(e.toString(),{method:"GET"})},r=async e=>{const t=new URL(`${n}${`/expenses/update/${e}/`}`);return(0,l.f)(t.toString(),{method:"GET"})},d=async e=>{const t={method:"POST",body:e},s=new URL(`${n}/expenses/new/`);return(0,l.f)(s.toString(),t)},c=async(e,t)=>{const s={method:"PUT",body:t},i=new URL(`${n}${`/expenses/update/${e}/`}`);return(0,l.f)(i.toString(),s)},u=async e=>{const t={method:"POST",body:e},s=new URL(`${n}/expenses/paid/`);return(0,l.f)(s.toString(),t)},h=async e=>{const t={method:"POST",body:e},s=new URL(`${n}/expenses/unpaid/`);return(0,l.f)(s.toString(),t)},p=async e=>{const t={method:"PUT",body:e},s=new URL(`${n}/expenses/to-xero/`);return(0,l.f)(s.toString(),t)},m=async e=>{const t=new URL(`${n}${`/expenses/delete/${e}/`}`);return(0,l.f)(t.toString(),{method:"DELETE"})},x=async e=>{const t={method:"POST",body:e},s=new URL(`${n}/clients/statement/pdf/`);return(0,l.f)(s.toString(),t)},v=async e=>{const t={method:"POST",body:e},s=new URL(`${n}/clients/statement/send/`);return(0,l.f)(s.toString(),t)}},17358:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var l=s(65043),n=s(14282),i=s(75329),o=s(39759),a=s(49367),r=s(54972),d=s(2028),c=s(22927),u=s(88166),h=s(35475),p=s(47097),m=s(58387),x=s(72018),v=s(9642),g=s(64824),f=s(56328);const j={active:"task_active__XHjXL",selectedCount:"task_selectedCount__KCjbh",filterBox:"task_filterBox__Vl8TJ",newButton:"task_newButton__FgzVj",total:"task_total__iv2al",totalCount:"task_totalCount__g7jIX",shadowRight:"task_shadowRight__POYJ0",clientName:"task_clientName__bfmFM",complete:"task_complete__zEIDq",pending:"task_pending__4JfNO",projectImg:"task_projectImg__SdMAS",projectText:"task_projectText__2Lg5C",projectNumber:"task_projectNumber__bQcj7",linkToProjectCard:"task_linkToProjectCard__cP8ki",statusFilter:"task_statusFilter__Rk3rx"};var b=s(79106),y=s(72796),_=s(48417),S=s(58027),N=s(27734),k=s(99868),w=s(36042),$=s(70579);const C=e=>{const t=new Date(1e3*e);return`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`},T=(0,l.forwardRef)(((e,t)=>{let{searchValue:s,setTotal:n,selected:i,setSelected:o,refetch:a,setRefetch:r,filter:d}=e;const{trialHeight:T}=(0,_.$)(),A=(0,l.useRef)(null),[F,R]=(0,l.useState)(!1),[D,I]=(0,l.useState)(null),[L,P]=(0,l.useState)(1),[z,E]=(0,l.useState)([]),[O,U]=(0,l.useState)({sortField:"id",sortOrder:-1}),[V,B]=(0,l.useState)({sortField:"id",sortOrder:-1}),[W,M]=(0,l.useState)(!0),[H,q]=(0,l.useState)(!1);(0,l.useEffect)((()=>{P(1)}),[s,a,d]),(0,l.useEffect)((()=>{(async()=>{q(!0);let e="";1===(null===V||void 0===V?void 0:V.sortOrder)?e=`${V.sortField}`:-1===(null===V||void 0===V?void 0:V.sortOrder)&&(e=`-${V.sortField}`);let t="not-complete"===d.status;"all"===d.status&&(t=null),"complete"===d.status&&(t=!1);const l=await(0,b.U9)(L,25,s,e,!1,t,null);var i;(n((()=>(null===l||void 0===l?void 0:l.count)||0)),1===L)?E(l.results):(null===l||void 0===l||null===(i=l.results)||void 0===i?void 0:i.length)>0&&E((e=>{const t=new Set(e.map((e=>e.id))),s=l.results.filter((e=>!t.has(e.id)));return[...e,...s]}));U(V),M(l.count!==z.length),q(!1)})()}),[L,s,V,a,d]),(0,l.useEffect)((()=>{if(z.length>0&&W){A.current=new IntersectionObserver((e=>{e[0].isIntersecting&&P((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&A.current.observe(e)}return()=>{A.current&&A.current.disconnect()}}),[z,W]);const G=(0,p.n)({mutationFn:e=>(0,y._x)(e.id,e.finished),onSuccess:()=>{r((e=>!e))},onError:e=>{console.error("Error updating task:",e)}});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(g.b,{ref:t,value:z,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${T}px)`,className:"border",selection:i,onSelectionChange:e=>o(e.value),loading:H,loadingIcon:N.A,emptyMessage:(0,$.jsx)(k.A,{isDataExist:!!s}),sortField:null===O||void 0===O?void 0:O.sortField,sortOrder:null===O||void 0===O?void 0:O.sortOrder,onSort:e=>{const{sortField:t,sortOrder:s}=e;B({sortField:t,sortOrder:s}),P(1)},rowClassName:e=>null!==e&&void 0!==e&&e.deleted?j.deletedRow:"",children:[(0,$.jsx)(v.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,$.jsx)(v.V,{field:"number",header:"Task ID",body:e=>{let t=new Date(1e3*+e.to_date).getTime()<Date.now();return(0,$.jsxs)("div",{className:"d-flex align-items-center justify-content-center show-on-hover",children:[(0,$.jsxs)("div",{className:"d-flex flex-column",children:[e.number,(0,$.jsx)("span",{className:"font-12",style:{color:t&&!e.finished?"#F97066":"#98A2B3"},children:C(e.to_date)})]}),(0,$.jsx)(x.$,{label:"Open",onClick:()=>{I(null===e||void 0===e?void 0:e.id),R(!0)},className:"primary-text-button ms-3 show-on-hover-element",text:!0})]})},style:{minWidth:"100px"},frozen:!0,sortable:!0}),(0,$.jsx)(v.V,{field:"title",header:"Task Title",body:e=>(0,$.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px"},children:e.title}),style:{minWidth:"150px"},bodyClassName:`${j.shadowRight}`,headerClassName:`${j.shadowRight}`,frozen:!0}),(0,$.jsx)(v.V,{field:"user.full_name",header:"Assigne",body:e=>{var t,s,l,n;const i=`${null===e||void 0===e?void 0:e.user.full_name}`,o=`${null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.alias}`;return(0,$.jsxs)("div",{className:"d-flex align-items-center",children:[(0,$.jsx)("div",{className:`d-flex justify-content-center align-items-center ${j.clientName}`,style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden"},children:null!==e&&void 0!==e&&null!==(s=e.user)&&void 0!==s&&s.has_photo?(0,$.jsx)(S.A,{has_photo:null===e||void 0===e||null===(l=e.user)||void 0===l?void 0:l.has_photo,photo:null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.photo,is_business:!1}):o}),i]})},style:{minWidth:"208px"}}),(0,$.jsx)(v.V,{field:"finished",header:"Status",body:e=>(0,$.jsx)("div",{className:`${j.time} ${e.finished?j.complete:j.pending}`,children:e.finished?"Complete":"Not Complete"}),style:{minWidth:"120px",maxWidth:"120px",width:"120px"}}),(0,$.jsx)(v.V,{field:"project.reference",header:"Project",body:e=>{var t,s,l;return(0,$.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,$.jsx)("div",{className:(0,m.A)(j.projectImg,"d-flex align-items-center justify-content-center"),children:(0,$.jsx)(c.A,{color:"#475467",size:13})}),(0,$.jsxs)("div",{style:{lineHeight:"1.385"},children:[(0,$.jsx)("h1",{className:(0,m.A)(j.projectText,"mb-0"),children:null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference}),(0,$.jsx)("span",{className:"font-12",style:{color:"#98A2B3"},children:(0,$.jsx)(h.N_,{className:`${j.linkToProjectCard}`,to:`/management?unique_id=${null===e||void 0===e||null===(s=e.project)||void 0===s?void 0:s.unique_id}`,children:null===e||void 0===e||null===(l=e.project)||void 0===l?void 0:l.number})})]})]})},style:{minWidth:"460px"}}),(0,$.jsx)(v.V,{field:"from_date",header:"Start Date",body:e=>C(e.from_date),style:{minWidth:"115px",maxWidth:"115px",width:"115px"},sortable:!0}),(0,$.jsx)(v.V,{field:"id",header:"Actions",body:e=>{var t,s;return e.finished?(0,$.jsxs)(x.$,{loading:G.isPending&&e.id===(null===(t=G.variables)||void 0===t?void 0:t.id),className:"outline-in-complete-button",style:{minWidth:"136px"},onClick:()=>(async e=>{await G.mutateAsync({id:e,finished:!1}),f.oR.success("Task marked as incomplete")})(e.id),children:["Completed ",(0,$.jsx)(u.A,{size:16,color:"#079455"})]}):(0,$.jsxs)(x.$,{loading:G.isPending&&e.id===(null===(s=G.variables)||void 0===s?void 0:s.id),className:"outline-complete-button",style:{minWidth:"136px"},onClick:()=>(async e=>{await G.mutateAsync({id:e,finished:!0}),f.oR.success("Task marked as complete")})(e.id),children:["Mark Complete ",(0,$.jsx)(u.A,{size:16,color:"#079455"})]})},style:{minWidth:"170px",maxWidth:"170px",width:"170px"}})]}),(0,$.jsx)(w.A,{view:F,setView:R,taskId:D,setTaskId:I,reInitialize:()=>r((e=>!e))})]})})),A=T;var F=s(98385);const R=()=>{const e=(0,l.useRef)(null),[t,s]=(0,l.useState)(0),[c,u]=(0,l.useState)(!1),[h,p,m]=(0,d.d7)("",400),[x,v]=(0,l.useState)([]),[g,f]=(0,l.useState)(!1),[b,y]=(0,l.useState)(!1),[_,S]=(0,l.useState)({status:"not-complete"});return l.useEffect((()=>{const e=e=>{!b||e.target.closest(`.${j.statusFilter}`)||e.target.closest(".p-button")||y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[b]),(0,$.jsxs)("div",{className:"jobs-page",children:[(0,$.jsx)(a.mg,{children:(0,$.jsx)("title",{children:"MeMate - Tasks"})}),(0,$.jsxs)("div",{className:`topbar ${null!==x&&void 0!==x&&x.length?j.active:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,$.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==x&&void 0!==x&&x.length?(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)("h6",{className:j.selectedCount,children:["Selected: ",null===x||void 0===x?void 0:x.length]}),(0,$.jsx)("div",{className:"filtered-box",children:(0,$.jsx)("button",{className:`${j.filterBox}`,onClick:()=>{return t=!0,void(e.current?e.current.exportCSV({selectionOnly:t}):console.error("DataTable ref is null"));var t},children:(0,$.jsx)(i.A,{})})})]}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{className:"filtered-box",children:(0,$.jsx)("button",{className:`${j.filterBox}`,onClick:()=>{},children:(0,$.jsx)(o.A,{size:20})})}),(0,$.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,$.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,$.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,$.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,$.jsx)("input",{type:"text",placeholder:"Search",value:h,onChange:e=>m(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,$.jsxs)("div",{style:{position:"relative"},children:[(0,$.jsxs)(n.A,{className:"outline-button",style:{padding:"4px 8px",height:"32px",fontSize:"14px",color:"#667085",border:"1px solid #D0D5DD",backgroundColor:"#FFFFFF"},onClick:()=>y(!b),children:[(0,$.jsx)(o.A,{size:16,style:{marginRight:"0px"}}),(0,$.jsx)("span",{style:{color:"#667085",fontSize:"14px",fontWeight:"400"},children:"Status"})]}),b&&(0,$.jsxs)("div",{className:`${j.statusFilter}`,children:[(0,$.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,$.jsx)(r.S,{checked:"complete"===_.status,label:"complete",onClick:()=>S({status:"complete"})}),(0,$.jsx)("div",{onClick:()=>S({status:"complete"}),className:j.complete,style:{marginLeft:"16px"},children:"Complete"})]}),(0,$.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,$.jsx)(r.S,{checked:"not-complete"===_.status,label:"not-complete",onClick:()=>S({status:"not-complete"})}),(0,$.jsx)("div",{onClick:()=>S({status:"not-complete"}),className:`${j.pending} cursor-pointer`,style:{marginLeft:"16px"},children:"Not Complete"})]}),(0,$.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,$.jsx)(r.S,{checked:"all"===_.status,label:"all",onClick:()=>S({status:"all"})}),(0,$.jsx)("div",{onClick:()=>S({status:"all"}),className:`${j.pending} cursor-pointer`,style:{marginLeft:"16px"},children:"All"})]})]})]})]})}),(0,$.jsxs)("div",{className:"featureName d-flex align-items-center",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[(0,$.jsx)("h1",{className:"title p-0",style:{marginRight:"16px"},children:"Tasks"}),(0,$.jsx)(n.A,{onClick:()=>u(!0),className:`${j.newButton}`,children:"Create New Task "})]}),(0,$.jsxs)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:[(0,$.jsx)("h1",{className:`${j.total} mb-0`,children:"Total"}),(0,$.jsxs)("div",{className:`${j.totalCount}`,children:[t," Jobs"]})]})]}),(0,$.jsx)(A,{ref:e,searchValue:p,setTotal:s,selected:x,setSelected:v,refetch:g,setRefetch:f,filter:_}),(0,$.jsx)(F.A,{show:c,setShow:u,refetch:()=>f((e=>!e))})]})}},20793:(e,t,s)=>{e.exports=s.p+"static/media/NodataImg.ee3ccbdc6b7e66284e17.png"},36042:(e,t,s)=>{s.d(t,{A:()=>a});var l=s(93747),n=s(79106),i=s(98385),o=s(70579);const a=e=>{let{view:t,setView:s,taskId:a,setTaskId:r,reInitialize:d}=e;const{data:c}=(0,l.I)({queryKey:["taskId",a],queryFn:()=>(0,n.gg)(a),enabled:!!a&&!!t,retry:1,cacheTime:0,staleTime:0});return(0,o.jsx)(o.Fragment,{children:t&&(0,o.jsx)(i.A,{show:t,setShow:s,taskId:a,setTaskId:r,defaultValue:c,refetch:d})})}},99868:(e,t,s)=>{s.d(t,{A:()=>x});var l=s(65043),n=s(14282),i=s(38294),o=s(35475),a=s(58387);const r="no-data-found-template_noDataBox__HgeT1",d="no-data-found-template_title__P5uV2",c="no-data-found-template_subTitle__zMBB-",u="no-data-found-template_supportext__pHg2P";var h=s(20793),p=s(32808),m=s(70579);const x=e=>{let{isDataExist:t=!0}=e;const[s,x]=(0,l.useState)(!1);return(0,m.jsxs)("div",{className:(0,a.A)(r),children:[(0,m.jsx)("div",{className:"position-relative d-flex flex-column",children:(0,m.jsx)("img",{src:h,alt:"no-data"})}),t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h2",{className:(0,a.A)(d),children:"There is no results"}),(0,m.jsxs)("p",{className:(0,a.A)(c),children:["The user you are looking for doesn't exist. ",(0,m.jsx)("br",{}),"Here are some helpful links:"]}),(0,m.jsx)(o.N_,{to:"/",children:(0,m.jsxs)(n.A,{className:"outline-button",style:{marginBottom:"32px"},children:[" ",(0,m.jsx)(i.A,{})," Go back"]})}),(0,m.jsx)(o.N_,{onClick:()=>x(!0),to:"#",children:(0,m.jsx)("span",{className:(0,a.A)(u),children:"Support"})})]}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("h2",{className:(0,a.A)(d),children:"No historical records yet."})}),(0,m.jsx)(p.A,{setVisible:x,visible:s})]})}}}]);
//# sourceMappingURL=4681.1a488493.chunk.js.map