"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[6731,6790],{14834:(e,s,t)=>{function i(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=parseFloat(e);return isNaN(t)?"0.00":s&&Math.abs(t)>=1e3?new Intl.NumberFormat("en-AU",{notation:"compact",compactDisplay:"short",minimumFractionDigits:2,maximumFractionDigits:2}).format(t):new Intl.NumberFormat("en-AU",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}t.d(s,{m:()=>i})},20793:(e,s,t)=>{e.exports=t.p+"static/media/NodataImg.ee3ccbdc6b7e66284e17.png"},43162:(e,s,t)=>{t.d(s,{$:()=>n,g:()=>a});var i=t(64018),l=t(63712);const n=(e,s)=>{const t=new FormData;t.append("firstname",e.firstname),t.append("lastname",e.lastname),e.email&&t.append("email",e.email);const n=(null===e||void 0===e?void 0:e.phone)&&(0,i.l)(e.phone);if(null!==n&&void 0!==n&&n.nationalNumber&&t.append("phone",e.phone),"0"!=e.category&&t.append("category",e.category),t.append("payment_terms",e.payment_terms),e.description&&t.append("description",e.description),e.address.city&&(t.append("address.country",e.address.country),t.append("address.title",e.address.title),t.append("address.city",e.address.city),t.append("address.address",e.address.address),t.append("address.state",e.address.state),t.append("address.postcode",e.address.postcode),e.address.id&&t.append("address.id",e.address.id)),null!==s&&void 0!==s&&s.croppedImageBlob){const e=(0,l.Ak)(6);t.append("photo",s.croppedImageBlob,`${e}.jpg`)}return t},a=async(e,s,t,i,l)=>{const n=localStorage.getItem("access_token");try{const a=await fetch(e,{method:s,headers:{Authorization:`Bearer ${n}`},body:t});if(a.ok)i(a);else{l(await a.json())}}catch(a){console.error("API request error:",a),l()}}},54967:(e,s,t)=>{t.d(s,{Ab:()=>o,dg:()=>d,fr:()=>c,Ay:()=>p});var i=t(65043),l=t(44541),n=t(95192);const a="image-avatar_clientImg__-nnRU";var r=t(70579);const o=e=>{let{has_photo:s,photo:t,is_business:a,size:o}=e;const[d,c]=(0,i.useState)(!1),p=a?l.A:n.A;return(0,r.jsx)(r.Fragment,{children:s&&t&&!d?(0,r.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,r.jsx)(p,{color:"#667085",size:o})})},d=e=>{var s,t,l;let{has_photo:n,photo:a,name:o}=e;const[d,c]=(0,i.useState)(!1),p=o&&(null===o||void 0===o||null===(s=o.split(" "))||void 0===s||null===(t=s.map((e=>e[0])))||void 0===t||null===(l=t.join(""))||void 0===l?void 0:l.toUpperCase())||"";return(0,r.jsx)(r.Fragment,{children:n&&a&&!d?(0,r.jsx)("img",{src:a,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):p})},c=e=>{let{name:s,size:t=14}=e;const i=s.split(" ").map((e=>e[0])).join("").toUpperCase();return(0,r.jsx)("span",{style:{fontSize:`${t}px`},children:i})},p=e=>{let{has_photo:s,photo:t,is_business:o}=e;const[d,c]=(0,i.useState)(!1),p=o?l.A:n.A;return(0,r.jsx)("div",{className:`d-flex justify-content-center align-items-center ${a} ${o?"":"rounded-circle"}`,style:{overflow:"hidden"},children:s&&t&&!d?(0,r.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,r.jsx)(p,{color:"#667085"})})}},60740:(e,s,t)=>{t.r(s),t.d(s,{default:()=>cs});var i=t(65043),l=t(14282),n=t(36097),a=t(10615),r=t(75329),o=t(39759),d=t(6168),c=t(43908),p=t(40808),m=t(49367),h=t(58387),u=t(2028),x=t(90818),j=t(56328),b=t(13534),y=t(83608),v=t(73216),_=t(35475),f=t(72018),g=t(9642),N=t(64824),A=t(76104);const C="clients_filterBox__Vcp+T",w="clients_menu__dHdc2",k="clients_newButton__YYCcj",F="clients_total__mHRdD",S="clients_totalCount__XP8AT",E="clients_ellipsis__IvsEr",R="clients_location__QKeW9",z="clients_active__c3iJL",q="clients_selectedCount__2Y1G8",B="clients_deletedRow__jyG8k",$="clients_actionButton__uAiaz";var I=t(59638),D=t(48417),P=t(14834),V=t(27734),W=t(54967),T=t(99868),M=t(70579);const U=(0,i.forwardRef)(((e,s)=>{let{searchValue:t,setTotalClients:l,selectedClients:n,setSelectedClients:a,isShowDeleted:r,refetch:o}=e;const d=(0,v.Zp)(),{trialHeight:c}=(0,D.$)(),p=(0,i.useRef)(null),[m,h]=(0,i.useState)([]),[u,x]=(0,i.useState)(1),[j,C]=(0,i.useState)({sortField:"id",sortOrder:-1}),[w,k]=(0,i.useState)({sortField:"id",sortOrder:-1}),[F,S]=(0,i.useState)(!0),[z,q]=(0,i.useState)(!1);(0,i.useEffect)((()=>{x(1)}),[t,r,o]),(0,i.useEffect)((()=>{(async()=>{q(!0);let e="";1===(null===w||void 0===w?void 0:w.sortOrder)?e=`${w.sortField}`:-1===(null===w||void 0===w?void 0:w.sortOrder)&&(e=`-${w.sortField}`);const s=await(0,I.oo)(u,25,t,e,r);var i;(l((()=>(null===s||void 0===s?void 0:s.count)||0)),1===u)?h(s.results):(null===s||void 0===s||null===(i=s.results)||void 0===i?void 0:i.length)>0&&h((e=>{const t=new Set(e.map((e=>e.id))),i=s.results.filter((e=>!t.has(e.id)));return[...e,...i]}));C(w),S(s.count!==m.length),q(!1)})()}),[u,t,w,r,o]),(0,i.useEffect)((()=>{if(m.length>0&&F){p.current=new IntersectionObserver((e=>{e[0].isIntersecting&&x((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&p.current.observe(e)}return()=>{p.current&&p.current.disconnect()}}),[m,F]);return(0,M.jsxs)(N.b,{ref:s,value:m,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${c}px)`,className:"border",selection:n,onSelectionChange:e=>a(e.value),loading:z,loadingIcon:V.A,emptyMessage:(0,M.jsx)(T.A,{isDataExist:!!t||!!r}),sortField:null===j||void 0===j?void 0:j.sortField,sortOrder:null===j||void 0===j?void 0:j.sortOrder,onSort:e=>{const{sortField:s,sortOrder:t}=e;k({sortField:s,sortOrder:t}),x(1)},rowClassName:e=>null!==e&&void 0!==e&&e.deleted?B:"",children:[(0,M.jsx)(g.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,M.jsx)(g.V,{field:"id",header:"Client ID",body:e=>(0,M.jsxs)("div",{className:"d-flex align-items-center justify-content-between show-on-hover",children:[(0,M.jsx)("span",{children:e.number}),(0,M.jsx)(f.$,{label:"Open",onClick:()=>d(`/clients/${e.id}/order-history`),className:"primary-text-button ms-3 show-on-hover-element not-show-checked",text:!0})]}),headerClassName:"paddingLeftHide",bodyClassName:"paddingLeftHide",style:{minWidth:"100px"},frozen:!0,sortable:!0}),(0,M.jsx)(g.V,{field:"name",header:"Client A\u2192Z",body:e=>(0,M.jsxs)("div",{className:"d-flex align-items-center",children:[(0,M.jsx)(W.Ay,{has_photo:e.has_photo,photo:e.photo,is_business:e.is_business}),(0,M.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,M.jsx)("div",{className:`${E}`,children:e.name}),e.deleted?(0,M.jsx)(A.v,{value:"Deleted",style:{height:"22px",width:"59px",borderRadius:"16px",border:"1px solid #FECDCA",background:"#FEF3F2",color:"#912018",fontSize:"12px",fontWeight:500}}):""]})]}),headerClassName:"shadowRight",bodyClassName:"shadowRight",style:{minWidth:"224px"},frozen:!0,sortable:!0}),(0,M.jsx)(g.V,{field:"category.name",header:"Category",style:{minWidth:"94px"}}),(0,M.jsx)(g.V,{field:"days_in_company",header:"Days",body:e=>(0,M.jsx)(A.v,{value:e.days_in_company,style:{height:"22px",minWidth:"26px",borderRadius:"4px",border:"1px solid #D0D5DD",background:"#fff",color:"#344054",fontSize:"12px",fontWeight:500}}),style:{minWidth:"56px"},className:"text-center"}),(0,M.jsx)(g.V,{field:"jobsdone",header:"Jobs",body:e=>(0,M.jsx)(A.v,{value:e.jobsdone,style:{height:"22px",minWidth:"32px",borderRadius:"16px",border:"1px solid #EAECF0",background:"#F9FAFB",color:"#344054",fontSize:"12px",fontWeight:500}}),style:{minWidth:"56px",textAlign:"center"}}),(0,M.jsx)(g.V,{field:"total_turnover",header:"Total turnover",body:e=>(0,M.jsxs)("span",{style:{color:"#667085"},children:["$",(0,P.m)(e.total_turnover)]}),style:{minWidth:"123px",textAlign:"right"},sortable:!0}),(0,M.jsx)(g.V,{field:"average_pd",header:"Average P/D",body:e=>(0,M.jsx)(A.v,{value:`$${(0,P.m)(e.average_pd)}`,style:{height:"22px",minWidth:"32px",borderRadius:"16px",border:"1px solid #ABEFC6",background:"#ECFDF3",color:"#067647",fontSize:"12px",fontWeight:500}}),style:{minWidth:"114px",textAlign:"center"},sortable:!0}),(0,M.jsx)(g.V,{field:"total_requests",header:"Projects",body:e=>(0,M.jsx)(A.v,{value:e.total_requests,style:{height:"22px",minWidth:"32px",borderRadius:"16px",border:"1px solid #EAECF0",background:"#F9FAFB",color:"#344054",fontSize:"12px",fontWeight:500}}),style:{minWidth:"89px",textAlign:"center"},sortable:!0}),(0,M.jsx)(g.V,{field:"order_frequency",header:"Order Frequency",body:e=>(0,M.jsx)(A.v,{value:`${(0,P.m)(e.order_frequency)} p/m`,style:{height:"22px",minWidth:"32px",borderRadius:"16px",border:"1px solid #A3E0FF",background:"#F2FAFF",color:"#1AB2FF",fontSize:"12px",fontWeight:500}}),style:{minWidth:"140px"},sortable:!0}),(0,M.jsx)(g.V,{field:"country",header:"Country",style:{minWidth:"75px"},bodyStyle:{color:"#667085"}}),(0,M.jsx)(g.V,{header:"Address",body:e=>{var s,t,i,l;let n=(null===e||void 0===e||null===(s=e.addresses)||void 0===s?void 0:s.length)&&(null===e||void 0===e||null===(t=e.addresses[0])||void 0===t?void 0:t.address)||"",a=(null===e||void 0===e||null===(i=e.addresses)||void 0===i?void 0:i.length)&&(null===e||void 0===e||null===(l=e.addresses)||void 0===l?void 0:l.find((e=>!0===e.is_main)));return(0,M.jsxs)("div",{className:"d-flex align-items-center justify-content-between show-on-hover",children:[(0,M.jsx)("span",{style:{color:"#98A2B3",fontSize:"14px"},children:(null===a||void 0===a?void 0:a.address)||n||"-"}),((null===a||void 0===a?void 0:a.address)||n)&&(0,M.jsx)(_.N_,{to:`http://maps.google.com/?q=${(null===a||void 0===a?void 0:a.address)||n}`,target:"_blank",className:`${R} show-on-hover-element`,children:(0,M.jsx)(b.A,{color:"#1AB2FF"})})]})},style:{minWidth:"469px"}}),(0,M.jsx)(g.V,{field:"abn",header:"ABN",style:{minWidth:"140px"}}),(0,M.jsx)(g.V,{field:"website",header:"Website",body:e=>e.website?(0,M.jsx)(_.N_,{to:e.website?e.website.startsWith("http://")||e.website.startsWith("https://")?e.website:`https://${e.website}`:"#",target:"_blank",children:(0,M.jsx)(y.A,{className:"show-on-hover-element",color:"#98A2B3"})}):"-",style:{minWidth:"56px",textAlign:"center"}})]})})),O=U;var L=t(98307),H=t(2210),Y=t(73728),G=t(69956),Z=t(56741),K=t(39881),Q=t(72970),X=t(88166),J=t(89488),ee=t(88060),se=t(20288),te=t(11238),ie=t(80899);const le="import-clients_circledesignstyle__bBMI2",ne="import-clients_out__V1G8H",ae="import-clients_stepIndicator__xe3ii",re="import-clients_step__G7Q0z",oe="import-clients_stepNumber__uHwQ8",de="import-clients_active__hOhbT",ce="import-clients_completed__oks+e",pe="import-clients_stepLabel__weUZz",me="import-clients_stepContent__IW+Zx",he="import-clients_stepTitle__HfAT4",ue="import-clients_stepDescription__ACHYs",xe="import-clients_selected__EsrIu",je="import-clients_methodOptions__Py5KP",be="import-clients_methodCard__BuufS",ye="import-clients_radioCircle__QjU1z",ve="import-clients_radioInner__65Vx7",_e="import-clients_methodCardContent__jJCGX",fe="import-clients_methodCardHeader__p5V3k",ge="import-clients_typeOptions__k3aUq",Ne="import-clients_typeOption__2hUAe",Ae="import-clients_iconBox__FlQ31",Ce="import-clients_tabText__xmCr3",we="import-clients_downloadBtn__3Uy6i",ke="import-clients_dropzone__cHkZp",Fe="import-clients_dropzoneText__wGdzs",Se="import-clients_dropzoneHint__3bars",Ee="import-clients_uploadedFile__u-Uqd",Re="import-clients_removeFile__Zd9z0",ze="import-clients_mappingContainer__XaBB0",qe="import-clients_mappingHeader__Vsvtj",Be="import-clients_mappingList__Ze8KO",$e="import-clients_mappingRow__n5jHK",Ie="import-clients_systemField__TzhDc",De="import-clients_required__rkSFu",Pe="import-clients_mappingDropdown__N0RsM",Ve="import-clients_previewTable__ipP6v",We="import-clients_previewNote__cuHzi",Te="import-clients_importProgress__Fnbab",Me="import-clients_spinner__4P2V9",Ue="import-clients_importResult__6D0jI",Oe="import-clients_error__e5GRl",Le="import-clients_validationErrors__egsPe",He="import-clients_errorHeader__lNo0K",Ye="import-clients_errorList__i1AKI",Ge="import-clients_errorRow__r0qxX",Ze="import-clients_errorMore__8KRSK",Ke=[{key:"name",label:"Company Name",required:!0},{key:"abn",label:"ABN",required:!1},{key:"email",label:"Email",required:!1},{key:"phone",label:"Phone",required:!1},{key:"website",label:"Website",required:!1},{key:"industry",label:"Industry",required:!1},{key:"payment_terms",label:"Payment Terms",required:!1},{key:"address_title",label:"Address Title",required:!1},{key:"address_line",label:"Address",required:!1},{key:"city",label:"City/Suburb",required:!1},{key:"state",label:"State",required:!1},{key:"postcode",label:"Postcode",required:!1},{key:"country",label:"Country",required:!1},{key:"contact_firstname",label:"Contact First Name",required:!1},{key:"contact_lastname",label:"Contact Last Name",required:!1},{key:"contact_email",label:"Contact Email",required:!1},{key:"contact_phone",label:"Contact Phone",required:!1},{key:"contact_position",label:"Contact Position",required:!1}],Qe=[{key:"firstname",label:"First Name",required:!0},{key:"lastname",label:"Last Name",required:!0},{key:"email",label:"Email",required:!1},{key:"phone",label:"Phone",required:!1},{key:"payment_terms",label:"Payment Terms",required:!1},{key:"address_title",label:"Address Title",required:!1},{key:"address_line",label:"Address",required:!1},{key:"city",label:"Suburb/City",required:!1},{key:"state",label:"State",required:!1},{key:"postcode",label:"Postcode",required:!1},{key:"country",label:"Country",required:!1}],Xe=ie.Ik({name:ie.Yj().required("Company name is required"),abn:ie.Yj().nullable().transform((e=>""===e?null:e)).matches(/^\d{11}$/,"ABN must be an 11-digit number").notRequired(),email:ie.Yj().nullable().transform((e=>""===e?null:e)).matches(/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Invalid email address").notRequired(),contact_email:ie.Yj().nullable().email("Invalid contact email format").notRequired()}),Je=ie.Ik({firstname:ie.Yj().required("First name is required"),lastname:ie.Yj().required("Last name is required"),email:ie.Yj().nullable().transform((e=>""===e?null:e)).matches(/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Invalid email address").notRequired()}),es=e=>{let{visible:s,setVisible:t,refetch:n}=e;const[a,o]=(0,i.useState)(1),[d,c]=(0,i.useState)("business"),[p,m]=(0,i.useState)(null),[u,x]=(0,i.useState)(null),[b,y]=(0,i.useState)({headers:[],rows:[]}),[v,_]=(0,i.useState)({}),[f,g]=(0,i.useState)(!1),[N,A]=(0,i.useState)(null),[C,w]=(0,i.useState)([]),k="business"===d?Ke:Qe,F="business"===d?Xe:Je,S=()=>{o(1),c("business"),m(null),x(null),y({headers:[],rows:[]}),_({}),g(!1),A(null),w([]),t(!1)},E=async(e,s)=>{try{return await F.validate(e,{abortEarly:!1}),null}catch(t){return{row:s+1,errors:t.inner.map((e=>e.message))}}},R=(0,i.useCallback)((async e=>{if(0===e.length)return;const s=e[0];x(s),w([]);try{const e=await(e=>new Promise(((s,t)=>{const i=new FileReader;i.onload=e=>{try{const i=new Uint8Array(e.target.result),l=te.LF(i,{type:"array"}),n=l.SheetNames[0],a=l.Sheets[n],r=te.Wp.sheet_to_json(a,{header:1});if(r.length<2)return void t(new Error("File must contain at least a header row and one data row"));const o=r[0].map(((e,s)=>({index:s,name:String(e||`Column ${s+1}`).trim()}))),d=r.slice(1).filter((e=>e.some((e=>null!==e&&void 0!==e&&""!==e))));s({headers:o,rows:d})}catch(i){t(i)}},i.onerror=()=>t(new Error("Failed to read file")),i.readAsArrayBuffer(e)})))(s);if(y(e),p){const s=(e=>{const s={};return k.forEach((t=>{const i=e=>e.toLowerCase().replace(/[^a-z0-9]/g,""),l=i(t.label),n=i(t.key),a=e.find((e=>{const s=i(e.name);return s===l||s===n||s.includes(n)||n.includes(s)}));a&&(s[t.key]=a.index)})),s})(e.headers);_(s),o(4)}else o(3)}catch(t){j.oR.error(t.message||"Failed to parse file"),x(null)}}),[p,k]),{getRootProps:z,getInputProps:q,isDragActive:B}=(0,J.VB)({onDrop:R,accept:{"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"text/csv":[".csv"]},maxFiles:1,multiple:!1}),$=()=>b.rows.map((e=>{const s={type:d};return Object.entries(v).forEach((t=>{let[i,l]=t;null!==l&&void 0!==l&&""!==l&&(s[i]=e[l]||"")})),s})),D=async()=>{const e=$();if(0===e.length)return void j.oR.error("No data to import");const s=k.filter((e=>e.required)).filter((e=>void 0===v[e.key]||""===v[e.key]));if(s.length>0)return void j.oR.error(`Please map required column: ${s.map((e=>e.label)).join(", ")}`);const t=await(async e=>{const s=[];for(let t=0;t<e.length;t++){const i=await E(e[t],t);i&&s.push(i)}return s})(e);if(t.length>0)return w(t),void j.oR.error(`Validation failed for ${t.length} row(s). Please fix the errors.`);g(!0);try{const s=await(0,I.cT)(e);A(s),j.oR.success(`Successfully imported ${s.success||e.length} clients`),n&&n((e=>!e))}catch(i){console.error("Import error:",i),j.oR.error(i.message||"Failed to import clients"),A({error:i.message||"Import failed"})}finally{g(!1)}},P=()=>{if(1===a)return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(l.A,{type:"button",onClick:S,className:"outline-button",children:"Cancel"}),(0,M.jsx)(l.A,{type:"button",onClick:()=>o(2),className:"solid-button",disabled:null===p,children:"Continue"})]});if(2===a)return(0,M.jsx)(l.A,{type:"button",onClick:()=>{o(1),x(null)},className:"outline-button",children:"Back"});if(3===a){const e=k.filter((e=>e.required)).every((e=>void 0!==v[e.key]&&""!==v[e.key]));return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(l.A,{type:"button",onClick:()=>{o(2),_({}),x(null)},className:"outline-button",children:"Back"}),(0,M.jsx)(l.A,{type:"button",onClick:()=>{w([]),o(4)},className:"solid-button",disabled:!e,children:"Preview Data"})]})}return 4===a?N?(0,M.jsx)(l.A,{type:"button",onClick:S,className:"solid-button",children:"Done"}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(l.A,{type:"button",onClick:()=>{o(p?2:3),w([])},className:"outline-button",disabled:f,children:"Back"}),(0,M.jsx)(l.A,{type:"button",onClick:D,className:"solid-button",disabled:f||C.length>0,style:{minWidth:"140px"},children:f?"Importing...":`Import ${b.rows.length} Clients`})]}):null},V=()=>(0,M.jsxs)("div",{className:me,children:[(0,M.jsx)("h3",{className:he,children:"Select Client Type"}),(0,M.jsx)("p",{className:ue,children:"Choose the type of clients you want to import"}),(0,M.jsxs)("div",{className:ge,children:[(0,M.jsxs)("div",{className:(0,h.A)(Ne,{[xe]:"business"===d}),onClick:()=>c("business"),children:[(0,M.jsx)("div",{className:Ae,children:(0,M.jsx)(L.A,{size:24,color:"#1AB2FF"})}),(0,M.jsx)("span",{className:Ce,children:"Business"})]}),(0,M.jsxs)("div",{className:(0,h.A)(Ne,{[xe]:"individual"===d}),onClick:()=>c("individual"),children:[(0,M.jsx)("div",{className:Ae,children:(0,M.jsx)(H.A,{size:24,color:"#1AB2FF"})}),(0,M.jsx)("span",{className:Ce,children:"Individual"})]})]}),(0,M.jsx)("h3",{className:he,style:{marginTop:"24px"},children:"Choose Import Method"}),(0,M.jsxs)("p",{className:ue,children:["Select how you'd like to import your ",d," clients"]}),(0,M.jsxs)("div",{className:je,children:[(0,M.jsxs)("div",{className:(0,h.A)(be,{[xe]:!0===p}),onClick:()=>m(!0),children:[(0,M.jsx)("div",{className:ye,children:!0===p&&(0,M.jsx)("div",{className:ve})}),(0,M.jsxs)("div",{className:_e,children:[(0,M.jsxs)("div",{className:fe,children:[(0,M.jsx)(Y.A,{size:20,color:"#158ECC"}),(0,M.jsx)("h4",{children:"Use Default Template"})]}),(0,M.jsx)("p",{children:"Download our pre-formatted template for seamless import with auto column mapping"}),!0===p&&(0,M.jsxs)(l.A,{className:we,onClick:e=>{e.stopPropagation(),(()=>{const e=document.createElement("a");e.href=`/templates/clients-import-template-${d}.xls`,e.download=`clients-import-template-${d}.xls`,document.body.appendChild(e),e.click(),document.body.removeChild(e)})()},children:[(0,M.jsx)(r.A,{size:16})," Download Template"]})]})]}),(0,M.jsxs)("div",{className:(0,h.A)(be,{[xe]:!1===p}),onClick:()=>m(!1),children:[(0,M.jsx)("div",{className:ye,children:!1===p&&(0,M.jsx)("div",{className:ve})}),(0,M.jsxs)("div",{className:_e,children:[(0,M.jsxs)("div",{className:fe,children:[(0,M.jsx)(G.A,{size:20,color:"#475467"}),(0,M.jsx)("h4",{children:"Use Custom File"})]}),(0,M.jsx)("p",{children:"Upload your own file and manually map columns to our system fields"})]})]})]})]}),W=()=>(0,M.jsxs)("div",{className:me,children:[(0,M.jsx)("h3",{className:he,children:"Map Your Columns"}),(0,M.jsx)("p",{className:ue,children:"Match your file columns to our system fields"}),(0,M.jsxs)("div",{className:ze,children:[(0,M.jsxs)("div",{className:qe,children:[(0,M.jsx)("span",{children:"SYSTEM FIELD"}),(0,M.jsx)("span",{children:"YOUR FILE COLUMN"})]}),(0,M.jsx)("div",{className:Be,children:k.map((e=>{var s;return(0,M.jsxs)("div",{className:$e,children:[(0,M.jsxs)("div",{className:Ie,children:[(0,M.jsx)("span",{children:e.label}),e.required&&(0,M.jsx)("span",{className:De,children:"*"})]}),(0,M.jsx)(ee.m,{value:null!==(s=v[e.key])&&void 0!==s?s:"",options:[{label:"Select column",value:""},...b.headers.map((e=>({label:e.name,value:e.index})))],onChange:s=>{return t=e.key,i=s.value,void _((e=>({...e,[t]:i})));var t,i},placeholder:"Select column",className:(0,h.A)(Pe,"w-100")})]},e.key)}))})]})]}),T=()=>{const e=$().slice(0,5),s=b.rows.length;return(0,M.jsxs)("div",{className:me,children:[(0,M.jsx)("h3",{className:he,children:"Preview & Import"}),(0,M.jsxs)("p",{className:ue,children:["Review the data before importing (",s," records found)"]}),C.length>0&&(0,M.jsxs)("div",{className:Le,children:[(0,M.jsxs)("div",{className:He,children:[(0,M.jsx)(K.A,{size:20,color:"#B42318"}),(0,M.jsxs)("span",{children:["Validation Errors Found (",C.length," rows)"]})]}),(0,M.jsxs)("div",{className:Ye,children:[C.slice(0,5).map(((e,s)=>(0,M.jsxs)("div",{className:Ge,children:[(0,M.jsxs)("strong",{children:["Row ",e.row,":"]})," ",e.errors.join(", ")]},s))),C.length>5&&(0,M.jsxs)("div",{className:Ze,children:["... and ",C.length-5," more errors"]})]})]}),!f&&!N&&0===C.length&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{className:Ve,children:(0,M.jsxs)("table",{children:[(0,M.jsx)("thead",{children:(0,M.jsx)("tr",{children:Object.entries(v).filter((e=>{let[,s]=e;return""!==s&&void 0!==s})).map((e=>{let[s]=e;const t=k.find((e=>e.key===s));return(0,M.jsx)("th",{children:(null===t||void 0===t?void 0:t.label)||s},s)}))})}),(0,M.jsx)("tbody",{children:e.map(((e,s)=>(0,M.jsx)("tr",{children:Object.entries(v).filter((e=>{let[,s]=e;return""!==s&&void 0!==s})).map((s=>{let[t]=s;return(0,M.jsx)("td",{children:e[t]||"-"},t)}))},s)))})]})}),s>5&&(0,M.jsxs)("p",{className:We,children:["Showing first 5 of ",s," records"]})]}),f&&(0,M.jsxs)("div",{className:Te,children:[(0,M.jsx)("div",{className:Me,children:(0,M.jsx)("span",{className:"spinner-border spinner-border-lg",role:"status","aria-hidden":"true"})}),(0,M.jsx)("p",{children:"Importing clients..."})]}),N&&(0,M.jsx)("div",{className:(0,h.A)(Ue,{[Oe]:N.error}),children:N.error?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Q.A,{size:48,color:"#B42318"}),(0,M.jsx)("h4",{children:"Import Failed"}),(0,M.jsx)("p",{children:N.error})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(X.A,{size:48,color:"#17B26A"}),(0,M.jsx)("h4",{children:"Import Successful"}),(0,M.jsxs)("p",{children:[N.success||b.rows.length," clients have been imported"]})]})})]})},U=()=>{const e=p?[{num:1,label:"Setup"},{num:2,label:"Upload File"},{num:4,label:"Import"}]:[{num:1,label:"Setup"},{num:2,label:"Upload File"},{num:3,label:"Map Columns"},{num:4,label:"Import"}];return(0,M.jsx)("div",{className:ae,children:e.map(((e,s)=>(0,M.jsxs)("div",{className:(0,h.A)(re,{[de]:a===e.num,[ce]:a>e.num}),children:[(0,M.jsx)("div",{className:oe,children:a>e.num?(0,M.jsx)(X.A,{size:16}):s+1}),(0,M.jsx)("span",{className:pe,children:e.label})]},e.num)))})};return(0,M.jsx)(se.B,{visible:s,position:"right",onHide:S,modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:t}=e;return(0,M.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,M.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,M.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,M.jsx)("div",{className:le,children:(0,M.jsx)("div",{className:ne,children:(0,M.jsx)(Y.A,{size:24,color:"#158ECC"})})}),(0,M.jsx)("span",{style:{color:"#344054",fontSize:"20px",fontWeight:600},children:"Import Clients"})]}),(0,M.jsx)("span",{children:(0,M.jsx)(l.A,{type:"button",className:"text-button",ref:s,onClick:e=>t(e),children:(0,M.jsx)(Z.A,{size:24,color:"#667085"})})})]}),(0,M.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 72px - 45px)",overflow:"auto"},children:[U(),1===a&&V(),2===a&&(0,M.jsxs)("div",{className:me,children:[(0,M.jsx)("h3",{className:he,children:"Upload Your File"}),(0,M.jsx)("p",{className:ue,children:p?"Upload the filled template file":"Upload your Excel or CSV file with client data"}),(0,M.jsxs)("div",{...z(),className:(0,h.A)(ke,{[de]:B}),children:[(0,M.jsx)("input",{...q()}),(0,M.jsx)(G.A,{size:48,color:"#158ECC"}),(0,M.jsx)("p",{className:Fe,children:B?"Drop the file here...":"Drag & drop your file here, or click to browse"}),(0,M.jsx)("span",{className:Se,children:"Supported formats: .xls, .xlsx, .csv"})]}),u&&(0,M.jsxs)("div",{className:Ee,children:[(0,M.jsx)(Y.A,{size:24,color:"#158ECC"}),(0,M.jsx)("span",{children:u.name}),(0,M.jsx)("button",{onClick:()=>x(null),className:Re,children:(0,M.jsx)(Z.A,{size:16})})]})]}),3===a&&W(),4===a&&T()]}),(0,M.jsx)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:P()})]})}})};var ss=t(93202),ts=t(64018),is=t(63712),ls=t(33074),ns=t(17344),as=t(20685),rs=t(88780),os=t(43162);const ds=e=>{let{visible:s,setVisible:t,refetch:n}=e;const a=(0,i.useRef)(null),[r,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[p,m]=(0,i.useState)("1"),[u]=(0,i.useState)({payment_terms:1,category:"",phone:{country:"",number:""},contact_persons:[{}],addresses:[{title:"Main Location",country:1}]}),[x]=(0,i.useState)({payment_terms:1,category:"",address:{title:"Main Location",country:1}}),b=async e=>{e&&"2"===p?(async e=>{console.log("indivisualFormSubmit: ",e);const s=(0,os.$)(e,d);o(!0),await(0,os.g)("https://app.memate.com.au/api/v1/clients/individual/new/","POST",s,(async()=>{if(j.oR.success("New client created successfully"),e.add_to_mailchimp&&e.mailchimp_list_id&&e.email)try{const s={list_id:e.mailchimp_list_id,email:e.email};e.firstname&&(s.first_name=e.firstname),e.lastname&&(s.last_name=e.lastname),e.phone&&(s.phone=e.phone),e.birthday&&(s.birthday=e.birthday),e.company&&(s.company=e.company),await(0,rs.cd)(s),j.oR.success("User added to Mailchimp mailing list")}catch(s){console.error("Error adding user to Mailchimp:",s),j.oR.error("Client created but failed to add to Mailchimp")}t(!1),n((e=>!e))}),(e=>{j.oR.error(e||"Failed to create new client. Please try again.")})),o(!1)})(e):(async e=>{console.log("data: ",e);const s=new FormData;s.append("name",e.name),e.abn&&s.append("abn",e.abn);const i=(null===e||void 0===e?void 0:e.phone)&&(0,ts.l)(e.phone);if(null!==i&&void 0!==i&&i.nationalNumber&&s.append("phone",e.phone),e.email&&s.append("email",e.email),e.website&&s.append("website",e.website),s.append("payment_terms",e.payment_terms),"0"!=e.category&&s.append("category",e.category),e.industry&&s.append("industry",e.industry),e.description&&s.append("description",e.description),e.addresses.forEach(((e,t)=>{e.city&&(s.append(`addresses[${t}]address`,e.address),s.append(`addresses[${t}]city`,e.city),s.append(`addresses[${t}]postcode`,e.postcode),s.append(`addresses[${t}]is_main`,e.is_main),s.append(`addresses[${t}]title`,e.title))})),e.contact_persons.forEach(((e,t)=>{if(e.firstname||e.email){s.append(`contact_persons[${t}]firstname`,e.firstname),s.append(`contact_persons[${t}]lastname`,e.lastname),s.append(`contact_persons[${t}]email`,e.email);const i=(null===e||void 0===e?void 0:e.phone)&&(0,ts.l)(e.phone);null!==i&&void 0!==i&&i.nationalNumber&&s.append(`contact_persons[${t}]phone`,e.phone),s.append(`contact_persons[${t}]position`,e.position),s.append(`contact_persons[${t}]is_main`,e.is_main)}})),null!==d&&void 0!==d&&d.croppedImageBlob){const e=(0,is.Ak)(6);s.append("photo",null===d||void 0===d?void 0:d.croppedImageBlob,`${e}.jpg`)}try{o(!0);const i=localStorage.getItem("access_token"),a=await fetch("https://app.memate.com.au/api/v1/clients/business/new/",{method:"POST",headers:{Authorization:`Bearer ${i}`},body:s});if(a.ok){if(j.oR.success("New client created successfully"),e.add_to_mailchimp&&e.mailchimp_list_id&&e.email)try{const s={list_id:e.mailchimp_list_id,email:e.email};e.name&&(s.company=e.name),e.phone&&(s.phone=e.phone),await(0,rs.cd)(s),j.oR.success("Business added to Mailchimp mailing list")}catch(l){console.error("Error adding business to Mailchimp:",l),j.oR.error("Client created but failed to add to Mailchimp")}t(!1),n((e=>!e))}else{const e=await a.json();j.oR.error(e||"Failed to create new client. Please try again.")}}catch(a){console.log("Error in creating new business client: ",a),j.oR.error("Failed to create new client. Please try again.")}finally{o(!1)}})(e)},y=()=>{a.current&&a.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,i.useEffect)((()=>{s||c(null)}),[s]),(0,M.jsx)(se.B,{visible:s,position:"right",onHide:()=>t(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:i}=e;return(0,M.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,M.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,M.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,M.jsx)("div",{className:as.A.circledesignstyle,children:(0,M.jsx)("div",{className:as.A.out,children:(0,M.jsx)(ss.A,{size:24,color:"#17B26A"})})}),(0,M.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create New Client"})]}),(0,M.jsx)("span",{children:(0,M.jsx)(l.A,{type:"button",className:"text-button",ref:s,onClick:e=>i(e),children:(0,M.jsx)(Z.A,{size:24,color:"#667085"})})})]}),(0,M.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:[(0,M.jsx)("div",{style:{padding:"24px 18px 0px 18px",background:"#f9fafb"},children:(0,M.jsxs)("div",{className:(0,h.A)("tabs d-flex gap-3"),children:[(0,M.jsxs)("div",{onClick:()=>m("1"),className:(0,h.A)(as.A.tab,{[as.A.active]:"1"===p}),children:[(0,M.jsx)("div",{className:(0,h.A)(as.A.iconBox),children:(0,M.jsx)(L.A,{size:24,color:"#1AB2FF"})}),(0,M.jsx)("span",{className:(0,h.A)(as.A.tabText),children:"Business"})]}),(0,M.jsxs)("div",{onClick:()=>m("2"),className:(0,h.A)(as.A.tab,{[as.A.active]:"2"===p}),children:[(0,M.jsx)("div",{className:(0,h.A)(as.A.iconBox),children:(0,M.jsx)(H.A,{size:24,color:"#1AB2FF"})}),(0,M.jsx)("span",{className:(0,h.A)(as.A.tabText),children:"Individual"})]})]})}),"1"===p?(0,M.jsx)(ls.A,{photo:d,setPhoto:c,ref:a,onSubmit:b,defaultValues:u,deleteAddress:()=>{},deleteContact:()=>{}}):(0,M.jsx)(ns.A,{photo:d,setPhoto:c,ref:a,onSubmit:b,defaultValues:x})]}),(0,M.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,M.jsx)(l.A,{type:"button",onClick:e=>{e.stopPropagation(),t(!1)},className:"outline-button",children:"Cancel"}),(0,M.jsx)(l.A,{type:"button",onClick:y,className:"solid-button",style:{minWidth:"179px"},children:r?"Loading...":"Save Client Details"})]})]})}})},cs=()=>{const e=(0,i.useRef)(null),s=(0,i.useRef)(null),[t,b]=(0,i.useState)(!1),[y,v]=(0,i.useState)(0),[_,f]=(0,i.useState)(!1),[g,N]=(0,i.useState)(!1),[A,E]=(0,i.useState)(!1),[R,B]=(0,i.useState)(null),[D,P,V]=(0,u.d7)("",400),[W,T]=(0,i.useState)(!1);return(0,M.jsxs)("div",{className:"peoples-page",children:[(0,M.jsx)(m.mg,{children:(0,M.jsx)("title",{children:"MeMate - Clients"})}),(0,M.jsxs)("div",{className:`topbar ${null!==R&&void 0!==R&&R.length?z:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,M.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==R&&void 0!==R&&R.length?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("h6",{className:q,children:["Selected: ",null===R||void 0===R?void 0:R.length]}),(0,M.jsx)("div",{className:"filtered-box",children:(0,M.jsx)("button",{className:`${C}`,onClick:()=>{return s=!0,void(e.current?e.current.exportCSV({selectionOnly:s}):console.error("DataTable ref is null"));var s},children:(0,M.jsx)(r.A,{})})})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"filtered-box",children:[(0,M.jsx)("button",{className:`${C}`,onClick:e=>s.current.toggle(e),children:(0,M.jsx)(o.A,{size:20})}),(0,M.jsx)(x.b,{model:[{label:(0,M.jsx)("div",{onClick:()=>E(!A),className:"d-flex align-items-center text-nowrap gap-3 p",children:A?(0,M.jsxs)(M.Fragment,{children:["Hide Deleted Clients ",(0,M.jsx)(d.A,{})]}):(0,M.jsxs)(M.Fragment,{children:["Show Deleted Clients ",(0,M.jsx)(c.A,{})]})})}],className:(0,h.A)(w),popup:!0,ref:s,breakpoint:"767px"})]}),(0,M.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,M.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,M.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,M.jsx)("input",{type:"text",placeholder:"Search",value:D,onChange:e=>V(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})}),(0,M.jsxs)("div",{className:"featureName d-flex align-items-center",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[(0,M.jsx)("h1",{className:"title p-0",style:{marginRight:"16px"},children:"Clients"}),(0,M.jsx)(l.A,{onClick:()=>f(!0),className:`${k}`,children:"Add New Client"})]}),(0,M.jsxs)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:[(0,M.jsxs)("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[(0,M.jsx)(n.A,{placement:"bottom",overlay:(0,M.jsx)(a.A,{id:"export-tooltip",children:"Export Clients"}),children:(0,M.jsx)("button",{className:$,onClick:async()=>{if(!W){T(!0);try{const{blob:e,filename:s}=await(0,I.h0)(),t=window.URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download=s,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(t),j.oR.success("Clients exported successfully")}catch(e){console.error("Export error:",e),j.oR.error("Failed to export clients")}finally{T(!1)}}},disabled:W,children:W?(0,M.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):(0,M.jsx)(p.A,{size:18})})}),(0,M.jsx)(n.A,{placement:"bottom",overlay:(0,M.jsx)(a.A,{id:"import-tooltip",children:"Import Clients"}),children:(0,M.jsx)("button",{className:$,onClick:()=>N(!0),children:(0,M.jsx)(r.A,{size:18})})})]}),(0,M.jsx)("h1",{className:`${F} mb-0`,children:"Total"}),(0,M.jsxs)("div",{className:`${S}`,children:[y," Clients"]})]})]}),(0,M.jsx)(O,{ref:e,searchValue:P,setTotalClients:v,selectedClients:R,setSelectedClients:B,isShowDeleted:A,refetch:t}),(0,M.jsx)(ds,{visible:_,setVisible:f,refetch:b}),(0,M.jsx)(es,{visible:g,setVisible:N,refetch:b})]})}},99868:(e,s,t)=>{t.d(s,{A:()=>x});var i=t(65043),l=t(14282),n=t(38294),a=t(35475),r=t(58387);const o="no-data-found-template_noDataBox__HgeT1",d="no-data-found-template_title__P5uV2",c="no-data-found-template_subTitle__zMBB-",p="no-data-found-template_supportext__pHg2P";var m=t(20793),h=t(32808),u=t(70579);const x=e=>{let{isDataExist:s=!0}=e;const[t,x]=(0,i.useState)(!1);return(0,u.jsxs)("div",{className:(0,r.A)(o),children:[(0,u.jsx)("div",{className:"position-relative d-flex flex-column",children:(0,u.jsx)("img",{src:m,alt:"no-data"})}),s?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("h2",{className:(0,r.A)(d),children:"There is no results"}),(0,u.jsxs)("p",{className:(0,r.A)(c),children:["The user you are looking for doesn't exist. ",(0,u.jsx)("br",{}),"Here are some helpful links:"]}),(0,u.jsx)(a.N_,{to:"/",children:(0,u.jsxs)(l.A,{className:"outline-button",style:{marginBottom:"32px"},children:[" ",(0,u.jsx)(n.A,{})," Go back"]})}),(0,u.jsx)(a.N_,{onClick:()=>x(!0),to:"#",children:(0,u.jsx)("span",{className:(0,r.A)(p),children:"Support"})})]}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("h2",{className:(0,r.A)(d),children:"No historical records yet."})}),(0,u.jsx)(h.A,{setVisible:x,visible:t})]})}}}]);
//# sourceMappingURL=6790.09df1249.chunk.js.map