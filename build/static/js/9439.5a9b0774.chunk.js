(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[9439],{32224:(e,t,a)=>{var s={"./ckb.js":23743,"./cs.js":7333,"./da.js":11664,"./de.js":30844,"./en.js":5460,"./es.js":6151,"./fa.js":96062,"./fr.js":27755,"./he.js":3296,"./hu.js":33776,"./index.js":70559,"./it.js":54762,"./ja.js":80074,"./km.js":27671,"./ko.js":20665,"./lv.js":90749,"./nl.js":66449,"./pl.js":48599,"./pt_br.js":48366,"./ro.js":73100,"./ru.js":34638,"./se.js":55111,"./tr.js":10057,"./ua.js":79657,"./ur.js":64640,"./zh_cn.js":25277};function o(e){var t=n(e);return a(t)}function n(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=n,e.exports=o,o.id=32224},65425:(e,t,a)=>{"use strict";a.d(t,{R:()=>c});var s=a(65043),o=a(86213),n=a(56328),r=a(9266),l=a.n(r),i=(a(23475),a(70579));const c=e=>{let{value:t="",onChange:a,placeholder:r="Enter content...",height:c=299,showTable:d=!0,showLink:p=!0,disabled:u=!1,className:h="",customOptions:m={},onLoad:g,onFocus:x,onBlur:f,enableS3Upload:b=!1,s3UploadEndpoint:C=null,uploadId:j=null,...v}=e;const[w,F]=(0,s.useState)({}),[y,E]=(0,s.useState)(!1),[A,_]=(0,s.useState)(!1),S=(0,s.useRef)(new Map);(0,s.useEffect)((()=>{const e=setInterval((()=>{const e=S.current;if(e.size>50){const t=Array.from(e.entries()).slice(-25);S.current=new Map(t)}}),6e4);return()=>clearInterval(e)}),[]);const R=(0,s.useRef)(null),P=(0,s.useRef)(null),k=(0,s.useCallback)((e=>{if(!e||"string"!==typeof e)return!1;return[/^https?:\/\/.*\.s3\..*\.amazonaws\.com\//,/^https?:\/\/s3\..*\.amazonaws\.com\//,/^https?:\/\/.*\.s3\.amazonaws\.com\//,/^https?:\/\/.*\.digitaloceanspaces\.com\//,new RegExp(`^https?://${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_API_URL:"https://dev.memate.com.au/api/v1",REACT_APP_URL:"https://dev.memate.com.au",REACT_APP_CHAT_API_URL:"https://chatd.memate.com.au",REACT_APP_STATIC_WEBSITE_URL:"https://memate.com.au/",REACT_APP_XERO_CLIENT_ID:"743BAB12B3A24534889C5C803A35E12C",REACT_APP_STRIPE_PUBLISH_KEY:"pk_test_51O94eKLxE22b6TLWEJNVcMXHpWx7FnaL75CcRPsUHATWytJH0GR1jJPKXk7FT6KuMCi0eeyng0nlfTK31cLADLZl00LrXHCPgs",REACT_APP_HUBSPOT_PORTAL_ID:"241966069",REACT_APP_HUBSPOT_FORM_ID:"39ad4b7b-9757-48e2-97d1-ac46aa95862c"}.REACT_APP_S3_BUCKET||".*"}\\.s3\\..*\\.amazonaws\\.com/`)].some((t=>t.test(e)))}),[]),B=(0,s.useCallback)((e=>{const t=/<img[^>]+src="([^"]+)"[^>]*>/gi,a=[],s=[],o=[];let n;for(;null!==(n=t.exec(e));){const e=n[0],t=n[1];if(t.startsWith("data:image/")){const s=t.match(/^data:image\/([^;]+);base64,(.+)$/);s&&a.push({fullMatch:e,format:s[1],base64Data:s[2],src:t,index:n.index})}else k(t)?s.push({fullMatch:e,src:t,index:n.index}):o.push({fullMatch:e,src:t,index:n.index})}return{base64Images:a,s3Images:s,otherImages:o}}),[k]),I=(0,s.useCallback)(((e,t,a)=>{const s=e.replace(/^data:image\/[a-z]+;base64,/,""),o=atob(s),n=new Array(o.length);for(let i=0;i<o.length;i++)n[i]=o.charCodeAt(i);const r=new Uint8Array(n),l=new Blob([r],{type:`image/${t}`});return new File([l],a,{type:`image/${t}`})}),[]),T=(0,s.useCallback)((async(e,t)=>{if(!b)return null;const a=btoa(e.substring(0,100));if(S.current.has(a)){return S.current.get(a)}try{const s=`image-${Date.now()}.${t}`,n=I(e,t,s),r=localStorage.getItem("access_token"),l=C||`https://dev.memate.com.au/api/v1/proposals/file/${j}/`,i=await o.A.post(l,{file_name:s},{headers:{Authorization:`Bearer ${r}`}}),{url:c}=i.data;if(!c)throw new Error("Failed to get upload URL");await o.A.put(c,n,{headers:{"Content-Type":""}});const d=c.split("?")[0]||"";return S.current.set(a,d),d}catch(s){throw console.error("Error uploading base64 image to S3:",s),s}}),[b,C,j,I]),D=(0,s.useCallback)((async(e,t)=>o.A.put(t,e,{headers:{"Content-Type":""},onUploadProgress:e=>{const t=Math.round(e.loaded/e.total*100);F({progress:t,uploading:!0})}}).then((e=>{if(200!==e.status&&201!==e.status)throw new Error(`Upload failed with status: ${e.status}`);F({progress:100,success:!0,uploading:!1});t.split("?")[0];n.oR.success("Image uploaded successfully"),setTimeout((()=>{F({})}),2e3)})).catch((e=>{throw console.log("Error uploading to S3: ",e),F({progress:0,error:!0,uploading:!1}),n.oR.error("Failed to upload image to S3"),e}))),[]),N=(0,s.useCallback)((async e=>{if(e&&b)try{var t,a,s;const r=null===e||void 0===e||null===(t=e.name)||void 0===t?void 0:t.split(".")[0],l=null===e||void 0===e||null===(a=e.name)||void 0===a||null===(s=a.split("."))||void 0===s?void 0:s.pop(),i=`proposal-images/${r}-${Date.now()}.${l}`;F({progress:0,uploading:!0});const c=localStorage.getItem("access_token"),d=C||`https://dev.memate.com.au/api/v1/proposals/file/${j}/`,p=await o.A.post(d,{filename:i},{headers:{Authorization:`Bearer ${c}`}}),{url:u}=p.data;if(!u)return F({progress:0,error:!0,uploading:!1}),void n.oR.error("Failed to get upload URL. Please try again.");await D(e,u)}catch(l){var r;null!==(r=l.message)&&void 0!==r&&r.includes("Upload failed with status")||(F({progress:0,error:!0,uploading:!1}),console.error("Error in fileUploadBySignedURL:",l),n.oR.error("Failed to upload file. Please try again."))}}),[D,b,C,j]),L=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),b&&E(!0)}),[b]),U=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget.getBoundingClientRect(),a=e.clientX,s=e.clientY;(a<t.left||a>t.right||s<t.top||s>t.bottom)&&E(!1)}),[]),z=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),O=(0,s.useCallback)((async e=>{if(e.preventDefault(),e.stopPropagation(),E(!1),!b)return;const t=e.dataTransfer.files;if(t&&t.length>0){const e=t[0];if(e.size>10485760)return void n.oR.error("File size must be less than 10MB");if(!e.type.startsWith("image/"))return void n.oR.error("Please select a valid image file");await N(e)}}),[N,b]),$={buttonList:(()=>{const e=[["undo","redo"],["bold","italic","underline","strike"],["formatBlock"],["list"],["align"],["image"]];return p&&e.push(["link"]),d&&e.push(["table"]),e})(),height:c,placeholder:r,showPathLabel:!1,charCounter:!1,resizingBar:!1,disable:u,imageUploadUrl:b?null:void 0,table:{headerStyle:"background-color: #f8f9fa; font-weight: bold; padding: 8px; min-width: 50px; border: none;",cellStyle:"padding: 8px; min-width: 50px; border: none;"},imageUploadHeader:b?void 0:{Authorization:`Bearer ${localStorage.getItem("access_token")||""}`},formats:["p","div","h1","h2","h3","h4","h5","h6"],font:["Arial","Helvetica","Georgia","Times New Roman","Courier New"],fontSize:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],colorList:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F3F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#FF9C63","#FFCE63","#9CDE9C","#63B5CE","#639CFF","#9C63E7","#CE639C"],["#E73131","#FF7031","#FFB531","#73DE73","#319CCE","#3173FF","#7331E7","#CE3173"],["#9C0000","#B56308","#9C9C00","#089C00","#008294","#0031FF","#4A0A77","#9C005A"],["#630000","#7B3900","#636300","#006300","#005A6B","#002173","#290A4A","#630039"]]},H={...$,...m,buttonList:m.buttonList||$.buttonList};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("style",{children:"\n                @keyframes spin {\n                    0% { transform: rotate(0deg); }\n                    100% { transform: rotate(360deg); }\n                }\n                \n                /* Remove all table borders in SunEditor */\n                .sun-editor-wrapper .se-wrapper-inner table,\n                .sun-editor-wrapper .se-wrapper-inner table td,\n                .sun-editor-wrapper .se-wrapper-inner table th,\n                .sun-editor-wrapper .se-wrapper-inner table tr {\n                    border: none !important;\n                    outline: none !important;\n                    border-collapse: collapse !important;\n                }\n                \n                /* Also remove borders when content is rendered outside editor */\n                .sun-editor-content table,\n                .sun-editor-content table td,\n                .sun-editor-content table th,\n                .sun-editor-content table tr {\n                    border: none !important;\n                    outline: none !important;\n                    border-collapse: collapse !important;\n                }\n            "}),(0,i.jsxs)("div",{className:`sun-editor-wrapper ${h}`,style:{position:"relative"},onDragEnter:L,onDragLeave:U,onDragOver:z,onDrop:O,children:[(0,i.jsx)(l(),{ref:R,setOptions:H,setContents:t,onChange:async e=>{if(b&&e&&"string"===typeof e){const{base64Images:s,s3Images:o}=B(e);if(s.length>0){_(!0);try{let t=e;for(const e of s){const{fullMatch:a,format:s,base64Data:o}=e,n=await T(o,s);if(n){const e=a.replace(/src="data:image\/[^;]+;base64,[^"]+"/,`src="${n}"`);t=t.replace(a,e),console.log("Replaced base64 image with S3 URL:",n)}}if(_(!1),a&&t!==e)return void a(t)}catch(t){console.error("Error processing base64 images:",t),_(!1),n.oR.error("Failed to upload images. Please try again.")}}else o.length>0&&console.log("Content contains only S3 images, no upload needed")}a&&a(e)},onLoad:e=>{if(P.current=e,R.current){const e=R.current.getInstance();e&&Object.keys(e).length>0&&(P.current=e)}g&&g(e)},onFocus:(e,t)=>{x&&x(e,t)},onBlur:(e,t)=>{f&&f(e,t)},...v}),y&&b?(0,i.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(52, 152, 219, 0.1)",border:"2px dashed #3498db",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999,borderRadius:"4px"},children:(0,i.jsxs)("div",{style:{textAlign:"center",color:"#3498db",fontSize:"16px",fontWeight:"500"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\udcc1"}),"Drop your image here"]})}):null,null!==w&&void 0!==w&&w.uploading||null!==w&&void 0!==w&&w.success||null!==w&&void 0!==w&&w.error||A?(0,i.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.9)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3,borderRadius:"4px"},children:[(w.uploading||A)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{width:"60px",height:"60px",border:"4px solid #f3f3f3",borderTop:"4px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"16px"}}),(0,i.jsx)("div",{style:{fontSize:"14px",fontWeight:"500",color:"#333",marginBottom:"8px"},children:A?"Processing images...":"Uploading image..."}),w.uploading&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{width:"200px",height:"6px",backgroundColor:"#f0f0f0",borderRadius:"3px",overflow:"hidden"},children:(0,i.jsx)("div",{style:{width:`${w.progress}%`,height:"100%",backgroundColor:"#3498db",transition:"width 0.3s ease"}})}),(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:[w.progress,"%"]})]})]}),w.success&&(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{width:"50px",height:"50px",backgroundColor:"#27ae60",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:(0,i.jsx)("span",{style:{color:"white",fontSize:"24px"},children:"\u2713"})}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#27ae60"},children:"Upload completed!"})]}),w.error&&(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{width:"50px",height:"50px",backgroundColor:"#e74c3c",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:(0,i.jsx)("span",{style:{color:"white",fontSize:"24px"},children:"\u2717"})}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#e74c3c"},children:"Upload failed"})]})]}):null]})]})};a(95903)},87160:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var s=a(65043),o=a(32952),n=a(14282),r=a(76163),l=a(69956),i=a(89488),c=a(55683),d=a(58387),p=a(29853),u=a(56328);const h="file-uploader_title__MJFJ7",m="file-uploader_previewSection__ot4jI",g="file-uploader_previewBox__KC4if",x="file-uploader_previewBoxImg1__rKP04",f="file-uploader_previewActions__r3LWm",b="file-uploader_label__pWhYK";var C=a(70579);const j=e=>{let{show:t,setShow:a,setPhoto:j,additionalDesign:v,shape:w="rect"}=e;const[F,y]=(0,s.useState)([]),[E,A]=(0,s.useState)({x:0,y:0}),[_,S]=(0,s.useState)(1),[R,P]=(0,s.useState)(0),[k,B]=(0,s.useState)(null),[I,T]=(0,s.useState)({}),D=(0,s.useCallback)(((e,t)=>{B(t)}),[]),N=(0,s.useCallback)((async()=>{if(!F.length||!k)return;const e=document.createElement("canvas"),t=e.getContext("2d"),a=new Image;a.src=F[0].preview,await new Promise((e=>a.onload=e)),e.width=k.width,e.height=k.height,t.translate(e.width/2,e.height/2),t.rotate(R*Math.PI/180),t.translate(-e.width/2,-e.height/2),t.drawImage(a,k.x,k.y,k.width,k.height,0,0,k.width,k.height);return e.toDataURL("image/jpeg")}),[F,k,R]),L=async()=>{const e=await N();e&&T({img2:e,img3:e,img4:e,img5:e})};(0,s.useEffect)((()=>{L()}),[_,E,R,F,k]);const{getRootProps:U,getInputProps:z}=(0,i.VB)({maxFiles:1,accept:{"image/*":[]},onDrop:e=>{y(e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e)}))))}});return(0,C.jsxs)(o.A,{style:{zIndex:1111},show:t,centered:!0,onHide:()=>a(!1),onShow:L,children:[(0,C.jsx)(o.A.Header,{closeButton:!0,children:(0,C.jsx)(o.A.Title,{children:(0,C.jsx)("span",{className:`${h}`,children:"Edit Photo"})})}),(0,C.jsxs)(o.A.Body,{children:[v,(0,C.jsxs)("div",{className:`${m}`,children:[(0,C.jsx)("div",{className:`${g}`,children:(0,C.jsx)("div",{className:(0,d.A)(x,"round"===w?"rounded-circle":""),children:(0,C.jsx)(c.Ay,{image:F.length>0?F[0].preview:null,crop:E,zoom:_,cropShape:w,rotation:R,onCropChange:A,onZoomChange:S,onCropComplete:D,aspect:1.5,restrictPosition:!1,style:{containerStyle:{width:"100%",height:"100%",position:"relative"},cropAreaStyle:{width:"100%",height:"100%"},mediaStyle:{width:"100%",height:"100%",objectFit:"contain"}}})})}),(0,C.jsxs)("div",{className:`${f}`,children:[(0,C.jsxs)(p.A.Group,{children:[(0,C.jsx)(p.A.Label,{className:`${b}`,children:"Zoom"}),(0,C.jsx)(p.A.Range,{value:_,min:1,max:3,step:.1,className:"custom-range",onChange:e=>S(e.target.value)})]}),(0,C.jsx)("div",{className:"d-flex align-item-center pt-4 ms-4",style:{gap:"8px"},children:(0,C.jsxs)(n.A,{className:"text-button",onClick:()=>{P((e=>(e+90)%360))},children:[(0,C.jsx)(r.A,{color:"#106B99",size:24}),"Rotate"]})})]})]}),(0,C.jsxs)("div",{...U({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"16px"},children:[(0,C.jsx)("input",{...z()}),(0,C.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:(0,C.jsx)(l.A,{})}),(0,C.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,C.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,C.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"SVG, PNG, JPG or GIF (max. 800x400px)"})]})]}),(0,C.jsxs)(o.A.Footer,{className:"d-flex justify-content-end",children:[(0,C.jsx)(n.A,{className:"outline-button",onClick:e=>{e.stopPropagation(),y([]),T({}),a(!1)},children:"Cancel"}),(0,C.jsx)(n.A,{className:"solid-button",onClick:async()=>{const e=await N();if(!e)return u.oR.error("Please select a photo");const t=function(e,t){const a=atob(e.split(",")[1]),s=new ArrayBuffer(a.length),o=new Uint8Array(s);for(let n=0;n<a.length;n++)o[n]=a.charCodeAt(n);return new Blob([s],{type:t})}(e,"image/jpeg");j({croppedImageBase64:e,croppedImageBlob:t}),a(!1),y([]),T({})},children:"Save Photo"})]})]})}},95903:(e,t,a)=>{"use strict";a.d(t,{w:()=>o});var s=a(70579);const o=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"ql-formats",children:[(0,s.jsx)("button",{className:"ql-bold me-1","aria-label":"Bold"}),(0,s.jsx)("button",{className:"ql-italic me-1","aria-label":"Italic"}),(0,s.jsx)("button",{className:"ql-underline me-1","aria-label":"Underline"})]}),(0,s.jsxs)("span",{className:"ql-formats",children:[(0,s.jsx)("button",{className:"ql-list me-1",value:"ordered","aria-label":"Ordered List"}),(0,s.jsx)("button",{className:"ql-list me-1",value:"bullet","aria-label":"Unordered List"}),(0,s.jsx)("button",{className:"ql-indent me-1",value:"-1","aria-label":"Indent"}),(0,s.jsx)("button",{className:"ql-indent me-1",value:"+1","aria-label":"Outdent"})]}),(0,s.jsxs)("span",{className:"ql-formats",children:[(0,s.jsxs)("select",{className:"ql-size me-1",children:[(0,s.jsx)("option",{value:"small",children:"Small"}),(0,s.jsx)("option",{value:"",selected:!0,children:"Normal"}),(0,s.jsx)("option",{value:"large",children:"Large"}),(0,s.jsx)("option",{value:"huge",children:"Huge"})]}),(0,s.jsx)("select",{className:"ql-color me-1"}),(0,s.jsx)("button",{className:"ql-link me-1",value:"+1","aria-label":"Outdent"})]})]})}}]);
//# sourceMappingURL=9439.5a9b0774.chunk.js.map