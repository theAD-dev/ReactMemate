"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[3171,6731],{568:(e,s,t)=>{t.d(s,{J:()=>l});const l=Object.freeze({CLIENTS:{CREATE:"CREATE_CLIENT",READ:"READ_CLIENT",UPDATE:"UPDATE_CLIENT",DELETE:"DELETE_CLIENT"},SUPPLIERS:{CREATE:"CREATE_SUPPLIER",READ:"READ_SUPPLIER",UPDATE:"UPDATE_SUPPLIER",DELETE:"DELETE_SUPPLIER"},SALES:{},MANAGEMENT:{},PROJECTS:{},STATISTIC:{},EXPENSE:{CREATE:"CREATE_EXPENSE",READ:"READ_EXPENSE",UPDATE:"UPDATE_EXPENSE",DELETE:"DELETE_EXPENSE"},INVOICE:{CREATE:"CREATE_INVOICE",READ:"READ_INVOICE",UPDATE:"UPDATE_INVOICE",DELETE:"DELETE_INVOICE"},SETTINGS:{SUBSCRIPTION:{BUY_BUSINESS_SUBSCRIPTION:"BUY_BUSINESS_SUBSCRIPTION",CANCEL_BUSINESS_SUBSCRIPTION:"CANCEL_BUSINESS_SUBSCRIPTION",BUY_COMPANY_USER_SUBSCRIPTION:"BUY_COMPANY_USER_SUBSCRIPTION",BUY_WORK_SUBSCRIPTION:"BUY_WORK_SUBSCRIPTION",CANCEL_WORK_SUBSCRIPTION:"CANCEL_WORK_SUBSCRIPTION",ACTIVE_WORK_SUBSCRIPTION:"ACTIVE_WORK_SUBSCRIPTION",BUY_WORK_USER_SUBSCRIPTION:"BUY_WORK_USER_SUBSCRIPTION",BUY_LOCATION_SUBSCRIPTION:"BUY_LOCATION_SUBSCRIPTION",REMOVE_LOCATION_SUBSCRIPTION:"REMOVE_LOCATION_SUBSCRIPTION"},USERS:{MOBILE_APP:{ADD:"ADD_USER",READ:"READ_USER",UPDATE:"UPDATE_USER",DISCONNECT_USER:"DISCONNECT_USER",RECONNECT_USER:"RECONNECT_USER",SHOW_DISCONNECTED_USERS:"SHOW_DISCONNECTED_USERS"},DESKTOP:{ADD:"ADD_USER",READ:"READ_USER",DELETE:"DELETE_USER",UPDATE:"UPDATE_USER",RESTORE:"RESTORE_USER",SHOW_DELETED_USERS:"SHOW_DELETED_USERS"}},LOCATION:{ADD:"ADD_LOCATION",READ:"READ_LOCATION",UPDATE:"UPDATE_LOCATION",DELETE:"DELETE_LOCATION"}}})},44908:(e,s,t)=>{t.d(s,{A:()=>Ce});var l=t(65043),n=t(61072),i=t(78602),a=t(14282),o=t(77918),r=t(96141),d=t(544),c=t(60867),p=t(55850),u=t(9634),m=t(93202),x=t(51038),h=t(94819),v=t(89488),E=t(24858),f=t(5293),g=t(35475),S=t(18403),j=t(93747),N=t(86213),_=t(58387),A=t(85371),I=t(55797),T=t(88060),b=t(28676),R=t(74532),C=t(79255),y=t(72052),P=t(27932),O=t(59690),D=t(20288),w=t(1356),U=t(56328),B=t(80899);const L="expenses-form_circledesignstyle__mbb1-",F="expenses-form_out__KMiJx",z="expenses-form_bgGreay__JyrcA",J="expenses-form_lable__PwIbw",G="expenses-form_inputText__juz8k",M="expenses-form_error__BY34l",k="expenses-form_dropdownSelect__9h-UH",V="expenses-form_expensesCreateNew__okukP",$="expenses-form_dividerIcon__9TOjY",W="expenses-form_expTotalRow__8u8o3",Y="expenses-form_CalItem__5I8ic",q="expenses-form_CalItemActive__NBMtY",H="expenses-form_fileBox__vJk+d",K="expenses-form_fileNameBox__Sb+Fy",X="expenses-form_deleteBox__IPh+B",Z="expenses-form_aiProcessingBox__Xslof",Q="expenses-form_aiProcessingSpinner__2Ykt8",ee="expenses-form_aiProcessingText__r+NWH",se="expenses-form_aiSuccessBox__5wZSk",te="expenses-form_aiSuccessText__g6HC8",le="expenses-form_aiNoDataBox__dy9sT",ne="expenses-form_aiNoDataText__fTku6",ie="expenses-form_aiErrorBox__nCorV",ae="expenses-form_aiErrorText__a5YuG",oe="expenses-form_selectButton__z9PXk",re="expenses-form_modal__lciui",de="expenses-form_modalHeader__Kf8rL",ce="expenses-form_headerTitle__2VPHZ",pe="expenses-form_iconStyle__s2Evh";var ue=t(10586),me=t(52781);const xe=t.p+"static/media/ai-scan.5a0b826f54cf1e4e72f8.png";var he=t(27472);const ve=e=>{try{if("object"===typeof e&&null!==e){if(!(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])))return e;{const s=e[0].find((e=>"text"===e[0]));s&&s[1]&&(e=s[1])}}if("string"===typeof e){const s=e.match(/```json\s*([\s\S]*?)\s*```/);if(s&&s[1])return JSON.parse(s[1]);const t=e.indexOf("{"),l=e.lastIndexOf("}");if(-1!==t&&-1!==l){const s=e.substring(t,l+1);return JSON.parse(s)}}return null}catch(s){return console.error("Error extracting AI response data:",s),null}},Ee=e=>{if(!e)return null;let s="0.00";e.total_amount&&(s=e.total_amount.replace(/[A-Za-z$,]/g,"").trim());let t="no";!0===e.gst_included?t="in":!1===e.gst_included&&(t="ex");const l=parseFloat(s)||0;let n=l,i=0;return"in"===t?(i=.1*l/1.1,n=l-i):"ex"===t&&(i=.1*n),{invoice_reference:e.invoice_number||"",amount:l.toFixed(2),"gst-calculation":t,gst:"ex"===t,nogst:"no"===t,subtotal:n.toFixed(2),tax:i.toFixed(2),totalAmount:(n+i).toFixed(2),note:e.description||""}};var fe=t(14834),ge=t(33296),Se=t(58027),je=t(11281),Ne=(t(66601),t(61427)),_e=t(70579);function Ae(e,s){let t;return function(){for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];clearTimeout(t),t=setTimeout((()=>e(...n)),s)}}const Ie=B.Ik({supplier:B.ai().typeError("Supplier must be a valid id").required("Supplier is required"),invoice_reference:B.Yj().required("Invoice reference is required"),date:B.Yj().required("Date is required"),due_date:B.Yj().required("Due date is required").test("is-after-date","Due date must be after the invoice date",(function(e){const{date:s}=this.parent;if(!s||!e)return!0;const t=new Date(s),l=new Date(e);return t.setHours(0,0,0,0),l.setHours(0,0,0,0),l>=t})),amount:B.Yj().required("Amount is required"),nogst:B.zM().required("NOGST must be a boolean"),gst:B.zM().required("GST must be a boolean")}).required(),Te=(0,l.forwardRef)(((e,s)=>{var t,f,I,B,re,de,ce,pe,Te,Ce,ye,Pe,Oe,De,we;let{onSubmit:Ue,defaultValues:Be,id:Le,defaultSupplier:Fe,projectId:ze}=e;(0,l.useRef)(null);const Je=(0,l.useRef)(null),Ge=localStorage.getItem("access_token"),[Me,ke]=(0,l.useState)(!1),[Ve,$e]=(0,l.useState)((null===Fe||void 0===Fe?void 0:Fe.id)||""),[We,Ye]=(0,l.useState)(Fe||null),[qe,He]=(0,l.useState)([]),[Ke,Xe]=(0,l.useState)([]),[Ze,Qe]=(0,l.useState)(1),[es,ss]=(0,l.useState)(""),[ts,ls]=(0,l.useState)(!0),[ns,is]=(0,l.useState)(!1),[as,os]=(0,l.useState)(!1),[rs,ds]=(0,l.useState)(!1),[cs,ps]=(0,l.useState)([]),{control:us,reset:ms,register:xs,handleSubmit:hs,setValue:vs,getValues:Es,watch:fs,setError:gs,trigger:Ss,formState:{errors:js}}=(0,E.mN)({resolver:(0,S.t)(Ie),defaultValues:Be}),{getRootProps:Ns,getInputProps:_s}=(0,v.VB)({maxFiles:1,multiple:!1,accept:{"application/pdf":[".pdf",".png",".jpg",".jpeg"]},maxSize:5242880,onDrop:e=>{const s=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0})));Xe((()=>[...s])),bs(s,!1)}}),{getRootProps:As,getInputProps:Is}=(0,v.VB)({maxFiles:1,multiple:!1,accept:{"application/pdf":[".pdf",".png",".jpg",".jpeg"]},maxSize:5242880,onDrop:e=>{const s=e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e),progress:0,aiAnalysis:!0})));Xe((()=>[...s])),bs(s,!0)}}),Ts=async(e,s)=>N.A.put(s,e,{headers:{"Content-Type":""},onUploadProgress:t=>{const l=Math.round(t.loaded/t.total*100);Xe((t=>t.map((t=>t.name===e.name?Object.assign(t,{progress:l,url:s}):t))))}}).catch((t=>{console.log("err: ",t),Xe((t=>t.map((t=>t.name===e.name?Object.assign(t,{progress:0,url:s,error:!0}):t))))})),bs=async(e,s)=>{if(e.length)for(const n of e)try{const e=await N.A.post("https://app.memate.com.au/api/v1/expenses/file/",{file_name:n.name},{headers:{Authorization:`Bearer ${Ge}`}}),{url:l}=e.data;if(!l)return Xe([]),void U.oR.error(`Failed to upload ${n.name}. Please try again.`);await Ts(n,l);const i=l.split("?")[0]||"";if(i&&(ps([i]),is(!0)),!s)return vs("file",i),void Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{progress:100}):e))));if(s){Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{progress:100,aiProcessing:!0}):e)))),U.oR.info("AI is analyzing your document...",{duration:3e3});try{const e=await N.A.post("https://app.memate.com.au/api/v1/expenses/recognize/",{file_url:i},{headers:{Authorization:`Bearer ${Ge}`}}),s=ve(null===e||void 0===e?void 0:e.data);if(s){const e=Ee(s);e?(vs("file",i),Object.entries(e).forEach((e=>{let[s,t]=e;vs(s,t)})),Ss(["invoice_reference","amount","gst","nogst"]),U.oR.success("Form prefilled with invoice data"),Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiSuccess:!0}):e))))):(Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),U.oR.warning("No invoice data could be extracted from the document"))}else Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiNoData:!0}):e)))),U.oR.warning("No invoice data could be extracted from the document")}catch(t){console.error("Error during AI recognition:",t),Xe((e=>e.map((e=>e.name===n.name?Object.assign(e,{aiProcessing:!1,aiError:!0}):e)))),U.oR.error("Failed to analyze the document. Please try again.")}}}catch(l){console.error("Error uploading file:",n.name,l),U.oR.error(`Failed to upload ${n.name}. Please try again.`)}},Rs=Ae((e=>{var s;const t=(null===e||void 0===e||null===(s=e.filter)||void 0===s?void 0:s.toLowerCase())||"";ss(t)}),300);(0,l.useEffect)((()=>{Qe(1)}),[es,rs]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,me.Jj)(Ze,25,es,"name");if(1===Ze){if(Ve){const s=e.results.filter((e=>e.id!==Ve));return He([We,...s])}He(e.results)}else{var s;if((null===e||void 0===e||null===(s=e.results)||void 0===s?void 0:s.length)>0){let s=e.results;Ve&&(s=[We,...e.results]),He((e=>{let t=e;Ve&&(t=[...e,We]);const l=new Set(t.map((e=>e.id))),n=s.filter((e=>!l.has(e.id)));return[...e,...n]}))}}ls(e.count!==qe.length)})()}),[Ze,es,Ve,We,rs]),(0,l.useEffect)((()=>{if(qe.length>0&&ts){const e=setTimeout((()=>{const e=document.querySelector(".supplier-dropdown .p-dropdown-items li.p-dropdown-item:last-child");console.log("lastRow: ",e),e&&(Je.current=new IntersectionObserver((e=>{e[0].isIntersecting&&(Qe((e=>e+1)),console.log("entries[0].isIntersecting: ",e[0].isIntersecting))})),Je.current.observe(e))}),1e3);return()=>{clearTimeout(e),Je.current&&Je.current.disconnect()}}}),[qe,ts]);const Cs=e=>{if(e){const s=parseFloat(Es("amount"))||0,{subtotal:t,calculatedTax:l,totalAmount:n}=((e,s)=>{let t=0,l=0;return"ex"===s?(l=e,t=.1*l):"in"===s?(t=.1*e/1.1,l=e-t):(l=e,t=0),{subtotal:l.toFixed(2),calculatedTax:t.toFixed(2),totalAmount:(parseFloat(l)+parseFloat(t)).toFixed(2)}})(s,e);vs("tax",l),vs("subtotal",t),vs("totalAmount",n),vs("nogst","no"===e),vs("gst","ex"===e),Ss(["gst"])}},ys=(0,j.I)({queryKey:["getXeroCodesList"],queryFn:ue.JP}),Ps=(0,j.I)({queryKey:["getProjectsList"],queryFn:ue.Bu}),Os=["Assign to project","Assign to timeframe"],[Ds,ws]=(0,l.useState)((null===Be||void 0===Be?void 0:Be.option)||Os[0]),Us=fs("order");(0,l.useEffect)((()=>{Us&&Ss(["order"])}),[Us]);const Bs=fs("type"),Ls=()=>{"Assign to project"!==Ds||Us||gs("order",{type:"manual",message:"Order is required"}),"Assign to timeframe"!==Ds||Bs||gs("type",{type:"manual",message:"Type is required"})};(0,l.useEffect)((()=>{Object.keys(js).length>0&&Ls()}),[js]),(0,l.useEffect)((()=>{"Assign to timeframe"===Ds?(vs("order",""),null!==Be&&void 0!==Be&&Be.type&&vs("type",null===Be||void 0===Be?void 0:Be.type)):"Assign to project"===Ds&&(vs("type",""),null!==Be&&void 0!==Be&&Be.order&&vs("order",null===Be||void 0===Be?void 0:Be.order)),vs("option",Ds)}),[Ds]),(0,l.useEffect)((()=>{null!==Be&&void 0!==Be&&Be.option&&ws(null===Be||void 0===Be?void 0:Be.option)}),[null===Be||void 0===Be?void 0:Be.option]);(0,l.useEffect)((()=>{ze&&vs("order",+ze)}),[ze]),(0,l.useEffect)((()=>{Le||vs("gst-calculation","in")}),[]),(0,l.useEffect)((()=>{var e,s;if(Ve&&vs("supplier",+Ve),Ve&&Ss(["supplier"]),null!==We&&void 0!==We&&null!==(e=We.service)&&void 0!==e&&e.code&&null!==ys&&void 0!==ys&&null!==(s=ys.data)&&void 0!==s&&s.length){var t;let e=null===ys||void 0===ys||null===(t=ys.data)||void 0===t?void 0:t.find((e=>{var s;return e.code===(null===We||void 0===We||null===(s=We.service)||void 0===s?void 0:s.code)}));null!==e&&void 0!==e&&e.id&&vs("account_code",null===e||void 0===e?void 0:e.id)}else Be.account_code&&vs("account_code",Be.account_code||"")}),[Ve,null===ys||void 0===ys?void 0:ys.data,vs,Ss,Be.account_code,null===We||void 0===We||null===(t=We.service)||void 0===t?void 0:t.code]);const Fs=(0,_e.jsx)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0 w-100",style:{borderBottom:"1px solid #EAECF0",padding:"4px 10px 24px 0px"},children:(0,_e.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,_e.jsx)("div",{className:L,children:(0,_e.jsx)("div",{className:F,children:(0,_e.jsx)(o.A,{size:24,color:"#17B26A"})})}),(0,_e.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Document Preview"})]})});(0,l.useEffect)((()=>{null!==Be&&void 0!==Be&&Be.file&&(ps([null===Be||void 0===Be?void 0:Be.file]),is(!0))}),[null===Be||void 0===Be?void 0:Be.file]);return(0,_e.jsxs)("div",{children:[(0,_e.jsxs)("form",{ref:s,onSubmit:hs((e=>{Ls(),Object.keys(js).length>0?console.log("Validation errors:",js):Ue(e,ms)})),children:[(0,_e.jsxs)(n.A,{className:(0,_.A)(z,"pt-3"),children:[(0,_e.jsx)(i.A,{sm:8,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mb-3",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Supplier",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsx)("input",{type:"hidden",...xs("supplier")}),(0,_e.jsx)(T.m,{value:Ve,options:qe,optionLabel:"name",optionValue:"id",onChange:e=>{$e(+e.value);let s=qe.find((s=>s.id===e.value));Ye(s||{})},itemTemplate:e=>(0,_e.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,_e.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,_e.jsx)(Se.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,_e.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}),valueTemplate:e=>Ve?(0,_e.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,_e.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,_e.jsx)(Se.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,_e.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}):null,className:(0,_.A)(k,"dropdown-height-fixed",{[M]:null===js||void 0===js?void 0:js.supplier}),panelClassName:"supplier-dropdown",style:{height:"46px"},scrollHeight:"350px",placeholder:"Search for supplier",filter:!0,onFilter:Rs,filterInputAutoFocus:!0}),js.supplier&&(0,_e.jsx)("p",{className:"error-message",children:js.supplier.message})]})}),(0,_e.jsx)(i.A,{sm:4,children:(0,_e.jsx)("div",{className:"d-flex justify-content-end text-md-end flex-column gap-1 mt-3 pt-3 mb-3",children:(0,_e.jsxs)(a.A,{className:V,onClick:()=>os(!0),children:["Create New Supplier",(0,_e.jsx)(r.A,{size:24,color:"#475467"})]})})}),(0,_e.jsx)(i.A,{sm:12,className:"mb-4",children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Invoice/#Ref",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsxs)(b.C,{children:[(0,_e.jsx)(R.m,{children:(null===js||void 0===js?void 0:js.invoice_reference)&&(0,_e.jsx)("img",{src:he.A,className:"mb-3"})}),(0,_e.jsx)(y.S,{...xs("invoice_reference"),className:(0,_.A)(G,{[M]:js.invoice_reference}),placeholder:"Enter invoice reference"})]}),(null===js||void 0===js?void 0:js.invoice_reference)&&(0,_e.jsx)("p",{className:"error-message",children:null===(f=js.invoice_reference)||void 0===f?void 0:f.message})]})}),(0,_e.jsxs)(i.A,{sm:12,children:[(0,_e.jsxs)(n.A,{children:[(0,_e.jsxs)(i.A,{sm:6,children:[(0,_e.jsx)("label",{className:(0,_.A)(J),children:"Upload Only"}),(0,_e.jsxs)("div",{...Ns({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"5px"},children:[(0,_e.jsx)("input",{..._s()}),(0,_e.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #EAECF0",background:"#fff",borderRadius:"8px",marginBottom:"16px"},children:(0,_e.jsx)(d.A,{size:20,color:"#475467"})}),(0,_e.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,_e.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,_e.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"PDF, SVG, PNG, JPG files \u2022 Max size: 5MB"})]})]}),(0,_e.jsxs)(i.A,{sm:6,children:[(0,_e.jsx)("label",{className:(0,_.A)(J),children:"Upload & Read With AI"}),(0,_e.jsxs)("div",{...As({className:"dropzone d-flex justify-content-center align-items-center flex-column"}),style:{width:"100%",height:"126px",background:"#fff",borderRadius:"4px",border:"1px solid #EAECF0",marginTop:"5px"},children:[(0,_e.jsx)("input",{...Is()}),(0,_e.jsx)("button",{type:"button",className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",border:"1px solid #FFF",background:"#f2f2f2",borderRadius:"8px",marginBottom:"16px"},children:(0,_e.jsx)("img",{src:xe,className:"w-100"})}),(0,_e.jsxs)("p",{className:"mb-0",style:{color:"#475467",fontSize:"14px"},children:[(0,_e.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop"]}),(0,_e.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"PDF, PNG, JPG, JPEG files \u2022 Max size: 5MB"})]})]})]}),(0,_e.jsxs)("div",{className:"d-flex flex-column",children:[(null===Ke||void 0===Ke?void 0:Ke.length)>0&&(0,_e.jsx)("label",{className:(0,_.A)(J,"mt-4 mb-1"),children:"Photo/Document Of The Expense"}),null===Ke||void 0===Ke?void 0:Ke.map(((e,s)=>(0,_e.jsxs)("div",{className:H,children:[(0,je.I)(e.type),(0,_e.jsxs)("div",{className:K,children:[(0,_e.jsx)("p",{className:"mb-0",children:(null===e||void 0===e?void 0:e.name)||""}),(0,_e.jsxs)("p",{className:"mb-0",children:[parseFloat((null===e||void 0===e?void 0:e.size)/1024).toFixed(2)," KB - ",parseInt(null===e||void 0===e?void 0:e.progress)||0,"% uploaded"]})]}),(0,_e.jsx)("div",{className:"ms-auto",children:e.error?(0,_e.jsx)("div",{className:X,children:(0,_e.jsx)(c.A,{color:"#F04438",size:16})}):e.aiProcessing?(0,_e.jsxs)("div",{className:Z,children:[(0,_e.jsx)("div",{className:Q}),(0,_e.jsx)("span",{className:ee,children:"AI analyzing..."})]}):e.aiSuccess?(0,_e.jsxs)("div",{className:se,children:[(0,_e.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,_e.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM7 11.4L3.6 8L5 6.6L7 8.6L11 4.6L12.4 6L7 11.4Z",fill:"#12B76A"})}),(0,_e.jsx)("span",{className:te,children:"Data extracted"})]}):e.aiNoData?(0,_e.jsxs)("div",{className:le,children:[(0,_e.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,_e.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM8 12C7.4 12 7 11.6 7 11C7 10.4 7.4 10 8 10C8.6 10 9 10.4 9 11C9 11.6 8.6 12 8 12ZM9 9H7V4H9V9Z",fill:"#F79009"})}),(0,_e.jsx)("span",{className:ne,children:"No data found"})]}):e.aiError?(0,_e.jsxs)("div",{className:ie,children:[(0,_e.jsx)(c.A,{color:"#F04438",size:16}),(0,_e.jsx)("span",{className:ae,children:"AI error"})]}):100==e.progress?(0,_e.jsx)(p.A,{color:"#12B76A",size:20}):(0,_e.jsx)(ge.A,{percentage:parseInt(null===e||void 0===e?void 0:e.progress)||0,size:30,color:"#158ECC"})})]},s)))]})]}),(0,_e.jsx)(i.A,{sm:6,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Date",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsx)(E.xI,{name:"date",control:us,render:e=>{let{field:s}=e;return(0,_e.jsx)(A.V,{...s,onChange:e=>{s.onChange(e.value),setTimeout((()=>Ss("due_date")),0)},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",showIcon:!0,style:{height:"46px"},icon:(0,_e.jsx)(u.A,{color:"#667085",size:20}),className:(0,_.A)(G,{[M]:js.date},"p-0 outline-none")})}}),(null===js||void 0===js?void 0:js.date)&&(0,_e.jsx)("p",{className:"error-message",children:null===(I=js.date)||void 0===I?void 0:I.message})]})}),(0,_e.jsx)(i.A,{sm:6,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Due Date",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsx)(E.xI,{name:"due_date",control:us,render:e=>{let{field:s}=e;const t=fs("date"),l=t?new Date(t):null;return(0,_e.jsx)(A.V,{...s,onChange:e=>{s.onChange(e.value),Ss("due_date")},showButtonBar:!0,placeholder:"DD/MM/YY",dateFormat:"dd/mm/yy",locale:"en",showIcon:!0,minDate:l,style:{height:"46px"},icon:(0,_e.jsx)(u.A,{color:"#667085",size:20}),className:(0,_.A)(G,{[M]:js.due_date},"p-0 outline-none")})}}),(null===js||void 0===js?void 0:js.due_date)&&(0,_e.jsx)("p",{className:"error-message",children:null===(B=js.due_date)||void 0===B?void 0:B.message})]})}),(0,_e.jsx)(i.A,{sm:6,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Total Amount",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsxs)(b.C,{children:[(0,_e.jsx)(C.Y,{prefix:"$",value:fs("amount"),onValueChange:e=>{vs("amount",e.value),Cs(Es("gst-calculation"))},onBlur:()=>Cs(Es("gst-calculation")),style:{height:"46px",padding:"0px"},className:(0,_.A)(G,{[M]:js.amount}),placeholder:"$ Enter total amount",maxFractionDigits:2,minFractionDigits:2,inputId:"minmaxfraction"}),(0,_e.jsx)(R.m,{children:js.amount&&(0,_e.jsx)("img",{src:he.A,className:"mb-3"})})]}),(null===js||void 0===js?void 0:js.amount)&&(0,_e.jsx)("p",{className:"error-message",children:null===(re=js.amount)||void 0===re?void 0:re.message})]})}),(0,_e.jsx)(i.A,{sm:6,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mb-2",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["GST",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsx)("input",{type:"hidden",...xs("nogst")}),(0,_e.jsx)(E.xI,{name:"gst-calculation",control:us,render:e=>{let{field:s}=e;return(0,_e.jsx)(T.m,{...s,options:[{value:"ex",label:"GST Exclusive"},{value:"in",label:"GST Inclusive"},{value:"no",label:"No GST"}]||0,onChange:e=>{s.onChange(e.value),Cs(e.value)},className:(0,_.A)(k,"dropdown-height-fixed",{[M]:null===js||void 0===js?void 0:js.gst}),style:{height:"46px"},value:s.value,placeholder:"Select GST",filterInputAutoFocus:!0})}}),(null===js||void 0===js?void 0:js.gst)&&(0,_e.jsx)("p",{className:"error-message",children:null===(de=js.gst)||void 0===de?void 0:de.message})]})})]}),(0,_e.jsxs)(n.A,{className:`${W}`,children:[(0,_e.jsxs)(i.A,{className:"d-flex align-items-center justify-content-end",style:{position:"relative"},children:[(0,_e.jsx)("div",{className:Y,children:(0,_e.jsxs)("div",{children:[(0,_e.jsx)("span",{children:"Subtotal"}),(0,_e.jsxs)("strong",{children:["$",(0,fe.m)(fs("subtotal")||"0.00")]})]})}),(0,_e.jsx)("div",{className:$,children:(0,_e.jsx)(m.A,{color:"#667085",size:20})})]}),(0,_e.jsxs)(i.A,{className:"d-flex align-items-center justify-content-end",style:{position:"relative"},children:[(0,_e.jsx)("div",{className:Y,children:(0,_e.jsxs)("div",{children:[(0,_e.jsx)("span",{children:"Tax"}),(0,_e.jsxs)("strong",{children:["$",(0,fe.m)(fs("tax")||"0.00")]})]})}),(0,_e.jsx)("div",{className:$,children:(0,_e.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",fontWeight:600},children:"="})})]}),(0,_e.jsx)(i.A,{style:{position:"relative"},children:(0,_e.jsx)("div",{className:`${q} ${Y}`,children:(0,_e.jsxs)("div",{children:[(0,_e.jsx)("span",{children:"Total"}),(0,_e.jsxs)("strong",{className:"text-nowrap",children:["$",(0,fe.m)(fs("totalAmount")||"0.00")]})]})})})]}),(0,_e.jsxs)(n.A,{className:(0,_.A)(z,"customSelectButton"),children:[(0,_e.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:(0,_e.jsx)(O.J,{value:Ds,className:oe,onChange:e=>ws(e.value),options:Os})}),"Assign to project"===Ds?(0,_e.jsx)(i.A,{sm:12,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,_e.jsx)(w.m,{position:"top",target:".info-timeinterval"}),(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Link to Project",(0,_e.jsx)("span",{className:"required",children:"*"})," ",(0,_e.jsx)(x.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Select an existing project to assign expenses and display the exact cost of using this asset."})]}),(0,_e.jsx)(E.xI,{name:"order",control:us,render:e=>{var s;let{field:t}=e;return(0,_e.jsx)(T.m,{...t,options:(null===Ps||void 0===Ps||null===(s=Ps.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{t.onChange(e.value)},className:(0,_.A)(k,"dropdown-height-fixed",{[M]:null===js||void 0===js?void 0:js.order}),style:{height:"46px"},value:t.value,loading:null===Ps||void 0===Ps?void 0:Ps.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,scrollHeight:"400px"})}}),(null===js||void 0===js?void 0:js.order)&&(0,_e.jsx)("p",{className:"error-message",children:null===(ce=js.order)||void 0===ce?void 0:ce.message})]})}):(0,_e.jsx)(i.A,{sm:12,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,_e.jsx)(w.m,{position:"top",target:".info-timeinterval"}),(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Expense time interval",(0,_e.jsx)("span",{className:"required",children:"*"})," ",(0,_e.jsx)(x.A,{color:"#667085",style:{position:"relative",top:"-1px"},className:"ms-1 info-timeinterval","data-pr-tooltip":"Selecting this option will categorize the expense under 'Operational Expense' and distribute it evenly over the chosen timeframe."})]}),(0,_e.jsx)(E.xI,{name:"type",control:us,render:e=>{let{field:s}=e;return(0,_e.jsx)(T.m,{...s,options:[{value:1,label:"Monthly"},{value:2,label:"Yearly"}],onChange:e=>{s.onChange(e.value)},className:(0,_.A)(k,"dropdown-height-fixed",{[M]:null===js||void 0===js?void 0:js.type}),style:{height:"46px"},value:s.value,placeholder:"Select expense time interval",filterInputAutoFocus:!0})}}),(null===js||void 0===js?void 0:js.type)&&(0,_e.jsx)("p",{className:"error-message",children:null===(pe=js.type)||void 0===pe?void 0:pe.message})]})})]}),(0,_e.jsx)(n.A,{className:(0,_.A)(z),children:(0,_e.jsx)(i.A,{sm:12,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,_e.jsx)("label",{className:(0,_.A)(J),children:"Notes"}),(0,_e.jsxs)(b.C,{children:[(0,_e.jsx)(R.m,{style:{top:"75%"},children:js.note&&(0,_e.jsx)("img",{src:he.A,alt:"error-icon"})}),(0,_e.jsx)(P.Z,{...xs("note"),rows:3,cols:30,className:(0,_.A)(G,{[M]:js.note}),style:{resize:"none"},placeholder:"Enter a note..."})]}),js.note&&(0,_e.jsx)("p",{className:"error-message",children:js.note.message})]})})}),(0,_e.jsx)(n.A,{className:(0,_.A)(z),children:(0,_e.jsx)(i.A,{sm:12,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1 mt-4 mb-4",children:[(0,_e.jsx)("label",{className:(0,_.A)(J),children:"Account Code"}),(0,_e.jsx)(E.xI,{name:"account_code",control:us,render:e=>{var s;let{field:t}=e;return(0,_e.jsx)(T.m,{...t,options:[...ys&&(null===ys||void 0===ys||null===(s=ys.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.code}: ${e.name}`}))))||[]]||[],onChange:e=>{t.onChange(e.value)},className:(0,_.A)(k,"dropdown-height-fixed",{[M]:null===js||void 0===js?void 0:js.account_code}),style:{height:"46px"},scrollHeight:"400px",value:t.value,loading:null===ys||void 0===ys?void 0:ys.isFetching,placeholder:"Select account code",filter:!0,filterInputAutoFocus:!0})}}),(null===js||void 0===js?void 0:js.account_code)&&(0,_e.jsx)("p",{className:"error-message",children:null===(Te=js.account_code)||void 0===Te?void 0:Te.message})]})})}),null!==cs&&void 0!==cs&&cs.length?(0,_e.jsx)(n.A,{className:(0,_.A)(z),children:(0,_e.jsx)(i.A,{sm:12,children:(0,_e.jsx)("div",{className:"d-flex flex-column gap-1",children:(0,_e.jsxs)("div",{className:"d-flex flex-column",children:[(0,_e.jsx)("label",{className:(0,_.A)(J,"mb-2"),children:"Photo/Document Of The Expense"}),cs[0]&&(0,_e.jsxs)("div",{className:H,children:[(0,je.I)((null===(Ce=cs[0])||void 0===Ce||null===(ye=Ce.split("."))||void 0===ye?void 0:ye[(null===(Pe=cs[0])||void 0===Pe?void 0:Pe.split(".").length)-1])||""),(0,_e.jsxs)("div",{className:K,children:[(0,_e.jsx)(g.N_,{className:"linkText",to:cs[0],target:"_blank",children:(0,_e.jsx)("p",{className:"mb-0",children:(null===(Oe=cs[0])||void 0===Oe||null===(De=Oe.split("/"))||void 0===De?void 0:De[(null===(we=cs[0])||void 0===we?void 0:we.split("/").length)-1])||""})}),(0,_e.jsx)("p",{className:"mb-0"})]}),(0,_e.jsx)("div",{className:"ms-auto",children:(0,_e.jsx)("div",{className:"d-flex align-items-center justify-content-center",style:{background:"#FEE4E2",borderRadius:"200px",width:"30px",height:"30px"},children:(0,_e.jsx)(h.A,{size:16,color:"#F04438",style:{cursor:"pointer"},onClick:()=>{vs("file",""),ps([]),is(!1)}})})})]})]})})})}):""]}),(0,_e.jsx)(D.B,{visible:ns&&(null===cs||void 0===cs?void 0:cs.length),header:Fs,position:"right",modal:!1,dismissable:!1,style:{width:"1200px",paddingRight:"720px"},maskClassName:"p-sidebar-mask-document",onHide:()=>is(!1),children:(0,_e.jsx)(be,{files:cs})}),Me&&(0,_e.jsx)(Re,{visible:Me,onHide:()=>ke(!1)}),as&&(0,_e.jsx)(Ne.A,{visible:as,setVisible:os,refetch:()=>ds((e=>!e))})]})})),be=e=>{let{files:s}=e;const[t,n]=(0,l.useState)({}),i=(e,s)=>{n((t=>{var l,n;const i=(null===(l=t[e])||void 0===l?void 0:l.currentPage)||1,a=(null===(n=t[e])||void 0===n?void 0:n.numPages)||1,o=Math.min(Math.max(i+s,1),a);return{...t,[e]:{...t[e],currentPage:o}}}))};return(0,_e.jsx)("div",{style:{display:"grid",gap:"2rem"},children:s.map(((e,s)=>{if(/\.(jpeg|jpg|png|webp|gif|svg)$/i.test(e))return(0,_e.jsx)("img",{src:e,alt:`preview-${s}`,style:{maxWidth:"100%",maxHeight:"400px",border:"1px solid #ccc"}},s);if((e=>/\.pdf$/i.test(e))(e)){const l=t[e]||{},{numPages:a=null,currentPage:o=1}=l;return(0,_e.jsxs)("div",{style:{border:"1px solid #ccc",padding:"1rem",maxWidth:"420px"},children:[(0,_e.jsx)(f.yo,{file:e,onLoadSuccess:s=>((e,s)=>{let{numPages:t}=s;n((s=>({...s,[e]:{...s[e],numPages:t,currentPage:1}})))})(e,s),onLoadError:e=>console.error("PDF load error:",e),children:(0,_e.jsx)(f.YW,{pageNumber:o,width:400})}),a&&(0,_e.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"1rem",gap:"1rem"},children:[(0,_e.jsx)("button",{className:"outline-button px-2",style:{height:"30px"},onClick:()=>i(e,-1),disabled:o<=1,children:"\u2039"}),(0,_e.jsxs)("span",{children:[o," of ",a]}),(0,_e.jsx)("button",{className:"outline-button px-2",style:{height:"30px"},onClick:()=>i(e,1),disabled:o>=a,children:"\u203a"})]})]},s)}return(0,_e.jsxs)("p",{children:["Unsupported file type: ",e]},s)}))})},Re=l.memo((e=>{var s;let{visible:t,onHide:o,defaultValues:d={}}=e;const c=(0,l.useRef)(null),[p,u]=(0,l.useState)((null===(s=d.supplier)||void 0===s?void 0:s.id)||""),[m,x]=(0,l.useState)(d.supplier||null),[h,v]=(0,l.useState)([]),[E,f]=(0,l.useState)(1),[S,j]=(0,l.useState)(""),[N,A]=(0,l.useState)(!0),[b,R]=(0,l.useState)([]),C=Ae((e=>{var s;const t=(null===e||void 0===e||null===(s=e.filter)||void 0===s?void 0:s.toLowerCase())||"";j(t)}),300);(0,l.useEffect)((()=>{f(1)}),[S]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,me.Jj)(E,25,S,"name");if(1===E){if(p){const s=e.results.filter((e=>e.id!==p));return v([m,...s])}v(e.results)}else{var s;if((null===e||void 0===e||null===(s=e.results)||void 0===s?void 0:s.length)>0){let s=e.results;p&&(s=[m,...e.results]),v((e=>{let t=e;p&&(t=[...e,m]);const l=new Set(t.map((e=>e.id))),n=s.filter((e=>!l.has(e.id)));return[...e,...n]}))}}A(e.count!==h.length)})()}),[E,S,p,m]),(0,l.useEffect)((()=>{if(h.length>0&&N){const e=setTimeout((()=>{const e=document.querySelector(".supplier-dropdown .p-dropdown-items li.p-dropdown-item:last-child");console.log("lastRow: ",e),e&&(c.current=new IntersectionObserver((e=>{e[0].isIntersecting&&(f((e=>e+1)),console.log("entries[0].isIntersecting: ",e[0].isIntersecting))})),c.current.observe(e))}),1e3);return()=>{clearTimeout(e),c.current&&c.current.disconnect()}}}),[h,N]);const y=(0,_e.jsxs)("div",{className:`${de}`,children:[(0,_e.jsx)("div",{className:pe,children:(0,_e.jsx)("img",{src:xe,alt:"Review Icon"})}),(0,_e.jsx)("span",{className:`white-space-nowrap ${ce}`,children:"Review"})]}),P=(0,_e.jsx)("div",{className:"d-flex justify-content-end align-items-center gap-3"});return(0,_e.jsxs)(I.l,{visible:t,modal:!0,onHide:o,header:y,footer:P,className:`${re} custom-modal`,children:[(0,_e.jsxs)(n.A,{className:"mb-2",children:[(0,_e.jsx)(i.A,{sm:8,children:(0,_e.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,_e.jsxs)("label",{className:(0,_.A)(J),children:["Supplier",(0,_e.jsx)("span",{className:"required",children:"*"})]}),(0,_e.jsx)(T.m,{value:p,options:h,optionLabel:"name",optionValue:"id",onChange:e=>{u(+e.value);let s=h.find((s=>s.id===e.value));x(s||{})},itemTemplate:e=>(0,_e.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,_e.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,_e.jsx)(Se.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,_e.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}),valueTemplate:e=>p?(0,_e.jsxs)("div",{className:"d-flex gap-2 align-items-center w-100",children:[(0,_e.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"4px",overflow:"hidden",border:"1px solid #dedede"},children:(0,_e.jsx)(Se.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!0,size:17})}),(0,_e.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"350px"},children:null===e||void 0===e?void 0:e.name})]}):null,className:(0,_.A)(k,"dropdown-height-fixed"),panelClassName:"supplier-dropdown",style:{height:"46px"},scrollHeight:"350px",placeholder:"Search for supplier",filter:!0,onFilter:C,filterInputAutoFocus:!0})]})}),(0,_e.jsx)(i.A,{sm:4,children:(0,_e.jsx)("div",{className:"d-flex justify-content-end text-md-end flex-column gap-1 mt-3 pt-3",children:(0,_e.jsx)(g.N_,{to:"/suppliers?addNewSupplier=true",target:"_blank",children:(0,_e.jsxs)(a.A,{className:V,children:["Create New Supplier",(0,_e.jsx)(r.A,{size:24,color:"#475467"})]})})})})]}),(0,_e.jsx)("hr",{}),(0,_e.jsx)(n.A,{})]})})),Ce=Te},54967:(e,s,t)=>{t.d(s,{Ab:()=>r,dg:()=>d,fr:()=>c,Ay:()=>p});var l=t(65043),n=t(44541),i=t(95192);const a="image-avatar_clientImg__-nnRU";var o=t(70579);const r=e=>{let{has_photo:s,photo:t,is_business:a,size:r}=e;const[d,c]=(0,l.useState)(!1),p=a?n.A:i.A;return(0,o.jsx)(o.Fragment,{children:s&&t&&!d?(0,o.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,o.jsx)(p,{color:"#667085",size:r})})},d=e=>{var s,t,n;let{has_photo:i,photo:a,name:r}=e;const[d,c]=(0,l.useState)(!1),p=r&&(null===r||void 0===r||null===(s=r.split(" "))||void 0===s||null===(t=s.map((e=>e[0])))||void 0===t||null===(n=t.join(""))||void 0===n?void 0:n.toUpperCase())||"";return(0,o.jsx)(o.Fragment,{children:i&&a&&!d?(0,o.jsx)("img",{src:a,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):p})},c=e=>{let{name:s,size:t=14}=e;const l=s.split(" ").map((e=>e[0])).join("").toUpperCase();return(0,o.jsx)("span",{style:{fontSize:`${t}px`},children:l})},p=e=>{let{has_photo:s,photo:t,is_business:r}=e;const[d,c]=(0,l.useState)(!1),p=r?n.A:i.A;return(0,o.jsx)("div",{className:`d-flex justify-content-center align-items-center ${a} ${r?"":"rounded-circle"}`,style:{overflow:"hidden"},children:s&&t&&!d?(0,o.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>c(!0)}):(0,o.jsx)(p,{color:"#667085"})})}},61427:(e,s,t)=>{t.d(s,{A:()=>v});var l=t(65043),n=t(14282),i=t(93202),a=t(56741),o=t(73216),r=t(64018),d=t(63712),c=t(20288),p=t(56328);const u="supplier-create_circledesignstyle__RXgvx",m="supplier-create_out__lEI-I";var x=t(1340),h=t(70579);const v=e=>{let{visible:s,setVisible:t,refetch:v}=e;const E=(0,l.useRef)(null),f=new URLSearchParams((0,o.zy)().search).get("addNewSupplier"),[g,S]=(0,l.useState)(!1),[j,N]=(0,l.useState)(null),[_]=(0,l.useState)({contact_persons:[{}],addresses:[{title:"Main Location",country:1}]}),A=async e=>{console.log("data: ",e),(async e=>{console.log("data: ",e);const s=new FormData;s.append("name",e.name),e.email&&s.append("email",e.email),e.website&&s.append("website",e.website),e.abn&&s.append("abn",e.abn);const l=(null===e||void 0===e?void 0:e.phone)&&(0,r.l)(e.phone);if(null!==l&&void 0!==l&&l.nationalNumber&&s.append("phone",e.phone),e.service&&s.append("service",e.service),e.note&&s.append("note",e.note),e.addresses.forEach(((e,t)=>{e.city&&(s.append(`addresses[${t}]address`,e.address),s.append(`addresses[${t}]city`,e.city),s.append(`addresses[${t}]postcode`,e.postcode),s.append(`addresses[${t}]is_main`,e.is_main),s.append(`addresses[${t}]title`,e.title))})),e.contact_persons.forEach(((e,t)=>{if(e.firstname||e.email){s.append(`contact_persons[${t}]firstname`,e.firstname),s.append(`contact_persons[${t}]lastname`,e.lastname),s.append(`contact_persons[${t}]email`,e.email);const l=(null===e||void 0===e?void 0:e.phone)&&(0,r.l)(e.phone);null!==l&&void 0!==l&&l.nationalNumber&&s.append(`contact_persons[${t}]phone`,e.phone),s.append(`contact_persons[${t}]position`,e.position),s.append(`contact_persons[${t}]is_main`,e.is_main)}})),null!==j&&void 0!==j&&j.croppedImageBlob){const e=(0,d.Ak)(6);s.append("photo",null===j||void 0===j?void 0:j.croppedImageBlob,`${e}.jpg`)}try{S(!0);const e=localStorage.getItem("access_token"),l=await fetch("https://app.memate.com.au/api/v1/suppliers/new/",{method:"POST",headers:{Authorization:`Bearer ${e}`},body:s});l.ok?(console.log("response: ",l),p.oR.success("New supplier created successfully"),t(!1),v((e=>!e))):p.oR.error("Failed to create new supplier. Please try again.")}catch(n){p.oR.error("Failed to create new supplier. Please try again.")}finally{S(!1)}})(e)},I=()=>{E.current&&E.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,l.useEffect)((()=>{s||N(null)}),[s]),(0,l.useEffect)((()=>{f&&t(!0)}),[f,t]),(0,h.jsx)(c.B,{visible:s,position:"right",onHide:()=>t(!1),modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:l}=e;return(0,h.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,h.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,h.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,h.jsx)("div",{className:u,children:(0,h.jsx)("div",{className:m,children:(0,h.jsx)(i.A,{size:24,color:"#17B26A"})})}),(0,h.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create new Supplier"})]}),(0,h.jsx)("span",{children:(0,h.jsx)(n.A,{type:"button",className:"text-button",ref:s,onClick:e=>l(e),children:(0,h.jsx)(a.A,{size:24,color:"#667085"})})})]}),(0,h.jsx)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:(0,h.jsx)(x.A,{photo:j,setPhoto:N,ref:E,onSubmit:A,defaultValues:_})}),(0,h.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,h.jsx)(n.A,{type:"button",onClick:e=>{e.stopPropagation(),t(!1)},className:"outline-button",children:"Cancel"}),(0,h.jsx)(n.A,{type:"button",disabled:g,onClick:I,className:"solid-button",style:{minWidth:"75px"},children:g?"Loading...":"Save"})]})]})}})}},62284:(e,s,t)=>{t.d(s,{A:()=>E});var l=t(65043),n=t(14282),i=t(93202),a=t(56741),o=t(47097),r=t(93740),d=t(20288),c=t(56328);const p="new-expense-create_circledesignstyle__Ke3sy",u="new-expense-create_out__C1Mi-",m="new-expense-create_expensesEditHead__xr-7V";var x=t(10586),h=t(44908),v=t(70579);const E=e=>{let{visible:s,setVisible:t,setRefetch:E,expenseProjectId:f,projectReference:g}=e;const S=window.location.href,j=new URL(S),N=new URLSearchParams(j.search),[_,A]=(0,l.useState)(null),I=new Date,T=new Date(I);T.setDate(T.getDate()+1);const b=(0,l.useRef)(null),[R,C]=(0,l.useState)({option:"Assign to timeframe",type:2,notification:!1,date:I,due_date:T});(0,l.useEffect)((()=>{const e=N.get("projectId")||f,s=N.get("reference")||g;s&&(C((e=>({...e,invoice_reference:s}))),j.searchParams.delete("reference"),window.history.replaceState({},"",j)),e&&(A(e),C((e=>({...e,option:"Assign to project"}))),j.searchParams.delete("projectId"),window.history.replaceState({},"",j))}),[_,t]);const y=(0,o.n)({mutationFn:e=>(0,x.Rv)(e),onSuccess:e=>{console.log("response: ",e),c.oR.success("Expense created successfully"),D(),E((e=>!e))},onError:e=>{console.error("Error creating expense:",e),c.oR.error("Failed to create expense. Please try again.")}}),P=async e=>{delete e["gst-calculation"],delete e.option,delete e.subtotal,delete e.totalAmount,delete e.tax,e.order||delete e.order,e.type||(e.type=1),e.date&&(e.date=new Date(e.date).toISOString().split("T")[0]),e.due_date&&(e.due_date=new Date(e.due_date).toISOString().split("T")[0]),y.mutate(e)},O=()=>{b.current&&b.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},D=()=>{t(!1),A(null),C({option:"Assign to timeframe",type:2,notification:!1,date:I,due_date:T})};return(0,v.jsx)(d.B,{visible:s,position:"right",onHide:D,modal:!1,dismissable:!1,style:{width:"702px"},content:e=>{let{closeIconRef:s,hide:t}=e;return(0,v.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,v.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,v.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,v.jsx)("div",{className:p,children:(0,v.jsx)("div",{className:u,children:(0,v.jsx)(i.A,{size:24,color:"#17B26A"})})}),(0,v.jsx)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:"Create new Expense"})]}),(0,v.jsx)("span",{children:(0,v.jsx)(n.A,{type:"button",className:"text-button",ref:s,onClick:e=>t(e),children:(0,v.jsx)(a.A,{size:24,color:"#667085"})})})]}),(0,v.jsxs)("div",{className:"modal-body",style:{padding:"24px",height:"calc(100vh - 72px - 122px)",overflow:"auto"},children:[(0,v.jsx)("div",{className:`d-flex align-items-center mb-2 justify-content-between ${m}`,children:(0,v.jsx)("h5",{children:"Expense Details"})}),(0,v.jsx)(h.A,{ref:b,onSubmit:P,defaultValues:R,projectId:_})]}),(0,v.jsxs)("div",{className:"modal-footer d-flex align-items-center justify-content-end gap-3",style:{padding:"16px 24px",borderTop:"1px solid var(--Gray-200, #EAECF0)",height:"72px"},children:[(0,v.jsx)(n.A,{type:"button",onClick:e=>{e.stopPropagation(),D()},className:"outline-button",disabled:y.isPending,children:"Cancel"}),(0,v.jsxs)(n.A,{type:"button",onClick:O,className:"solid-button",style:{minWidth:"70px"},disabled:y.isPending,children:["Save ",y.isPending&&(0,v.jsx)(r.p,{style:{width:"18px",height:"18px"}})]})]})]})}})}},74737:(e,s,t)=>{t.d(s,{_:()=>a});var l=t(568);const n=Object.freeze({ADMIN:"Admin",LOCATION_MANAGER:"Location Manager",GENERAL_MANAGER:"General Manager",DEVELOPER:"Developer",DESIGNER:"Designers",SMM_PR:"SMM/PR"}),i={[n.ADMIN]:{permissions:[l.J.CLIENTS.CREATE,l.J.CLIENTS.READ,l.J.CLIENTS.UPDATE,l.J.CLIENTS.DELETE,l.J.SUPPLIERS.CREATE,l.J.SUPPLIERS.READ,l.J.SUPPLIERS.UPDATE,l.J.SUPPLIERS.DELETE,l.J.EXPENSE.CREATE,l.J.EXPENSE.READ,l.J.EXPENSE.UPDATE,l.J.EXPENSE.DELETE,l.J.INVOICE.CREATE,l.J.INVOICE.READ,l.J.INVOICE.UPDATE,l.J.INVOICE.DELETE,l.J.SETTINGS.SUBSCRIPTION.BUY_BUSINESS_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.CANCEL_BUSINESS_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.BUY_COMPANY_USER_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.BUY_WORK_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.CANCEL_WORK_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.ACTIVE_WORK_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.BUY_WORK_USER_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.BUY_LOCATION_SUBSCRIPTION,l.J.SETTINGS.SUBSCRIPTION.REMOVE_LOCATION_SUBSCRIPTION,l.J.SETTINGS.LOCATION.ADD,l.J.SETTINGS.LOCATION.READ,l.J.SETTINGS.LOCATION.UPDATE,l.J.SETTINGS.LOCATION.DELETE,l.J.SETTINGS.USERS.DESKTOP.ADD,l.J.SETTINGS.USERS.DESKTOP.READ,l.J.SETTINGS.USERS.DESKTOP.DELETE,l.J.SETTINGS.USERS.DESKTOP.UPDATE,l.J.SETTINGS.USERS.DESKTOP.RESTORE,l.J.SETTINGS.USERS.DESKTOP.SHOW_DELETED_USERS,l.J.SETTINGS.USERS.MOBILE_APP.ADD,l.J.SETTINGS.USERS.MOBILE_APP.READ,l.J.SETTINGS.USERS.MOBILE_APP.UPDATE,l.J.SETTINGS.USERS.MOBILE_APP.DISCONNECT_USER,l.J.SETTINGS.USERS.MOBILE_APP.RECONNECT_USER,l.J.SETTINGS.USERS.MOBILE_APP.SHOW_DISCONNECTED_USERS]}},a=function(e,s){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!i[e])return!1;const l=i[e].permissions;return Array.isArray(s)?t?s.every((e=>l.includes(e))):s.some((e=>l.includes(e))):l.includes(s)}}}]);
//# sourceMappingURL=3171.3021180e.chunk.js.map