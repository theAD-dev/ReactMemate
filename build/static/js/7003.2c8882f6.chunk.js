"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[1242,6731,7003,7344],{316:(e,s,t)=>{t.d(s,{A:()=>i});var l=t(65043),a=t(68811),n=t(70579);const i=e=>{let{project:s,reInitialize:t,projectCardData:i}=e;const[o,r]=(0,l.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"linkByttonStyle py-2 border-right pe-5",onClick:()=>r(!0),children:"New Task"}),(0,n.jsx)(a.A,{show:o,setShow:r,project:s,reInitialize:t,projectCardData:i})]})}},10586:(e,s,t)=>{t.d(s,{$R:()=>r,Bu:()=>o,D3:()=>m,E4:()=>x,JP:()=>i,Rv:()=>c,Wz:()=>p,a_:()=>u,eY:()=>d,ik:()=>h,md:()=>n,oP:()=>v,sr:()=>g});var l=t(31342);const a="https://app.memate.com.au/api/v1",n=async function(e,s){var t;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;const c=(e-1)*s,d=[];d.push(`limit=${s}`),d.push(`offset=${c}`),n&&d.push(`search=${encodeURIComponent(n)}`),i&&d.push(`ordering=${encodeURIComponent(i)}`),o&&d.push("status=not_paid");let m="";var h;null!==r&&void 0!==r&&r.suppliers&&(m=null===r||void 0===r||null===(h=r.suppliers)||void 0===h?void 0:h.map((e=>e.id)).join(","),console.log("Suppliers filter string:",m),m&&d.push(`suppliers=${m}`));let u="";var p;null!==r&&void 0!==r&&r.departments&&(u=null===r||void 0===r||null===(p=r.departments)||void 0===p?void 0:p.map((e=>e.id)).join(","),u&&d.push(`departments=${u}`));let x="";var v;null!==r&&void 0!==r&&r.status&&1===(null===r||void 0===r||null===(t=r.status)||void 0===t?void 0:t.length)?(console.log("Status filter array:",r.status),null===r||void 0===r||null===(v=r.status)||void 0===v||v.forEach((e=>{console.log("Processing status element:",e),"paid"===(null===e||void 0===e?void 0:e.name)?x="paid":"not_paid"===(null===e||void 0===e?void 0:e.name)&&(x="not_paid")})),x&&(console.log("Applied status filter:",x),d.push(`status=${x}`))):null!==r&&void 0!==r&&r.status&&console.log("Status filter not applied - length:",r.status.length,"values:",r.status);if(null!==r&&void 0!==r&&r.date){var g,j,f,y;const e=null===r||void 0===r||null===(g=r.date[0])||void 0===g||null===(j=g.value)||void 0===j?void 0:j[0];if(e){const s=new Date(e),t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");d.push(`date_after=${t}-${l}-${a}`)}const s=null===r||void 0===r||null===(f=r.date[0])||void 0===f||null===(y=f.value)||void 0===y?void 0:y[1];if(s){const e=new Date(s),t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");d.push(`date_before=${t}-${l}-${a}`)}}const b=`${a}/expenses/?${d.join("&")}`;return console.log("Final expenses API URL:",b),(0,l.f)(b,{method:"GET"})},i=async()=>{const e=new URL(`${a}/references/xero-codes/`);return(0,l.f)(e.toString(),{method:"GET"})},o=async()=>{const e=new URL(`${a}/references/projects/expenses/`);return(0,l.f)(e.toString(),{method:"GET"})},r=async e=>{const s=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},c=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/new/`);return(0,l.f)(t.toString(),s)},d=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/expenses/update/${e}/`}`);return(0,l.f)(n.toString(),t)},m=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/paid/`);return(0,l.f)(t.toString(),s)},h=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/expenses/unpaid/`);return(0,l.f)(t.toString(),s)},u=async e=>{const s={method:"PUT",body:e},t=new URL(`${a}/expenses/to-xero/`);return(0,l.f)(t.toString(),s)},p=async e=>{const s=new URL(`${a}${`/expenses/delete/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},x=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/clients/statement/pdf/`);return(0,l.f)(t.toString(),s)},v=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/clients/statement/send/`);return(0,l.f)(t.toString(),s)},g=async(e,s)=>{const t={method:"PUT",body:{code:s}},n=new URL(`${a}${`/suppliers/service-update/${e}/`}`);return(0,l.f)(n.toString(),t)}},11520:(e,s,t)=>{t.d(s,{Mv:()=>y,Np:()=>i,OE:()=>b,SE:()=>h,Wb:()=>v,ZE:()=>d,aj:()=>o,fi:()=>u,jE:()=>c,jy:()=>g,ky:()=>f,m2:()=>x,mw:()=>n,o2:()=>r,pV:()=>p,qm:()=>j,yE:()=>m});const l="https://app.memate.com.au/api/v1",a=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:t="GET",headers:l={},body:a}=s,n={method:t,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...l},body:JSON.stringify(a),redirect:"follow"};try{const s=new URL(`${e}`),t=await fetch(s,n);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const l=t.headers.get("Content-Type");if(l&&l.includes("application/json"))return await t.json();return{message:"Non-JSON response",body:await t.text()}}catch(i){throw console.error("Fetch API error:",i),i}},n=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${l}${`/project-card/schedule/${e}/`}`);return a(n.toString(),t)},i=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${l}${`/project-card/custom-status/${e}/`}`);return a(n.toString(),t)},o=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${l}${`/project-card/reference/${e}/`}`);return a(n.toString(),t)},r=async(e,s)=>{const t={method:"POST",body:s},n=new URL(`${l}${`/project-card/note/${e}/`}`);return a(n.toString(),t)},c=async e=>{const s={method:"PUT",body:{unique_id:e}},t=new URL(`${l}/projects/back/`);return a(t.toString(),s)},d=async e=>{const s={method:"PUT",body:{unique_id:e}},t=new URL(`${l}/projects/decline/`);return a(t.toString(),s)},m=async e=>{const s={method:"PUT",body:{unique_id:e}},t=new URL(`${l}/projects/complete/`);return a(t.toString(),s)},h=async e=>{const s=new URL(`${l}${`/invoices/create/${e}/`}`);return a(s.toString(),{method:"POST"})},u=async(e,s)=>{const t={method:"POST",body:s},n=new URL(`${l}${`/invoices/send/${e}/`}`);return a(n.toString(),t)},p=async e=>{const s=new URL(`${l}${`/projects/file-list/${e}/`}`);return a(s.toString(),{method:"GET"})},x=async(e,s)=>{const t={method:"POST",body:{file_name:s}},n=new URL(`${l}${`/projects/file-delete/${e}/`}`);return a(n.toString(),t)},v=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${l}${`/project-card/calc-description/${e}/`}`);return a(n.toString(),t)},g=async(e,s,t)=>{let n;n=s?`/custom/email/${e}/${s}/`:`/custom/email/${e}/`;const i={method:"POST",body:t},o=new URL(`${l}${n}`);return a(o.toString(),i)},j=async(e,s)=>{const t={method:"POST",body:s},n=new URL(`${l}${`/sms/${e}/`}`);return a(n.toString(),t)},f=async(e,s)=>{const t={method:"POST",body:s},n=new URL(`${l}${`/resend/quote/${e}/`}`);return a(n.toString(),t)},y=async()=>{const e=new Headers,s=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${s}`),e.append("Content-Type","application/json");const t={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${l}/management/`,t);return await e.json()}catch(a){throw console.error(a),a}},b=async e=>{const s=new Headers,t=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${t}`),s.append("Content-Type","application/json");const a={method:"GET",headers:s,redirect:"follow"};try{const s=await fetch(`${l}/project-card/${e}/`,a);return await s.json()}catch(n){throw console.error(n),n}}},17344:(e,s,t)=>{t.d(s,{A:()=>S});var l=t(65043),a=t(61072),n=t(78602),i=t(95192),o=t(24858),r=t(17380),c=t(18403),d=t(28261),m=t(58387),h=t(54972),u=t(88060),p=t(28676),x=t(74532),v=t(72052),g=t(27932),j=t(80899),f=t(20685),y=t(59638),b=t(88780),_=t(57189),C=t(27472),N=t(63882),A=t(70579);const w=j.Ik({firstname:j.Yj().required("First name is required"),lastname:j.Yj().required("Last name is required"),email:j.Yj().nullable().transform((e=>""===e?null:e)).matches(/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Invalid email address").notRequired(),payment_terms:j.ai().typeError("Enter a valid payment terms").required("Payment terms are required"),category:j.ai().typeError("Enter a valid category").required("Category is required"),add_to_mailchimp:j.zM(),mailchimp_list_id:j.Yj().when("add_to_mailchimp",{is:!0,then:e=>e.required("Please select a mailing list"),otherwise:e=>e.notRequired()})}).required(),S=(0,l.forwardRef)(((e,s)=>{var t,j,S,k,F,L,E,I,T,$,R,B,q,D,z,P,U,H,M,V,W,O,G,Q;let{photo:Z,setPhoto:K,onSubmit:Y,defaultValues:J}=e;const{session:X}=(0,_.As)(),[ee,se]=(0,l.useState)(!1),[te,le]=(0,l.useState)(!1),[ae,ne]=(0,l.useState)(""),[ie,oe]=(0,l.useState)(""),re=(0,d.I)({queryKey:["countries"],queryFn:y.X6,enabled:!0}),ce=(0,d.I)({queryKey:["states",ae],queryFn:()=>(0,y.nP)(ae),enabled:!!ae,retry:1}),de=(0,d.I)({queryKey:["cities",ie],queryFn:()=>(0,y.i6)(ie),enabled:!!ie}),me=(0,d.I)({queryKey:["categories"],queryFn:y.Ql}),he=(0,d.I)({queryKey:["mailchimp-lists"],queryFn:b.Yn,enabled:te&&(null===X||void 0===X?void 0:X.has_mailchimp)}),{control:ue,register:pe,handleSubmit:xe,formState:{errors:ve},setValue:ge,watch:je}=(0,o.mN)({resolver:(0,c.t)(w),defaultValues:J}),fe=je("email");return(0,l.useEffect)((()=>{var e,s,t,l;null!==J&&void 0!==J&&null!==(e=J.address)&&void 0!==e&&e.country&&ne(null===J||void 0===J||null===(s=J.address)||void 0===s?void 0:s.country),null!==J&&void 0!==J&&null!==(t=J.address)&&void 0!==t&&t.state&&oe(null===J||void 0===J||null===(l=J.address)||void 0===l?void 0:l.state)}),[null===J||void 0===J?void 0:J.address]),(0,l.useEffect)((()=>{var e;if(null!==me&&void 0!==me&&null!==(e=me.data)&&void 0!==e&&e.length&&!J.category){var s;let e=null===(s=me.data)||void 0===s?void 0:s.find((e=>"regular"===e.name.toLowerCase()));e.name&&ge("category",e.id)}}),[null===me||void 0===me?void 0:me.data,J,ge]),(0,A.jsxs)("form",{ref:s,onSubmit:xe(Y),children:[(0,A.jsxs)(a.A,{className:(0,m.A)(f.A.bgGreay,"pt-0"),children:[(0,A.jsxs)(n.A,{sm:12,children:[(0,A.jsxs)("div",{className:(0,m.A)(f.A.fileUploadBox,"cursor-pointer"),onClick:()=>se(!0),children:[(0,A.jsx)("div",{className:(0,m.A)(f.A.uploadedImgBox),children:Z?(0,A.jsx)("img",{src:(null===Z||void 0===Z?void 0:Z.croppedImageBase64)||Z,alt:"profile-img"}):(0,A.jsx)(i.A,{size:32,color:"#667085"})}),(0,A.jsx)("p",{className:(0,m.A)("mb-0",f.A.uploadedText1),children:(0,A.jsx)("span",{className:(0,m.A)("mb-0",f.A.uploadedText2),children:"Click to upload"})}),(0,A.jsx)("span",{style:{color:"#475467",fontSize:"12px"},children:"SVG, PNG, JPG or GIF (max. 800x400px)"})]}),(0,A.jsx)(N.A,{show:ee,setShow:se,setPhoto:K,shape:"round"})]}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsxs)("label",{className:(0,m.A)(f.A.lable),children:["First Name",(0,A.jsx)("span",{className:"required",children:"*"})]}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:ve.firstname&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("firstname"),className:(0,m.A)(f.A.inputText,{[f.A.error]:ve.firstname}),placeholder:"Enter first name"})]}),ve.firstname&&(0,A.jsx)("p",{className:"error-message",children:ve.firstname.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsxs)("label",{className:(0,m.A)(f.A.lable),children:["Last Name",(0,A.jsx)("span",{className:"required",children:"*"})]}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:ve.lastname&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("lastname"),className:(0,m.A)(f.A.inputText,{[f.A.error]:ve.lastname}),placeholder:"Enter last name"})]}),ve.lastname&&(0,A.jsx)("p",{className:"error-message",children:ve.lastname.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Email"}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:ve.email&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("email"),className:(0,m.A)(f.A.inputText,{[f.A.error]:ve.email}),placeholder:"example@email.com"})]}),ve.email&&(0,A.jsx)("p",{className:"error-message",children:ve.email.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Phone number"}),(0,A.jsx)(o.xI,{name:"phone",control:ue,render:e=>{let{field:s}=e;return(0,A.jsx)(r.LR,{defaultCountry:"au",value:s.value,className:"phoneInput rounded",containerClass:f.A.countrySelector,onChange:s.onChange,style:{border:"1px solid "+(ve.phone?"red":"#dedede")}})}}),ve.phone&&(0,A.jsx)("p",{className:"error-message",children:ve.phone.message})]})})]}),(0,A.jsx)("h2",{className:(0,m.A)(f.A.headingInputs,"mt-4"),children:"Payment Terms"}),(0,A.jsxs)(a.A,{className:(0,m.A)(f.A.bgGreay),children:[(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsxs)("label",{className:(0,m.A)(f.A.lable),children:["Payment Terms",(0,A.jsx)("span",{className:"required",children:"*"})]}),(0,A.jsx)(o.xI,{name:"payment_terms",control:ue,render:e=>{let{field:s}=e;return(0,A.jsx)(u.m,{...s,options:[{value:1,label:"COD"},{value:0,label:"Prepaid"},{value:7,label:"Week"},{value:14,label:"Two weeks"},{value:30,label:"One month"}]||0,onChange:e=>{s.onChange(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed",{[f.A.error]:ve.payment_terms}),style:{height:"46px"},value:s.value,placeholder:"Select payment terms",scrollHeight:"380px",filterInputAutoFocus:!0})}}),ve.payment_terms&&(0,A.jsx)("p",{className:"error-message",children:ve.payment_terms.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsxs)("label",{className:(0,m.A)(f.A.lable),children:["Customers Discount Category",(0,A.jsx)("span",{className:"required",children:"*"})]}),(0,A.jsx)(o.xI,{name:"category",control:ue,render:e=>{var s;let{field:t}=e;return(0,A.jsx)(u.m,{...t,options:[...me&&(null===(s=me.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.name} - ${e.value}%`}))))||[]],onChange:e=>{t.onChange(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed",{[f.A.error]:ve.category}),style:{height:"46px"},value:t.value,loading:null===me||void 0===me?void 0:me.isFetching,placeholder:"Select a category",scrollHeight:"380px",filterInputAutoFocus:!0})}}),ve.category&&(0,A.jsx)("p",{className:"error-message",children:ve.category.message})]})})]}),(0,A.jsx)("h2",{className:(0,m.A)(f.A.headingInputs),children:"Locations"}),(0,A.jsxs)(a.A,{className:(0,m.A)(f.A.bgGreay),children:[(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Location Name"}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:(null===(t=ve.address)||void 0===t?void 0:t.title)&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("address.title"),className:(0,m.A)(f.A.inputText,{[f.A.error]:null===(j=ve.address)||void 0===j?void 0:j.title}),placeholder:"Enter location name"})]}),(null===(S=ve.address)||void 0===S?void 0:S.title)&&(0,A.jsx)("p",{className:"error-message",children:null===(k=ve.address)||void 0===k||null===(F=k.title)||void 0===F?void 0:F.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Country"}),(0,A.jsx)(o.xI,{name:"address.country",control:ue,defaultValue:"",render:e=>{var s;let{field:t}=e;return(0,A.jsx)(u.m,{...t,options:re&&(null===(s=re.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:e.name}))))||[],onChange:e=>{t.onChange(e.value),ne(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed"),style:{height:"46px"},value:t.value,loading:null===re||void 0===re?void 0:re.isFetching,placeholder:"Select a country",scrollHeight:"380px",filterInputAutoFocus:!0})}}),(null===(L=ve.address)||void 0===L?void 0:L.country)&&(0,A.jsx)("p",{className:"error-message",children:null===(E=ve.address)||void 0===E||null===(I=E.country)||void 0===I?void 0:I.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"State"}),(0,A.jsx)(o.xI,{name:"address.state",control:ue,defaultValue:"",render:e=>{var s;let{field:t}=e;return(0,A.jsx)(u.m,{...t,options:ce&&(null===(s=ce.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:e.name}))))||[],onChange:e=>{t.onChange(e.value),oe(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed"),style:{height:"46px"},value:t.value,loading:null===ce||void 0===ce?void 0:ce.isFetching,placeholder:"Select a state",scrollHeight:"380px",filter:!0,filterInputAutoFocus:!0})}}),(null===(T=ve.address)||void 0===T?void 0:T.state)&&(0,A.jsx)("p",{className:"error-message",children:null===($=ve.address)||void 0===$||null===(R=$.state)||void 0===R?void 0:R.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"City/Suburb"}),(0,A.jsx)(o.xI,{name:"address.city",control:ue,defaultValue:"",render:e=>{var s;let{field:t}=e;return(0,A.jsx)(u.m,{...t,options:de&&(null===(s=de.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:e.name}))))||[],onChange:e=>{t.onChange(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed"),style:{height:"46px"},value:t.value,loading:null===de||void 0===de?void 0:de.isFetching,disabled:null===de||void 0===de?void 0:de.isFetching,placeholder:"Select a city",emptyMessage:ie?"No cities found":"Select a state first",scrollHeight:"380px",filter:!0,filterInputAutoFocus:!0})}}),(null===(B=ve.address)||void 0===B?void 0:B.city)&&(0,A.jsx)("p",{className:"error-message",children:null===(q=ve.address)||void 0===q||null===(D=q.city)||void 0===D?void 0:D.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Street Address"}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:(null===(z=ve.address)||void 0===z?void 0:z.address)&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("address.address"),className:(0,m.A)(f.A.inputText,{[f.A.error]:null===(P=ve.address)||void 0===P?void 0:P.address}),placeholder:"Enter street address"})]}),(null===(U=ve.address)||void 0===U?void 0:U.address)&&(0,A.jsx)("p",{className:"error-message",children:null===(H=ve.address)||void 0===H||null===(M=H.address)||void 0===M?void 0:M.message})]})}),(0,A.jsx)(n.A,{sm:6,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Postcode"}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{children:(null===(V=ve.address)||void 0===V?void 0:V.postcode)&&(0,A.jsx)("img",{src:C.A,className:"mb-3"})}),(0,A.jsx)(v.S,{...pe("address.postcode"),keyfilter:"int",className:(0,m.A)(f.A.inputText,{[f.A.error]:null===(W=ve.address)||void 0===W?void 0:W.postcode}),placeholder:"Enter postcode"})]}),(null===(O=ve.address)||void 0===O?void 0:O.postcode)&&(0,A.jsx)("p",{className:"error-message",children:null===(G=ve.address)||void 0===G||null===(Q=G.postcode)||void 0===Q?void 0:Q.message})]})})]}),(0,A.jsx)("h2",{className:(0,m.A)(f.A.headingInputs),children:"Client Description"}),(0,A.jsx)(a.A,{className:(0,m.A)(f.A.bgGreay),children:(0,A.jsx)(n.A,{children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,A.jsx)("label",{className:(0,m.A)(f.A.lable),children:"Description"}),(0,A.jsxs)(p.C,{children:[(0,A.jsx)(x.m,{style:{top:"80%"},children:ve.description&&(0,A.jsx)("img",{src:C.A})}),(0,A.jsx)(g.Z,{...pe("description"),rows:5,cols:30,className:(0,m.A)(f.A.inputText,{[f.A.error]:ve.description}),style:{resize:"none"},placeholder:"Enter a description..."})]}),ve.description&&(0,A.jsx)("p",{className:"error-message",children:ve.description.message})]})})}),(null===X||void 0===X?void 0:X.has_mailchimp)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("h2",{className:(0,m.A)(f.A.headingInputs),children:"Mailchimp Integration"}),(0,A.jsxs)(a.A,{className:(0,m.A)(f.A.bgGreay),children:[(0,A.jsxs)(n.A,{sm:12,children:[(0,A.jsxs)("div",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,A.jsx)(o.xI,{name:"add_to_mailchimp",control:ue,render:e=>{let{field:s}=e;return(0,A.jsx)(h.S,{inputId:"add_to_mailchimp",checked:s.value||!1,onChange:e=>{s.onChange(e.checked),le(e.checked)},disabled:!fe})}}),(0,A.jsx)("label",{htmlFor:"add_to_mailchimp",className:(0,m.A)(f.A.lable,"mb-0"),children:"Add to Mailchimp mailing list"})]}),!fe&&(0,A.jsx)("p",{className:"text-muted",style:{fontSize:"12px",marginTop:"-8px",marginBottom:"12px"},children:"Please enter an email address to enable this option"})]}),te&&(0,A.jsx)(n.A,{sm:12,children:(0,A.jsxs)("div",{className:"d-flex flex-column gap-1 mb-4",children:[(0,A.jsxs)("label",{className:(0,m.A)(f.A.lable),children:["Mailing List",(0,A.jsx)("span",{className:"required",children:"*"})]}),(0,A.jsx)(o.xI,{name:"mailchimp_list_id",control:ue,render:e=>{var s;let{field:t}=e;return(0,A.jsx)(u.m,{...t,options:Array.isArray(null===he||void 0===he||null===(s=he.data)||void 0===s?void 0:s.lists)?he.data.lists.map((e=>({value:e.id,label:e.name}))):[],onChange:e=>{t.onChange(e.value)},className:(0,m.A)(f.A.dropdownSelect,"dropdown-height-fixed",{[f.A.error]:ve.mailchimp_list_id}),style:{height:"46px"},value:t.value,loading:null===he||void 0===he?void 0:he.isFetching,placeholder:"Select a mailing list",scrollHeight:"380px",filterInputAutoFocus:!0,emptyMessage:null!==he&&void 0!==he&&he.isFetching?"Loading...":"No mailing lists found"})}}),ve.mailchimp_list_id&&(0,A.jsx)("p",{className:"error-message",children:ve.mailchimp_list_id.message})]})})]})]})]})}))},31812:(e,s,t)=>{t.d(s,{A:()=>y});var l=t(65043),a=t(56741),n=t(33361),i=t(35475),o=t(28261),r=t(47097),c=t(58387),d=t(32952),m=t(56328);const h="compose-email_emailUnavailableText__-vpup",u="compose-email_emailStatus__ounlY",p="compose-email_disconnected__mB26k",x="compose-email_dots__Lk2LO";var v=t(81047),g=t(11520),j=t(81242),f=t(70579);const y=e=>{let{projectId:s,projectCardData:t,contactPersons:y=[]}=e;const[,b]=(0,l.useState)({}),[_,C]=(0,l.useState)(!1),[N,A]=(0,l.useState)(!1),w=(0,o.I)({queryKey:["getOutgoingEmail"],queryFn:v.hx}),S=(0,r.n)({mutationFn:e=>(0,g.jy)(s,"",e),onSuccess:()=>{C(!1),t(),m.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),m.oR.error("Failed to send email. Please try again.")}});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"linkByttonStyle py-2 ps-0",onClick:()=>{var e,s;null!==w&&void 0!==w&&null!==(e=w.data)&&void 0!==e&&e.outgoing_email&&"no-reply@memate.com.au"!==(null===w||void 0===w||null===(s=w.data)||void 0===s?void 0:s.outgoing_email)?C(!0):A(!0)},children:"Compose Email"}),(0,f.jsxs)(d.A,{show:N,onHide:()=>A(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,f.jsxs)(d.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,f.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,f.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,f.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,f.jsx)("path",{d:"M18 21.5H38C39.1 21.5 40 22.4 40 23.5V33.5C40 34.6 39.1 35.5 38 35.5H18C16.9 35.5 16 34.6 16 33.5V23.5C16 22.4 16.9 21.5 18 21.5ZM38 23.5L28 29.5L18 23.5V25.5L28 31.5L38 25.5V23.5Z",fill:"#F04438"})]}),(0,f.jsx)("span",{className:"ms-3",children:"Email is currently unavailable"})]})}),(0,f.jsx)("button",{className:"CustonCloseModal",onClick:()=>A(!1),children:(0,f.jsx)(a.A,{size:24,color:"#667085"})})]}),(0,f.jsxs)(d.A.Body,{children:[(0,f.jsx)("div",{className:"ContactModel",children:(0,f.jsxs)("p",{className:h,children:["Email functionality is currently unavailable. To use this feature, please configure an email account via ",(0,f.jsx)(i.N_,{to:"/settings/integrations?openEmail=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]})}),(0,f.jsxs)("div",{className:(0,c.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",u),children:[(0,f.jsxs)("div",{className:(0,c.A)("d-flex align-items-center justify-content-center"),children:[(0,f.jsx)(n.A,{size:25,color:"#667085"}),(0,f.jsx)("h6",{className:"ms-2 mt-2",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Outgoing Email"})]}),(0,f.jsxs)("span",{className:(0,c.A)("px-2 py-1",p),children:["Pending",(0,f.jsx)("span",{className:x})]})]})]})]}),(0,f.jsx)(j.A,{show:_,isLoading:!1,mutation:S,setShow:C,setPayload:b,contactPersons:y,isComposeEmail:!0})]})}},44787:(e,s,t)=>{t.d(s,{A:()=>A});var l=t(65043),a=t(56741),n=t(17380),i=t(35475),o=t(28261),r=t(47097),c=t(58387),d=t(17803),m=t(88060),h=t(93740),u=t(14282),p=t(78602),x=t(32952),v=t(61072),g=t(56328);const j={phoneInput:"send-sms_phoneInput__Qgh+S",countrySelector:"send-sms_countrySelector__y14UT",customLabel:"send-sms_customLabel__RzF9F",smsUnavailableAlert:"send-sms_smsUnavailableAlert__8Wmw4",smsIcon:"send-sms_smsIcon__mwlTu",twilioStatus:"send-sms_twilioStatus__9LyX9",twilioIcon:"send-sms_twilioIcon__vuhjt",disconnectedBadge:"send-sms_disconnectedBadge__L41qv",smsUnavailableText:"send-sms_smsUnavailableText__iot1y",settingsLink:"send-sms_settingsLink__DYIqa"};var f=t(81047),y=t(11520),b=t(70767),_=t(70579);const C=d.PhoneNumberUtil.getInstance(),N=e=>{try{return C.isValidNumber(C.parseAndKeepRawInput(e))}catch(s){return!1}},A=e=>{var s;let{projectId:t,projectCardData:d}=e;const[C,A]=(0,l.useState)(null),[w,S]=(0,l.useState)(!1),[k,F]=(0,l.useState)(!1),[L,E]=(0,l.useState)(""),[I,T]=(0,l.useState)({}),[$,R]=(0,l.useState)(""),B=()=>{S(!1),E(""),R(""),T({}),A(null)},q=(0,o.I)({queryKey:["getSMSTemplates"],queryFn:f.pJ}),D=(0,o.I)({queryKey:["smsQuery",C],queryFn:()=>(0,f.Mp)(C),enabled:!!C,retry:1}),z=(0,r.n)({mutationFn:e=>(0,y.qm)(t,e),onSuccess:()=>{g.oR.success("SMS send successfully"),B(),d()},onError:e=>{console.error("Error creating expense:",e),g.oR.error("Failed to send sms. Please try again.")}});return(0,l.useEffect)((()=>{var e;null!==D&&void 0!==D&&null!==(e=D.data)&&void 0!==e&&e.text&&(E(D.data.text),T((e=>({...e,message:!1}))))}),[D.data]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"linkByttonStyle py-2 border-right text-center ps-0",onClick:()=>{const e=JSON.parse(window.localStorage.getItem("profileData")||"{}");null!==e&&void 0!==e&&e.has_twilio?S(!0):F(!0)},children:"Send SMS"}),(0,_.jsxs)(x.A,{show:k,onHide:()=>F(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,_.jsxs)(x.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,_.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,_.jsxs)("span",{children:[(0,_.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,_.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,_.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,_.jsx)("path",{d:"M20.0168 34.3409C20.3324 34.6574 20.4904 35.0981 20.4479 35.5431C20.3524 36.5401 20.1325 37.5778 19.8502 38.5417C21.9425 38.0581 23.2204 37.4972 23.8012 37.2028C24.1309 37.0357 24.5107 36.9963 24.8677 37.092C25.8545 37.3566 26.9061 37.5 28 37.5C33.9934 37.5 38.5 33.2887 38.5 28.5C38.5 23.7113 33.9934 19.5 28 19.5C22.0066 19.5 17.5 23.7113 17.5 28.5C17.5 30.7021 18.426 32.7456 20.0168 34.3409ZM19.2773 40.1984C19.2672 40.2004 19.2571 40.2024 19.247 40.2044C19.1093 40.2315 18.9688 40.2583 18.8257 40.2845C18.625 40.3212 18.419 40.357 18.2076 40.3916C17.9091 40.4405 17.6805 40.1282 17.7985 39.8496C17.8755 39.6676 17.9515 39.4769 18.0255 39.2791C18.0725 39.1535 18.1187 39.025 18.1639 38.8941C18.1658 38.8885 18.1678 38.8828 18.1697 38.8772C18.5413 37.7976 18.8439 36.5567 18.9547 35.4001C17.1146 33.5548 16 31.1413 16 28.5C16 22.701 21.3726 18 28 18C34.6274 18 40 22.701 40 28.5C40 34.299 34.6274 39 28 39C26.7749 39 25.5926 38.8394 24.4793 38.5408C23.7 38.9357 22.0215 39.6545 19.2773 40.1984Z",fill:"#F04438"}),(0,_.jsx)("path",{d:"M22 24.75C22 24.3358 22.3358 24 22.75 24H33.25C33.6642 24 34 24.3358 34 24.75C34 25.1642 33.6642 25.5 33.25 25.5H22.75C22.3358 25.5 22 25.1642 22 24.75ZM22 28.5C22 28.0858 22.3358 27.75 22.75 27.75H33.25C33.6642 27.75 34 28.0858 34 28.5C34 28.9142 33.6642 29.25 33.25 29.25H22.75C22.3358 29.25 22 28.9142 22 28.5ZM22 32.25C22 31.8358 22.3358 31.5 22.75 31.5H28.75C29.1642 31.5 29.5 31.8358 29.5 32.25C29.5 32.6642 29.1642 33 28.75 33H22.75C22.3358 33 22 32.6642 22 32.25Z",fill:"#F04438"})]}),(0,_.jsx)("span",{className:"ms-3",children:"SMS is currently unavailable"})]})}),(0,_.jsx)("button",{className:"CustonCloseModal",onClick:()=>F(!1),children:(0,_.jsx)(a.A,{size:24,color:"#667085"})})]}),(0,_.jsx)(x.A.Body,{children:(0,_.jsxs)("div",{className:"ContactModel",children:[(0,_.jsxs)("p",{className:j.smsUnavailableText,children:["SMS functionality is currently unavailable. To use this",(0,_.jsx)("br",{})," feature, please ask your admin to set up a Twilio",(0,_.jsx)("br",{})," account and connect it via ",(0,_.jsx)(i.N_,{to:"/settings/integrations?openTwilio=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]}),(0,_.jsxs)("div",{className:(0,c.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",j.twilioStatus),children:[(0,_.jsxs)("div",{className:(0,c.A)("d-flex align-items-center justify-content-center",j.twilioIcon),children:[(0,_.jsx)("img",{src:"/static/media/twilio-logo.c9f32aa9e92765a4deb7.png",style:{width:"50px"}}),(0,_.jsx)("h6",{className:"mb-1",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Twilio"})]}),(0,_.jsxs)("span",{className:(0,c.A)("px-2 py-1",j.disconnectedBadge),children:["Disconnected \xa0",(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"9",viewBox:"0 0 8 9",fill:"none",children:(0,_.jsx)("circle",{cx:"4",cy:"4.5",r:"3",fill:"#F79009"})})]})]})]})})]}),(0,_.jsxs)(x.A,{show:w,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:B,animation:!1,children:[(0,_.jsxs)(x.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,_.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,_.jsxs)("span",{children:[(0,_.jsx)("img",{src:b.A,alt:"AddNoteModeIcon"}),"Send SMS"]})}),(0,_.jsx)("button",{className:"CustonCloseModal",onClick:B,children:(0,_.jsx)(a.A,{size:24,color:"#667085"})})]}),(0,_.jsx)(x.A.Body,{children:(0,_.jsxs)("div",{className:"ContactModel",children:[(0,_.jsxs)(v.A,{children:[(0,_.jsx)(p.A,{sm:12,className:"mb-3",children:(0,_.jsxs)("div",{style:{position:"relative"},children:[(0,_.jsx)("label",{className:(0,c.A)(j.customLabel),children:"Templates"}),(0,_.jsx)(m.m,{options:q&&(null===(s=q.data)||void 0===s?void 0:s.map((e=>({value:e.id,label:`${e.title}`}))))||[],className:(0,c.A)(j.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{A(e.value)},value:C,loading:null===q||void 0===q?void 0:q.isFetching,filterInputAutoFocus:!0,scrollHeight:"380px"})]})}),(0,_.jsx)(p.A,{children:(0,_.jsxs)("div",{className:"formgroup sendSMSPhone mb-2 mt-0",children:[(0,_.jsxs)("label",{children:["To",(0,_.jsx)("span",{className:"required",children:"*"})]}),(0,_.jsx)("div",{className:"inputInfo p-0 "+(I.taskRead?"error-border":"border-0"),children:(0,_.jsx)(n.LR,{defaultCountry:"au",placeholder:"Enter phone number",value:$||"",className:"phoneInput w-100",containerClass:j.countrySelector,onChange:e=>{R(e),N(e)&&T((e=>({...e,phone:!1})))}})}),I.phone&&(0,_.jsx)("p",{className:"error-message",children:"Phone is not valid"})]})})]}),(0,_.jsx)(v.A,{children:(0,_.jsx)(p.A,{children:(0,_.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,_.jsxs)("label",{children:["Message",(0,_.jsx)("span",{className:"required",children:"*"})]}),(0,_.jsxs)("div",{className:"inputInfo "+(I.description?"error-border":""),style:{position:"relative"},children:[(0,_.jsx)("div",{style:{position:"absolute",right:"10px",top:"15px"},children:(null===D||void 0===D?void 0:D.isFetching)&&(0,_.jsx)(h.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,_.jsx)("textarea",{type:"text",name:"Enter a message here...",value:L,placeholder:"Enter a message here...",onChange:e=>{const s=e.target.value.slice(0,150);E(s),T((e=>({...e,message:!1})))}})]}),(0,_.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-1",children:[(0,_.jsx)("p",{className:"error-message",children:I.message&&"Description is required"}),(0,_.jsxs)("div",{style:{float:"right",fontSize:"14px",color:"#6c757d"},children:[(null===L||void 0===L?void 0:L.length)||0,"/150"]})]})]})})}),(0,_.jsx)(v.A,{}),(0,_.jsxs)("div",{className:"popoverbottom  mt-0 pt-4",children:[(0,_.jsx)(u.A,{variant:"outline-danger",onClick:B,children:"Cancel"}),(0,_.jsxs)(u.A,{disabled:null===z||void 0===z?void 0:z.isPending,variant:"primary save d-flex align-items-center gap-2",onClick:()=>{let e={};if(L||(e.message=!0),$&&N($)||(e.phone=!0),Object.keys(e).length)return T(e);z.mutate({phone_number:$,message:L})},children:["Send",(null===z||void 0===z?void 0:z.isPending)&&(0,_.jsx)(h.p,{style:{width:"15px",height:"15px"}})]})]})]})})]})]})}},54967:(e,s,t)=>{t.d(s,{Ab:()=>r,dg:()=>c,fr:()=>d,Ay:()=>m});var l=t(65043),a=t(44541),n=t(95192);const i="image-avatar_clientImg__-nnRU";var o=t(70579);const r=e=>{let{has_photo:s,photo:t,is_business:i,size:r}=e;const[c,d]=(0,l.useState)(!1),m=i?a.A:n.A;return(0,o.jsx)(o.Fragment,{children:s&&t&&!c?(0,o.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>d(!0)}):(0,o.jsx)(m,{color:"#667085",size:r})})},c=e=>{var s,t,a;let{has_photo:n,photo:i,name:r}=e;const[c,d]=(0,l.useState)(!1),m=r&&(null===r||void 0===r||null===(s=r.split(" "))||void 0===s||null===(t=s.map((e=>e[0])))||void 0===t||null===(a=t.join(""))||void 0===a?void 0:a.toUpperCase())||"";return(0,o.jsx)(o.Fragment,{children:n&&i&&!c?(0,o.jsx)("img",{src:i,alt:"client avatar",className:"w-100",onError:()=>d(!0)}):m})},d=e=>{let{name:s,size:t=14}=e;const l=s.split(" ").map((e=>e[0])).join("").toUpperCase();return(0,o.jsx)("span",{style:{fontSize:`${t}px`},children:l})},m=e=>{let{has_photo:s,photo:t,is_business:r}=e;const[c,d]=(0,l.useState)(!1),m=r?a.A:n.A;return(0,o.jsx)("div",{className:`d-flex justify-content-center align-items-center ${i} ${r?"":"rounded-circle"}`,style:{overflow:"hidden"},children:s&&t&&!c?(0,o.jsx)("img",{src:t,alt:"client avatar",className:"w-100",onError:()=>d(!0)}):(0,o.jsx)(m,{color:"#667085"})})}},55973:(e,s,t)=>{t.d(s,{A:()=>Be});var l=t(65043),a=t(93202),n=t(38161),i=t(56741),o=t(95192),r=t(88166),c=t(28261),d=t(47097),m=t(58387),h=t(10446),u=t.n(h),p=t(88060),x=t(93740),v=t(20288),g=t(74856),j=t(14282),f=t(78602),y=t(29853),b=t(61072),_=t(56328),C=t(43984),N=t(71807),A=t(8242),w=t(47009),S=t(86213),k=t(4258);const F="comment-editor_asanaEditorWrapper__1UAiy",L="comment-editor_avatarWrapper__HX3H9",E="comment-editor_editorContainer__5DNNe",I="comment-editor_focused__A0TDm",T="comment-editor_dragOver__3RQri",$="comment-editor_disabled__kEgBL",R="comment-editor_inputArea__iqu88",B="comment-editor_textInput__BuSfR",q="comment-editor_attachmentsPreview__2tXR3",D="comment-editor_attachmentChip__tsAPk",z="comment-editor_error__Gh98k",P="comment-editor_fileIcon__9QnuH",U="comment-editor_fileInfo__Ak+Ca",H="comment-editor_fileName__NFnbx",M="comment-editor_fileSize__I8VsI",V="comment-editor_fileStatus__O7zuJ",W="comment-editor_removeChip__UIpfQ",O="comment-editor_toolbar__H14ex",G="comment-editor_toolbarLeft__QjN7m",Q="comment-editor_toolbarRight__q1XK-",Z="comment-editor_toolbarIcon__YrnT2",K="comment-editor_emojiWrapper__xJmG8",Y="comment-editor_emojiPickerDropdown__hdgWf",J="comment-editor_commentBtn__zCVYF",X="comment-editor_active__j2dE3",ee="comment-editor_imagePreviewChip__YNUuv",se="comment-editor_removeImageBtn__lUflP",te="comment-editor_progressBar__PTWAG",le="comment-editor_progressFill__lTJmW";var ae=t(79106),ne=t(58027),ie=t(70579);const oe=e=>{let{taskId:s,session:t,onCommentAdded:a,disabled:n=!1,commentsScrollRef:o}=e;const[r,c]=(0,l.useState)(""),[d,h]=(0,l.useState)([]),[u,p]=(0,l.useState)(!1),[v,g]=(0,l.useState)(!1),[f,y]=(0,l.useState)(!1),[b,oe]=(0,l.useState)([]),[re,ce]=(0,l.useState)(!1),de=(0,l.useRef)(null),me=(0,l.useRef)(null),he=(0,l.useRef)(null),ue=(0,l.useRef)(null);(0,l.useEffect)((()=>{const e=e=>{ue.current&&!ue.current.contains(e.target)&&g(!1)};return v&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[v]);const pe=async(e,s,t)=>{try{const l=await S.A.put(s,e,{headers:{"Content-Type":""},onUploadProgress:e=>{const l=Math.round(e.loaded/e.total*100);oe((e=>e.map((e=>e.id===t?{...e,progress:l,url:s}:e))))}});return oe((e=>e.map((e=>e.id===t?{...e,progress:100,uploaded:!0}:e)))),l}catch(l){let s="Upload failed";return s=l.response?403===l.response.status?"Permission denied (403 Forbidden)":`Server error: ${l.response.status}`:l.request?"No response from server":l.message,console.error(`Error uploading ${e.name}:`,s),oe((e=>e.map((e=>e.id===t?{...e,progress:0,error:!0,errorMessage:s,uploadFailed:!0}:e)))),{error:!0,message:s}}},xe=async e=>{if(!s)return void _.oR.error("Save the task first before adding attachments");const t=Array.from(e).filter((e=>!(e.size>10485760)||(_.oR.error(`${e.name} is too large. Max size is 10MB`),!1)));if(0===t.length)return;const l=t.map(((e,s)=>({id:`upload-${Date.now()}-${s}`,name:e.name,size:e.size,type:e.type,progress:0,file:e})));oe((e=>[...e,...l]));for(const n of l)try{const e=await(0,ae.qT)(s,n.name,n.type),{url:t}=e;if(!t){console.error(`No URL returned for file: ${n.name}`),oe((e=>e.map((e=>e.id===n.id?{...e,error:!0,errorMessage:"No URL returned"}:e))));continue}const l=await pe(n.file,t,n.id);if(l&&!l.error){const e=t.split("?")[0];h((s=>[...s,{id:n.id,name:n.name,url:e,type:n.type,size:n.size}])),oe((e=>e.filter((e=>e.id!==n.id))))}}catch(a){console.error("Error uploading file:",n.name,a),oe((e=>e.map((e=>e.id===n.id?{...e,progress:0,error:!0,errorMessage:a.message||"Failed to get upload URL",uploadFailed:!0}:e))))}},ve=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),p(!0)}),[]),ge=(0,l.useCallback)((e=>{var s;e.preventDefault(),e.stopPropagation(),null!==(s=he.current)&&void 0!==s&&s.contains(e.relatedTarget)||p(!1)}),[]),je=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),fe=(0,l.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),p(!1);const s=e.dataTransfer.files;s.length>0&&xe(s)}),[s]),ye=(0,l.useCallback)((e=>{var s;const t=null===(s=e.clipboardData)||void 0===s?void 0:s.items;if(!t)return;const l=[];for(const a of t)if("file"===a.kind){const e=a.getAsFile();e&&l.push(e)}l.length>0&&(e.preventDefault(),xe(l))}),[s]),be=e=>{h((s=>s.filter((s=>s.id!==e))))},_e=e=>{oe((s=>s.filter((s=>s.id!==e))))},Ce=async()=>{if(r.trim()||0!==d.length)if(s){y(!0);try{var e;let l=null,n=null;d.length>0&&(1===d.length?(l=d[0].url,n=d[0].type):(l=JSON.stringify(d.map((e=>e.url))),n=JSON.stringify(d.map((e=>e.type))))),await(0,ae.Zi)(s,{comment:r.trim(),attachment_url:l,attachment_type:n,created_by:{role:null===t||void 0===t||null===(e=t.user)||void 0===e?void 0:e.role}}),c(""),h([]),null===a||void 0===a||a(),setTimeout((()=>{null!==o&&void 0!==o&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"end"})}),500)}catch(n){console.error("Error adding comment:",n),_.oR.error("Failed to add comment. Please try again.")}finally{var l;y(!1),null===(l=de.current)||void 0===l||l.focus()}}else _.oR.error("Save the task first")},Ne=e=>null!==e&&void 0!==e&&e.startsWith("image/")?(0,ie.jsx)(C.A,{size:16}):(0,ie.jsx)(N.A,{size:16}),Ae=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",we=e=>null===e||void 0===e?void 0:e.startsWith("image/"),Se=r.trim()||d.length>0;return(0,ie.jsxs)("div",{className:F,children:[(0,ie.jsx)("div",{className:L,children:(0,ie.jsx)(ne.A,{photo:null===t||void 0===t?void 0:t.photo,has_photo:null===t||void 0===t?void 0:t.has_photo,is_business:!1,size:20})}),(d.length>0||b.length>0)&&(0,ie.jsxs)("div",{className:q,children:[b.map((e=>we(e.type)?(0,ie.jsxs)("div",{className:ee,children:[(0,ie.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.name}),(0,ie.jsx)("button",{className:se,onClick:()=>_e(e.id),type:"button",children:(0,ie.jsx)(i.A,{size:12})}),!e.uploaded&&!e.error&&(0,ie.jsx)("div",{className:te,children:(0,ie.jsx)("div",{className:le,style:{width:`${e.progress}%`}})})]},e.id):(0,ie.jsxs)("div",{className:(0,m.A)(D,e.error&&z),children:[(0,ie.jsx)("div",{className:P,children:Ne(e.type)}),(0,ie.jsxs)("div",{className:U,children:[(0,ie.jsx)("span",{className:H,children:e.name}),(0,ie.jsx)("span",{className:M,children:Ae(e.size)})]}),(0,ie.jsx)("span",{className:(0,m.A)(V,e.error&&z),children:e.error?"Failed":`${e.progress}%`}),(0,ie.jsx)("button",{className:W,onClick:()=>_e(e.id),type:"button",children:(0,ie.jsx)(i.A,{size:14})})]},e.id))),d.map((e=>we(e.type)?(0,ie.jsxs)("div",{className:ee,children:[(0,ie.jsx)("img",{src:e.url,alt:e.name}),(0,ie.jsx)("button",{className:se,onClick:()=>be(e.id),type:"button",children:(0,ie.jsx)(i.A,{size:12})})]},e.id):(0,ie.jsxs)("div",{className:D,children:[(0,ie.jsx)("div",{className:P,children:Ne(e.type)}),(0,ie.jsxs)("div",{className:U,children:[(0,ie.jsx)("span",{className:H,children:e.name}),(0,ie.jsx)("span",{className:M,children:Ae(e.size)})]}),(0,ie.jsx)("button",{className:W,onClick:()=>be(e.id),type:"button",children:(0,ie.jsx)(i.A,{size:14})})]},e.id)))]}),(0,ie.jsxs)("div",{className:(0,m.A)(E,re&&I,u&&T,n&&$),ref:he,onDragEnter:ve,onDragLeave:ge,onDragOver:je,onDrop:fe,children:[(0,ie.jsx)("div",{className:R,children:(0,ie.jsx)("input",{ref:de,type:"text",className:B,placeholder:"Add a comment",value:r,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Ce())},onPaste:ye,onFocus:()=>ce(!0),onBlur:()=>ce(!1),disabled:n||f||!s})}),(0,ie.jsxs)("div",{className:O,children:[(0,ie.jsxs)("div",{className:G,children:[(0,ie.jsxs)("div",{className:K,ref:ue,children:[(0,ie.jsx)("button",{className:Z,type:"button",title:"Add emoji",disabled:n||!s,onClick:()=>g(!v),children:(0,ie.jsx)(A.A,{size:18})}),v&&(0,ie.jsx)("div",{className:Y,children:(0,ie.jsx)(k.Ay,{onEmojiClick:e=>{var s;c((s=>s+e.emoji)),g(!1),null===(s=de.current)||void 0===s||s.focus()},theme:"light",width:300,height:350,searchPlaceHolder:"Search emoji...",previewConfig:{showPreview:!1}})})]}),(0,ie.jsx)("button",{className:Z,onClick:()=>{var e;return null===(e=me.current)||void 0===e?void 0:e.click()},type:"button",title:"Attach file",disabled:n||!s,children:(0,ie.jsx)(w.A,{size:18})}),(0,ie.jsx)("input",{ref:me,type:"file",multiple:!0,onChange:e=>xe(e.target.files),style:{display:"none"}})]}),(0,ie.jsx)("div",{className:Q,children:(0,ie.jsx)(j.A,{onClick:Ce,className:(0,m.A)(J,Se&&X),disabled:n||f||!s||!Se,children:f?(0,ie.jsx)(x.p,{style:{width:"14px",height:"14px"},strokeWidth:"3"}):"Comment"})})]})]})]})},re="create-task_circleDesignStyle__vtKho",ce="create-task_out__LG-iY",de="create-task_taskTitleInput__s+lNu",me="create-task_formLabel__04J0h",he="create-task_taskDescriptionInput__RZWSI",ue="create-task_projectDropdown__qXb5+",pe="create-task_saveStatusWrapper__1NhE+",xe="create-task_saveStatus__6yreg",ve="create-task_saved__jqL5a",ge="create-task_error__5CguB",je="create-task_footerHint__acXGx",fe="create-task_sidebarFooter__+ieeU",ye="create-task_taskFooter__zplYw",be="create-task_footerRight__UmNHb";var _e=t(10586),Ce=t(72796),Ne=t(57189),Ae=t(63040),we=t(83738);const Se=(e,s)=>{const t={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",t)} - ${new Date(s).toLocaleDateString("en-US",t)}`},ke=e=>{let{startDate:s,endDate:t}=e;return(0,ie.jsx)("div",{className:"dateSelectdTaskBar",children:Se(s,t)})},Fe=e=>{let{setDateRange:s,dateRange:t}=e;const[a,n]=(0,l.useState)(!1),i=(0,l.useRef)(null),o=e=>{i.current&&!i.current.contains(e.target)&&n(!1)};return(0,l.useEffect)((()=>(a?document.addEventListener("mousedown",o):document.removeEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)})),[a]),(0,ie.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:i,children:[(0,ie.jsx)("div",{onClick:()=>n((e=>!e)),style:{cursor:"pointer"},children:null!==t&&void 0!==t&&t.startDate&&null!==t&&void 0!==t&&t.endDate?(0,ie.jsx)(ke,{startDate:t.startDate,endDate:t.endDate}):(0,ie.jsx)("div",{style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},className:"iconStyleCircle d-flex justify-content-center align-items-center iconStyleCircleRight "+(a?"active":""),children:(0,ie.jsx)(Ae.A,{color:a?"#1AB2FF":"#475467",size:14})})}),a&&(0,ie.jsx)("div",{className:"select-date-range",style:{position:"absolute",top:"-100px",background:"#fff",zIndex:1e3},children:(0,ie.jsx)(we.s,{onDataApply:e=>{s(e),n(!1)},dateRange:t,onClose:()=>n(!1)})})]})};var Le=t(75714);const Ee={commentsContainer:"task-comments_commentsContainer__9Qiud",commentsHeader:"task-comments_commentsHeader__SxVw0",commentsTitle:"task-comments_commentsTitle__f66k0",commentsList:"task-comments_commentsList__NBm+d",commentItem:"task-comments_commentItem__bv78f",deleteButton:"task-comments_deleteButton__XLlzH",userName:"task-comments_userName__EH9bR",commentTime:"task-comments_commentTime__4eCW6",commentText:"task-comments_commentText__rSHhj",addCommentSection:"task-comments_addCommentSection__-KvEG",avatar:"task-comments_avatar__GZ9fT",loadMoreWrapper:"task-comments_loadMoreWrapper__TLDxd",loadMoreBtn:"task-comments_loadMoreBtn__6oQeF",loading:"task-comments_loading__3LE67",commentAvatar:"task-comments_commentAvatar__Pc8rI",commentHeader:"task-comments_commentHeader__T9R4I",noComments:"task-comments_noComments__xAIGD",attachmentContainer:"task-comments_attachmentContainer__QEIIm",imageAttachment:"task-comments_imageAttachment__pMEwt",attachmentImage:"task-comments_attachmentImage__3TpwU",fileAttachment:"task-comments_fileAttachment__F5SBZ",fileIconWrapper:"task-comments_fileIconWrapper__bozGA",fileDetails:"task-comments_fileDetails__3maHd",fileName:"task-comments_fileName__6bsXF",fileAction:"task-comments_fileAction__bNX3c"},Ie=e=>{var s,t,l,a,n;let i=[],o=[];if(e.attachment_url)try{const s=JSON.parse(e.attachment_url);i=Array.isArray(s)?s:[e.attachment_url]}catch{i=[e.attachment_url]}if(e.attachment_type)try{const s=JSON.parse(e.attachment_type);o=Array.isArray(s)?s:[e.attachment_type]}catch{o=[e.attachment_type]}return{id:e.id,text:e.comment,created_at:e.created_at,attachments:i.map(((e,s)=>({url:e,type:o[s]||"application/octet-stream"}))),attachment_url:e.attachment_url||null,attachment_type:e.attachment_type||null,user:{id:null===(s=e.created_by)||void 0===s?void 0:s.id,full_name:null===(t=e.created_by)||void 0===t?void 0:t.full_name,email:null===(l=e.created_by)||void 0===l?void 0:l.email,photo:null===(a=e.created_by)||void 0===a?void 0:a.avatar,role:null===(n=e.created_by)||void 0===n?void 0:n.role}}},Te=e=>{const s=new Date,t=new Date(e),l=Math.floor((s-t)/6e4);return l<1?"Just now":l<60?`${l} min ago`:l<1440?`${Math.floor(l/60)} hours ago`:`${Math.floor(l/1440)} days ago`},$e=(0,l.forwardRef)(((e,s)=>{let{taskId:t,usersMap:a=new Map}=e;const{data:n,refetch:i,fetchNextPage:o,hasNextPage:r,isFetchingNextPage:c,isLoading:m}=(0,Le.q)({queryKey:["task-comments",t],queryFn:e=>{let{pageParam:s}=e;return s?fetch(s).then((e=>e.json())):(0,ae.Lb)(t)},enabled:!!t,getNextPageParam:e=>e.next});(0,l.useImperativeHandle)(s,(()=>({refetchComments:()=>i()})));const h=(0,d.n)({mutationFn:ae.Co,onSuccess:()=>{_.oR.success("Comment deleted"),i()},onError:()=>{_.oR.error("Failed to delete comment")}}),u=n?n.pages.slice().flatMap((e=>e.results)).map(Ie).sort(((e,s)=>new Date(e.created_at).getTime()-new Date(s.created_at).getTime())).reverse():[];if(m)return(0,ie.jsx)("div",{className:Ee.loading,children:"Loading comments\u2026"});if(!u.length)return(0,ie.jsx)("div",{className:Ee.noComments,children:"No comments yet."});return(0,ie.jsxs)("div",{className:Ee.commentsContainer,children:[r&&(0,ie.jsx)("div",{className:Ee.loadMoreWrapper,children:(0,ie.jsx)("button",{onClick:o,disabled:c,className:Ee.loadMoreBtn,children:c?"Loading\u2026":"Load older comments"})}),(0,ie.jsx)("div",{className:Ee.commentsList,children:u.map((e=>{var s,t,l;const n=a.get(null===(s=e.user)||void 0===s?void 0:s.id),i=(null===n||void 0===n?void 0:n.photo)||(null===(t=e.user)||void 0===t?void 0:t.photo),o=(null===n||void 0===n?void 0:n.has_photo)||!!i;return(0,ie.jsx)("div",{className:Ee.commentItem,children:(0,ie.jsxs)("div",{className:"d-flex gap-3",children:[(0,ie.jsx)("div",{className:Ee.avatar,children:(0,ie.jsx)(ne.A,{photo:i,has_photo:o,is_business:!1,size:18})}),(0,ie.jsxs)("div",{className:"flex-grow-1",style:{width:"calc(100% - 50px)"},children:[(0,ie.jsxs)("div",{className:Ee.header,children:[(0,ie.jsx)("span",{className:Ee.userName,children:null===(l=e.user)||void 0===l?void 0:l.full_name}),(0,ie.jsxs)("span",{className:Ee.commentTime,children:["\xb7 ",Te(1e3*e.created_at)]}),(0,ie.jsx)("button",{onClick:()=>{return s=e.id,void h.mutate(s);var s},disabled:h.isPending,className:Ee.deleteButton,style:{marginLeft:"5px",background:"none",border:"none",color:"#D92D20",cursor:h.isPending&&h.variables===e.id?"not-allowed":"pointer",fontSize:12,opacity:h.isPending&&h.variables===e.id?.6:1},children:h.isPending&&h.variables===e.id?"Deleting...":"Delete"})]}),(0,ie.jsx)("p",{className:Ee.commentText,children:e.text}),e.attachments&&e.attachments.length>0&&(0,ie.jsx)("div",{className:Ee.attachmentContainer,children:e.attachments.map(((e,s)=>{var t,l;return null!==(t=e.type)&&void 0!==t&&t.startsWith("image/")?(0,ie.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:Ee.imageAttachment,children:(0,ie.jsx)("img",{src:e.url,alt:`Attachment ${s+1}`,className:Ee.attachmentImage})},s):(0,ie.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:Ee.fileAttachment,children:[(0,ie.jsx)("div",{className:Ee.fileIconWrapper,children:(0,ie.jsx)(N.A,{size:18})}),(0,ie.jsxs)("div",{className:Ee.fileDetails,children:[(0,ie.jsx)("span",{className:Ee.fileName,children:(null===(l=e.url.split("/").pop())||void 0===l?void 0:l.split("?")[0])||"Attachment"}),(0,ie.jsx)("span",{className:Ee.fileAction,children:"Click to download"})]})]},s)}))})]})]})},e.id)}))})]})})),Re=e=>{if(!e)return null;return new Date(1e3*+e)},Be=e=>{var s,t;let{show:h,setShow:C,refetch:N,taskId:A,setTaskId:w,defaultValue:S,projectId:k,refetchTask:F,isFetching:L=!1}=e;const E=(0,l.useRef)(null),I=(0,l.useRef)(null),T=(0,l.useRef)(null),$=(0,l.useRef)(null),{session:R}=(0,Ne.As)(),[B,q]=(0,l.useState)("idle"),[D,z]=(0,l.useState)(null),[P,U]=(0,l.useState)(""),[H,M]=(0,l.useState)(""),[V,W]=(0,l.useState)(""),[O,G]=(0,l.useState)(null),[Q,Z]=(0,l.useState)(null),[K,Y]=(0,l.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1}),J=A||D;(0,l.useEffect)((()=>{var e,s;A&&S&&(U(null===S||void 0===S?void 0:S.title),M(null===S||void 0===S?void 0:S.description),W(null===S||void 0===S||null===(e=S.project)||void 0===e?void 0:e.id),G(null===S||void 0===S||null===(s=S.user)||void 0===s?void 0:s.id),Z({startDate:Re(null===S||void 0===S?void 0:S.from_date),endDate:Re(null===S||void 0===S?void 0:S.to_date)}))}),[A,S]);const X=()=>{N(),U(""),M(""),W(""),G(null),Z(null),q("idle"),z(null),Se.current=null,ke.current=!0,Y({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},ee=(0,c.I)({queryKey:["getProjectsList"],queryFn:_e.Bu}),se=(0,c.I)({queryKey:["getUserList"],queryFn:ae.aU}),te=(0,c.I)({queryKey:["getMobileUserList"],queryFn:ae.gy}),le=l.useMemo((()=>{var e,s,t,l;const a=new Map;return null===se||void 0===se||null===(e=se.data)||void 0===e||null===(s=e.users)||void 0===s||s.forEach((e=>{a.set(e.id,{id:e.id,label:`${e.first_name} ${e.last_name}`.trim()||e.first_name||"-",photo:e.photo||"",has_photo:e.has_photo})})),null===te||void 0===te||null===(t=te.data)||void 0===t||null===(l=t.users)||void 0===l||l.forEach((e=>{a.has(e.id)||a.set(e.id,{id:e.id,label:`${e.first_name} ${e.last_name}`.trim()||e.first_name||"-",photo:e.photo||"",has_photo:e.has_photo})})),a}),[null===se||void 0===se||null===(s=se.data)||void 0===s?void 0:s.users,null===te||void 0===te||null===(t=te.data)||void 0===t?void 0:t.users]);(0,l.useEffect)((()=>{h||X()}),[h]);const Ae=(0,d.n)({mutationFn:e=>(0,ae.Af)(e),onSuccess:e=>{z(null===e||void 0===e?void 0:e.id),q("saved"),_.oR.success("Task created"),setTimeout((()=>q("idle")),2e3)},onError:e=>{console.error("Error creating task:",e),q("error"),_.oR.error("Failed to create task")}}),we=(0,d.n)({mutationFn:e=>(0,ae.lC)(J,e),onSuccess:()=>{q("saved"),setTimeout((()=>q("idle")),2e3)},onError:e=>{console.error("Error updating task:",e),q("error"),_.oR.error("Failed to save changes")}}),Se=(0,l.useRef)(null),ke=(0,l.useRef)(!0),Le=(0,l.useRef)(null);(0,l.useEffect)((()=>{Le.current=()=>{var e,s;if(null===P||void 0===P||!P.trim())return;const t={title:P,description:H||"",...V&&{project:V},...O&&{user:O},...(null===Q||void 0===Q?void 0:Q.startDate)&&{from_date:Q.startDate},...(null===Q||void 0===Q?void 0:Q.endDate)&&{to_date:Q.endDate}},l=JSON.stringify({title:P,description:H||"",project:V||null,user:O||null,fromDate:(null===Q||void 0===Q||null===(e=Q.startDate)||void 0===e?void 0:e.toString())||null,toDate:(null===Q||void 0===Q||null===(s=Q.endDate)||void 0===s?void 0:s.toString())||null});if(Se.current!==l){if(ke.current&&J)return ke.current=!1,void(Se.current=l);Se.current=l,ke.current=!1,q("saving"),J?we.mutate(t):Ae.mutate(t)}}}),[P,H,V,O,Q,J,we,Ae]);const Ee=(0,l.useCallback)(u()((()=>{var e;null===(e=Le.current)||void 0===e||e.call(Le)}),1500),[]);(0,l.useEffect)((()=>(h&&null!==P&&void 0!==P&&P.trim()&&Ee(),()=>{var e;null===(e=Ee.cancel)||void 0===e||e.call(Ee)})),[P,H,V,O,Q,h,Ee]);const Ie=(0,d.n)({mutationFn:()=>(0,Ce.mM)(J),onSuccess:()=>{console.log("Delete success"),C(!1),N()},onError:e=>{console.error("Error creating task:",e)}}),Te=(0,d.n)({mutationFn:e=>(0,Ce._x)(J,e),onSuccess:(e,s)=>{_.oR.success(s?"Task marked as complete":"Task marked as incomplete"),null===F||void 0===F||F()},onError:e=>{console.error("Error updating task status:",e),_.oR.error("Failed to update task status")}}),Be=()=>{const e=null===S||void 0===S?void 0:S.finished;Te.mutate(!e)},qe=()=>{Ie.mutate()},De=()=>{var e;null===(e=T.current)||void 0===e||e.refetchComments()};return(0,l.useEffect)((()=>{setTimeout((()=>{I.current&&(I.current.style.height="auto",I.current.style.height=I.current.scrollHeight+"px")}),200)}),[H,A]),(0,l.useEffect)((()=>{k&&W(+k)}),[k]),(0,ie.jsx)(v.B,{visible:h,position:"right",onHide:()=>{C(!1),A&&w(null),X()},modal:!1,dismissable:!1,style:{width:"591px",height:"97vh",borderRadius:"10px",marginRight:"10px"},content:e=>{var s,t,l,c,d,h,u,v,_,C;let{closeIconRef:N,hide:w}=e;return(0,ie.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,ie.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,ie.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,ie.jsx)("div",{className:re,children:(0,ie.jsx)("div",{className:ce,children:(0,ie.jsx)(a.A,{size:24,color:"#17B26A"})})}),(0,ie.jsxs)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:[J?"Edit":"Create New"," Task"]}),(0,ie.jsxs)("div",{className:pe,children:["saving"===B&&(0,ie.jsxs)("div",{className:xe,children:[(0,ie.jsx)(x.p,{style:{width:"14px",height:"14px"},strokeWidth:"3"}),(0,ie.jsx)("span",{children:"Saving..."})]}),"saved"===B&&(0,ie.jsxs)("div",{className:(0,m.A)(xe,ve),children:[(0,ie.jsx)(n.A,{size:14}),(0,ie.jsx)("span",{children:"Saved"})]}),"error"===B&&(0,ie.jsx)("div",{className:(0,m.A)(xe,ge),children:(0,ie.jsx)("span",{children:"Save failed"})})]})]}),(0,ie.jsx)("span",{children:(0,ie.jsx)(j.A,{type:"button",className:"text-button",ref:N,onClick:e=>w(e),children:(0,ie.jsx)(i.A,{size:24,color:"#667085"})})})]}),(0,ie.jsxs)("div",{className:"modal-body",style:{height:"calc(100vh - 72px - 200px)",overflow:"auto"},children:[L&&A?(0,ie.jsxs)("div",{className:"task-content",style:{padding:"24px"},children:[(0,ie.jsx)(g.E,{width:"70%",height:"28px",className:"mb-3"}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,ie.jsx)(g.E,{width:"80px",height:"22px"})}),(0,ie.jsxs)(f.A,{sm:8,className:"d-flex align-items-center",children:[(0,ie.jsx)(g.E,{shape:"circle",size:"24px",className:"me-2"}),(0,ie.jsx)(g.E,{width:"120px",height:"22px",style:{marginLeft:"8px"}})]})]}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,ie.jsx)(g.E,{width:"80px",height:"22px"})}),(0,ie.jsx)(f.A,{sm:8,children:(0,ie.jsx)(g.E,{width:"180px",height:"22px"})})]}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,ie.jsx)(g.E,{width:"100px",height:"22px"})}),(0,ie.jsx)(f.A,{sm:8,children:(0,ie.jsx)(g.E,{width:"200px",height:"46px",borderRadius:"8px"})})]}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,children:(0,ie.jsx)(g.E,{width:"90px",height:"22px"})}),(0,ie.jsx)(f.A,{sm:12,className:"mt-2",children:(0,ie.jsx)(g.E,{width:"100%",height:"120px",borderRadius:"8px"})})]})]}):(0,ie.jsxs)("div",{className:"task-content",style:{padding:"24px"},children:[(0,ie.jsx)(y.A.Control,{type:"text",name:"taskTitle",id:"taskTitle",placeholder:"Enter task title",value:P,onChange:e=>U(e.target.value),className:de}),K.taskTitle&&(0,ie.jsx)(y.A.Text,{className:"error-message",children:"Task title is required"}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,ie.jsx)(y.A.Label,{className:me,children:"Assignee"})}),(0,ie.jsxs)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:[!O&&(0,ie.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.show()},style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},children:(0,ie.jsx)(o.A,{color:null!==(s=E.current)&&void 0!==s&&null!==(t=s.panel)&&void 0!==t&&null!==(l=t.element)&&void 0!==l&&l.offsetParent?"#1AB2FF":"#475467",size:18,className:"cursor-pointer"})}),(0,ie.jsx)(p.m,{ref:E,options:[{label:"Desktop User",items:(null===se||void 0===se||null===(c=se.data)||void 0===c||null===(d=c.users)||void 0===d||null===(h=d.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===h?void 0:h.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==R&&void 0!==R&&R.has_work_subscription?[{label:"Mobile User",items:(null===te||void 0===te||null===(u=te.data)||void 0===u||null===(v=u.users)||void 0===v||null===(_=v.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===_?void 0:_.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{G(e.value)},valueTemplate:e=>{const s="object"===typeof e?null===e||void 0===e?void 0:e.value:e,t=le.get(s);return t?(0,ie.jsxs)("div",{className:"d-flex gap-2 align-items-center",style:{position:"relative",left:"-10px"},children:[(0,ie.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ie.jsx)(ne.A,{photo:null===t||void 0===t?void 0:t.photo,has_photo:null===t||void 0===t?void 0:t.has_photo,is_business:!1,size:17})}),null===t||void 0===t?void 0:t.label]}):null},itemTemplate:e=>(0,ie.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,ie.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,ie.jsx)(ne.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:O?"fit-content":"0px",height:O?"46px":"0px",zIndex:O?"1":"0",position:"relative",left:O?"-4px":"-60px",top:O?"0px":"-15px"},value:O,dropdownIcon:(0,ie.jsx)(ie.Fragment,{}),collapseIcon:(0,ie.jsx)(ie.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"})]})]}),K.user&&(0,ie.jsx)(y.A.Text,{className:"error-message",children:"User is required"}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,ie.jsx)(y.A.Label,{className:me,children:"Due Date"})}),(0,ie.jsx)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,ie.jsx)(Fe,{dateRange:Q,setDateRange:Z})})]}),K.date&&(0,ie.jsx)(y.A.Text,{className:"error-message",children:"Date is required"}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,ie.jsx)(y.A.Label,{className:me,children:"Link to Project"})}),(0,ie.jsx)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,ie.jsx)(p.m,{options:(null===ee||void 0===ee||null===(C=ee.data)||void 0===C?void 0:C.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{W(e.value)},className:(0,m.A)("outline-none",ue),style:{height:"46px",maxWidth:"100%",width:"fit-content"},value:V,loading:null===ee||void 0===ee?void 0:ee.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,panelStyle:{maxHeight:"400px",width:"591px"}})})]}),K.project&&(0,ie.jsx)(y.A.Text,{className:"error-message",children:"Project task is required"}),(0,ie.jsxs)(b.A,{className:"mt-3",children:[(0,ie.jsx)(f.A,{sm:4,children:(0,ie.jsx)(y.A.Label,{className:me,children:"Description"})}),(0,ie.jsx)(f.A,{sm:12,children:(0,ie.jsx)(y.A.Control,{name:"taskDescription",id:"taskDescription",as:"textarea",placeholder:"Enter a description...",value:H,rows:2,ref:I,onChange:e=>{M(e.target.value)},className:he,onInput:e=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onFocus:()=>{I.current&&(I.current.style.height="auto",I.current.style.height=I.current.scrollHeight+"px")}})})]}),K.description&&(0,ie.jsx)(y.A.Text,{className:"error-message",children:"Description is required"})]}),J&&(0,ie.jsxs)("div",{className:"border-top",style:{background:"#F2F3F4",padding:"12px 24px"},children:[(0,ie.jsx)(y.A.Label,{className:me,children:"Comments"}),(0,ie.jsx)("div",{ref:$,children:(0,ie.jsx)($e,{taskId:J,ref:T,usersMap:le})})]})]}),(0,ie.jsxs)("div",{className:fe,children:[(0,ie.jsx)(oe,{taskId:J,session:R,onCommentAdded:De,disabled:!J,commentsScrollRef:$}),(0,ie.jsxs)("div",{className:ye,children:[(0,ie.jsxs)(j.A,{disabled:!J||Te.isPending,className:null!==S&&void 0!==S&&S.finished?"outline-in-complete-button":"outline-complete-button",onClick:Be,children:[null!==S&&void 0!==S&&S.finished?"Completed":"Mark Complete",(0,ie.jsx)(r.A,{size:16,color:"#079455"}),Te.isPending&&(0,ie.jsx)(x.p,{style:{width:"16px",height:"16px"},strokeWidth:"3"})]}),(0,ie.jsxs)("div",{className:be,children:[(0,ie.jsxs)("span",{className:je,children:["saving"===B&&"Saving...","saved"===B&&"Changes saved","idle"===B&&"Auto-save enabled"]}),(0,ie.jsxs)(j.A,{className:"danger-text-button",onClick:qe,disabled:!J,children:["Delete",Ie.isPending&&(0,ie.jsx)(x.p,{style:{width:"18px",height:"18px"}})]})]})]})]})]})}})}},68811:(e,s,t)=>{t.d(s,{A:()=>n});var l=t(55973),a=t(70579);const n=e=>{let{show:s,setShow:t,project:n,reInitialize:i}=e;const o=n.value;return(0,a.jsx)(a.Fragment,{children:s&&(0,a.jsx)(l.A,{show:s,setShow:t,projectId:o,refetch:i})})}},70767:(e,s,t)=>{t.d(s,{A:()=>l});t(65043);const l=t.p+"static/media/addNoteModeIcon.43bdc8582f3ef769329a44f15a05fe67.svg"},72796:(e,s,t)=>{t.d(s,{_x:()=>i,dd:()=>a,mM:()=>n});const l="https://app.memate.com.au/api/v1",a=async e=>{const s=new Headers,t=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${t}`),s.append("Content-Type","application/json");const a={method:"GET",headers:s};try{const s=new URL(`${l}/tasks/${e}/`),t=await fetch(s,a);return await t.json()}catch(n){throw console.error("Tasks fetch error:",n),n}},n=async e=>{const s=new Headers,t=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${t}`),s.append("Content-Type","application/json");const a={method:"DELETE",headers:s,redirect:"follow"};try{const s=new URL(`${l}/tasks/delete/${e}/`);if((await fetch(s,a)).ok)return{message:"Task deleted successfully"};throw new Error("Error during deleting")}catch(n){throw console.error("Tasks fetch error:",n),n}},i=async(e,s)=>{const t=new Headers,a=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${a}`),t.append("Content-Type","application/json");const n={method:"PATCH",headers:t,body:JSON.stringify({finished:s}),redirect:"follow"};try{const s=new URL(`${l}/tasks/complete/${e}/`),t=await fetch(s,n);return await t.json()}catch(i){throw console.error("Tasks fetch error:",i),i}}},73184:(e,s,t)=>{t.d(s,{A:()=>I});var l=t(65043),a=t(14282),n=t(44505),i=t(56741),o=t(55850),r=t(84062),c=t(69956),d=t(38161),m=t(94819),h=t(89488),u=t(35475),p=t(28261),x=t(47097),v=t(86213),g=t(21576),j=t(93740),f=t(74856),y=t(32952),b=t(56328),_=t(11520);const C=t.p+"static/media/folderFileIcon.ea8d1ab0e5f9d712876b6e6f3e9f303d.svg";var N=t(95753),A=t(99678),w=t(70579);const S=e=>{var s,t;let{file:l}=e;const a=null===l||void 0===l||null===(s=l.key)||void 0===s||null===(t=s.split(".").pop())||void 0===t?void 0:t.toLowerCase(),n=(e=>["jpg","jpeg","png","gif","svg","bmp","webp","heic"].includes(null===e||void 0===e?void 0:e.toLowerCase()))(a);return n?(0,w.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",overflow:"hidden",flexShrink:0,background:"#E5E7EB"},children:(0,w.jsx)("img",{src:l.url,alt:l.key,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;"><svg width="24" height="24" viewBox="0 0 24 24" fill="#9CA3AF"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></div>'}})}):(0,w.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,w.jsx)(A.L,{extension:a,size:28})})},k=()=>(0,w.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,w.jsx)(n.A,{size:28,color:"#FFA500"})}),F=e=>{if(!e)return[];if(Array.isArray(e))return e;const s=[];return Array.isArray(e.project)&&s.push(...e.project),e.jobs&&"object"===typeof e.jobs&&Object.entries(e.jobs).forEach((e=>{let[t,l]=e;Array.isArray(l)&&s.push(...l.map((e=>({...e,jobId:t}))))})),s},L=e=>{let{file:s,onClose:t,triggerRef:a}=e;const[n,r]=(0,l.useState)(!1),c=(0,l.useRef)(null),d=s.url,[m,h]=(0,l.useState)(null);if((0,l.useEffect)((()=>{if(null!==a&&void 0!==a&&a.current){const e=a.current.getBoundingClientRect(),s=415,t=280;let l=e.right-s;l<10&&(l=10);let n=e.bottom+8;n+t>window.innerHeight-10&&(n=e.top-t-8),n<10&&(n=10),h({top:n,left:l})}}),[a]),(0,l.useEffect)((()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&t()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[t]),!m)return null;const u=[{name:"WhatsApp",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#25D366"}),(0,w.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z",fill:"white"})]}),onClick:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`Check out this file: ${s.name}\n${d}`)}`,"_blank"),t()}},{name:"Facebook",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#1877F2"}),(0,w.jsx)("path",{d:"M16.671 15.469l.547-3.469h-3.343V9.531c0-.969.475-1.906 1.984-1.906h1.532V4.656s-1.39-.234-2.719-.234c-2.773 0-4.578 1.657-4.578 4.656V12H6.921v3.469h3.173V24h3.906v-8.531h2.671z",fill:"white"})]}),onClick:()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(d)}`,"_blank","width=600,height=400"),t()}},{name:"X",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#000000"}),(0,w.jsx)("path",{d:"M13.544 10.456L17.89 5.5h-1.03l-3.773 4.305L10.16 5.5H6.5l4.56 6.513L6.5 17.5h1.03l3.987-4.55 3.184 4.55H18l-4.456-7.044zm-1.41 1.608l-.462-.649L8.04 6.28h1.585l2.97 4.17.462.649 3.862 5.423h-1.585l-3.2-4.458z",fill:"white"})]}),onClick:()=>{window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`Check out this file: ${s.name}`)}&url=${encodeURIComponent(d)}`,"_blank","width=600,height=400"),t()}},{name:"Email",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#9CA3AF"}),(0,w.jsx)("path",{d:"M6 8.5C6 7.67157 6.67157 7 7.5 7H16.5C17.3284 7 18 7.67157 18 8.5V15.5C18 16.3284 17.3284 17 16.5 17H7.5C6.67157 17 6 16.3284 6 15.5V8.5Z",stroke:"white",strokeWidth:"1.5"}),(0,w.jsx)("path",{d:"M6.5 8L12 12L17.5 8",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round"})]}),onClick:()=>{const e=encodeURIComponent(`Shared File: ${s.name}`),l=encodeURIComponent(`Hi,\n\nI wanted to share this file with you:\n\n${s.name}\n\nYou can access it here:\n${d}\n\nBest regards`);window.location.href=`mailto:?subject=${e}&body=${l}`,t()}},{name:"LinkedIn",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#0A66C2"}),(0,w.jsx)("path",{d:"M8.5 10H6.5V17.5H8.5V10Z",fill:"white"}),(0,w.jsx)("path",{d:"M7.5 8.5C8.19036 8.5 8.75 7.94036 8.75 7.25C8.75 6.55964 8.19036 6 7.5 6C6.80964 6 6.25 6.55964 6.25 7.25C6.25 7.94036 6.80964 8.5 7.5 8.5Z",fill:"white"}),(0,w.jsx)("path",{d:"M13 10H10.5V17.5H13V13.5C13 12.5 13.5 11.5 14.75 11.5C16 11.5 16 12.75 16 13.5V17.5H18V13C18 10.5 16.5 10 15.25 10C14 10 13.25 10.75 13 11V10Z",fill:"white"})]}),onClick:()=>{window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(d)}`,"_blank","width=600,height=400"),t()}},{name:"Telegram",icon:(0,w.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,w.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#0088CC"}),(0,w.jsx)("path",{d:"M17.0708 7.25736L5.82893 11.7157C5.19282 11.9722 5.19617 12.3354 5.71355 12.4916L8.45534 13.3441L15.2726 8.87451C15.5898 8.67576 15.879 8.78168 15.6426 9.00033L10.0851 14.0632H10.0839L10.0851 14.0637L9.87243 16.8879C10.1449 16.8879 10.2654 16.7614 10.4166 16.6161L11.734 15.3391L14.5173 17.4133C15.0157 17.6918 15.3734 17.5497 15.4991 16.9561L17.4706 8.19979C17.6561 7.47058 17.1969 7.14026 17.0708 7.25736Z",fill:"white"})]}),onClick:()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(d)}&text=${encodeURIComponent(`Check out this file: ${s.name}`)}`,"_blank"),t()}}];return(0,w.jsxs)("div",{ref:c,onClick:e=>e.stopPropagation(),style:{position:"fixed",top:`${m.top}px`,left:`${m.left}px`,background:"#FFFFFF",borderRadius:"12px",boxShadow:"0px 12px 24px -4px rgba(16, 24, 40, 0.18), 0px 8px 16px -4px rgba(16, 24, 40, 0.08)",border:"1px solid #EAECF0",padding:"16px",width:"415px",zIndex:9999},children:[(0,w.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,w.jsx)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#101828"},children:"Share"}),(0,w.jsx)("div",{onClick:t,style:{cursor:"pointer",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,w.jsx)(i.A,{size:20,color:"#667085"})})]}),(0,w.jsx)("div",{className:"d-flex justify-content-start gap-3 mb-4",style:{overflowX:"auto",paddingBottom:"4px"},children:u.map((e=>(0,w.jsxs)("div",{onClick:e.onClick,className:"d-flex flex-column align-items-center gap-2",style:{cursor:"pointer",minWidth:"48px"},children:[(0,w.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:e.icon}),(0,w.jsx)("span",{style:{fontSize:"11px",color:"#667085",textAlign:"center"},children:e.name})]},e.name)))}),(0,w.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{background:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB",padding:"8px 12px"},children:[(0,w.jsx)("input",{type:"text",value:d,readOnly:!0,style:{flex:1,border:"none",background:"transparent",fontSize:"13px",color:"#667085",outline:"none",overflow:"hidden",textOverflow:"ellipsis"}}),(0,w.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(d),r(!0),b.oR.success("Link copied to clipboard!"),setTimeout((()=>{r(!1)}),2e3)}catch(e){const s=document.createElement("textarea");s.value=d,document.body.appendChild(s),s.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(s),r(!0),b.oR.success("Link copied to clipboard!"),setTimeout((()=>{r(!1)}),2e3)}},style:{padding:"8px 16px",background:n?"#17B26A":"#158ECC",border:"none",borderRadius:"20px",color:"#FFFFFF",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},children:n?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(o.A,{size:14}),"Copied"]}):"Copy"})]})]})},E=e=>{let{item:s,isShareOpen:t,onToggle:a,onClose:n}=e;const i=(0,l.useRef)(null);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{ref:i,className:"d-flex align-items-center justify-content-center",onClick:e=>{e.preventDefault(),e.stopPropagation(),a()},title:"Share",style:{background:t?"#EBF8FF":"#F0F9FF",borderRadius:"50%",width:"28px",height:"28px",flexShrink:0,cursor:"pointer",transition:"all 0.2s ease",border:t?"1px solid #158ECC":"1px solid transparent"},onMouseEnter:e=>{t||(e.currentTarget.style.background="#E0F2FE")},onMouseLeave:e=>{t||(e.currentTarget.style.background="#F0F9FF")},children:(0,w.jsx)(r.A,{size:14,color:"#158ECC"})}),t&&(0,w.jsx)(L,{file:s,onClose:n,triggerRef:i})]})},I=e=>{var s;let{projectId:t}=e;const[n,o]=(0,l.useState)([]),[r,A]=(0,l.useState)(!1),[L,I]=(0,l.useState)(!1),[T,$]=(0,l.useState)(!1),[R,B]=(0,l.useState)(""),[q,D]=(0,l.useState)(!1),[z,P]=(0,l.useState)(""),[U,H]=(0,l.useState)([]),[M,V]=(0,l.useState)(null),W=(0,l.useRef)(null),O=localStorage.getItem("access_token"),G=()=>{D(!1),H([]),P(""),I(!1),B(""),o([]),V(null)},Q=(0,p.I)({queryKey:["id",t],queryFn:()=>(0,_.pV)(t),enabled:!!t,retry:1,staleTime:0,cacheTime:0}),Z=async(e,s,t)=>v.A.put(s,e,{headers:{"Content-Type":""},onUploadProgress:e=>{const s=Math.round(e.loaded/e.total*100);o((e=>e.map((e=>e.id===t?{...e,progress:s}:e))))}}).catch((e=>{throw console.log("err: ",e),o((e=>e.map((e=>e.id===t?{...e,progress:0,error:!0}:e)))),e})),K=async e=>{if(!e.trim())return b.oR.error("Folder name cannot be empty."),I(!1),void B("");if(!O)return b.oR.error("Access token is missing. Please log in again."),void I(!1);const s=`${U.join("/")+(U.length?"/":"")}${e}/`;try{$(!0);const l=await v.A.post(`https://app.memate.com.au/api/v1/projects/file/${t}/`,{file_name:s},{headers:{Authorization:`Bearer ${O}`}}),{url:a}=l.data;if(!a)throw new Error("No URL received");await v.A.put(a,new Blob,{headers:{"Content-Type":""}}),b.oR.success(`Successfully created folder ${e}`),null===Q||void 0===Q||Q.refetch()}catch(l){console.error("Error creating folder:",l),b.oR.error(`Failed to create folder ${e}. Please try again.`)}finally{I(!1),B(""),$(!1)}},{getRootProps:Y,getInputProps:J}=(0,h.VB)({multiple:!0,accept:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg"],"video/mp4":[".mp4"]},maxSize:26214400,onDrop:e=>{(async e=>{if(!e.length)return;if(!O)return b.oR.error("Access token is missing. Please log in again.");const s=U.join("/")+(U.length?"/":""),l=e.map(((e,s)=>({id:Date.now()+s,name:e.name,progress:0,error:!1,type:"uploading_file"})));o((e=>[...l,...e]));for(const[n,i]of e.entries()){const e=l[n].id,r=Date.now(),c=i.name.split("."),d=c.pop(),m=`${s}${c.join(".")}-${r}.${d}`;try{const s=await v.A.post(`https://app.memate.com.au/api/v1/projects/file/${t}/`,{file_name:m},{headers:{Authorization:`Bearer ${O}`}}),{url:l}=s.data;if(!l)throw new Error("No URL received");let a=l.split("?")[0];await Z(i,a,e),b.oR.success(`Successfully uploaded ${i.name}`),null===Q||void 0===Q||Q.refetch()}catch(a){console.error("Error uploading file:",i.name,a),b.oR.error(`Failed to upload ${i.name}. Please try again.`),o((s=>s.map((s=>s.id===e?{...s,error:!0}:s))));continue}finally{o((s=>s.filter((s=>s.id!==e))))}}})(e)}}),X=(0,x.n)({mutationFn:e=>(0,_.m2)(t,e),onSuccess:()=>{b.oR.success("File deleted successfully"),null===Q||void 0===Q||Q.refetch()},onError:()=>{b.oR.error("Failed to delete file")}}),ee=(0,x.n)({mutationFn:async e=>{console.log("folderPrefix: ",e);const s=F(Q.data),l=s.filter((s=>s.url.includes(e)));console.log("toDelete: ",l),await Promise.all(l.map((e=>{let s=null===e||void 0===e?void 0:e.url;if(!s)return;const l=new URL(s).pathname.replace(/^\/+/,"");(0,_.m2)(t,l)})));const a=e;s.some((e=>e.key===a))&&!l.some((e=>e.key===a))&&await(0,_.m2)(t,a)},onSuccess:()=>{b.oR.success("Folder deleted successfully"),null===Q||void 0===Q||Q.refetch()},onError:e=>{console.error("Error deleting folder:",e),b.oR.error("Failed to delete folder")}}),se=()=>{I(!1),B("")},te=F(Q.data),le=((e,s)=>{const t=s.join("/")+(s.length?"/":""),l=new Map;for(const a of e)if(a.key.startsWith(t)){const e=a.key.slice(t.length);if(""===e)continue;const s=e.split("/"),n=s[0];s.length>1?l.has(n)||l.set(n,{type:"folder",name:n,...a}):l.set(n,{type:"file",name:n,...a})}return Array.from(l.values()).sort(((e,s)=>e.type===s.type?e.name.localeCompare(s.name):"folder"===e.type?-1:1))})(te,U);let ae=z?le.filter((e=>e.name.toLowerCase().includes(z.toLowerCase()))):le;return ae=[...n,...ae],L&&(ae=[{type:"new_folder"},...ae]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(a.A,{className:"filebut "+(null!==te&&void 0!==te&&te.length?"fileActive":""),onClick:()=>{D(!0)},children:["Files",(0,w.jsx)("img",{src:C,alt:"FolderFileIcon"})]}),(0,w.jsxs)(y.A,{show:q,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject taskModelProjectFiles",onHide:G,animation:!1,children:[(0,w.jsxs)(y.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,w.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start py-2",children:(0,w.jsx)("span",{children:"Integrated File System"})}),(0,w.jsx)("button",{className:"CustonCloseModal",onClick:G,children:(0,w.jsx)(i.A,{size:24,color:"#667085"})})]}),(0,w.jsxs)(y.A.Body,{children:[(0,w.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,w.jsx)("nav",{"aria-label":"breadcrumb",children:(0,w.jsx)("ol",{className:"breadcrumb",style:{fontSize:"14px",marginBottom:"0"},children:["Files",...U].map(((e,s,t)=>(0,w.jsx)("li",{className:"breadcrumb-item "+(s===t.length-1?"active":""),children:(0,w.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),H(U.slice(0,s))},className:"font-14",style:{color:s===t.length-1?"#344054":"#106B99",textDecoration:"none"},children:e})},s)))})}),(0,w.jsxs)("div",{className:"d-flex gap-2 justify-content-end align-items-center",children:[(0,w.jsx)(a.A,{className:"solid-button font-14 d-flex align-items-center",onClick:()=>A(!r),children:"Upload Files"}),(0,w.jsx)(a.A,{className:"outline-button font-14 d-flex align-items-center",onClick:()=>{I(!0),B(""),setTimeout((()=>{W.current&&W.current.focus()}),0)},children:"New Folder"}),(0,w.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,w.jsx)("div",{style:{position:"absolute",top:"3px",left:"8px"},children:(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",children:(0,w.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,w.jsx)("input",{type:"text",placeholder:"Search",value:z,onChange:e=>P(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})]}),r&&(0,w.jsxs)("div",{...Y({className:"dropzone d-flex justify-content-center align-items-center flex-column cursor-pointer mb-4"}),style:{width:"100%",height:"100px",background:"#F9FAFB",borderRadius:"8px",border:"2px dashed #D0D5DD",padding:"20px"},children:[(0,w.jsx)("input",{...J()}),(0,w.jsx)(c.A,{size:24,color:"#106B99"}),(0,w.jsxs)("p",{className:"mb-0 mt-2",style:{color:"#475467",fontSize:"14px",textAlign:"center"},children:[(0,w.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop files here",(0,w.jsx)("br",{}),(0,w.jsx)("small",{children:"(PDF, PNG, JPG, JPEG, MP4 - Max 25MB)"})]})]}),(0,w.jsx)("div",{style:{height:"300px",overflow:"auto",paddingRight:"4px"},children:(0,w.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[!(null!==Q&&void 0!==Q&&Q.isPending)&&(null===(s=ae)||void 0===s?void 0:s.map(((e,s)=>{if("new_folder"===e.type)return(0,w.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px"},className:"d-flex align-items-center gap-2",children:[(0,w.jsx)(k,{}),(0,w.jsx)("input",{ref:W,type:"text",value:R,onChange:e=>B(e.target.value),onKeyDown:e=>{"Enter"===e.key?K(R):"Escape"===e.key&&se()},style:{flex:1,border:"none",background:"transparent",fontSize:"13px",fontWeight:"500",color:"#344054"},placeholder:"Folder name"}),(0,w.jsxs)("div",{className:"d-flex gap-1",children:[(0,w.jsx)("div",{onClick:()=>K(R),style:{cursor:"pointer",color:"#106B99"},title:"Save",children:T?(0,w.jsx)(j.p,{style:{width:"14px",height:"14px"}}):(0,w.jsx)(d.A,{size:20})}),(0,w.jsx)("div",{onClick:se,style:{cursor:"pointer",color:"#F04438"},title:"Cancel",children:(0,w.jsx)(i.A,{size:20})})]})]},"new_folder");if("uploading_file"===e.type)return(0,w.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px"},className:"d-flex align-items-center justify-content-between gap-2",children:[(0,w.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{flex:1,minWidth:0},children:[(0,w.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,w.jsx)(c.A,{size:28,color:"#106B99"})}),(0,w.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,w.jsx)("div",{title:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:e.name}),e.error?(0,w.jsx)("small",{style:{color:"#F04438",fontSize:"12px"},children:"Upload failed"}):(0,w.jsx)(g.z,{value:e.progress,style:{height:"6px"},showValue:!1})]})]}),e.error&&(0,w.jsx)("div",{onClick:()=>o((s=>s.filter((s=>s.id!==e.id)))),style:{cursor:"pointer",color:"#F04438"},title:"Remove",children:(0,w.jsx)(m.A,{size:14})})]},e.id);const t=(null===X||void 0===X?void 0:X.isPending)&&e.url.includes(null===X||void 0===X?void 0:X.variables),l=M===e.key;return(0,w.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px",position:"relative"},className:"d-flex align-items-center justify-content-between gap-2",children:["file"===e.type?(0,w.jsxs)(u.N_,{to:`${e.url}`,target:"_blank",className:"d-flex align-items-center gap-2",style:{flex:1,minWidth:0,textDecoration:"none"},children:[(0,w.jsx)(S,{file:e}),(0,w.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,w.jsx)("div",{title:null===e||void 0===e?void 0:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:null===e||void 0===e?void 0:e.name}),(0,w.jsx)("small",{style:{color:"#667085",fontSize:"12px"},children:(0,N.v)(null===e||void 0===e?void 0:e.size)})]})]}):(0,w.jsxs)("div",{className:"d-flex align-items-center gap-2 cursor-pointer",style:{flex:1,minWidth:0},onClick:()=>H([...U,e.name]),children:[(0,w.jsx)(k,{}),(0,w.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,w.jsx)("div",{title:null===e||void 0===e?void 0:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:null===e||void 0===e?void 0:e.name}),(0,w.jsx)("small",{style:{color:"#667085",fontSize:"12px"},children:"Folder"})]})]}),(0,w.jsxs)("div",{className:"d-flex align-items-center gap-1",children:["file"===e.type&&(0,w.jsx)(E,{item:e,isShareOpen:l,onToggle:()=>V(l?null:e.key),onClose:()=>V(null)}),(0,w.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>"file"===e.type?(e=>{let s=null===e||void 0===e?void 0:e.url;if(s)try{const e=new URL(s).pathname.replace(/^\/+/,"");X.mutate(e)}catch(t){console.error("Invalid URL:",s),b.oR.error("Failed to delete file")}})(e):(async e=>{let s=null===e||void 0===e?void 0:e.url;if(s)try{const e=new URL(s).pathname.replace(/^\/+/,"");await ee.mutateAsync(e),null===Q||void 0===Q||Q.refetch()}catch(t){console.error("Invalid URL:",s),b.oR.error("Failed to delete folder")}})(e),title:"Delete",style:{background:"#FEE4E2",borderRadius:"50%",width:"28px",height:"28px",flexShrink:0,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.background="#FEF3F2",onMouseLeave:e=>e.currentTarget.style.background="#FEE4E2",children:t?(0,w.jsx)(j.p,{style:{width:"14px",height:"14px"}}):(0,w.jsx)(m.A,{size:14,color:"#F04438"})})]})]},e.name||s)}))),(null===Q||void 0===Q?void 0:Q.isPending)&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,w.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"})]}),!(null!==Q&&void 0!==Q&&Q.isPending)&&0===ae.length&&(0,w.jsx)("div",{style:{width:"100%",textAlign:"center",color:"#667085",fontSize:"14px"},children:"No files found."})]})})]}),(0,w.jsx)("div",{className:"CustonCloseModalBottom",children:(0,w.jsx)("button",{className:"but",onClick:G,children:"Close"})})]})]})}},79106:(e,s,t)=>{t.d(s,{Af:()=>o,Co:()=>u,Lb:()=>m,U9:()=>n,Zi:()=>h,aU:()=>c,gg:()=>i,gy:()=>d,lC:()=>r,qT:()=>p});var l=t(31342);const a="https://app.memate.com.au/api/v1",n=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;const c=(e-1)*s,d=new URL(`${a}/tasks/`);return d.searchParams.append("limit",s),d.searchParams.append("offset",c),t&&d.searchParams.append("search",t),n&&d.searchParams.append("ordering",n),i&&d.searchParams.append("deleted",1),!0===o&&d.searchParams.append("finished",!1),!1===o&&d.searchParams.append("finished",!0),r&&d.searchParams.append("users",r),(0,l.f)(d.toString(),{method:"GET"})},i=async e=>{const s=new URL(`${a}${`/tasks/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},o=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/tasks/new/`);return(0,l.f)(t.toString(),s)},r=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/tasks/update/${e}/`}`);return(0,l.f)(n.toString(),t)},c=async()=>{const e=new URL(`${a}/desktop-users/`);return(0,l.f)(e.toString(),{method:"GET"})},d=async()=>{const e=new URL(`${a}/team/mobile-users/`);return(0,l.f)(e.toString(),{method:"GET"})},m=async e=>{const s=new URL(`${a}${`/tasks/${e}/comments/`}`);return(0,l.f)(s.toString(),{method:"GET"})},h=async(e,s)=>{const t=new URL(`${a}${`/tasks/${e}/comments/`}`);return(0,l.f)(t.toString(),{method:"POST",body:s})},u=async e=>{const s=new URL(`${a}${`/tasks/comments/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},p=async(e,s,t)=>{const n=new URL(`${a}/tasks/comments/presigned-url/`);return(0,l.f)(n.toString(),{method:"POST",body:{file_name:s,task_id:e,attachment_type:t}})}},81047:(e,s,t)=>{t.d(s,{AO:()=>p,Ad:()=>_,Bz:()=>L,Hb:()=>m,IT:()=>F,Kb:()=>o,Mp:()=>b,Pf:()=>A,Rh:()=>C,SQ:()=>d,T6:()=>v,UM:()=>f,VQ:()=>k,Xm:()=>c,bd:()=>S,bj:()=>x,gY:()=>g,hS:()=>u,hx:()=>w,iS:()=>i,p4:()=>r,pJ:()=>y,rJ:()=>N,s:()=>h,sB:()=>j,tC:()=>n});var l=t(31342);const a="https://app.memate.com.au/api/v1",n=async()=>{const e=new URL(`${a}/jobs/templates/`);return(0,l.f)(e.toString(),{method:"GET"})},i=async e=>{const s=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},o=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/jobs/templates/`);return(0,l.f)(t.toString(),s)},r=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,l.f)(n.toString(),t)},c=async e=>{const s=new URL(`${a}${`/jobs/templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},d=async()=>{const e=new URL(`${a}/settings/templates/email-templates/`);return(0,l.f)(e.toString(),{method:"GET"})},m=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/settings/templates/email-templates/`);return(0,l.f)(t.toString(),s)},h=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,l.f)(n.toString(),t)},u=async e=>{const s=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},p=async()=>{const e=new URL(`${a}/email-signatures/`);return(0,l.f)(e.toString(),{method:"GET"})},x=async e=>{const s=new URL(`${a}${`/email-signatures/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},v=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/email-signatures/`);return(0,l.f)(t.toString(),s)},g=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/email-signatures/${e}/`}`);return(0,l.f)(n.toString(),t)},j=async e=>{const s=new URL(`${a}${`/email-signatures/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},f=async e=>{const s=new URL(`${a}${`/settings/email-signatures/default/${e}/`}`);return(0,l.f)(s.toString(),{method:"PUT"})},y=async()=>{const e=new URL(`${a}/sms-templates/`);return(0,l.f)(e.toString(),{method:"GET"})},b=async e=>{const s=new URL(`${a}${`/sms-templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},_=async e=>{const s={method:"POST",body:e},t=new URL(`${a}/sms-templates/`);return(0,l.f)(t.toString(),s)},C=async(e,s)=>{const t={method:"PUT",body:s},n=new URL(`${a}${`/sms-templates/${e}/`}`);return(0,l.f)(n.toString(),t)},N=async e=>{const s=new URL(`${a}${`/sms-templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},A=async e=>{const s=new URL(`${a}${`/proposals/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},w=async()=>{const e=new URL(`${a}/references/outgoing-email/`);return(0,l.f)(e.toString(),{method:"GET"})},S=async e=>{const s=new URL(`${a}${`/settings/templates/email-templates/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})},k=async()=>{const e=new URL(`${a}/settings/proposals/`);return(0,l.f)(e.toString(),{method:"GET"})},F=async e=>{const s=new URL(`${a}${`/settings/proposals/${e}/`}`);return(0,l.f)(s.toString(),{method:"GET"})},L=async e=>{const s=new URL(`${a}${`/settings/proposals/delete/${e}/`}`);return(0,l.f)(s.toString(),{method:"DELETE"})}},81242:(e,s,t)=>{t.d(s,{A:()=>C});var l=t(65043),a=t(32952),n=t(61072),i=t(78602),o=t(14282),r=t(77918),c=t(28261),d=t(58387),m=t(75758),h=t(88060),u=t(8868),p=t(28676),x=t(74532),v=t(72052),g=t(18226),j=t(93740);const f={headerTitle:"send-email_headerTitle__50KUB",customLabel:"send-email_customLabel__r5xED",templateInfo:"send-email_templateInfo__mWkVT",bag:"send-email_bag__wtdwK",lable:"send-email_lable__+kNCa",dropdownSelect:"send-email_dropdownSelect__RY5w8",autoCompleteBox:"send-email_autoCompleteBox__fWZ7C",AutoComplete:"send-email_AutoComplete__m9YI5",bcc:"send-email_bcc__BwFzl",box:"send-email_box__Zlmer",active:"send-email_active__vEx4h",inputBox:"send-email_inputBox__NpU2b"};var y=t(81047),b=t(70579);const _=(0,b.jsxs)("span",{className:"ql-formats",children:[(0,b.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,b.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,b.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,b.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,b.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,b.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,b.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,b.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,b.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,b.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,b.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,b.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,b.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,b.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),C=e=>{var s,t,C,N;let{show:A,setShow:w,mutation:S,contactPersons:k,setPayload:F,defaultTemplateId:L,isAddingContact:E=!1}=e;const I=(0,l.useRef)(null),T=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[$,R]=(0,l.useState)(""),[B,q]=(0,l.useState)([]),[D,z]=(0,l.useState)([]),[P,U]=(0,l.useState)([]),[H,M]=(0,l.useState)(null),[V,W]=(0,l.useState)(null),[O,G]=(0,l.useState)(null),[Q,Z]=(0,l.useState)({}),[K,Y]=(0,l.useState)([]),J=(0,l.useRef)(null),X=(0,l.useRef)(null),ee=(0,l.useRef)(null),[se,te]=(0,l.useState)(!1),[le,ae]=(0,l.useState)(!1),ne=(0,l.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),ie=(0,l.useCallback)((e=>!e||0===e.length||e.every((e=>ne(e)))),[ne]),oe=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>!ne(e))):[]),[ne]),re=(0,l.useCallback)((e=>e&&0!==e.length?e.filter((e=>ne(e))):[]),[ne]),ce=(0,l.useCallback)((()=>{let e=!1;if(B.length>0){const s=oe(B);s.length>0&&(console.log("Found invalid TO emails:",s),q(re(B)),e=!0)}if(D.length>0){const s=oe(D);s.length>0&&(console.log("Found invalid CC emails:",s),z(re(D)),e=!0)}if(P.length>0){const s=oe(P);s.length>0&&(console.log("Found invalid BCC emails:",s),U(re(P)),e=!0)}return!e}),[B,D,P,oe,re]),[de,me]=(0,l.useState)(null),he=()=>{w(!1),L||(R([]),q([]),z([]),U([]),M([]),W([]),me(null))},ue=(0,c.I)({queryKey:["emailTemplate"],queryFn:y.SQ,enabled:!!A}),pe=(0,c.I)({queryKey:["getSignatureTemplates"],queryFn:y.AO,enabled:!!A}),xe=(0,c.I)({queryKey:["getOutgoingEmail"],queryFn:y.hx,enabled:!!A}),ve=(0,c.I)({queryKey:["emailQuery",de],queryFn:()=>(0,y.hS)(de),enabled:!!de,retry:1});(0,l.useEffect)((()=>{var e,s,t;null!==xe&&void 0!==xe&&xe.data&&(null!==xe&&void 0!==xe&&null!==(e=xe.data)&&void 0!==e&&e.outgoing_email&&null!==xe&&void 0!==xe&&null!==(s=xe.data)&&void 0!==s&&s.outgoing_email_verified?R(null===xe||void 0===xe||null===(t=xe.data)||void 0===t?void 0:t.outgoing_email):R("no-reply@memate.com.au"));if(!de&&null!==ue&&void 0!==ue&&ue.data&&L){var l;const e=null===ue||void 0===ue||null===(l=ue.data)||void 0===l?void 0:l.find((e=>e.type===L));e&&me(null===e||void 0===e?void 0:e.id)}}),[ue,xe,L,de]);const ge=e=>{var s,t;const l=(null===e||void 0===e||null===(s=e.query)||void 0===s?void 0:s.toLowerCase())||"";let a=null===(t=k.map((e=>e.email)))||void 0===t?void 0:t.filter((e=>e));a=a.filter((e=>!B.includes(e))),a=a.filter((e=>!D.includes(e))),a=a.filter((e=>!P.includes(e))),a=a.filter((e=>e.toLowerCase().includes(l))),Y(a)},je=()=>{ge(),J.current&&J.current.show()},fe=()=>{ge(),X.current&&X.current.show()},ye=()=>{ge(),ee.current&&ee.current.show()};return(0,l.useEffect)((()=>{if(null!==k&&void 0!==k&&k.length){var e;let s=null===(e=k.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));Y(s)}}),[k]),(0,l.useEffect)((()=>{if(B.length>0){const e=oe(B);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const s=re(B);q(s)}}}),[B,oe,re]),(0,l.useEffect)((()=>{if(D.length>0){const e=oe(D);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const s=re(D);z(s)}}}),[D,oe,re]),(0,l.useEffect)((()=>{if(P.length>0){const e=oe(P);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const s=re(P);U(s)}}}),[P,oe,re]),(0,l.useEffect)((()=>{F((e=>({...e,subject:H,email_body:V,from_email:$,to:null===B||void 0===B?void 0:B.toString(),...D.length>0&&{cc:D.toString()},...P.length>0&&{bcc:P.toString()},...O&&{signature:O}})))}),[H,V,$,B,D,P,O,F]),(0,l.useEffect)((()=>{var e,s;null!==pe&&void 0!==pe&&pe.data&&G(null===pe||void 0===pe||null===(e=pe.data)||void 0===e||null===(s=e.find((e=>e.id===T.email_signature)))||void 0===s?void 0:s.id)}),[null===pe||void 0===pe?void 0:pe.data,T.email_signature]),(0,l.useEffect)((()=>{var e,s;W((null===ve||void 0===ve||null===(e=ve.data)||void 0===e?void 0:e.body)||""),M(null===ve||void 0===ve||null===(s=ve.data)||void 0===s?void 0:s.subject),Z((e=>({...e,subject:!1}))),Z((e=>({...e,text:!1})))}),[null===ve||void 0===ve?void 0:ve.data]),(0,b.jsxs)(a.A,{show:A,centered:!0,onHide:he,className:"invoice-form",size:"lg",children:[(0,b.jsx)(a.A.Header,{closeButton:!0,children:(0,b.jsx)("div",{className:`${f.modalHeader}`,children:(0,b.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,b.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${f.headerTitle}`,children:"Send email"})})})}),(0,b.jsxs)(a.A.Body,{children:[(0,b.jsxs)(n.A,{children:[(0,b.jsxs)(i.A,{sm:6,className:"mb-3",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"FROM"}),(0,b.jsx)(h.m,{options:xe&&(null===xe||void 0===xe?void 0:xe.data)&&[{value:null===xe||void 0===xe||null===(s=xe.data)||void 0===s?void 0:s.outgoing_email,label:`${null===xe||void 0===xe||null===(t=xe.data)||void 0===t?void 0:t.outgoing_email}`}]||[],className:(0,d.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{R(e.value),Z((e=>({...e,from:!1})))},value:$,filterInputAutoFocus:!0})]}),(null===Q||void 0===Q?void 0:Q.from)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,b.jsx)(i.A,{sm:6,className:"mb-3",children:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"Templates"}),(0,b.jsx)(h.m,{options:ue&&(null===(C=ue.data)||void 0===C?void 0:C.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,d.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{me(e.value)},value:de,loading:null===ue||void 0===ue?void 0:ue.isFetching,filterInputAutoFocus:!0,scrollHeight:"380px"}),(0,b.jsx)("div",{className:f.templateInfo,onClick:e=>I.current.toggle(e),children:(0,b.jsx)(r.A,{size:16,color:"#737374ff"})}),(0,b.jsxs)(g.j,{ref:I,children:[(0,b.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,b.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,b.jsx)("br",{})," Profile Settings > Templates > Email",(0,b.jsx)("br",{})," Templates."]})]})]})})]}),(0,b.jsxs)(n.A,{children:[(0,b.jsxs)(i.A,{sm:12,className:"mb-3",children:[(0,b.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,b.jsxs)("div",{style:{position:"relative"},className:f.autoCompleteBox,children:[(0,b.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"TO"}),(0,b.jsx)(m.j,{ref:J,value:B,completeMethod:ge,onChange:e=>{q(e.value),Z((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:K,onClick:je,onFocus:je,onKeyUp:e=>{const s=e.target.value;if(s.includes(",")||"Enter"===e.key){const t=s.split(/[\s,]+/).filter((e=>e)),l=t.filter((e=>ne(e)));q((e=>[...new Set([...e,...l])])),l.length===t.length&&l.length>0&&Z((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const s=e.target.value.trim();s&&(ne(s)?(q((e=>[...new Set([...e,s])])),Z((e=>({...e,to:!1,toInvalid:!1})))):Z((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,d.A)(f.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,b.jsx)(o.A,{className:(0,d.A)(f.box,{[f.active]:se}),onClick:()=>{te(!se),z([])},children:"CC"}),(0,b.jsx)(o.A,{className:(0,d.A)(f.box,{[f.active]:le}),onClick:()=>{ae(!le),U([])},children:"BCC"})]}),(null===Q||void 0===Q?void 0:Q.to)&&!(null!==Q&&void 0!==Q&&Q.toInvalid)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===Q||void 0===Q?void 0:Q.toInvalid)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===Q||void 0===Q?void 0:Q.invalidToEmails)&&Q.invalidToEmails.length>0&&(0,b.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidToEmails.join(", ")]})]})]}),se&&(0,b.jsxs)(i.A,{sm:6,className:"mb-3",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"CC"}),(0,b.jsx)(m.j,{ref:X,value:D,completeMethod:ge,onChange:e=>{z(e.value),Z((e=>({...e,cc:!1})))},multiple:!0,suggestions:K,onClick:fe,onFocus:fe,onKeyUp:e=>{const s=e.target.value;if(s.includes(",")||"Enter"===e.key){const t=s.split(/[\s,]+/).filter((e=>e)),l=t.filter((e=>ne(e)));z((e=>[...new Set([...e,...l])])),l.length===t.length&&Z((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const s=e.target.value.trim();s&&(ne(s)?(z((e=>[...new Set([...e,s])])),Z((e=>({...e,cc:!1})))):Z((e=>({...e,cc:!0}))),e.target.value="")},className:(0,d.A)(f.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===Q||void 0===Q?void 0:Q.cc)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===Q||void 0===Q?void 0:Q.invalidCcEmails)&&Q.invalidCcEmails.length>0&&(0,b.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidCcEmails.join(", ")]})]})]}),le&&(0,b.jsxs)(i.A,{sm:6,className:"mb-3",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"BCC"}),(0,b.jsx)(m.j,{ref:ee,value:P,completeMethod:ge,onChange:e=>{U(e.value),Z((e=>({...e,bcc:!1})))},multiple:!0,suggestions:K,onClick:ye,onFocus:ye,onKeyUp:e=>{const s=e.target.value;if(s.includes(",")||"Enter"===e.key){const t=s.split(/[\s,]+/).filter((e=>e)),l=t.filter((e=>ne(e)));U((e=>[...new Set([...e,...l])])),l.length===t.length&&Z((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const s=e.target.value.trim();s&&(ne(s)?(U((e=>[...new Set([...e,s])])),Z((e=>({...e,bcc:!1})))):Z((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,d.A)(f.AutoComplete,f.bcc,"w-100"),placeholder:"BCC"})]}),(null===Q||void 0===Q?void 0:Q.bcc)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===Q||void 0===Q?void 0:Q.invalidBccEmails)&&Q.invalidBccEmails.length>0&&(0,b.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidBccEmails.join(", ")]})]})]}),(0,b.jsxs)(i.A,{sm:12,className:"mb-2",children:[(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"SUBJECT"}),(0,b.jsxs)(p.C,{children:[(0,b.jsx)(x.m,{children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,b.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,b.jsx)(v.S,{value:H,className:(0,d.A)(f.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{M(e.target.value),Z((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===Q||void 0===Q?void 0:Q.subject)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,b.jsxs)(i.A,{sm:12,className:"mb-3",children:[(0,b.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,d.A)(f.lable),children:"Message"}),(0,b.jsx)(x.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,b.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,b.jsx)(u.K,{style:{minHeight:"150px"},headerTemplate:_,value:V,placeholder:"Enter a description...",onTextChange:e=>{W(e.htmlValue),Z((e=>({...e,text:!1})))}})]}),(null===Q||void 0===Q?void 0:Q.text)&&(0,b.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,b.jsx)(i.A,{sm:12,children:(0,b.jsxs)("div",{style:{position:"relative"},children:[(0,b.jsx)("label",{className:(0,d.A)(f.customLabel),children:"Signature"}),(0,b.jsx)(h.m,{options:pe&&(null===(N=pe.data)||void 0===N?void 0:N.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,d.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{G(e.value)},value:O,loading:null===pe||void 0===pe?void 0:pe.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,b.jsxs)(a.A.Footer,{className:"d-flex justify-content-between",children:[(0,b.jsx)("span",{}),(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,b.jsxs)(o.A,{className:"outline-button",onClick:he,children:["Cancel"," "]}),(0,b.jsxs)(o.A,{disabled:null===S||void 0===S?void 0:S.isPending,className:"solid-button",onClick:async()=>{let e=0;Z({});if(ce()||console.log("Some emails were invalid and have been cleaned"),$||(++e,Z((e=>({...e,from:!0})))),0===(null===B||void 0===B?void 0:B.length))++e,Z((e=>({...e,to:!0})));else if(!ie(B)){++e;const s=oe(B);console.log("Invalid TO emails:",s),Z((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:s})))}if(D.length>0&&!ie(D)){++e;const s=oe(D);console.log("Invalid CC emails:",s),Z((e=>({...e,cc:!0,invalidCcEmails:s})))}if(P.length>0&&!ie(P)){++e;const s=oe(P);console.log("Invalid BCC emails:",s),Z((e=>({...e,bcc:!0,invalidBccEmails:s})))}H||(++e,Z((e=>({...e,subject:!0})))),V||(++e,Z((e=>({...e,text:!0})))),e||S.mutate({subject:H,email_body:V,from_email:$,to:null===B||void 0===B?void 0:B.toString(),...D.length>0&&{cc:D.toString()},...P.length>0&&{bcc:P.toString()},...O&&{signature:O}})},children:["Send"," ",((null===S||void 0===S?void 0:S.isPending)||E)&&(0,b.jsx)(j.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})}},83230:(e,s,t)=>{t.r(s),t.d(s,{default:()=>At});var l=t(65043),a=t(27417),n=t(49367),i=t(64196),o=t(95192),r=t(83627),c=t(22636),d=t(52572),m=t(72413),h=t(38161),u=t(55003),p=t(35475),x=t(28261),v=t(65148),g=t(16484),j=t(748),f=t(18226),y=t(93740),b=t(14282),_=t(56328),C=t(18091),N=t(56682),A=t(44713),w=t(38345),S=t(1607),k=t(94819),F=t(50565),L=t(17392),E=t(88059),I=t(37970),T=t(67046),$=t(47097),R=t(20701);const B=()=>(0,$.n)({mutationFn:e=>(async e=>{const s=`/quotes/${e}/delete/`;return(0,R.y)(s,{method:"DELETE"})})(e),onSuccess:()=>{_.oR.success("Quotation deleted successfully")},onError:e=>{console.error("Error deleting sale quotation:",e),_.oR.error("Failed to delete deleteSaleQuotation. Please try again.")}});var q=t(59638),D=t(11520),z=t(81242),P=t(70579);const U=e=>{var s,t,a;let{viewShow:n,setViewShow:i,clientId:o,projectId:r,projectCardData:c}=e;const[,d]=(0,l.useState)({}),[m,h]=(0,l.useState)(!1);function u(e){if(!e)return"";return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const p=(0,x.I)({queryKey:["getClientById",o],queryFn:()=>(0,q.EZ)(o),enabled:!!o&&n,retry:1}),v=[...(null===p||void 0===p||null===(s=p.data)||void 0===s?void 0:s.contact_persons)||[],...null!==p&&void 0!==p&&null!==(t=p.data)&&void 0!==t&&t.email?[{email:null===p||void 0===p||null===(a=p.data)||void 0===a?void 0:a.email}]:[]],g=(0,$.n)({mutationFn:e=>(0,D.ky)(r,e),onSuccess:async()=>{await(async()=>{h(!0);const e={type:"E",date:u(new Date((new Date).toLocaleString("en-US",{timeZone:"Australia/Sydney"}))),note:"Contacted by Email."};try{await(0,T.oe)(r,e)}catch(s){h(!1),console.error("Error while saving:",s),_.oR.error("Failed to add contact. Please try again.")}finally{h(!1)}})(),i(!1),c(),_.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),_.oR.error("Failed to send email. Please try again.")}});return(0,P.jsx)(z.A,{show:n,setShow:i,mutation:g,contactPersons:v,setPayload:d,defaultTemplateId:"Resend Quote",isAddingContact:m})};var H=t(58387),M=t(55797);const V="sale-history_modal__GF6MN",W="sale-history_modalHeader__WvZhi",O="sale-history_headerTitle__o4ot5",G="sale-history_title__K+lKo",Q="sale-history_historyBox__mPHuV";var Z=t(20793);const K=e=>{let{history:s,setHistory:t}=e;const[a,n]=(0,l.useState)(!!s),i=(0,P.jsx)("div",{className:`${W}`,children:(0,P.jsx)("span",{className:`white-space-nowrap ${O}`,children:"History"})});return(0,P.jsx)(M.l,{visible:a,modal:!0,header:i,className:`${V} custom-modal`,onHide:()=>t(null),children:(0,P.jsxs)("div",{className:"d-flex justify-content-start flex-wrap gap-4 align-items-center",children:[Object.entries(s).map((e=>{let[s,t]=e;return(0,P.jsxs)("div",{className:(0,H.A)(Q,"d-flex align-items-center gap-1"),children:[(0,P.jsx)(d.A,{color:"#667085",size:18}),(0,P.jsx)(p.N_,{to:t,target:"_blank",children:s})]},s)})),0===Object.entries(s).length&&(0,P.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column w-100",children:[(0,P.jsx)("img",{src:Z,alt:"no-data"}),(0,P.jsx)("h2",{className:(0,H.A)(G),children:"No history found"})]})]})})},Y=e=>{let{saleUniqueId:s,clientId:t,refreshData:a,status:n,salesHistory:i}=e;const[o,r]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),[u,p]=(0,l.useState)(!1),x=B(),v=()=>{r(null)},g=[{label:"Resend",icon:1===c?(0,P.jsx)(y.p,{style:{width:"20px",height:"20px"}}):(0,P.jsx)(C.A,{color:"#344054",size:20})},{label:"History",icon:(0,P.jsx)(N.A,{color:"#344054",size:20})},{label:"Print Label",icon:(0,P.jsx)(A.A,{color:"#344054",size:20})},{label:"Project Card",icon:(0,P.jsx)(w.A,{color:"#344054",size:20})},{label:"Replicate",icon:4===c?(0,P.jsx)(y.p,{style:{width:"20px",height:"20px",position:"absolute",right:"15px",top:"10px"}}):(0,P.jsx)(S.A,{color:"#344054",size:20})},..."Draft"===n?[{label:"Delete",icon:5===c?(0,P.jsx)(y.p,{style:{width:"20px",height:"20px",position:"absolute",right:"15px",top:"10px"}}):(0,P.jsx)(k.A,{size:20})}]:[]];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(L.A,{"aria-label":"more",id:"long-button","aria-controls":o?"long-menu":void 0,"aria-expanded":o?"true":void 0,"aria-haspopup":"true",onClick:e=>r(e.currentTarget),children:(0,P.jsx)(F.A,{size:24,color:"#667085"})}),(0,P.jsx)(E.A,{id:"long-menu",anchorEl:o,open:Boolean(o),onClose:v,PaperProps:{style:{borderBottom:"1px solid #EAECF0",width:"215px",padding:"0"}},children:g.map((e=>(0,P.jsxs)(I.A,{className:"LmenuList d-flex justify-content-between",onClick:t=>(async(e,t)=>{if("Replicate"===t.label)try{d(4),await(0,T.L)(s),a(),v()}catch(l){console.error("Error fetching duplicate data:",l)}finally{d(null)}else"Resend"===t.label?(p(!0),r(null)):"Print Label"===t.label?window.open(`/api/v1/sales/${s}/label/`,"_blank"):"Project Card"===t.label?window.open(`/api/v1/project-card/${s}/pdf/`,"_blank"):"Delete"===t.label&&s?(d(5),await x.mutateAsync(s),d(null),a()):"History"===t.label&&(h(i),r(null))})(0,e),children:[e.label,e.icon]},s+e.label)))}),(0,P.jsx)(U,{projectId:s,clientId:t,viewShow:u,setViewShow:p,projectCardData:a}),m&&(0,P.jsx)(K,{history:m,setHistory:h})]})};var J=t(6091),X=t(62477),ee=t(92719),se=t(56741),te=t(37753),le=t(33361),ae=t(77527),ne=t(9634),ie=t(85865),oe=t(60446),re=t.n(oe),ce=t(670),de=t(599),me=t(29853),he=t(32952),ue=t(88490);const pe=t.p+"static/media/sale-01.74c52636eaacc72e4c5a7a89e51203b5.svg",xe=e=>{let{saleUniqueIdold:s,contactRefresh:t,step:a,created:n,type:i}=e;const[o,c]=(0,l.useState)("E"),[d,m]=(0,l.useState)(null),[h,u]=(0,l.useState)(""),[p,x]=(0,l.useState)(!1),[v,g]=(0,l.useState)({}),[j,f]=(0,l.useState)(!1),y=500,_=(0,l.useCallback)((()=>{x(!1),f(!1),g({}),u(""),m(null),c("E")}),[]),C=(0,l.useCallback)((()=>x(!0)),[]);function N(e){if(!e)return"";return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const A=(0,l.useCallback)((async()=>{if(!(()=>{const e={};return d&&re()(d).isValid()||(e.date="Please select a valid date"),h.trim()?h.length<3?e.note="Note must be at least 3 characters":h.length>y&&(e.note="Note must not exceed 500 characters"):e.note="Note is required",g(e),0===Object.keys(e).length})())return;if(!s)return void g({general:"Sale ID is missing"});f(!0);const e={type:o,date:N(d),note:h.trim()};try{await(0,T.oe)(s,e),t(),_()}catch(l){f(!1),console.error("Error while saving:",l),g({general:"Failed to save contact. Please try again."})}finally{f(!1)}}),[o,d,h,s,t,_]),w=[{name:"Email",value:"E",icon:(0,P.jsx)(le.A,{size:20})},{name:"Phone",value:"P",icon:(0,P.jsx)(te.A,{size:20})},{name:"Meeting",value:"M",icon:(0,P.jsx)(ae.A,{size:20})}],S=0===a?Date.now()-1e3*n>=2592e5:Date.now()-1e3*i[a-1].date>=2592e5;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(b.A,{variant:"ContactAdd",onClick:C,children:(0,P.jsx)(r.A,{color:"#1AB2FF",className:""+(S?"vibrate":""),size:16,style:{width:"16px",height:"16px"}})}),(0,P.jsxs)(he.A,{show:p,onHide:_,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"SalesContact salesTableWrap",animation:!1,children:[(0,P.jsx)(he.A.Header,{className:"SalesContact mb-0 pb-0 border-0",closeButton:!0,children:(0,P.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,P.jsxs)("span",{children:[(0,P.jsx)("div",{className:"iconOutStyle",children:(0,P.jsx)("div",{className:"iconinStyle",children:(0,P.jsx)("div",{className:"iconinnerStyle",children:(0,P.jsx)("img",{src:pe,alt:"saleContact"})})})}),"Sales Contact"]})})}),(0,P.jsx)(he.A.Body,{children:(0,P.jsxs)("div",{className:"ContactModel",children:[(0,P.jsxs)("div",{className:"ContactModelIn",children:[(0,P.jsxs)(me.A.Label,{children:["Contact Type",(0,P.jsx)("sup",{className:"required",children:"*"})]}),(0,P.jsx)(de.A,{className:"radioSelectButton",children:w.map(((e,s)=>(0,P.jsx)("div",{className:"radioSelectButtons",children:(0,P.jsxs)(ue.A,{id:`radio-${s}`,type:"radio",variant:o===e.value?"selectBox":"outlineBox",name:"radio",value:e.value,checked:o===e.value,onChange:e=>c(e.currentTarget.value),disabled:j,children:[e.name," ",e.icon]})},s)))}),(0,P.jsxs)(me.A.Label,{className:"flexRemove mt-3 mb-0",children:["Date",(0,P.jsx)("sup",{className:"required",children:"*"})]}),(0,P.jsx)(ce.V,{value:d,onChange:e=>m(e.value),dateFormat:"dd/mm/yy",disabled:j,locale:"en",className:"w-100 outline-none border rounded",style:{height:"46px",width:"230px",overflow:"hidden"},showIcon:!0,showButtonBar:!0,icon:(0,P.jsx)(ne.A,{color:"#667085",size:20,style:{position:"absolute",top:"6px"}}),inputStyle:{width:"88%"},placeholder:"DD/MM/YY"}),v.date&&(0,P.jsx)("div",{className:"error-message mt-2",children:v.date}),(0,P.jsxs)(me.A.Label,{className:"mt-3",children:["Note",(0,P.jsx)("sup",{className:"required",children:"*"})]}),(0,P.jsxs)(ie.A,{sx:{p:0},children:[(0,P.jsx)(me.A.Control,{as:"textarea",placeholder:"Enter a description...",style:{height:"152px"},value:h,onChange:e=>u(e.target.value),maxLength:y,isInvalid:!!v.note}),(0,P.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,P.jsx)("small",{className:v.note?"error-message":"text-muted",children:v.note||`${h.length}/500 characters`})})]}),v.general&&(0,P.jsx)("div",{className:"text-danger mt-2",children:v.general})]}),(0,P.jsxs)("div",{className:"popoverbottom mt-0 pt-4",children:[(0,P.jsx)(b.A,{className:"closebox",onClick:_,disabled:j,children:"Cancel"}),(0,P.jsx)(b.A,{className:"savebox",onClick:A,disabled:j,children:j?"Saving...":"Save"})]})]})})]})]})};const ve=t.p+"static/media/calendargradi.b3116ec64a97e5fef4c8d79e73c4993a.svg";const ge=t.p+"static/media/mailgradi.2164d17057c769448ddf96d8f89a722a.svg";const je=t.p+"static/media/phonecallgra.20daa5d6965e95d0209bd3a0ffd66365.svg",fe="sales_footerwrap__Ymbwg",ye="sales_cancelbut__BhO13",be="sales_padding_24__nSSrM",_e="sales_paddingLR_24__oXCU4",Ce=function(e){arguments.length>1&&void 0!==arguments[1]||Intl.DateTimeFormat().resolvedOptions().timeZone;const s=new Date(1e3*e);return new Intl.DateTimeFormat("en-AU",{day:"numeric",month:"short",year:"numeric",timeZone:"Australia/Sydney"}).format(s)},Ne=e=>{let{saleUniqueId:s,type:t,refreshData:a,created:n}=e;const[i,o]=l.useState(null),r=()=>{o(null)};return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)("div",{className:"innerTableStyle",children:(0,P.jsxs)("ul",{children:[null===t||void 0===t?void 0:t.map(((e,s)=>(0,P.jsx)("li",{children:(0,P.jsx)(J.A,{children:(0,P.jsx)(X.A,{trigger:"click",rootClose:!0,placement:"bottom",show:i===s,onHide:r,overlay:(0,P.jsx)(ee.A,{id:`popover-trigger-click-root-close-${s}`,className:"salesTableWrap",title:"",children:(0,P.jsxs)("div",{className:"contactInfo",children:[(0,P.jsxs)("div",{className:`contactInfoflex ${be}`,children:[(0,P.jsxs)("div",{className:"iconStyle",children:["Phone"===e.type&&(0,P.jsx)("img",{src:je,alt:"phonecallgra"}),"Email"===e.type&&(0,P.jsx)("img",{src:ge,alt:"mailgradi"}),"Meeting"===e.type&&(0,P.jsx)("img",{src:ve,alt:"calendargradi"})]}),(0,P.jsx)(b.A,{variant:"link",className:"ClosePopover",onClick:r,children:(0,P.jsx)(se.A,{color:"#667085",size:24})})]}),(0,P.jsxs)("div",{className:_e,children:[(0,P.jsx)("p",{className:"contactdate",children:Ce(e.date)}),(0,P.jsx)("p",{children:e.note})]}),(0,P.jsx)("div",{className:fe,children:(0,P.jsx)(b.A,{onClick:r,className:ye,children:"Cancel"})})]})}),children:(0,P.jsx)(b.A,{variant:"saleContacte",onClick:()=>(e=>{const s=document.querySelectorAll(".ClosePopover");s.length>0&&s.forEach((e=>e.click())),o(i===e?null:e)})(s),children:(0,P.jsxs)(P.Fragment,{children:["Phone"===e.type&&(0,P.jsx)(te.A,{color:"#344054",size:16}),"Email"===e.type&&(0,P.jsx)(le.A,{color:"#344054",size:16}),"Meeting"===e.type&&(0,P.jsx)(ae.A,{color:"#344054",size:16}),(0,P.jsx)("div",{children:Ce(e.date)})]})})})},s)},s))),t&&t.length<3&&(0,P.jsx)("li",{children:(0,P.jsx)("span",{className:"contactButList",children:(0,P.jsx)("div",{className:"contactButListIn1",children:(0,P.jsx)("div",{className:"contactButListIn2",children:(0,P.jsx)(xe,{step:t.length,created:n,type:t,saleUniqueIdold:s,contactRefresh:()=>{a()}})})})})})]})})})};var Ae=t(66415);const we=e=>{let{percentage:s,selectlabel:t}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:"progress","data-percentage":s,children:[(0,P.jsx)("span",{className:"progress-left",children:(0,P.jsx)("span",{className:"progress-bar"})}),(0,P.jsx)("span",{className:"progress-right",children:(0,P.jsx)("span",{className:"progress-bar"})}),(0,P.jsx)("div",{className:"progress-value",children:(0,P.jsx)("div",{children:null===s?"0%":s+"%"})})]}),(0,P.jsx)("span",{children:t})]})},Se=e=>{let{percentage:s,label:t,gradient:l,onSelect:a,isActive:n}=e;return(0,P.jsxs)("li",{className:"option "+(n?"active":""),"data-percentage":s,onClick:a,children:[(0,P.jsx)("input",{className:"radio-custom",name:"radio-group",type:"radio",checked:n,onChange:()=>{}}),(0,P.jsx)("em",{className:"radio-custom-label"}),(0,P.jsxs)("div",{className:"progressWrapper",children:[(0,P.jsxs)("div",{className:"labelInfo",children:[(0,P.jsx)("strong",{children:t}),(0,P.jsx)("div",{className:"progress-light-grey",children:(0,P.jsx)("div",{className:"progress-container progress-color progress-center","aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100",style:{"--value":s,background:l},children:(0,P.jsxs)("span",{children:[s,"%"]})})})]}),(0,P.jsxs)("label",{children:[s,"%"]})]})]})},ke=e=>{let{progressName1:s,progressPercentage1:t,salesUniqId1:a,refreshData:n}=e;const[i,o]=(0,l.useState)({text:s,percentage:t,background:"linear-gradient(90deg, #9E77ED 10%, transparent 10%)"}),[r,c]=(0,l.useState)(!1),[d,m]=(0,l.useState)(i.percentage);return(0,P.jsxs)("div",{className:"select-menu",children:[(0,P.jsxs)("div",{className:"select-btn",onClick:()=>{document.querySelectorAll(".options.active").forEach((e=>e.classList.remove("active"))),c((e=>!e))},children:[(0,P.jsx)(we,{percentage:i.percentage,selectlabel:i.text}),(0,P.jsx)(Ae.A,{color:"#98A2B3",size:16})]}),(0,P.jsx)("ul",{className:"options "+(r?"active":""),children:[{percentage:10,label:"Lead",gradient:"linear-gradient(90deg, #1AB2FF 10%, transparent 10%)"},{percentage:20,label:"Prospect",gradient:"linear-gradient(90deg, #1AB2FF 20%, transparent 20%)"},{percentage:40,label:"Proposal sent",gradient:"linear-gradient(90deg, #1AB2FF 40%, transparent 40%)"},{percentage:60,label:"Negotiation",gradient:"linear-gradient(90deg, #1AB2FF 60%, transparent 60%)"},{percentage:80,label:"Awaiting approval",gradient:"linear-gradient(90deg, #1AB2FF 80%, transparent 80%)"}].map((e=>{return(0,P.jsx)(Se,{percentage:e.percentage,label:e.label,gradient:e.gradient,onSelect:()=>(async e=>{try{const s=a,t=e.percentage;await(0,T.V3)(s,t),o({text:e.label,percentage:e.percentage,background:e.gradient}),m(t),n(),c(!1)}catch(s){console.error("Error updating sales lead:",s)}})(e),isActive:(s=e.percentage,s===d)},e.percentage);var s}))})]})};var Fe=t(72970),Le=t(76083),Ee=t(74802),Ie=t(96446),Te=t(11906),$e=t(63977);const Re=t.p+"static/media/archive.a93d5d4bb5e805d41614288a785b8375.svg";var Be=t(97483);const qe=e=>{let{saleUniqueId:s,LostQuote:t,quoteType:a,onRemoveRow:n}=e;const[i,o]=l.useState(!1),[,r]=(0,l.useState)(!1),[c]=(0,l.useState)({content:"",type:"success"}),d=()=>{setTimeout((()=>{r(!1),o(!1)}),1e3)};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Te.A,{onClick:()=>o(!0),className:`quoteLost message ${c.type}`,children:(0,P.jsx)(Fe.A,{color:"#D92D20",size:16})}),(0,P.jsx)($e.A,{open:i,onClose:d,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,P.jsx)(Ie.A,{className:"modelStyleBox QuoteLost salesTableWrap  QuoteActionStyle",sx:{width:460},children:(0,P.jsxs)(ie.A,{id:"modal-modal-title",variant:"h6",component:"h2",children:[(0,P.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,P.jsxs)("span",{children:[(0,P.jsxs)("div",{className:"iconOutStyleflex",children:[(0,P.jsxs)("div",{className:"flexIconWrap",children:[(0,P.jsx)("div",{className:"iconOutStyle",children:(0,P.jsx)("div",{className:"iconinStyle",children:(0,P.jsx)("div",{className:"iconinnerStyle",children:(0,P.jsx)(Le.A,{color:"#F04438",size:24})})})}),(0,P.jsx)("div",{className:"quoteStyleHeading",children:"lost"===a&&(0,P.jsx)(P.Fragment,{children:`Quote Lost ${t}`})})]}),(0,P.jsx)(L.A,{edge:"end",color:"inherit",onClick:d,"aria-label":"close",children:(0,P.jsx)(Ee.A,{color:"#667085",size:24})})]}),(0,P.jsxs)("div",{className:"stepBoxStyle",children:[(0,P.jsxs)("ul",{children:[(0,P.jsxs)("li",{children:[(0,P.jsx)("strong",{children:(0,P.jsx)("img",{src:Be.A,alt:"SalesIcon"})}),(0,P.jsx)("span",{className:"lightColorStyle",children:"Sales"})]}),(0,P.jsxs)("li",{children:[(0,P.jsx)("em",{className:"lineHor"}),(0,P.jsx)("strong",{children:(0,P.jsxs)("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,P.jsx)("g",{clipPath:"url(#clip0_13244_72509)",children:(0,P.jsx)("path",{d:"M4.31518 0.577465C4.6602 0.577465 4.93493 0.727048 5.13939 1.02621C5.3481 1.31938 5.45246 1.75914 5.45246 2.3455V5.45975H4.31518V2.71346C4.31518 2.40832 4.27473 2.18694 4.1938 2.04933C4.11287 1.91172 3.9936 1.84291 3.836 1.84291C3.6784 1.84291 3.54636 1.93266 3.43988 2.11215C3.33765 2.28566 3.28654 2.54594 3.28654 2.89296V5.45975H2.15566V2.71346C2.15566 2.40832 2.1152 2.18694 2.03427 2.04933C1.95334 1.91172 1.83407 1.84291 1.67648 1.84291C1.51888 1.84291 1.38684 1.93266 1.28035 2.11215C1.17813 2.28566 1.12701 2.54594 1.12701 2.89296V5.45975H-0.0102539V0.694137H1.08228V1.34032H1.10784C1.35915 0.831748 1.70842 0.577465 2.15566 0.577465C2.38567 0.577465 2.58586 0.64627 2.75624 0.783889C2.92661 0.915517 3.05866 1.11595 3.15237 1.3852C3.30144 1.13989 3.46543 0.945429 3.64433 0.801836C3.82323 0.652252 4.04684 0.577465 4.31518 0.577465ZM9.16305 4.02378C9.12046 4.26909 9.03099 4.51141 8.8947 4.75074C8.7584 4.98408 8.5667 5.18153 8.3197 5.34307C8.07264 5.49864 7.77023 5.57642 7.4124 5.57642C6.84593 5.57642 6.40293 5.35504 6.08346 4.91229C5.76405 4.46953 5.6043 3.86224 5.6043 3.09041C5.6043 2.30661 5.76187 1.69333 6.07711 1.25058C6.39652 0.801836 6.83952 0.577465 7.40605 0.577465C7.96399 0.577465 8.40276 0.795854 8.72217 1.23262C9.04593 1.6694 9.20776 2.29763 9.20776 3.11733L9.2014 3.39555H6.77352C6.77352 3.74856 6.83099 4.02977 6.94599 4.23917C7.06528 4.44261 7.22076 4.54432 7.4124 4.54432C7.58705 4.54432 7.72123 4.48448 7.81493 4.36482C7.90864 4.24516 7.9704 4.09857 8.00023 3.92506L9.16305 4.02378ZM7.40605 1.58264C7.21864 1.58264 7.06952 1.66641 6.95881 1.83393C6.84805 1.99548 6.7884 2.21088 6.77987 2.48012H8.03858C8.03005 2.21088 7.96828 1.99548 7.85328 1.83393C7.74252 1.66641 7.59346 1.58264 7.40605 1.58264ZM4.31518 6.3615C4.6602 6.3615 4.93493 6.51109 5.13939 6.81024C5.3481 7.10342 5.45246 7.54316 5.45246 8.12957V11.2438H4.31518V8.49752C4.31518 8.19237 4.27473 7.97101 4.1938 7.83335C4.11287 7.69577 3.9936 7.62694 3.836 7.62694C3.6784 7.62694 3.54636 7.71668 3.43988 7.89623C3.33765 8.06967 3.28654 8.32995 3.28654 8.67699V11.2438H2.15566V8.49752C2.15566 8.19237 2.1152 7.97101 2.03427 7.83335C1.95334 7.69577 1.83407 7.62694 1.67648 7.62694C1.51888 7.62694 1.38684 7.71668 1.28035 7.89623C1.17813 8.06967 1.12701 8.32995 1.12701 8.67699V11.2438H-0.0102539V6.47817H1.08228V7.12436H1.10784C1.35915 6.61579 1.70842 6.3615 2.15566 6.3615C2.38567 6.3615 2.58586 6.43031 2.75624 6.56793C2.92661 6.69955 3.05866 6.89999 3.15237 7.16923C3.30144 6.92393 3.46543 6.72947 3.64433 6.58587C3.82323 6.43629 4.04684 6.3615 4.31518 6.3615ZM7.92358 11.2438C7.85964 11.1361 7.8277 10.9057 7.8277 10.5528C7.74681 10.804 7.60623 11.0014 7.40605 11.145C7.21011 11.2887 6.98434 11.3605 6.72876 11.3605C6.53287 11.3605 6.34758 11.3036 6.17293 11.1899C5.99828 11.0763 5.85776 10.9147 5.75123 10.7053C5.64476 10.4959 5.59152 10.2476 5.59152 9.96039C5.59152 9.47577 5.7044 9.11377 5.93017 8.87448C6.15587 8.6351 6.49876 8.47356 6.95881 8.38977C7.19305 8.34193 7.37193 8.29706 7.49546 8.25517C7.61899 8.20733 7.70417 8.15643 7.75105 8.10264C7.80217 8.04281 7.8277 7.96498 7.8277 7.86929C7.8277 7.71965 7.78511 7.60604 7.69993 7.5282C7.61899 7.4445 7.50399 7.4026 7.35493 7.4026C7.21864 7.4026 7.09934 7.4564 6.99711 7.56414C6.89487 7.67181 6.82252 7.82443 6.77987 8.02183L5.7257 7.86929C5.79811 7.39657 5.98128 7.02863 6.27517 6.76537C6.56905 6.49612 6.93534 6.3615 7.37411 6.3615C7.89799 6.3615 8.29411 6.5051 8.56246 6.79229C8.83081 7.0735 8.96499 7.47441 8.96499 7.99489V10.3553C8.96499 10.6126 8.96923 10.807 8.97776 10.9386C8.99052 11.0643 9.01611 11.166 9.0544 11.2438H7.92358ZM7.8277 9.00007C7.78087 9.04197 7.70417 9.08088 7.5977 9.11675C7.49123 9.14666 7.37411 9.17657 7.24628 9.20648C6.91405 9.29622 6.74793 9.50568 6.74793 9.83471C6.74793 9.99625 6.78417 10.1249 6.85658 10.2207C6.93323 10.3104 7.03334 10.3553 7.15687 10.3553C7.25911 10.3553 7.36128 10.3224 7.46352 10.2565C7.56576 10.1908 7.65093 10.089 7.71911 9.95138C7.79152 9.80785 7.8277 9.6283 7.8277 9.41289V9.00007ZM11.3669 10.0681V11.2438C11.2988 11.2558 11.0688 11.2617 10.6769 11.2617C10.4 11.2617 10.1828 11.2288 10.0252 11.163C9.87187 11.0913 9.75687 10.9656 9.68023 10.7861C9.60781 10.6065 9.57158 10.3433 9.57158 9.99625V7.47441H9.05411V6.47817H9.57158V5.16786H10.7025V6.47817H11.3797V7.47441H10.7025V9.61938C10.7025 9.81083 10.7302 9.93345 10.7855 9.98733C10.8452 10.0412 10.9559 10.0681 11.1178 10.0681H11.3669ZM14.9363 9.80785C14.8937 10.0531 14.8042 10.2954 14.6679 10.5347C14.5316 10.7681 14.3399 10.9656 14.0929 11.1271C13.8459 11.2827 13.5435 11.3605 13.1856 11.3605C12.6192 11.3605 12.1762 11.1391 11.8567 10.6963C11.5373 10.2536 11.3775 9.64623 11.3775 8.87448C11.3775 8.09066 11.5351 7.47738 11.8503 7.03462C12.1698 6.58587 12.6128 6.3615 13.1793 6.3615C13.7372 6.3615 14.176 6.57989 14.4954 7.01666C14.8192 7.45342 14.981 8.08165 14.981 8.90133L14.9746 9.17954H12.5468C12.5468 9.53262 12.6042 9.8138 12.7192 10.0232C12.8385 10.2266 12.994 10.3283 13.1856 10.3283C13.3603 10.3283 13.4945 10.2685 13.5882 10.1489C13.6819 10.0292 13.7436 9.88263 13.7735 9.70911L14.9363 9.80785ZM13.1793 7.36666C12.9919 7.36666 12.8428 7.45045 12.732 7.61794C12.6213 7.77956 12.5616 7.99489 12.5531 8.26418H13.8118C13.8033 7.99489 13.7415 7.77956 13.6265 7.61794C13.5158 7.45045 13.3667 7.36666 13.1793 7.36666Z",fill:"url(#paint0_radial_13244_72509)"})}),(0,P.jsxs)("defs",{children:[(0,P.jsxs)("radialGradient",{id:"paint0_radial_13244_72509",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(-0.195533 0.874516) rotate(33.8103) scale(16.7787 220.176)",children:[(0,P.jsx)("stop",{stopColor:"#1AB3FF"}),(0,P.jsx)("stop",{offset:"1",stopColor:"#FFB258"})]}),(0,P.jsx)("clipPath",{id:"clip0_13244_72509",children:(0,P.jsx)("rect",{width:"15",height:"10.8451",fill:"white",transform:"translate(0 0.577465)"})})]})]})}),(0,P.jsx)("em",{className:"lineHor"})]}),(0,P.jsxs)("li",{children:[(0,P.jsx)("strong",{children:(0,P.jsx)("img",{src:Re,alt:"Archive"})}),(0,P.jsx)("span",{children:"Archive"})]})]}),(0,P.jsx)("p",{children:"Sorry to see a lost opportunity. This quote will be stored in the client's history, should you need to refer to it in the future."})]})]})}),(0,P.jsx)("div",{className:"footerBorder text-center",children:(0,P.jsx)("button",{onClick:async()=>{try{if(s){(await(0,T.Op)([s])).length?(n(),_.oR.success("Sale request has been updated to Lost!")):_.oR.error("Failed to update the sale request to Lost. Please try again.")}}catch(e){console.error("Error:",e),_.oR.error("An error occurred. Please try again.")}d(),r(!0)},children:"Archive"})})]})})})]})};var De=t(88166),ze=t(99832),Pe=t(6030),Ue=t(15129);const He=e=>{let{active:s,config:t}=e;return(0,P.jsx)(Ue.A,{active:s,config:t})},Me=e=>{let{saleUniqueId:s,wonQuote:t,quoteType:a,onRemoveRow:n}=e;const[i,o]=l.useState(!1),[r,c]=(0,l.useState)(!1),[d]=(0,l.useState)({content:"",type:"success"}),[m,h]=(0,l.useState)(!1),u=()=>{setTimeout((()=>{c(!1),o(!1)}),1e3)};return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Te.A,{onClick:()=>o(!0),className:`message quoteWon ${d.type} ${"Draft"===t}`,children:(0,P.jsx)(De.A,{color:"#079455",size:16})}),(0,P.jsx)($e.A,{open:i,onClose:u,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,P.jsx)(Ie.A,{className:"modelStyleBox QuoteWon salesTableWrap QuoteActionStyle",sx:{width:460},children:(0,P.jsxs)(ie.A,{id:"modal-modal-title",variant:"h6",component:"h2",children:[(0,P.jsx)("div",{className:"modelHeader justify-content-between align-items-start",children:(0,P.jsxs)("span",{children:[(0,P.jsxs)("div",{className:"iconOutStyleflex",children:[(0,P.jsxs)("div",{className:"flexIconWrap",children:[(0,P.jsx)("div",{className:"iconOutStyle",children:(0,P.jsx)("div",{className:"iconinStyle",children:(0,P.jsx)("div",{className:"iconinnerStyle",children:(0,P.jsx)(ze.A,{color:"#17B26A",size:24})})})}),(0,P.jsx)("div",{className:"quoteStyleHeading",children:"won"===a&&(0,P.jsx)(P.Fragment,{children:`Quote Won ${t}`})})]}),(0,P.jsx)(L.A,{edge:"end",color:"inherit",onClick:u,"aria-label":"close",children:(0,P.jsx)(Ee.A,{color:"#667085",size:24})})]}),(0,P.jsxs)("div",{className:"stepBoxStyle",children:[(0,P.jsxs)("ul",{children:[(0,P.jsxs)("li",{children:[(0,P.jsx)("strong",{children:(0,P.jsx)("img",{src:Be.A,alt:"SalesIcon"})}),(0,P.jsx)("span",{className:"lightColorStyle",children:"Sales"})]}),(0,P.jsxs)("li",{children:[(0,P.jsx)("em",{className:"lineHor"}),(0,P.jsx)("strong",{children:(0,P.jsxs)("svg",{width:"15",height:"12",viewBox:"0 0 15 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,P.jsx)("g",{clipPath:"url(#clip0_13244_72509)",children:(0,P.jsx)("path",{d:"M4.31518 0.577465C4.6602 0.577465 4.93493 0.727048 5.13939 1.02621C5.3481 1.31938 5.45246 1.75914 5.45246 2.3455V5.45975H4.31518V2.71346C4.31518 2.40832 4.27473 2.18694 4.1938 2.04933C4.11287 1.91172 3.9936 1.84291 3.836 1.84291C3.6784 1.84291 3.54636 1.93266 3.43988 2.11215C3.33765 2.28566 3.28654 2.54594 3.28654 2.89296V5.45975H2.15566V2.71346C2.15566 2.40832 2.1152 2.18694 2.03427 2.04933C1.95334 1.91172 1.83407 1.84291 1.67648 1.84291C1.51888 1.84291 1.38684 1.93266 1.28035 2.11215C1.17813 2.28566 1.12701 2.54594 1.12701 2.89296V5.45975H-0.0102539V0.694137H1.08228V1.34032H1.10784C1.35915 0.831748 1.70842 0.577465 2.15566 0.577465C2.38567 0.577465 2.58586 0.64627 2.75624 0.783889C2.92661 0.915517 3.05866 1.11595 3.15237 1.3852C3.30144 1.13989 3.46543 0.945429 3.64433 0.801836C3.82323 0.652252 4.04684 0.577465 4.31518 0.577465ZM9.16305 4.02378C9.12046 4.26909 9.03099 4.51141 8.8947 4.75074C8.7584 4.98408 8.5667 5.18153 8.3197 5.34307C8.07264 5.49864 7.77023 5.57642 7.4124 5.57642C6.84593 5.57642 6.40293 5.35504 6.08346 4.91229C5.76405 4.46953 5.6043 3.86224 5.6043 3.09041C5.6043 2.30661 5.76187 1.69333 6.07711 1.25058C6.39652 0.801836 6.83952 0.577465 7.40605 0.577465C7.96399 0.577465 8.40276 0.795854 8.72217 1.23262C9.04593 1.6694 9.20776 2.29763 9.20776 3.11733L9.2014 3.39555H6.77352C6.77352 3.74856 6.83099 4.02977 6.94599 4.23917C7.06528 4.44261 7.22076 4.54432 7.4124 4.54432C7.58705 4.54432 7.72123 4.48448 7.81493 4.36482C7.90864 4.24516 7.9704 4.09857 8.00023 3.92506L9.16305 4.02378ZM7.40605 1.58264C7.21864 1.58264 7.06952 1.66641 6.95881 1.83393C6.84805 1.99548 6.7884 2.21088 6.77987 2.48012H8.03858C8.03005 2.21088 7.96828 1.99548 7.85328 1.83393C7.74252 1.66641 7.59346 1.58264 7.40605 1.58264ZM4.31518 6.3615C4.6602 6.3615 4.93493 6.51109 5.13939 6.81024C5.3481 7.10342 5.45246 7.54316 5.45246 8.12957V11.2438H4.31518V8.49752C4.31518 8.19237 4.27473 7.97101 4.1938 7.83335C4.11287 7.69577 3.9936 7.62694 3.836 7.62694C3.6784 7.62694 3.54636 7.71668 3.43988 7.89623C3.33765 8.06967 3.28654 8.32995 3.28654 8.67699V11.2438H2.15566V8.49752C2.15566 8.19237 2.1152 7.97101 2.03427 7.83335C1.95334 7.69577 1.83407 7.62694 1.67648 7.62694C1.51888 7.62694 1.38684 7.71668 1.28035 7.89623C1.17813 8.06967 1.12701 8.32995 1.12701 8.67699V11.2438H-0.0102539V6.47817H1.08228V7.12436H1.10784C1.35915 6.61579 1.70842 6.3615 2.15566 6.3615C2.38567 6.3615 2.58586 6.43031 2.75624 6.56793C2.92661 6.69955 3.05866 6.89999 3.15237 7.16923C3.30144 6.92393 3.46543 6.72947 3.64433 6.58587C3.82323 6.43629 4.04684 6.3615 4.31518 6.3615ZM7.92358 11.2438C7.85964 11.1361 7.8277 10.9057 7.8277 10.5528C7.74681 10.804 7.60623 11.0014 7.40605 11.145C7.21011 11.2887 6.98434 11.3605 6.72876 11.3605C6.53287 11.3605 6.34758 11.3036 6.17293 11.1899C5.99828 11.0763 5.85776 10.9147 5.75123 10.7053C5.64476 10.4959 5.59152 10.2476 5.59152 9.96039C5.59152 9.47577 5.7044 9.11377 5.93017 8.87448C6.15587 8.6351 6.49876 8.47356 6.95881 8.38977C7.19305 8.34193 7.37193 8.29706 7.49546 8.25517C7.61899 8.20733 7.70417 8.15643 7.75105 8.10264C7.80217 8.04281 7.8277 7.96498 7.8277 7.86929C7.8277 7.71965 7.78511 7.60604 7.69993 7.5282C7.61899 7.4445 7.50399 7.4026 7.35493 7.4026C7.21864 7.4026 7.09934 7.4564 6.99711 7.56414C6.89487 7.67181 6.82252 7.82443 6.77987 8.02183L5.7257 7.86929C5.79811 7.39657 5.98128 7.02863 6.27517 6.76537C6.56905 6.49612 6.93534 6.3615 7.37411 6.3615C7.89799 6.3615 8.29411 6.5051 8.56246 6.79229C8.83081 7.0735 8.96499 7.47441 8.96499 7.99489V10.3553C8.96499 10.6126 8.96923 10.807 8.97776 10.9386C8.99052 11.0643 9.01611 11.166 9.0544 11.2438H7.92358ZM7.8277 9.00007C7.78087 9.04197 7.70417 9.08088 7.5977 9.11675C7.49123 9.14666 7.37411 9.17657 7.24628 9.20648C6.91405 9.29622 6.74793 9.50568 6.74793 9.83471C6.74793 9.99625 6.78417 10.1249 6.85658 10.2207C6.93323 10.3104 7.03334 10.3553 7.15687 10.3553C7.25911 10.3553 7.36128 10.3224 7.46352 10.2565C7.56576 10.1908 7.65093 10.089 7.71911 9.95138C7.79152 9.80785 7.8277 9.6283 7.8277 9.41289V9.00007ZM11.3669 10.0681V11.2438C11.2988 11.2558 11.0688 11.2617 10.6769 11.2617C10.4 11.2617 10.1828 11.2288 10.0252 11.163C9.87187 11.0913 9.75687 10.9656 9.68023 10.7861C9.60781 10.6065 9.57158 10.3433 9.57158 9.99625V7.47441H9.05411V6.47817H9.57158V5.16786H10.7025V6.47817H11.3797V7.47441H10.7025V9.61938C10.7025 9.81083 10.7302 9.93345 10.7855 9.98733C10.8452 10.0412 10.9559 10.0681 11.1178 10.0681H11.3669ZM14.9363 9.80785C14.8937 10.0531 14.8042 10.2954 14.6679 10.5347C14.5316 10.7681 14.3399 10.9656 14.0929 11.1271C13.8459 11.2827 13.5435 11.3605 13.1856 11.3605C12.6192 11.3605 12.1762 11.1391 11.8567 10.6963C11.5373 10.2536 11.3775 9.64623 11.3775 8.87448C11.3775 8.09066 11.5351 7.47738 11.8503 7.03462C12.1698 6.58587 12.6128 6.3615 13.1793 6.3615C13.7372 6.3615 14.176 6.57989 14.4954 7.01666C14.8192 7.45342 14.981 8.08165 14.981 8.90133L14.9746 9.17954H12.5468C12.5468 9.53262 12.6042 9.8138 12.7192 10.0232C12.8385 10.2266 12.994 10.3283 13.1856 10.3283C13.3603 10.3283 13.4945 10.2685 13.5882 10.1489C13.6819 10.0292 13.7436 9.88263 13.7735 9.70911L14.9363 9.80785ZM13.1793 7.36666C12.9919 7.36666 12.8428 7.45045 12.732 7.61794C12.6213 7.77956 12.5616 7.99489 12.5531 8.26418H13.8118C13.8033 7.99489 13.7415 7.77956 13.6265 7.61794C13.5158 7.45045 13.3667 7.36666 13.1793 7.36666Z",fill:"url(#paint0_radial_13244_72509)"})}),(0,P.jsxs)("defs",{children:[(0,P.jsxs)("radialGradient",{id:"paint0_radial_13244_72509",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(-0.195533 0.874516) rotate(33.8103) scale(16.7787 220.176)",children:[(0,P.jsx)("stop",{stopColor:"#1AB3FF"}),(0,P.jsx)("stop",{offset:"1",stopColor:"#FFB258"})]}),(0,P.jsx)("clipPath",{id:"clip0_13244_72509",children:(0,P.jsx)("rect",{width:"15",height:"10.8451",fill:"white",transform:"translate(0 0.577465)"})})]})]})}),(0,P.jsx)("em",{className:"lineHor"})]}),(0,P.jsxs)("li",{children:[(0,P.jsx)("strong",{children:(0,P.jsx)("img",{src:Pe.A,alt:"ManagementIcon"})}),(0,P.jsx)("span",{children:"Management"})]})]}),(0,P.jsx)("p",{children:"Great, another quote converted into a project."})]})]})}),(0,P.jsxs)("div",{className:"footerBorder text-center",children:[(0,P.jsxs)("button",{disabled:m,onClick:async()=>{try{if(s){h(!0);if((await(0,T.WG)([s])).length){n(),document.querySelector(".management-notification").style.display="block";let e=parseInt(document.querySelector(".management-notification-count").innerText||0);document.querySelector(".management-notification-count").innerHTML=e+1,_.oR.success("Successfully moved to Management!")}else _.oR.error("Failed to move to Management. Please try again.")}}catch(e){_.oR.error("An error occurred. Please try again.")}finally{h(!1)}u(),c(!0)},children:["Move to the Management ",m&&(0,P.jsx)(y.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,P.jsx)(He,{active:r,config:{}})]})]})})})]})};var Ve=t(46679),We=t(58415);const Oe="request-changes_iconButton__G0dvv",Ge="request-changes_badge__Ab3AT",Qe="request-changes_modalHeader__Uwuv4",Ze="request-changes_headerContent__yaZpp",Ke="request-changes_headerIcon__oOy37",Ye="request-changes_headerText__gXFA1",Je="request-changes_headerTitle__ociwv",Xe="request-changes_headerSubtitle__C1cA1",es="request-changes_closeButton__L+Kgd",ss="request-changes_modalBody__cTIqY",ts="request-changes_changesContainer__EHDSA",ls="request-changes_changeCard__1gpYZ",as="request-changes_cardContent__U58rA",ns="request-changes_messageLabel__oxx2-",is="request-changes_messageText__0yqru",os="request-changes_emptyState__1f0TF",rs="request-changes_emptyIcon__9w0qX",cs="request-changes_emptyText__2R+Gp",ds="request-changes_emptySubtext__UObUu",ms=e=>{let{requestChanges:s,quoteNumber:t,status:a}=e;const[n,i]=(0,l.useState)(!1),o=()=>i(!1),r=s&&s.length>0;return r&&"Review"===a?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("button",{className:Oe,onClick:()=>i(!0),title:`${s.length} change request(s)`,children:[(0,P.jsx)(Ve.A,{color:"#FDB022",size:16}),s.length>0&&(0,P.jsx)("span",{className:Ge,children:s.length})]}),(0,P.jsxs)(he.A,{show:n,onHide:o,centered:!0,size:"lg",animation:!1,children:[(0,P.jsxs)(he.A.Header,{className:Qe,children:[(0,P.jsxs)("div",{className:Ze,children:[(0,P.jsx)("div",{className:Ke,children:(0,P.jsx)(Ve.A,{size:20,color:"#FDB022"})}),(0,P.jsxs)("div",{className:Ye,children:[(0,P.jsx)("h2",{className:Je,children:"Change Requests"}),(0,P.jsxs)("p",{className:Xe,children:["Quote ",t," \u2022 ",(null===s||void 0===s?void 0:s.length)||0," request",1!==(null===s||void 0===s?void 0:s.length)?"s":""]})]})]}),(0,P.jsx)("button",{className:es,onClick:o,"aria-label":"Close",children:(0,P.jsx)(se.A,{size:24})})]}),(0,P.jsx)(he.A.Body,{className:ss,children:r?(0,P.jsx)("div",{className:ts,children:s.map(((e,s)=>(0,P.jsx)("div",{className:ls,children:(0,P.jsxs)("div",{className:as,children:[(0,P.jsxs)("div",{className:ns,children:[(0,P.jsx)(We.A,{size:14}),(0,P.jsx)("span",{children:"Requested Changes:"})]}),(0,P.jsx)("div",{className:is,children:e.request_changes})]})},s)))}):(0,P.jsxs)("div",{className:os,children:[(0,P.jsx)("div",{className:rs,children:(0,P.jsx)(Ve.A,{size:48,color:"#D0D5DD"})}),(0,P.jsx)("p",{className:cs,children:"No change requests"}),(0,P.jsx)("p",{className:ds,children:"Change requests from clients will appear here"})]})})]})]}):null};var hs=t(10615),us=t(71807),ps=t(38300),xs=t(27066),vs=t(22927),gs=t(90991),js=t(98176),fs=t(64967),ys=t(77918),bs=t(73898),_s=t(94673),Cs=t(88578),Ns=t(76104),As=t(78602),ws=t(61072);const Ss={modalHeader:"sales-history_modalHeader__+fyEQ",modalContent:"sales-history_modalContent__tx9B4",headerContent:"sales-history_headerContent__35-SD",headerIcon:"sales-history_headerIcon__wpxzK",headerText:"sales-history_headerText__9TiAr",headerTitle:"sales-history_headerTitle__S6M6s",headerSubtitle:"sales-history_headerSubtitle__gUExm",headerActions:"sales-history_headerActions__DGw3m",headerIconButton:"sales-history_headerIconButton__P2Wh3",closeButton:"sales-history_closeButton__JhKKm",leftColumn:"sales-history_leftColumn__WaUTy",rightColumn:"sales-history_rightColumn__Jsz+w",tabsContainer:"sales-history_tabsContainer__jP4aG",tabsList:"sales-history_tabsList__CIqjL",tabItem:"sales-history_tabItem__aHq2Q",active:"sales-history_active__oq3o3",scrollContainer:"sales-history_scrollContainer__V+LPo",quoteSection:"sales-history_quoteSection__AMuvQ",sectionBlock:"sales-history_sectionBlock__YEft2",sectionTitle:"sales-history_sectionTitle__bQ6QW",editIcon:"sales-history_editIcon__oSQJF",sectionContent:"sales-history_sectionContent__WWg6H",customerInfoSection:"sales-history_customerInfoSection__rLd0W",sectionHeader:"sales-history_sectionHeader__OWAsT",clientIdBadge:"sales-history_clientIdBadge__DVQnz",divider:"sales-history_divider__6T8Jp",boxLabel:"sales-history_boxLabel__9tA+y",boxLabel2:"sales-history_boxLabel2__TvjmU",profileBox:"sales-history_profileBox__thSCa",leadInfoSection:"sales-history_leadInfoSection__-d5vz",enquirySection:"sales-history_enquirySection__baBWi",infoGrid:"sales-history_infoGrid__vCLQa",infoItem:"sales-history_infoItem__dEBY5",infoLabel:"sales-history_infoLabel__tmwzu",infoValue:"sales-history_infoValue__2fXfv",ellipsis:"sales-history_ellipsis__6n2jS",fieldCardsContainer:"sales-history_fieldCardsContainer__ZWaUL",fieldCard:"sales-history_fieldCard__9h4R0",fieldLabel:"sales-history_fieldLabel__bmisp",fieldValue:"sales-history_fieldValue__jtBqD",infoCard:"sales-history_infoCard__U2VSu",infoIcon:"sales-history_infoIcon__9tEvH",infoContent:"sales-history_infoContent__MGtdG",infoLink:"sales-history_infoLink__SsbYG",infoRow:"sales-history_infoRow__IfXqo",label:"sales-history_label__xdCkE",value:"sales-history_value__Vq36s",badge:"sales-history_badge__ecMi2",tableContainer:"sales-history_tableContainer__dfRUz",dataTable:"sales-history_dataTable__vPt8-",tableLabel:"sales-history_tableLabel__EgamJ",tableValue:"sales-history_tableValue__MZ50I",actionsRow:"sales-history_actionsRow__e5K-K",activitySection:"sales-history_activitySection__eQati",activityScroll:"sales-history_activityScroll__oTiGB",historySectionHeader:"sales-history_historySectionHeader__8Vjk9",historyList:"sales-history_historyList__022je",historyItem:"sales-history_historyItem__MWDHf",historyHeader:"sales-history_historyHeader__a0Rm+",historyIcon:"sales-history_historyIcon__V0YZC",historyType:"sales-history_historyType__juNy4",historyLinks:"sales-history_historyLinks__ljH6u",historySubtitle:"sales-history_historySubtitle__OdRH2",historyTimestamp:"sales-history_historyTimestamp__oOc0v",emailPreview:"sales-history_emailPreview__QtlC2",emailBody:"sales-history_emailBody__B5lc4",emptyState:"sales-history_emptyState__pIhri",emptyIcon:"sales-history_emptyIcon__T9hy4",emptyText:"sales-history_emptyText__hs2ez",emptySubtext:"sales-history_emptySubtext__u6oqY",loadingContainer:"sales-history_loadingContainer__+NZo8",skeletonContainer:"sales-history_skeletonContainer__8w+Zq",skeletonCircle:"sales-history_skeletonCircle__iNRHt",pulse:"sales-history_pulse__rdiz9",skeletonLineShort:"sales-history_skeletonLineShort__ymlHD",skeletonLine:"sales-history_skeletonLine__oFjKS",skeletonLineLong:"sales-history_skeletonLineLong__3k2wj",modalFooter:"sales-history_modalFooter__qgCvF",footerLeft:"sales-history_footerLeft__PIN97",footerActionButton:"sales-history_footerActionButton__c6wEd",calculationButton:"sales-history_calculationButton__l6Vi0",footerRight:"sales-history_footerRight__4eGLf",assignedTo:"sales-history_assignedTo__MloDC",assignedLabel:"sales-history_assignedLabel__LgXiZ",avatarGroup:"sales-history_avatarGroup__5IGGH",noManager:"sales-history_noManager__kq5GU",assignedUser:"sales-history_assignedUser__tovF6",lostButton:"sales-history_lostButton__awJ2P",wonButton:"sales-history_wonButton__9KLmn",enquiryGrid:"sales-history_enquiryGrid__YLj8U",footerCenter:"sales-history_footerCenter__HOa14"};var ks=t(70972),Fs=t(58027),Ls=t(81493),Es=t(985),Is=t(91242),Ts=t(31812),$s=t(73184),Rs=t(316),Bs=t(44787);const qs="quote",Ds="customer_info",zs="enquiry",Ps=e=>{if(!e)return"-";const s=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(s)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(s)} | ${`${s.getDate()}.${String(s.getMonth()+1).padStart(2,"0")}.${s.getFullYear()}`}`},Us=e=>e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),Hs=e=>{switch(e){case"quote":default:return(0,P.jsx)(us.A,{size:16,color:"#1AB2FF"});case"task":case"tag":return(0,P.jsx)(ps.A,{size:16,color:"#1AB2FF"});case"order":case"job":return(0,P.jsx)(ze.A,{size:16,color:"#1AB2FF"});case"note":return(0,P.jsx)(xs.A,{size:16,color:"#1AB2FF"});case"invoice":return(0,P.jsx)(vs.A,{size:16,color:"#1AB2FF"});case"billing":return(0,P.jsx)(gs.A,{size:16,color:"#1AB2FF"});case"email":return(0,P.jsx)(le.A,{size:16,color:"#1AB2FF"});case"sms":return(0,P.jsx)(js.A,{size:16,color:"#1AB2FF"});case"expense":return(0,P.jsx)(fs.A,{size:16,color:"#1AB2FF"})}},Ms=e=>{switch(e){case"quote":return"Quote";case"task":return"Tasks";case"order":return"Order";case"note":return"Notes";case"tag":return"Tag";case"invoice":return"Invoice";case"billing":return"Billing";case"email":return"Email";case"sms":return"SMS";case"job":return"Job Created";case"expense":return"Expense Linked";default:return(null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))}},Vs=e=>{var s;let{emailData:t}=e;const[a,n]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1),r=(0,l.useRef)(null),c=(e=>{var s,t,l;if(!e)return{subject:"",recipients:[],body:""};const a=e.split("\n"),n=(null===(s=a.find((e=>e.startsWith("Subject:"))))||void 0===s?void 0:s.replace("Subject: ",""))||"",i=(null===(t=a.find((e=>null===e||void 0===e?void 0:e.startsWith("Recipient(s):"))))||void 0===t?void 0:t.replace("Recipient(s): ",""))||"[]";let o=[];try{o=JSON.parse(null===i||void 0===i?void 0:i.replace(/'/g,'"'))}catch(r){o=[]}return{subject:n,recipients:o,body:(null===(l=e.split("Body:")[1])||void 0===l?void 0:l.trim())||""}})(t);return(0,l.useEffect)((()=>{if(r.current){const e=r.current.scrollHeight;o(e>90)}}),[c.body]),(0,P.jsxs)("div",{className:Ss.emailPreview,children:[(0,P.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[(0,P.jsx)("strong",{className:"font-12",children:"Subject:"}),(0,P.jsx)("span",{className:"font-12",children:c.subject})]}),(0,P.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[(0,P.jsx)("strong",{className:"font-12",children:"Recipients:"}),(0,P.jsx)("span",{className:"font-12",children:null===(s=c.recipients)||void 0===s?void 0:s.join(", ")})]}),(0,P.jsx)("div",{ref:r,className:Ss.emailBody,style:{maxHeight:a?"none":"87px",overflowY:"hidden"},dangerouslySetInnerHTML:{__html:c.body}}),i&&(0,P.jsx)("button",{className:"text-button font-12 px-0",onClick:()=>n(!a),children:a?"Show Less":"Load More"})]})},Ws=e=>{let{salesHistoryId:s,setSalesHistoryId:t,onRemoveRow:a,managers:n}=e;const[i,r]=(0,l.useState)(qs),[h,u]=(0,l.useState)(!1),[j,f]=(0,l.useState)(!1),[b,C]=(0,l.useState)(!1),[N,A]=(0,l.useState)(!1),{data:w,isFetching:S,refetch:k}=(0,x.I)({queryKey:["project-card",s],queryFn:()=>(0,D.OE)(s),enabled:!!s}),{data:F,isFetching:L}=(0,x.I)({queryKey:["enquiry-submission-details",null===w||void 0===w?void 0:w.enquiry_id],queryFn:()=>(0,ks.Is)(null===w||void 0===w?void 0:w.enquiry_id),enabled:!(null===w||void 0===w||!w.enquiry_id)}),E=(0,x.I)({queryKey:["getClientById",null===w||void 0===w?void 0:w.client],queryFn:()=>(0,q.EZ)(null===w||void 0===w?void 0:w.client),enabled:!(null===w||void 0===w||!w.client),retry:1}),I=(null===E||void 0===E?void 0:E.data)||null,$=s,R={value:s},B=(null===w||void 0===w?void 0:w.history)||[],z=(null===w||void 0===w?void 0:w.contact_persons)||[],U=()=>{t(null)},M=()=>{k()},V=()=>(0,P.jsx)("div",{className:Ss.quoteSection,children:S?(0,P.jsx)("div",{className:Ss.loadingContainer,children:(0,P.jsx)(y.p,{style:{width:"40px",height:"40px"}})}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:Ss.sectionBlock,children:[(0,P.jsxs)("div",{className:Ss.sectionTitle,children:[(0,P.jsxs)("h4",{children:["Reference",(0,P.jsx)(ys.A,{size:14,color:"#98A2B3"})]}),(0,P.jsx)(bs.A,{size:16,className:Ss.editIcon})]}),(0,P.jsx)("p",{className:Ss.sectionContent,children:(null===w||void 0===w?void 0:w.reference)||"-"})]}),(0,P.jsxs)("div",{className:Ss.sectionBlock,children:[(0,P.jsxs)("div",{className:Ss.sectionTitle,children:[(0,P.jsx)("h4",{children:"Description"}),(0,P.jsx)(bs.A,{size:16,className:Ss.editIcon})]}),(0,P.jsx)("p",{className:Ss.sectionContent,children:(null===w||void 0===w?void 0:w.description)||"-"})]})]})});return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(He,{active:h,config:{}}),(0,P.jsxs)(he.A,{show:!!s,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"projectCardModel",onHide:U,animation:!1,enforceFocus:!1,size:"xl",contentClassName:Ss.modalContentClass,children:[(0,P.jsxs)(he.A.Header,{className:Ss.modalHeader,children:[(0,P.jsxs)("div",{className:Ss.headerContent,children:[(0,P.jsx)("div",{className:Ss.headerIcon,children:(0,P.jsx)(_s.A,{size:24,color:"#17B26A"})}),(0,P.jsxs)("div",{className:Ss.headerText,children:[(0,P.jsx)("h2",{className:Ss.headerTitle,children:"Quote Request"}),(0,P.jsx)("p",{className:Ss.headerSubtitle,children:(null===I||void 0===I?void 0:I.name)||"Customer Name"})]})]}),(0,P.jsxs)("div",{className:Ss.headerActions,children:["qd"!==(null===w||void 0===w?void 0:w.status)&&(0,P.jsx)(p.N_,{to:(null===w||void 0===w?void 0:w.quote_pdf)||"#",target:"_blank",className:Ss.headerIconButton,children:(0,P.jsx)(d.A,{size:18,color:"#F04438"})}),"qd"!==(null===w||void 0===w?void 0:w.status)&&(0,P.jsx)(p.N_,{to:`/quote/${$}`,target:"_blank",className:Ss.headerIconButton,children:(0,P.jsx)(m.A,{size:18,color:"#667085"})}),(0,P.jsx)("button",{className:Ss.closeButton,onClick:U,"aria-label":"Close",children:(0,P.jsx)(se.A,{size:24})})]})]}),(0,P.jsx)(he.A.Body,{className:"p-0",children:(0,P.jsx)("div",{className:Ss.modalContent,children:(0,P.jsxs)(ws.A,{className:"g-0 h-100",children:[(0,P.jsxs)(As.A,{sm:6,className:Ss.leftColumn,children:[(0,P.jsx)("div",{className:Ss.tabsContainer,children:(0,P.jsxs)("ul",{className:Ss.tabsList,children:[(0,P.jsx)("li",{className:(0,H.A)(Ss.tabItem,i===qs&&Ss.active),onClick:()=>r(qs),children:"Quote"}),(0,P.jsx)("li",{className:(0,H.A)(Ss.tabItem,i===Ds&&Ss.active),onClick:()=>r(Ds),children:"Customer Info"}),(0,P.jsx)("li",{className:(0,H.A)(Ss.tabItem,i===zs&&Ss.active),onClick:()=>r(zs),children:"Enquiry"})]})}),(0,P.jsx)("div",{className:Ss.scrollContainer,children:(()=>{switch(i){case qs:return V();case Ds:return(0,P.jsx)("div",{className:Ss.customerInfoSection,children:null!==E&&void 0!==E&&E.isFetching?(0,P.jsx)("div",{className:Ss.loadingContainer,children:(0,P.jsx)(y.p,{style:{width:"40px",height:"40px"}})}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,P.jsx)("div",{className:Ss.profileBox,style:null!==I&&void 0!==I&&I.is_business?{borderRadius:"4px"}:{borderRadius:"50%"},children:(0,P.jsx)(Fs.A,{has_photo:null===I||void 0===I?void 0:I.has_photo,photo:I.photo,is_business:null===I||void 0===I?void 0:I.is_business,size:30})}),(0,P.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,P.jsx)("span",{style:{color:"344054",fontSize:"16px",fontWeight:600},children:I.name}),I.deleted?(0,P.jsx)(Ns.v,{value:"Deleted",style:{height:"22px",width:"59px",borderRadius:"16px",border:"1px solid #FECDCA",background:"#FEF3F2",color:"#912018",fontSize:"12px",fontWeight:500}}):""]})]}),(0,P.jsx)("hr",{}),(0,P.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,P.jsx)("h5",{className:(0,H.A)(Ss.boxLabel),children:"Client Details"}),(0,P.jsxs)("h6",{className:(0,H.A)(Ss.boxLabel2),children:["Client ID: ",null===I||void 0===I?void 0:I.number]})]}),null!==I&&void 0!==I&&I.is_business?(0,P.jsx)(Ls.$,{client:I,refetch:()=>null===E||void 0===E?void 0:E.refetch()}):(0,P.jsx)(Es.w,{client:I})]})});case zs:return(()=>{var e,s,t,l,a,n,i,r,c,d;return(0,P.jsx)("div",{className:Ss.enquirySection,children:L?(0,P.jsx)("div",{className:Ss.loadingContainer,children:(0,P.jsx)(y.p,{style:{width:"40px",height:"40px"}})}):F?(0,P.jsxs)("div",{className:Ss.leadInfoSection,children:[(0,P.jsxs)("div",{className:Ss.infoGrid,children:[(null===F||void 0===F||null===(e=F.data)||void 0===e?void 0:e.name)&&(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(o.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Name"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:null===F||void 0===F||null===(s=F.data)||void 0===s?void 0:s.name})]}),(null===F||void 0===F||null===(t=F.data)||void 0===t?void 0:t.date_field)&&(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(ae.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Date Field"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:null===F||void 0===F||null===(l=F.data)||void 0===l?void 0:l.date_field})]}),(null===F||void 0===F||null===(a=F.data)||void 0===a?void 0:a.email)&&(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(le.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Email"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:null===F||void 0===F||null===(n=F.data)||void 0===n?void 0:n.email})]}),(null===F||void 0===F||null===(i=F.data)||void 0===i?void 0:i.time_field)&&(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(We.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Time Field"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:null===F||void 0===F||null===(r=F.data)||void 0===r?void 0:r.time_field})]}),(null===F||void 0===F||null===(c=F.data)||void 0===c?void 0:c.phone)&&(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(te.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Phone"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:null===F||void 0===F||null===(d=F.data)||void 0===d?void 0:d.phone})]}),(0,P.jsxs)("div",{className:Ss.infoItem,children:[(0,P.jsx)(vs.A,{size:16,color:"#1AB2FF"}),(0,P.jsx)("span",{className:Ss.infoLabel,children:"Form Type"}),(0,P.jsx)("span",{className:(0,H.A)(Ss.infoValue,Ss.ellipsis),children:"web"===(null===F||void 0===F?void 0:F.form_type)?"Web":"Form"})]})]}),(0,P.jsx)("div",{className:Ss.fieldCardsContainer,children:(null===F||void 0===F?void 0:F.data)&&Object.entries(null===F||void 0===F?void 0:F.data).filter((e=>{let[s,t]=e;return!["name","email","phone","date_field","time_field"].includes(s)&&""!==t&&null!==t&&void 0!==t&&!("object"===typeof t&&0===Object.keys(t).length)})).map((e=>{let[s,t]=e;return(0,P.jsxs)("div",{className:Ss.fieldCard,children:[(0,P.jsx)("span",{className:Ss.fieldLabel,children:Us(s)}),(0,P.jsx)("span",{className:Ss.fieldValue,children:"boolean"===typeof t?t?"Yes":"No":"object"===typeof t?Array.isArray(t)?t.join(", "):JSON.stringify(t):t})]},s)}))})]}):(0,P.jsxs)("div",{className:Ss.emptyState,children:[(0,P.jsx)("div",{className:Ss.emptyIcon,children:(0,P.jsx)(vs.A,{size:24,color:"#98A2B3"})}),(0,P.jsx)("p",{className:Ss.emptyText,children:"No enquiry data available"}),(0,P.jsx)("p",{className:Ss.emptySubtext,children:"This quote may not have been created from an enquiry form."})]})})})();default:return V()}})()})]}),(0,P.jsxs)(As.A,{sm:6,className:Ss.rightColumn,children:[(0,P.jsxs)("div",{className:Ss.actionsRow,children:[(0,P.jsx)(Is.A,{projectId:$,projectCardData:M}),(0,P.jsx)(Rs.A,{project:R,reInitialize:()=>{k()},projectCardData:M}),(0,P.jsx)(Bs.A,{projectId:$,projectCardData:M}),(0,P.jsx)(Ts.A,{projectId:$,projectCardData:M,contactPersons:z})]}),(0,P.jsxs)("div",{className:Ss.activitySection,children:[(0,P.jsx)("div",{className:Ss.historySectionHeader,children:(0,P.jsx)("h3",{children:"Project History"})}),(0,P.jsx)("div",{className:Ss.activityScroll,children:S?(0,P.jsx)("div",{className:Ss.skeletonContainer,children:[1,2,3,4].map((e=>(0,P.jsxs)("div",{className:"d-flex flex-column mb-3",children:[(0,P.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,P.jsx)("div",{className:Ss.skeletonCircle}),(0,P.jsx)("div",{className:Ss.skeletonLineShort,style:{width:"80px",marginBottom:0}})]}),(0,P.jsx)("div",{className:Ss.skeletonLine,style:{marginLeft:"24px",marginTop:"8px"}}),(0,P.jsx)("div",{className:Ss.skeletonLineLong,style:{marginLeft:"24px",width:"120px"}})]},e)))}):(null===B||void 0===B?void 0:B.length)>0?(0,P.jsx)("div",{className:Ss.historyList,children:B.map(((e,s)=>{const{id:t,type:l,text:a,title:n,created:i,manager:o,links:r}=e;return(0,P.jsxs)("div",{className:Ss.historyItem,children:[(0,P.jsxs)("div",{className:Ss.historyHeader,children:[(0,P.jsx)("span",{className:Ss.historyIcon,children:Hs(l)}),(0,P.jsx)("span",{className:Ss.historyType,children:Ms(l)}),((null===r||void 0===r?void 0:r.quote_pdf)||(null===r||void 0===r?void 0:r.invoice_pdf)||$&&("Quote Created"===n||"Invoice Created"===n))&&(0,P.jsxs)("div",{className:Ss.historyLinks,children:[(null===r||void 0===r?void 0:r.quote_pdf)&&(0,P.jsx)(p.N_,{to:r.quote_pdf,target:"_blank",children:(0,P.jsx)(d.A,{color:"#F04438",size:14})}),(null===r||void 0===r?void 0:r.invoice_pdf)&&(0,P.jsx)(p.N_,{to:r.invoice_pdf,target:"_blank",children:(0,P.jsx)(d.A,{color:"#F04438",size:14})}),$&&("Quote Created"===n||"Invoice Created"===n)&&(0,P.jsx)(p.N_,{to:"Quote Created"===n?`/quote/${$}`:`/invoice/${$}`,target:"_blank",children:(0,P.jsx)(m.A,{color:"#667085",size:16})})]})]}),n&&(0,P.jsx)("p",{className:Ss.historySubtitle,children:n}),a&&(0,P.jsx)("p",{className:Ss.historySubtitle,children:a}),"email"===l&&a&&(0,P.jsx)(Vs,{emailData:a}),(0,P.jsxs)("p",{className:Ss.historyTimestamp,children:[Ps(+i)," by ",o]})]},`history-${t||s}`)}))}):(0,P.jsxs)("div",{className:Ss.emptyState,children:[(0,P.jsx)("div",{className:Ss.emptyIcon,children:(0,P.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,P.jsx)("path",{d:"M12 5V19M5 12H19",stroke:"#98A2B3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,P.jsx)("p",{className:Ss.emptyText,children:"No history available yet."}),(0,P.jsx)("p",{className:Ss.emptySubtext,children:"Activities like notes, tasks, emails, and SMS will appear here."})]})})]})]})]})})}),(0,P.jsxs)(he.A.Footer,{className:Ss.modalFooter,children:[(0,P.jsxs)("div",{className:Ss.footerLeft,children:[(0,P.jsxs)("div",{className:Ss.assignedTo,children:[(0,P.jsx)("span",{className:Ss.assignedLabel,children:"Assigned To"}),n&&n.length>0?(0,P.jsxs)(g.Z,{className:Ss.avatarGroup,children:[n.slice(0,3).map(((e,s)=>(0,P.jsx)(X.A,{placement:"top",overlay:(0,P.jsx)(hs.A,{id:`tooltip-${e.id||s}`,children:e.full_name||`${e.first_name||""} ${e.last_name||""}`.trim()}),children:(0,P.jsx)(v.e,{shape:"circle",image:e.has_photo&&e.photo?e.photo:null,label:e.has_photo&&e.photo?null:(0,P.jsx)("small",{children:e.alias_name||(e.full_name?e.full_name.split(" ").map((e=>e[0])).join("").toUpperCase():"")}),style:{background:"#fff",border:"1px solid #dedede",width:"32px",height:"32px",fontSize:"12px"}})},`${e.id||e.email}-${s}`))),n.length>3&&(0,P.jsx)(X.A,{placement:"top",overlay:(0,P.jsx)(hs.A,{id:"tooltip-more",children:n.slice(3).map((e=>e.full_name||`${e.first_name||""} ${e.last_name||""}`.trim())).join(", ")}),children:(0,P.jsx)(v.e,{label:"+"+(n.length-3),shape:"circle",style:{background:"#f2f4f7",border:"1px solid #dedede",width:"32px",height:"32px",fontSize:"12px",color:"#344054"}})})]}):(0,P.jsx)("span",{className:Ss.noManager,children:"\u2014"})]}),(0,P.jsxs)("button",{className:Ss.footerActionButton,onClick:async()=>{if(s){A(!0);try{const e=await(0,T.L)(s);console.log("success: ",e),_.oR.success("Sale request has been duplicated!"),a&&a(),U()}catch(e){_.oR.error("Failed to duplicate sale request. Please try again.")}finally{A(!1)}}},disabled:N||b||j,children:["Duplicate",N?(0,P.jsx)(y.p,{style:{width:"14px",height:"14px"},strokeWidth:"4"}):(0,P.jsx)(Cs.A,{size:16})]}),(0,P.jsxs)(p.N_,{to:`/sales/quote-calculation/${$}`,target:"_blank",className:Ss.calculationButton,children:["Calculation",(0,P.jsx)(c.A,{color:"#FDB022",size:16})]}),(0,P.jsx)($s.A,{projectId:$})]}),(0,P.jsxs)("div",{className:Ss.footerRight,children:[(0,P.jsxs)("button",{className:Ss.lostButton,onClick:async()=>{if(s){C(!0);try{const e=await(0,T.Op)([s]);null!==e&&void 0!==e&&e.length?(_.oR.success("Sale request has been marked as Lost!"),a&&a(),U()):_.oR.error("Failed to mark as Lost. Please try again.")}catch(e){_.oR.error("An error occurred. Please try again.")}finally{C(!1)}}},disabled:b||j,children:["Lost",b?(0,P.jsx)(y.p,{style:{width:"14px",height:"14px"},strokeWidth:"4"}):(0,P.jsx)(Fe.A,{size:16})]}),(0,P.jsxs)("button",{className:Ss.wonButton,onClick:async()=>{if(s){f(!0);try{const e=await(0,T.WG)([s]);null!==e&&void 0!==e&&e.length?(u(!0),_.oR.success("Successfully moved to Management!"),a&&a(),setTimeout((()=>{u(!1),U()}),2e3)):_.oR.error("Failed to move to Management. Please try again.")}catch(e){_.oR.error("An error occurred. Please try again.")}finally{f(!1)}}},disabled:j||b,children:["Won",j?(0,P.jsx)(y.p,{style:{width:"14px",height:"14px"},strokeWidth:"4"}):(0,P.jsx)(De.A,{size:16})]})]})]})]})]})};var Os=t(90239),Gs=t(76688),Qs=t(96776);const Zs=e=>{let{saleUniqueId:s,noteData:t,onNoteUpdate:a,refreshData:n}=e;const[i,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(t||""),[m,h]=(0,l.useState)(!t),[u,p]=(0,l.useState)(""),[x,v]=(0,l.useState)(!1),g=2e3,j=e=>e.trim()?e.length<3?"Note must be at least 3 characters":e.length>g?"Note must not exceed 2000 characters":"":"Note is required",f=()=>{o(null),d(t||""),p(""),h(!t)},y=async()=>{const e=j(c);if(e)p(e);else if(s){v(!0);try{await(0,T.cS)(s,c.trim()),await(0,T.j3)(),a&&a(c.trim()),h(!1),f(),n()}catch(u){console.error("Error saving note:",u),p(u.message||"Failed to save note. Please try again.")}finally{v(!1)}}else p("Sale ID is missing")},b=Boolean(i);return(0,l.useEffect)((()=>{t&&d(t)}),[t]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"saleNoteBorder noteInfo "+(c?"Yes":"No"),"aria-describedby":b?"simple-popover":void 0,onClick:e=>{o(e.currentTarget),p("")},children:c?(0,P.jsxs)("span",{style:{cursor:"pointer"},onClick:()=>h(!0),children:["Note ",(0,P.jsx)(Os.A,{color:"#17B26A",size:16})]}):(0,P.jsx)("strong",{children:(0,P.jsxs)("span",{style:{cursor:"pointer"},children:["Note ",(0,P.jsx)(r.A,{color:"#667085",size:16})]})})}),(0,P.jsx)(Qs.Ay,{id:"simple-popover",open:b,anchorEl:i,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{width:"640px"},id:"popoverStyleChange"},children:(0,P.jsxs)(me.A,{onSubmit:e=>{e.preventDefault(),y()},children:[(0,P.jsxs)("div",{className:"popoverHead popoverHeadflex salesTableWrap",children:[(0,P.jsxs)("span",{children:[(0,P.jsx)("div",{className:"iconOutStyle",children:(0,P.jsx)("div",{className:"iconinStyle",children:(0,P.jsx)("div",{className:"iconinnerStyle",children:(0,P.jsx)(Gs.A,{color:"#17B26A",size:24})})})}),"Add Note"]}),(0,P.jsx)(L.A,{className:"popupcrossInfo",size:"small",onClick:f,disabled:x,children:(0,P.jsx)(Ee.A,{})})]}),(0,P.jsx)("div",{className:"popupcrossInfomain",children:(0,P.jsxs)(ie.A,{sx:{p:"16px 24px 24px 24px"},children:[(0,P.jsxs)("h3",{children:["Note ",(0,P.jsx)("span",{className:"required",children:"*"})]}),(0,P.jsx)(me.A.Control,{id:"placeholderColor",as:"textarea",placeholder:"Enter a description...",style:{height:"157px"},value:c,onChange:e=>{const s=e.target.value;d(s);const t=j(s);p(t)},maxLength:g,className:u?"error-border":""}),(0,P.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,P.jsx)("small",{className:u?"error-message":"text-muted",children:u||`${c.length}/2000 characters`})})]})}),(0,P.jsxs)("div",{className:"popoverbottom popoverendflex",children:[(0,P.jsx)(Te.A,{className:"closebox",onClick:f,disabled:x,children:"Cancel"}),(0,P.jsx)(Te.A,{className:"savebox",onClick:y,disabled:x||!!u,children:x?"Saving...":"Save"})]})]})})]})};var Ks=t(39759),Ys=t(75329),Js=t(62812),Xs=t(39195),et=t(56052),st=t(2028),tt=t(53519),lt=t(5328),at=t(44621),nt=t(3098),it=t(73216);const ot=t.p+"static/media/newQuote.9cbe4c1c556f514b424a.png",rt=()=>{const[e,s]=(0,l.useState)(!1),t=()=>s(!1),a=(0,it.Zp)();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Te.A,{onClick:()=>s(!0),className:"addNewBilling p-0",children:(0,P.jsxs)("div",{className:"styleGrey01 tabActive",children:[(0,P.jsx)("span",{style:{fontWeight:400,textTransform:"capitalize"},children:"Quote New Project"})," ",(0,P.jsx)(r.A,{color:"#fff",size:16})]})}),(0,P.jsx)($e.A,{open:e,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,P.jsx)(Ie.A,{className:"modelStyleBoxstatus NewQuoteModal",sx:{width:732},children:(0,P.jsx)(ie.A,{id:"modal-modal-title",className:"",variant:"h6",component:"h2",children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:"modelHeader modelHeaderBillig d-flex justify-content-between align-items-start",children:[(0,P.jsxs)("span",{className:"modelHeadFlex",children:[(0,P.jsx)("div",{className:"iconinnerStyle1",children:(0,P.jsx)(nt.A,{color:"#F04438",size:24})}),(0,P.jsx)("h2",{children:"Complete Your Profile to Proceed"})]}),(0,P.jsx)(L.A,{edge:"end",color:"inherit",onClick:t,"aria-label":"close",children:(0,P.jsx)(Ee.A,{color:"#667085",size:24})})]}),(0,P.jsxs)("div",{className:"stepBoxStyle ",children:[(0,P.jsx)("img",{src:ot,alt:"NewQuoteImg"}),(0,P.jsxs)("div",{className:"newQuotewrap",children:[(0,P.jsx)("h3",{children:"Bank Details Required"}),(0,P.jsx)("p",{children:"Before creating a new request, please ensure you have filled in your bank details. This is necessary to process your transactions smoothly. You can add your bank information by navigating to your profile settings. "})]})]}),(0,P.jsxs)("div",{className:"footerButton",children:[(0,P.jsx)("button",{className:"Cancel",onClick:t,children:"Cancel and Return"}),(0,P.jsx)(Te.A,{className:"save",onClick:()=>{a("/settings/generalinformation/bank-details"),t()},children:"Add Bank Details"})]})]})})})})]})};t(7245);var ct=t(27965);const dt=e=>{let{onDataApply:s}=e;const[t,a]=(0,l.useState)([]),n=(0,l.useRef)(null),[i,o]=(0,l.useState)(null),[r,c]=(0,l.useState)(null),[,d]=(0,l.useState)(!1),[m,h]=(0,l.useState)("");(0,l.useEffect)((()=>{const e=new Date,s=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`;h(s)}),[]);(0,l.useEffect)((()=>{if(2===t.length){const e=t[0],s=t[1];o(e),c(s)}}),[t]);(0,l.useEffect)((()=>{if(i||r){if(i&&r){const e={year:"numeric",month:"short",day:"numeric"},s=`<p>${`${new Date(i).toLocaleDateString("en-US",e)} - ${new Date(r).toLocaleDateString("en-US",e)}`}</p><span class="today-span" style="cursor: pointer">Today</span>`,t=document.querySelector(".flatpickr-months");if(t){const e=document.querySelector(".custom-div");if(e)e.innerHTML=s;else{const e=document.createElement("div");e.className="custom-div",e.innerHTML=s,t.parentNode.insertBefore(e,t.nextSibling)}}}}else{const e=new Date;o(e),c(e)}}),[i,r]);const u=()=>{const e=new Date;a([e,e])};return(0,l.useEffect)((()=>{const e=document.querySelector(".today-span");return e&&e.addEventListener("click",u),()=>{e&&e.removeEventListener("click",u)}}),[i,r]),(0,P.jsxs)("div",{children:[(0,P.jsx)(ct.A,{options:{dateFormat:"Y-m-d",mode:"range",inline:!0},value:t,onChange:e=>{a(e)},ref:n}),(0,P.jsxs)("div",{className:"calenderBut",children:[(0,P.jsx)("button",{className:"tabCancel",onClick:()=>{a([]),o(null),c(null),d(!1);const e=document.querySelector(".custom-div p");e&&(e.textContent=`${m}`)},children:"Cancel"}),(0,P.jsx)("button",{className:"tabApply",onClick:()=>{(()=>{const e=document.querySelector(".custom-div p");i&&r&&e&&(e.textContent=`${i.toISOString().split("T")[0]} - ${r.toISOString().split("T")[0]}`)})(),d(!0),s({startDate:i,endDate:r});const e=document.querySelector(".tags-input-container .rangedatepicker .mainWrapperTags");e&&(e.textContent=`${i.toISOString().split("T")[0]} - ${r.toISOString().split("T")[0]}`)},children:"Apply"})]})]})};var mt=t(25721);const ht=e=>{let{setInputValue:s,inputValue:t}=e;return(0,P.jsxs)("div",{children:[(0,P.jsx)("span",{className:"mr-3",children:(0,P.jsx)(mt.A,{color:"#98A2B3",size:20})}),(0,P.jsx)("input",{type:"text",placeholder:"Search",value:t,onChange:e=>s(e.target.value)})]})};var ut=t(14834),pt=t(54967);const xt=[{percentage:10,label:"Lead",gradient:"linear-gradient(90deg, #1AB2FF 10%, transparent 10%)"},{percentage:20,label:"Prospect",gradient:"linear-gradient(90deg, #1AB2FF 20%, transparent 20%)"},{percentage:40,label:"Proposal sent",gradient:"linear-gradient(90deg, #1AB2FF 40%, transparent 40%)"},{percentage:60,label:"Negotiation",gradient:"linear-gradient(90deg, #1AB2FF 60%, transparent 60%)"},{percentage:80,label:"Awaiting approval",gradient:"linear-gradient(90deg, #1AB2FF 80%, transparent 80%)"}],vt=e=>{var s,t,a,n;let{profileData:i,salesData:c,removeRowMulti:d,selectedUniqueIds:m,onRowsFilterChange:u,rows:v,setSelectedRows:g,selectedRow:j,selectedRowCount:f}=e;const[y,C]=(0,p.ok)(),N=y.get("search"),A=y.get("targetId"),[w,S]=(0,l.useState)(0),[k,F]=(0,l.useState)(0),[L,E]=(0,l.useState)(0),[I,$]=(0,l.useState)("DateRange"),[R,B]=(0,l.useState)({}),[D,z]=(0,l.useState)({}),[U,M]=(0,l.useState)(!1),[V,W]=(0,l.useState)(!1),O=(0,l.useRef)(null),[G,Q,Z]=(0,st.d7)("",400),[K,Y]=(0,l.useState)(!1),J=(0,x.I)({queryKey:["project-manager"],queryFn:q.Fl}),X=e=>{var s,t;let l=Ct(c);if(null!==e&&void 0!==e&&e.dateRange){const[s,t]=e.dateRange;l=v.filter((e=>{const l=new Date(1e3*parseInt(e.created)).toLocaleDateString("en-CA");return l>=s&&l<=t}))}null!==e&&void 0!==e&&e.progress&&(l=l.filter((s=>{var t;return null===e||void 0===e||null===(t=e.progress)||void 0===t?void 0:t.includes(s.progressName)}))),(null===(s=e.statuses)||void 0===s?void 0:s.length)>0&&(l=l.filter((s=>{var t;return null===e||void 0===e||null===(t=e.statuses)||void 0===t?void 0:t.includes(null===s||void 0===s?void 0:s.Status)}))),(null===e||void 0===e||null===(t=e.projectManager)||void 0===t?void 0:t.length)>0&&(l=l.filter((s=>{var t;return null===s||void 0===s||null===(t=s.User)||void 0===t?void 0:t.map((e=>null===e||void 0===e?void 0:e.full_name)).some((s=>{var t;return null===e||void 0===e||null===(t=e.projectManager)||void 0===t?void 0:t.includes(s)}))}))),l=l.filter((e=>{var s,t,l;return!!(null!==e&&void 0!==e&&null!==(s=e.Client)&&void 0!==s&&s.toLowerCase().includes(null===Q||void 0===Q?void 0:Q.toLowerCase())||null!==e&&void 0!==e&&null!==(t=e.Quote)&&void 0!==t&&t.toLowerCase().includes(null===Q||void 0===Q?void 0:Q.toLowerCase())||null!==e&&void 0!==e&&null!==(l=e.Reference)&&void 0!==l&&l.toLowerCase().includes(null===Q||void 0===Q?void 0:Q.toLowerCase()))})),u(l)},ee=(0,ut.m)(w);(0,l.useEffect)((()=>{if(null!==v&&void 0!==v&&v.length){const e=v.reduce(((e,s)=>e+s.amountData),0),s=v.reduce(((e,s)=>Number(e)+Number((null===s||void 0===s?void 0:s.progressPercentage)||0)),0)/v.length,t=v.reduce(((e,s)=>Number(e)+Number((null===s||void 0===s?void 0:s.progressPercentage)||0)/100*Number((null===s||void 0===s?void 0:s.amountData)||0)),0);E(t),F(parseInt(s)),S(e)}}),[v]);return(0,l.useEffect)((()=>{const e=e=>{O.current&&!O.current.contains(e.target)&&(e.target.closest(".tab-content,.nav-tabs")||M(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,l.useEffect)((()=>{X(D)}),[Q]),(0,l.useEffect)((()=>{N&&A&&(Z(N),Y(!0))}),[N,A,Z]),(0,l.useEffect)((()=>{if(!K||!A||Q!==N)return;const e=function(s){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return setTimeout((()=>{const s=document.querySelector(`.row-id-${A}`);if(s)(l=s).classList.add("highlight-row"),setTimeout((()=>{const e=l.closest(".table-responsive, .salesTableWrap");if(e){const s=l.offsetTop-e.clientHeight/2+l.clientHeight/2;e.scrollTo({top:s,behavior:"smooth"})}}),100),setTimeout((()=>{l.classList.remove("highlight-row"),Y(!1);const e=new URLSearchParams(y);e.delete("search"),e.delete("targetId"),C(e,{replace:!0})}),6e3);else{if(!t){const s=e(1500,!0);return()=>clearTimeout(s)}Y(!1),console.warn("Target row not found:",A)}var l}),s)},s=e(800);return()=>clearTimeout(s)}),[K,A,Q,N,y,C]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:(f?"selected-row":"")+" flexbetween paddingLR tableTopBar tableTopBarSales",style:{borderBottom:"1px solid #f2f2f2"},children:j&&0!==(null===j||void 0===j?void 0:j.length)?(0,P.jsx)(tt.A,{fluid:!0,children:(0,P.jsxs)(ws.A,{style:{display:"flex",alignItems:"center"},children:[(0,P.jsxs)(As.A,{style:{textAlign:"left",display:"flex",alignItems:"center"},children:[(0,P.jsxs)("span",{className:"styleT4",children:["Selected: ",f]}),(0,P.jsxs)("ul",{className:"filterBtn",children:[(0,P.jsxs)("li",{children:[(0,P.jsxs)(b.A,{variant:"lostFilter",onClick:async()=>{try{if(m){await(0,T.HT)(m)?(g([]),d(),W(!0),_.oR.success("Sale request has been updated to Lost!")):_.oR.error("Failed to update to Lost. Please try again.")}}catch(e){_.oR.error("An error occurred. Please try again.")}},children:["Lost",(0,P.jsx)(Fe.A,{color:"#D92D20",size:20})]}),(0,P.jsx)(He,{active:V,config:{}})]}),(0,P.jsxs)("li",{children:[" ",(0,P.jsxs)(b.A,{variant:"wonFilter",onClick:async()=>{try{if(m){if(await(0,T.fW)(m)){g([]),d(),W(!0),document.querySelector(".management-notification").style.display="block";let e=parseInt(document.querySelector(".management-notification-count").innerText||0);document.querySelector(".management-notification-count").innerHTML=e+m.length,_.oR.success("Successfully moved to Management!")}else _.oR.error("Failed to move to Management. Please try again.")}}catch(e){_.oR.error("An error occurred. Please try again.")}},children:["Won",(0,P.jsx)(De.A,{color:"#079455",size:20})]}),(0,P.jsx)(He,{active:V,config:{}})]}),(0,P.jsx)("li",{children:(0,P.jsx)(b.A,{variant:"downloadBtn",children:(0,P.jsx)(Ys.A,{color:"#344054",size:20})})})]})]}),(0,P.jsx)(As.A,{}),(0,P.jsx)(As.A,{style:{textAlign:"right"},children:c&&(null===c||void 0===c?void 0:c.length)>0?(0,P.jsxs)("p",{className:"flexEndStyle styleT3",children:["Total"," ",(0,P.jsxs)("span",{className:"styleT2",children:[null!==v&&void 0!==v&&v.length?(0,P.jsxs)(P.Fragment,{children:[" ",null===v||void 0===v?void 0:v.length]}):(0,P.jsxs)(P.Fragment,{children:[null===c||void 0===c?void 0:c.length," "]})," ","Sales"]}),(0,P.jsxs)("strong",{className:"styleT1",children:["$",(0,P.jsx)(P.Fragment,{children:ee})]})]}):(0,P.jsxs)("p",{className:"flexEndStyle styleT3",children:["Total ",(0,P.jsx)("span",{className:"styleT2",children:"0 Sales"})," ",(0,P.jsx)("strong",{className:"styleT1",children:"$0.00"})]})})]})}):(0,P.jsx)(tt.A,{fluid:!0,children:(0,P.jsxs)(ws.A,{style:{display:"flex",alignItems:"center"},children:[(0,P.jsxs)(As.A,{style:{textAlign:"left",display:"flex",alignItems:"center"},children:[(0,P.jsx)("div",{className:"filterDropDown",onClick:()=>{M(!U)},children:(0,P.jsx)(b.A,{ref:O,variant:"link",children:(0,P.jsx)(Ks.A,{color:"#344054",size:20})})}),(0,P.jsx)("div",{className:"filterSearch",children:(0,P.jsx)(ht,{setInputValue:Z,inputValue:G})})]}),(0,P.jsx)(As.A,{children:(0,P.jsx)("div",{className:"centerTabSales",children:(0,P.jsxs)("ul",{children:[(0,P.jsx)("li",{children:(0,P.jsx)(p.k2,{to:"#",children:"Sales"})}),(0,P.jsx)("li",{children:null!==i&&void 0!==i&&null!==(s=i.bank_detail)&&void 0!==s&&s.account_number?(0,P.jsxs)(p.k2,{className:"tabActive",to:"/sales/newquote/selectyourclient",children:[(0,P.jsx)("span",{style:{fontWeight:400},children:"Quote New Project"})," ",(0,P.jsx)(r.A,{color:"#fff",size:16})]}):(0,P.jsx)(rt,{})})]})})}),(0,P.jsx)(As.A,{style:{textAlign:"right"},children:c&&(null===c||void 0===c?void 0:c.length)>0?(0,P.jsxs)("p",{className:"flexEndStyle styleT3",children:["Total"," ",(0,P.jsxs)("span",{className:"styleT2",style:{whiteSpace:"nowrap"},children:[null!==v&&void 0!==v&&v.length?(0,P.jsxs)(P.Fragment,{children:[" ",null===v||void 0===v?void 0:v.length]}):(0,P.jsxs)(P.Fragment,{children:[null===c||void 0===c?void 0:c.length," "]})," ","Sales"]}),(0,P.jsxs)("strong",{className:"styleT1",children:["$",(0,P.jsx)(P.Fragment,{children:ee})]}),(0,P.jsx)("div",{style:{width:"60px",height:"12px",background:"#EAECF0",borderRadius:"20px",marginLeft:"8px"},children:(0,P.jsx)("div",{style:{width:`${k||0}%`,height:"100%",background:"#1AB2FF",borderRadius:"20px"}})}),(0,P.jsxs)("span",{className:"font-14",style:{fontWeight:500,margin:"0px 8px 0px 12px",color:"#344054"},children:[k||0,"%"]}),(0,P.jsxs)("strong",{className:"styleT1",children:["$",(0,ut.m)(L||0)]})]}):(0,P.jsxs)("p",{className:"flexEndStyle styleT3",children:["Total ",(0,P.jsx)("span",{className:"styleT2",children:"0 Sales"})," ",(0,P.jsx)("strong",{className:"styleT1",children:"$0.00"})]})})]})})}),U&&(0,P.jsxs)(at.A,{id:"controlled-tab-example",activeKey:I,onSelect:e=>$(e),className:"filtterBoxWrapper",children:[(0,P.jsx)(lt.A,{eventKey:"DateRange",title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Js.A,{color:"#667085",size:16})," Date Range"]}),children:(0,P.jsx)("ul",{children:(0,P.jsx)(dt,{onDataApply:e=>{const s=e=>e?new Date(e).toLocaleDateString("en-CA"):"",t=s(e.startDate),l=s(e.endDate),a=`${t} - ${l}`;B({...R,dateRange:[a]});let n={...D};n.dateRange=[t,l],z(n),X(n),M(!1)}})})}),(0,P.jsx)(lt.A,{eventKey:"Progress",title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Xs.A,{color:"#667085",size:16})," Progress"]}),children:(0,P.jsxs)("ul",{children:[(0,P.jsx)("div",{style:{maxHeight:"350px",overflow:"auto"},children:xt.map(((e,s)=>{var t,l;return(0,P.jsx)("li",{className:null!==D&&void 0!==D&&null!==(t=D.progress)&&void 0!==t&&t.includes(e.label)?"checkedList":"",children:(0,P.jsx)("label",{className:"customCheckBox",children:(0,P.jsx)("div",{className:"userName",children:(0,P.jsx)("div",{className:"ProgressTag",children:(0,P.jsxs)("div",{className:"option","data-percentage":e.percentage,children:[(0,P.jsx)("input",{type:"checkbox",value:e.label,checked:null===D||void 0===D||null===(l=D.progress)||void 0===l?void 0:l.includes(e.label),onChange:()=>{return s=e.label,void z((e=>{const t=e.progress||[];return null!==t&&void 0!==t&&t.includes(s)?{...e,progress:t.filter((e=>e!==s))}:{...e,progress:[...t,s]}}));var s}}),(0,P.jsx)("span",{className:"checkmark",children:(0,P.jsx)(h.A,{color:"#1ab2ff",size:20})}),(0,P.jsxs)("div",{className:"progressWrapper",children:[(0,P.jsxs)("div",{className:"labelInfo",children:[(0,P.jsx)("strong",{children:e.label}),(0,P.jsx)("div",{className:"progress-light-grey",children:(0,P.jsx)("div",{className:"progress-container progress-color progress-center",style:{background:e.gradient},"aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100",children:(0,P.jsxs)("span",{children:[e.percentage,"%"]})})})]}),(0,P.jsxs)("label",{children:[e.percentage,"%"]})]})]})})})})},s)}))}),(0,P.jsxs)(ws.A,{className:"buttomBottom d-flex justify-content-between align-items-center",children:[(0,P.jsx)(As.A,{className:"pr-2",children:(0,P.jsx)(b.A,{variant:"tabContent tabCancel",onClick:()=>{z((e=>{const{progress:s,...t}=e;return t}))},children:"Cancel"})}),(0,P.jsx)(As.A,{children:(0,P.jsx)(b.A,{variant:"tabContent tabApply",onClick:()=>{const e=D.progress||[];B({...R,progress:e}),X(D),M(!1)},children:"Apply"})})]})]})}),(0,P.jsx)(lt.A,{eventKey:"Status",title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(et.A,{color:"#667085",size:16}),"Status"]}),children:(0,P.jsxs)("ul",{children:[(0,P.jsx)("div",{style:{maxHeight:"350px",overflow:"auto"},children:["Draft","Saved","Sent","Accepted","Recurring","Review","Declined","Required"].map(((e,s)=>{var t,l;return(0,P.jsx)("li",{className:null!==D&&void 0!==D&&null!==(t=D.statuses)&&void 0!==t&&t.includes(e)?"checkedList":"",children:(0,P.jsxs)("label",{className:`customCheckBox ${e}`,children:[(0,P.jsx)("input",{type:"checkbox",value:e,checked:null===D||void 0===D||null===(l=D.statuses)||void 0===l?void 0:l.includes(e),onChange:()=>{return s=e,void z((e=>{const t=e.statuses||[];return null!==t&&void 0!==t&&t.includes(s)?{...e,statuses:t.filter((e=>e!==s))}:{...e,statuses:[...t,s]}}));var s}}),(0,P.jsx)("span",{className:"checkmark",children:(0,P.jsx)(h.A,{color:"#1ab2ff",size:20})}),(0,P.jsxs)("div",{className:"userName",children:[(0,P.jsx)("span",{className:(0,H.A)("statusInfo",e),children:(0,P.jsx)("a",{children:e})})," "]})]})},s)}))}),(0,P.jsxs)(ws.A,{className:"buttomBottom d-flex justify-content-between align-items-center",children:[(0,P.jsx)(As.A,{className:"pr-2",children:(0,P.jsx)(b.A,{variant:"tabContent tabCancel",onClick:()=>{z((e=>{const{statuses:s,...t}=e;return t}))},children:"Cancel"})}),(0,P.jsx)(As.A,{children:(0,P.jsx)(b.A,{variant:"tabContent tabApply",onClick:()=>{const e={...D};z(e),X(e),B({...R,statuses:e.statuses}),M(!1)},children:"Apply"})})]})]})}),(0,P.jsx)(lt.A,{eventKey:"projectManager",title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(o.A,{color:"#667085",size:16}),"Project Manager"]}),children:(0,P.jsxs)("ul",{children:[(0,P.jsx)("div",{id:"controlled-tab-example-tabpane-Status",style:{maxHeight:"350px",overflow:"auto"},children:null===J||void 0===J||null===(t=J.data)||void 0===t?void 0:t.map(((e,s)=>{var t,l;return(0,P.jsx)("li",{className:null!==D&&void 0!==D&&null!==(t=D.projectManager)&&void 0!==t&&t.includes(e.name)?"checkedList":"",children:(0,P.jsxs)("label",{className:`customCheckBox ${e.name}`,children:[(0,P.jsx)("input",{type:"checkbox",value:e.name,checked:(null===D||void 0===D||null===(l=D.projectManager)||void 0===l?void 0:l.includes(e.name))||!1,onChange:()=>{return s=e.name,void z((e=>{const t=e.projectManager||[];return null!==t&&void 0!==t&&t.includes(s)?{...e,projectManager:t.filter((e=>e!==s))}:{...e,projectManager:[...t,s]}}));var s}}),(0,P.jsx)("span",{className:"checkmark",children:(0,P.jsx)(h.A,{color:"#1ab2ff",size:20})}),(0,P.jsxs)("div",{className:"ms-3 d-flex justify-content-center align-items-center",children:[(0,P.jsx)(pt.Ay,{has_photo:e.has_photo,photo:e.photo,is_business:!1}),(0,P.jsx)("span",{className:"font-14",style:{color:"#374151"},children:(0,P.jsx)("a",{children:e.name})})]})]})},s)}))}),(0,P.jsxs)(ws.A,{className:"buttomBottom d-flex justify-content-between align-items-center",children:[(0,P.jsx)(As.A,{className:"pr-2",children:(0,P.jsx)(b.A,{variant:"tabContent tabCancel",onClick:()=>{console.log("..."),z((e=>{const{projectManager:s,...t}=e;return t}))},children:"Cancel"})}),(0,P.jsx)(As.A,{children:(0,P.jsx)(b.A,{variant:"tabContent tabApply",onClick:()=>{const e={...D};z(e),X(e),B({...R,projectManager:e.projectManager}),M(!1)},children:"Apply"})})]})]})})]}),(null===(a=Object.keys(R))||void 0===a?void 0:a.length)>0&&(0,P.jsx)("div",{className:"mainTagsWrapper",children:null===(n=Object.entries(R))||void 0===n?void 0:n.map((e=>{let[s,t]=e;return(0,P.jsx)("div",{children:(null===t||void 0===t?void 0:t.length)>0&&(0,P.jsx)("div",{className:"tags-input-container",children:(0,P.jsxs)("ul",{children:[t.map(((e,l)=>(0,P.jsxs)("li",{className:"mainWrapperTags tag-item-wrap",children:[e,(null===t||void 0===t?void 0:t.length)>1&&(0,P.jsx)(b.A,{variant:"link",size:"sm",style:{marginLeft:"5px"},onClick:()=>((e,s)=>{const t={...R},l=t[e].filter((e=>e!==s));t[e]=l,B(t),z({...D,[e]:l}),X({...D,[e]:l})})(s,e),children:(0,P.jsx)(se.A,{color:"#F96969",size:15})})]},l))),(0,P.jsx)(b.A,{variant:"link",size:"sm",style:{marginLeft:"0px"},onClick:()=>(e=>{const s={...R};delete s[e],B(s);const t={...D};delete t[e],z(t),X(t)})(s),children:(0,P.jsx)(se.A,{color:"#F96969",size:20})})]})})},s)}))})]})};var gt=t(79106),jt=t(48417),ft=t(99868);const yt=e=>{let{params:s,userGroups:t=[],refreshData:a}=e;const n=(0,l.useRef)(null),i=(0,l.useRef)(null),[c,d]=(0,l.useState)(!1),m=(0,l.useMemo)((()=>(null===s||void 0===s?void 0:s.value)||[]),[null===s||void 0===s?void 0:s.value]),[h,u]=(0,l.useState)([]);(0,l.useEffect)((()=>{const e=null===m||void 0===m?void 0:m.map((e=>null===e||void 0===e?void 0:e.full_name)),s=[];t.forEach((t=>{t.items.forEach((t=>{e.includes(t.first_name+" "+t.last_name)&&s.push(t.id)}))})),u(s)}),[m,t]);const p=(0,P.jsxs)("div",{className:"d-flex justify-content-end gap-2 p-3 border-top",children:[(0,P.jsx)(b.A,{className:"outline-button py-1",onClick:()=>{u([]),i.current.hide()},children:"Cancel"}),(0,P.jsxs)(b.A,{className:"solid-button py-1",onClick:async()=>{if(0!==h.length)try{var e;d(!0),await(0,T.Sg)(null===s||void 0===s||null===(e=s.row)||void 0===e?void 0:e.id,h),_.oR.success(h.length>1?`${h.length} managers assigned`:"Manager assigned successfully"),u([]),i.current.hide(),a&&a(),d(!1)}catch(t){d(!1),console.error("Assignment failed:",t),_.oR.error("Failed to assign managers")}else i.current.hide()},disabled:0===h.length,children:["Apply",c&&(0,P.jsx)(y.p,{style:{width:"16px",height:"16px",marginLeft:"8px"},strokeWidth:"4"})]})]});return(0,P.jsxs)("div",{style:{position:"relative"},children:[(0,P.jsxs)(g.Z,{onClick:e=>{n.current.toggle(e)},style:{cursor:"pointer"},children:[m.slice(0,2).map(((e,s)=>(0,P.jsx)(v.e,{shape:"circle",image:e.has_photo&&e.photo?e.photo:null,label:e.has_photo&&e.photo?null:(0,P.jsx)("small",{children:e.alias_name}),style:{background:"#fff",border:"1px solid #dedede"}},`${e.id||e.email}-${s}`))),m.length>2&&(0,P.jsx)(v.e,{label:"+"+(m.length-2),shape:"circle",size:"small",style:{fontSize:"14px"}})]}),(0,P.jsxs)(f.j,{ref:n,className:"salesOverlay",style:{width:"340px"},children:[m.length>0?m.map(((e,s)=>(0,P.jsxs)("div",{className:"d-flex align-items-center px-3 py-2",style:{borderBottom:s<m.length-1?"1px solid #f2f4f7":"none"},children:[(0,P.jsx)(v.e,{image:e.has_photo&&e.photo?e.photo:null,icon:e.has_photo&&e.photo?null:(0,P.jsx)(o.A,{color:"#667085",size:20}),shape:"circle",style:{background:"#fff",border:"1px solid #dedede"}}),(0,P.jsx)("div",{className:"ms-2",children:(0,P.jsx)("div",{className:"fullnameText",children:e.full_name})})]},e.id||s))):(0,P.jsx)("div",{className:"px-3 py-2 text-muted fst-italic",children:"No managers assigned"}),(0,P.jsx)("div",{className:"py-2 border-top",children:(0,P.jsxs)("div",{className:"d-flex align-items-center gap-3 px-3 py-3 rounded cursor-pointer",style:{backgroundColor:"#f9fafb",transition:"background 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f0f5ff",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#f9fafb",onClick:e=>{var s;e.stopPropagation(),null===(s=i.current)||void 0===s||s.show(e)},children:[(0,P.jsx)("div",{className:"d-flex align-items-center justify-content-center rounded-circle",style:{width:"32px",height:"32px",backgroundColor:"#1AB2FF"},children:(0,P.jsx)(r.A,{color:"white",size:16})}),(0,P.jsx)("span",{style:{color:"#1AB2FF",fontWeight:500},children:"Assign Project Manager"})]})}),(0,P.jsx)(j.K,{ref:i,value:h,onChange:e=>u(e.value),options:t,optionLabel:"first_name",optionValue:"id",optionGroupLabel:"label",optionGroupChildren:"items",placeholder:"Search managers...",filter:!0,filterBy:"first_name,last_name,email",itemTemplate:e=>{var s,t;return(0,P.jsxs)("div",{className:"d-flex align-items-center gap-2 py-2",children:[(0,P.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede",background:"#fff",flexShrink:0},children:e.has_photo&&e.photo?(0,P.jsx)(Fs.A,{photo:e.photo,has_photo:e.has_photo,alt:`${e.first_name} ${e.last_name}`,is_business:!1,size:32}):(0,P.jsx)("div",{className:"d-flex align-items-center justify-content-center h-100",children:(0,P.jsx)("small",{style:{fontSize:"12px",color:"#667085"},children:e.alias_name||`${(null===(s=e.first_name)||void 0===s?void 0:s[0])||""}${(null===(t=e.last_name)||void 0===t?void 0:t[0])||""}`})})}),(0,P.jsxs)("div",{className:"flex-1",children:[(0,P.jsxs)("div",{style:{fontSize:"14px",fontWeight:500,color:"#344054"},children:[e.first_name," ",e.last_name]}),e.email&&(0,P.jsx)("div",{style:{fontSize:"12px",color:"#667085"},children:e.email})]})]})},panelFooterTemplate:p,style:{opacity:0,position:"absolute",pointerEvents:"none",width:"100%"},panelStyle:{width:"340px"}})]})]})},bt=e=>{const s=new Date(1e3*e);return`${s.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(s)} ${s.getFullYear()}`},_t=(e,s,t)=>(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(Zs,{noteData:e,saleUniqueId:s,refreshData:t})}),Ct=(e,s)=>e.map((e=>({unique_id:e.unique_id,id:e.id,Quote:e.number,created:e.created,Client:e.client.name,clientId:e.client.id,photo:e.client.photo,is_business:e.client.is_business,hasPhoto:e.client.has_photo,Reference:e.reference,Status:e.status,Calculation:e.calculation,CalculationPDF:e.quote_url,CalculationURL:e.unique_url,Note:_t(e.sales_note,e.unique_id,s),User:e.managers,fullName:e.manager.full_name,Contact:e.sales_contacts,progressName:e.lead.name,progressPercentage:e.lead.percentage,saleUniqueId:e.unique_id,wonQuote:(e.number,e.status),LostQuote:(e.number,e.status),amountData:e.amount,Actions:"Actions",history:null===e||void 0===e?void 0:e.previous_versions,has_recurring:e.has_recurring,requestChanges:e.request_changes||[],assignManagers:e.managers||[]}))),Nt=e=>{let{profileData:s,salesData:t,fetchData:a,isLoading:n}=e;const{trialHeight:o}=(0,jt.$)(),[r,v]=(0,l.useState)([]),[g,j]=(0,l.useState)([]),[f,y]=(0,l.useState)([]),[_,C]=(0,l.useState)(null),[N,A]=(0,l.useState)([]),w=(0,x.I)({queryKey:["getUserList"],queryFn:gt.aU});(0,l.useEffect)((()=>{!_&&N.length>0&&A([])}),[_,N]),(0,l.useEffect)((()=>{var e,s;const t=[];if((null===w||void 0===w||null===(e=w.data)||void 0===e||null===(s=e.users)||void 0===s?void 0:s.length)>0){const e=w.data.users.filter((e=>null===e||void 0===e?void 0:e.is_active)).map((e=>({id:null===e||void 0===e?void 0:e.id,first_name:null===e||void 0===e?void 0:e.first_name,last_name:null===e||void 0===e?void 0:e.last_name,photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo})));e.length>0&&t.push({label:"Desktop User",items:e})}y(t)}),[null===w||void 0===w?void 0:w.data]);const S=(0,l.useCallback)((async()=>{await a()}),[a]),k=(0,l.useCallback)((()=>{a()}),[a]),F=g.length,L=[{field:"Quote",width:144,headerName:(0,P.jsx)("div",{className:"styleColor1",children:(0,P.jsx)("span",{className:"ps-3",children:"Quote"})}),renderCell:e=>(0,P.jsxs)("div",{className:"innerFlex styleColor2 d-flex justify-content-between",children:[(0,P.jsxs)("div",{className:"styleColor1",children:[(0,P.jsx)("strong",{className:"ellipsis-width",style:{maxWidth:"85px"},title:e.value,children:e.value}),(0,P.jsx)("p",{children:bt(e.row.created)})]}),(0,P.jsx)(p.N_,{to:"#",onClick:()=>{C(e.row.unique_id),A(e.row.assignManagers)},children:(0,P.jsx)(b.A,{className:"linkByttonStyle",variant:"link",children:"Open"})})]})},{field:"Client",width:270,headerName:(0,P.jsx)("div",{className:"styleColor1",children:(0,P.jsx)("span",{children:"Client"})}),renderCell:e=>{var s,t;return(0,P.jsxs)("div",{className:"d-flex align-items-center",children:[(0,P.jsx)(pt.Ay,{has_photo:e.row.hasPhoto,photo:null===(s=e.row)||void 0===s?void 0:s.photo,is_business:null===(t=e.row)||void 0===t?void 0:t.is_business}),(0,P.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"200px"},title:e.value,children:e.value})]})}},{field:"Reference",sortable:!1,width:500,headerName:"Reference",renderCell:e=>(0,P.jsx)("div",{className:"mainStyle mainStyleMin",style:{whiteSpace:"normal",textAlign:"left"},children:e.value})},{field:"Status",sortable:!1,headerName:(0,P.jsx)("div",{className:"styleColor1",children:(0,P.jsx)("span",{children:"Status"})}),width:118,renderCell:e=>(0,P.jsxs)("div",{className:"d-flex align-items-center justify-content-start",children:[(0,P.jsx)("div",{className:`statusInfo ${e.value}`,children:(0,P.jsx)(p.N_,{to:"/",style:{pointerEvents:"none"},children:e.value})}),e.row.has_recurring&&(0,P.jsx)(p.N_,{to:`/settings/quotesjobs/recurring-quotes?recurringId=${e.row.unique_id}`,className:"ms-2",children:(0,P.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"17",height:"14",viewBox:"0 0 17 14",fill:"none",children:[(0,P.jsx)("path",{d:"M11.5 4.46622V2.99998H5.5C3.29086 2.99998 1.5 4.79085 1.5 6.99998C1.5 7.63948 1.6497 8.24258 1.91552 8.77747C2.03841 9.02476 1.93757 9.32485 1.69028 9.44774C1.44299 9.57063 1.1429 9.46979 1.02 9.2225C0.687005 8.55243 0.5 7.79733 0.5 6.99998C0.5 4.23856 2.73858 1.99998 5.5 1.99998H11.5V0.533742C11.5 0.321783 11.7472 0.205993 11.91 0.341687L14.2695 2.30793C14.3895 2.40788 14.3895 2.59209 14.2695 2.69204L11.91 4.65828C11.7472 4.79397 11.5 4.67818 11.5 4.46622Z",fill:"#158ECC"}),(0,P.jsx)("path",{d:"M15.3097 4.55223C15.557 4.42934 15.8571 4.53018 15.98 4.77747C16.313 5.44754 16.5 6.20264 16.5 6.99998C16.5 9.76141 14.2614 12 11.5 12H5.5V13.4662C5.5 13.6782 5.25279 13.794 5.08995 13.6583L2.73047 11.692C2.61053 11.5921 2.61053 11.4079 2.73047 11.3079L5.08995 9.34169C5.25279 9.20599 5.5 9.32178 5.5 9.53374V11H11.5C13.7091 11 15.5 9.20912 15.5 6.99998C15.5 6.36049 15.3503 5.75739 15.0845 5.2225C14.9616 4.97521 15.0624 4.67512 15.3097 4.55223Z",fill:"#158ECC"})]})}),(0,P.jsx)(ms,{requestChanges:e.row.requestChanges,quoteNumber:e.row.Quote,status:e.value})]})},{field:"Calculation",sortable:!1,headerName:"Calculation",width:147,renderCell:e=>(0,P.jsx)("div",{children:(0,P.jsxs)("ul",{className:"disPlayInline disPlayInlineCenter",children:[(0,P.jsx)(p.N_,{to:`/sales/quote-calculation/${e.row.unique_id}`,children:(0,P.jsx)("li",{className:"plusminus",children:(0,P.jsx)(c.A,{color:"#FDB022",size:16})})}),(0,P.jsx)("li",{className:`${e.row.Status}`,children:(0,P.jsx)(p.N_,{to:e.row.CalculationPDF,target:"_blank",rel:"noopener noreferrer",children:(0,P.jsx)(d.A,{color:"#FF0000",size:16})})}),(0,P.jsx)("li",{className:`${e.row.Status}`,children:(0,P.jsx)(p.N_,{to:`/quote/${e.row.unique_id}`,target:"_blank",rel:"noopener noreferrer",children:(0,P.jsx)(m.A,{color:"#3366CC",size:16})})})]})})},{field:"Note",sortable:!1,headerName:"Note",width:94,renderCell:e=>(0,P.jsx)("div",{children:e.value})},{field:"User",sortable:!1,headerName:"User",width:56,renderCell:e=>(0,P.jsx)(yt,{params:e,userGroups:f,refreshData:k})},{field:"Contact",sortable:!1,headerName:"Contact",width:183,renderCell:e=>(0,P.jsx)("div",{children:(0,P.jsx)(Ne,{type:e.value,saleUniqueId:e.row.saleUniqueId,refreshData:k,created:e.row.created})})},{field:"Progress",headerName:(0,P.jsx)("div",{className:"styleColor1",children:(0,P.jsx)("span",{children:"Progress"})}),width:232,renderCell:e=>(0,P.jsx)("div",{style:{width:"100%"},children:(0,P.jsx)(ke,{progressName1:e.row.progressName,progressPercentage1:e.row.progressPercentage,salesUniqId1:e.row.saleUniqueId,refreshData:()=>{}})})},{field:"W",sortable:!1,headerName:"Lost / Won",width:106,renderCell:e=>(0,P.jsx)("div",{children:(0,P.jsxs)("div",{className:"styleActionBtn",children:[(0,P.jsx)(qe,{size:16,color:"#D92D20",LostQuote:e.row.LostQuote,saleUniqueId:e.row.saleUniqueId,saleId:e.row.id,status:e.row.status,onRemoveRow:S,fetchData1:v,quoteType:"lost"}),(0,P.jsx)(Me,{size:16,color:"#079455",wonQuote:e.row.wonQuote,saleUniqueId:e.row.saleUniqueId,saleId:e.row.id,status:e.row.status,onRemoveRow:S,fetchData1:v,quoteType:"won"})]})})},{field:"Actions",sortable:!1,headerName:"Actions",width:72,className:"ActionBtn",renderCell:e=>(0,P.jsx)(Y,{saleUniqueId:e.row.saleUniqueId,clientId:e.row.clientId,refreshData:k,status:e.row.Status,salesHistory:e.row.history},e.row.saleUniqueId)}];(0,l.useEffect)((()=>{const e=Ct(t,k);v(e)}),[t,g,k]);return(0,P.jsxs)("div",{className:"salesTableWrap",children:[(0,P.jsx)(vt,{profileData:s,salesData:t,removeRowMulti:S,selectedUniqueIds:t.filter((e=>g.includes(e.id))).map((e=>e.unique_id)),onRowsFilterChange:e=>{v(e)},rows:r,setSelectedRows:j,selectedRow:g,selectedRowCount:F}),!n&&(0,P.jsxs)(i.A,{responsive:!0,style:{marginBottom:`${o}px`},children:[(0,P.jsx)("thead",{style:{position:"sticky",top:"0px",zIndex:9},children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{style:{width:40},children:(0,P.jsxs)("label",{className:"customCheckBox",children:[(0,P.jsx)("input",{type:"checkbox",checked:g.length&&g.length===t.length,onChange:()=>{const e=t&&t.length&&t.map((e=>e.id))||[];g.length===e.length?j([]):j(e)}}),(0,P.jsx)("span",{className:"checkmark",children:(0,P.jsx)(h.A,{color:"#1ab2ff",size:20})})]})}),L.map((e=>(0,P.jsx)("th",{style:{width:e.width},children:(0,P.jsx)(u.Resizable,{width:e.width||100,height:0,children:(0,P.jsx)("div",{children:e.headerName})})},e.field)))]})}),(0,P.jsx)("tbody",{children:0===r.length?(0,P.jsx)("tr",{className:"nodataTableRow",children:(0,P.jsx)("td",{colSpan:L.length,style:{textAlign:"center",overflow:"auto"},children:(0,P.jsx)(ft.A,{isDataExist:!!t.length})})}):r.map((e=>(0,P.jsxs)("tr",{"data-saleuniqueid":e.saleUniqueId,className:`${g.includes(e.id)?"selected-row":""} ${e.unique_id?`row-id-${e.unique_id}`:""}`,children:[(0,P.jsx)("td",{style:{width:40},children:(0,P.jsxs)("label",{className:"customCheckBox",children:[(0,P.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:()=>(e=>{const s=[...g];s.includes(e)?s.splice(s.indexOf(e),1):s.push(e),j(s||[])})(e.id)}),(0,P.jsx)("span",{className:"checkmark",children:(0,P.jsx)(h.A,{color:"#1AB2FF",size:20})})]})}),L.map((s=>(0,P.jsx)("td",{children:s.renderCell({value:e[s.field],row:e})},s.field+e.id)))]},e.id)))})]}),_&&(0,P.jsx)(Ws,{salesHistoryId:_,setSalesHistoryId:C,onRemoveRow:k,managers:N||[]})]})},At=()=>{const[e,s]=(0,l.useState)(!0),t=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[i,o]=(0,l.useState)([]),r=async()=>{try{s(!0);const e=await(0,T.j3)(),t=JSON.parse(e);o(t)}catch(e){console.error("Error fetching sales data:",e)}finally{s(!1)}};return(0,l.useEffect)((()=>{r()}),[]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(n.mg,{children:(0,P.jsx)("title",{children:"MeMate - Sales"})}),e&&(0,P.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,P.jsx)(a.A,{animation:"border",role:"status",children:(0,P.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),(0,P.jsx)(Nt,{profileData:t,salesData:i,fetchData:r,isLoading:e})]})}},83738:(e,s,t)=>{t.d(s,{s:()=>c});var l=t(65043),a=t(58387),n=t(670),i=t(68767),o=t(32370),r=t(70579);const c=e=>{let{onDataApply:s,dateRange:t,onClose:c,className:d=""}=e;const[m,h]=(0,l.useState)(null);(0,l.useEffect)((()=>{if(null!==t&&void 0!==t&&t.startDate&&null!==t&&void 0!==t&&t.endDate){const e=t.startDate instanceof Date?t.startDate:new Date(t.startDate),s=t.endDate instanceof Date?t.endDate:new Date(t.endDate);h([e,s])}}),[t]);const u=(0,l.useCallback)((()=>{m&&2===m.length&&m[0]&&m[1]?s({startDate:m[0],endDate:m[1]}):m&&1===m.length&&m[0]&&s({startDate:m[0],endDate:m[0]})}),[m,s]),p=(0,l.useCallback)((()=>{h(null),c&&c()}),[c]),x=(0,l.useCallback)((()=>{const e=new Date;e.setHours(0,0,0,0),h([e,e])}),[]),v=(0,l.useCallback)((()=>{const e=m&&m.length>=1&&m[0];return(0,r.jsxs)("div",{className:"date-range-footer",children:[(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-today",onClick:x,children:"Today"}),(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-cancel",onClick:p,children:"Cancel"}),(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-apply",onClick:u,disabled:!e,children:"Apply"})]})}),[m,x,p,u]),g=(0,l.useCallback)((()=>{var e,s;if(!m||0===m.length)return"Select date range";const t={month:"short",day:"numeric",year:"numeric"},l=(null===(e=m[0])||void 0===e?void 0:e.toLocaleDateString("en-US",t))||"",a=(null===(s=m[1])||void 0===s?void 0:s.toLocaleDateString("en-US",t))||"";return l&&a?`${l} - ${a}`:l?`${l} - Select end date`:"Select date range"}),[m]);return(0,r.jsxs)("div",{className:(0,a.A)("date-range-picker-calendar",d),children:[(0,r.jsx)("div",{className:"date-range-header",children:(0,r.jsx)("span",{className:"date-range-header-text",children:g()})}),(0,r.jsx)(n.V,{value:m,onChange:e=>h(e.value),selectionMode:"range",inline:!0,numberOfMonths:1,locale:"en",dateFormat:"dd M yy",footerTemplate:v,firstDayOfWeek:1,showButtonBar:!1,prevIcon:(0,r.jsx)(i.Y,{}),nextIcon:(0,r.jsx)(o.v,{})})]})}},91242:(e,s,t)=>{t.d(s,{A:()=>u});var l=t(65043),a=t(56741),n=t(47097),i=t(14282),o=t(78602),r=t(32952),c=t(61072),d=t(11520),m=t(70767),h=t(70579);const u=e=>{let{projectId:s,projectCardData:t}=e;const[u,p]=(0,l.useState)(!1),[x,v]=(0,l.useState)(""),[g,j]=(0,l.useState)({description:""}),f=2e3,y=()=>p(!1),b=(0,n.n)({mutationFn:e=>(0,d.o2)(s,e),onSuccess:()=>{y(),t(s)},onError:e=>{console.error("Error creating note:",e),j((s=>({...s,description:e.message||"Failed to save note. Please try again."})))}}),_=e=>e.trim()?e.length<3?"Note must be at least 3 characters long":e.length>f?"Note must not exceed 2000 characters":/^\s+$/.test(e)?"Note cannot contain only whitespace":"":"Note is required";return(0,l.useEffect)((()=>{u||(v(""),j({description:""}))}),[u]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"linkByttonStyle py-2 border-right",onClick:()=>p(!0),children:"Add Note"}),(0,h.jsxs)(r.A,{show:u,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:y,animation:!1,size:"lg",children:[(0,h.jsxs)(r.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,h.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,h.jsxs)("span",{children:[(0,h.jsx)("img",{src:m.A,alt:"AddNoteModeIcon"}),"Add Note"]})}),(0,h.jsx)("button",{className:"CustonCloseModal",onClick:y,children:(0,h.jsx)(a.A,{size:24,color:"#667085"})})]}),(0,h.jsx)(r.A.Body,{children:(0,h.jsx)("div",{className:"ContactModel",children:(0,h.jsx)(c.A,{children:(0,h.jsx)(o.A,{children:(0,h.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,h.jsxs)("label",{htmlFor:"note-input",children:["Note ",(0,h.jsx)("span",{className:"required",children:"*"})]}),(0,h.jsx)("div",{className:"inputInfo "+(g.description?"error-border":""),children:(0,h.jsx)("textarea",{id:"note-input",type:"text",name:"note",value:x,placeholder:"Enter a message here...",onChange:e=>{const s=e.target.value;v(s);const t=_(s);j((e=>({...e,description:t})))},maxLength:f,rows:10,className:"w-100"})}),(0,h.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,h.jsx)("small",{className:g.description?"error-message":"text-muted",children:g.description||`${x.length}/2000 characters`})})]})})})})}),(0,h.jsx)(r.A.Footer,{className:"pt-0",children:(0,h.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,h.jsx)(i.A,{variant:"outline-danger",onClick:y,disabled:b.isPending,children:"Cancel"}),(0,h.jsx)(i.A,{variant:"primary save",onClick:()=>{const e=_(x);e?j((s=>({...s,description:e}))):b.mutate({text:x.trim()})},disabled:b.isPending||!!g.description,children:b.isPending?"Saving...":"Save"})]})})]})]})}},95753:(e,s,t)=>{t.d(s,{A:()=>r,v:()=>o});var l=t(65043),a=t(22927),n=t(43984),i=t(70579);function o(e){return e>=1048576?(e/1048576).toFixed(1)+" MB":e>=1024?(e/1024).toFixed(1)+" KB":e+" B"}const r=e=>{let{onFileChange:s,styles:t}=e;const[o,r]=(0,l.useState)(!1),c=(0,l.useRef)(),d=(0,l.useRef)(),m=e=>{const s=c.current,t=d.current;if(!s||!t)return;const l=s.contains(e.target),a=t.contains(e.target);l||a||r(!1)};return l.useEffect((()=>(document.addEventListener("click",m),()=>{document.removeEventListener("click",m)})),[]),(0,i.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,i.jsx)("button",{className:t.attachButton,type:"button","aria-label":"Attach file",ref:c,onClick:()=>r((e=>!e)),style:{padding:"6px 6px 6px 8px"},children:(0,i.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M18.0833 8.33333L9.16667 17.25C8.17221 18.2444 6.82407 18.8042 5.41667 18.8042C4.00926 18.8042 2.66112 18.2444 1.66667 17.25C0.672214 16.2556 0.112446 14.9074 0.112446 13.5C0.112446 12.0926 0.672214 10.7444 1.66667 9.75L10.5833 0.833329C11.2486 0.167998 12.1514 -0.149151 13.0833 0.0666624C14.0153 0.282476 14.8056 0.947998 15.25 1.83333C15.6944 2.71866 15.7361 3.75 15.3333 4.66666C14.9306 5.58333 14.1389 6.29166 13.1667 6.5L5.08333 14.5833C4.75 14.9167 4.31944 15.0833 3.83333 15.0833C3.34722 15.0833 2.91667 14.9167 2.58333 14.5833C2.25 14.25 2.08333 13.8194 2.08333 13.3333C2.08333 12.8472 2.25 12.4167 2.58333 12.0833L9.16667 5.5",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}),o&&(0,i.jsxs)("div",{ref:d,className:t.attachmentPopover,style:{position:"absolute",bottom:"40px",left:-200,zIndex:20,minWidth:220,background:"#fff",borderRadius:8,boxShadow:"0 4px 24px rgba(16,24,40,0.18)",padding:10},children:[(0,i.jsxs)("label",{className:t.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,i.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{s(e),r(!1)},accept:".pdf, .doc, .docx, .txt"}),(0,i.jsx)(a.A,{size:16,color:"#667085"}),(0,i.jsx)("span",{className:"font-16",children:"Document"})]}),(0,i.jsxs)("label",{className:t.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,i.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{s(e),r(!1)},accept:"image/*"}),(0,i.jsx)(n.A,{size:16,color:"#667085"}),(0,i.jsx)("span",{className:"font-16",children:"Photo "})]})]})]})}},99678:(e,s,t)=>{t.d(s,{L:()=>ee});var l=t(10737),a=t(36858),n=t(50917),i=t(35646),o=t(62645),r=t(50410),c=t(43808),d=t(26506),m=t(11062),h=t(53516),u=t(57927),p=t(80501),x=t(25004),v=t(64721),g=t(55251),j=t(25958),f=t(28987),y=t(86169),b=t(10213),_=t(65961),C=t(78909),N=t(988),A=t(71584),w=t(11733),S=t(98465),k=t(83700),F=t(46),L=t(85421),E=t(97530),I=t(14872),T=t(18917),$=t(60571),R=t(19188),B=t(52068),q=t(27726),D=t(86944),z=t(1427),P=t(94154),U=t(57160),H=t(93819),M=t(40261),V=t(17544),W=t(28494),O=t(81460),G=t(43414),Q=t(10095),Z=t(7647),K=t(91875),Y=t(10696),J=t(70579);const X={aac:{icon:l.A,color:"#4CAF50"},ai:{icon:a.A,color:"#FF9800"},bmp:{icon:n.A,color:"#00ADEF"},cs:{icon:i.A,color:"#239120"},css:{icon:o.A,color:"#1572B6"},csv:{icon:r.A,color:"#22A746"},doc:{icon:c.A,color:"#2368E1"},docx:{icon:d.A,color:"#2368E1"},exe:{icon:m.A,color:"#8E8E8E"},gif:{icon:h.A,color:"#F64A8A"},heic:{icon:u.A,color:"#FFAA00"},html:{icon:p.A,color:"#E34F26"},java:{icon:x.A,color:"#007396"},jpg:{icon:v.A,color:"#FFAA00"},jpeg:{icon:v.A,color:"#FFAA00"},js:{icon:g.A,color:"#F7DF1E"},json:{icon:j.A,color:"#22A746"},jsx:{icon:f.A,color:"#61DAFB"},key:{icon:y.A,color:"#FF9800"},m4p:{icon:b.A,color:"#4CAF50"},md:{icon:_.A,color:"#8E8E8E"},mdx:{icon:C.A,color:"#8E8E8E"},mov:{icon:N.A,color:"#9C27B0"},mp3:{icon:A.A,color:"#4CAF50"},mp4:{icon:w.A,color:"#9C27B0"},otf:{icon:S.A,color:"#795548"},pdf:{icon:k.A,color:"#FF0000"},php:{icon:F.A,color:"#777BB4"},png:{icon:L.A,color:"#00ADEF"},ppt:{icon:E.A,color:"#FF9800"},pptx:{icon:I.A,color:"#FF9800"},psd:{icon:T.A,color:"#31A8FF"},py:{icon:$.A,color:"#3776AB"},raw:{icon:R.A,color:"#FFAA00"},rb:{icon:B.A,color:"#CC342D"},sass:{icon:q.A,color:"#CF649A"},scss:{icon:D.A,color:"#CF649A"},sh:{icon:z.A,color:"#8E8E8E"},sql:{icon:P.A,color:"#336791"},svg:{icon:U.A,color:"#FF5722"},tiff:{icon:H.A,color:"#FFAA00"},tsx:{icon:M.A,color:"#3178C6"},ttf:{icon:V.A,color:"#795548"},txt:{icon:W.A,color:"#8E8E8E"},wav:{icon:O.A,color:"#795548"},woff:{icon:G.A,color:"#795548"},xls:{icon:Q.A,color:"#22A746"},xlsx:{icon:Z.A,color:"#22A746"},xml:{icon:K.A,color:"#E34F26"},yml:{icon:Y.A,color:"#8E8E8E"},zip:{icon:m.A,color:"#FFD700"},rar:{icon:m.A,color:"#F44336"},tar:{icon:m.A,color:"#FFC107"},pub:{icon:c.A,color:"#4CAF50"},swf:{icon:m.A,color:"#FFEB3B"}},ee=e=>{let{extension:s,color:t,size:l}=e;const a=null===s||void 0===s?void 0:s.toLowerCase(),n=X[a];if(n){const e=n.icon,s=t||n.color;return(0,J.jsx)(e,{color:s,size:l})}return(0,J.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:t||"#888",xmlns:"http://www.w3.org/2000/svg",children:(0,J.jsx)("path",{d:"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.5L9.5 0H4zm8 1.5V6H9V1h3z"})})}}}]);
//# sourceMappingURL=7003.2c8882f6.chunk.js.map