"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[7302],{7302:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});var s=a(65043),n=a(87201),i=a(70579);function r(){const e="undefined"!==typeof window?new URL(window.location.href):null,t=e?e.searchParams.get("id"):null,a=null===e||void 0===e?void 0:e.pathname.match(/forms\/(\d+)/),r=(null===a||void 0===a?void 0:a[1])||t||"",[c,d]=(0,s.useState)(r),[m,f]=(0,s.useState)(!1),[p,h]=(0,s.useState)(""),[u,x]=(0,s.useState)([]),[b,g]=(0,s.useState)(""),[j,w]=(0,s.useState)("All"),v=s.useRef(new Set);async function y(){h(""),f(!0);try{const e=await(0,n.Mb)(c);x(Array.isArray(e)?e:(null===e||void 0===e?void 0:e.results)||[])}catch(e){h(e.message||"Failed to load")}finally{f(!1)}}function N(e,t){if(!e)return"";if(Array.isArray(e.fields)){const a={};e.fields.forEach((e=>{var t,s;const n=(e.name||e.label||"").toLowerCase();a[n]=null!==(t=null!==(s=e.value)&&void 0!==s?s:e.answer)&&void 0!==t?t:""}));for(const e of t){const t=a[e];if(t)return t}for(const e in a)if(t.some((t=>e.includes(t))))return a[e];return""}const a=e.payload||e.data||e||{};for(const n of t)if(null!=a[n])return a[n];const s=Object.keys(a).find((e=>t.some((t=>e.toLowerCase().includes(t)))));return s?a[s]:""}(0,s.useEffect)((()=>{c&&(v.current.has(c)||(v.current.add(c),y()))}),[c]);const k=(0,s.useMemo)((()=>{const e=b.trim().toLowerCase();return e?u.filter((t=>[N(t,["name","full_name"]),N(t,["email"]),N(t,["phone","mobile","tel"]),N(t,["message","note","comments"])].join(" ").toLowerCase().includes(e))):u}),[u,b]);return(0,i.jsxs)("div",{className:"mf-inquiries-page",children:[(0,i.jsxs)("div",{className:"mf-toolbar",children:[(0,i.jsxs)("div",{className:"mf-toolbar-left",children:[(0,i.jsx)("input",{className:"mf-input",placeholder:"Form ID",value:c,onChange:e=>d(e.target.value),style:{width:120}}),(0,i.jsx)("button",{className:"mf-btn",onClick:y,disabled:!c||m,children:"Load"}),(0,i.jsx)("button",{className:"mf-btn ghost",onClick:()=>g(""),children:"Reload"})]}),(0,i.jsxs)("div",{className:"mf-toolbar-mid",children:[(0,i.jsx)("input",{className:"mf-search",placeholder:"Search",value:b,onChange:e=>g(e.target.value)}),(0,i.jsx)("div",{className:"mf-tabs",children:["All","Web","Form","Fb/In"].map((e=>(0,i.jsx)("button",{className:"mf-tab "+(j===e?"active":""),onClick:()=>w(e),children:e},e)))})]}),(0,i.jsxs)("div",{className:"mf-toolbar-right",children:[(0,i.jsx)("button",{className:"mf-btn primary",disabled:!0,children:"New"}),(0,i.jsx)("button",{className:"mf-btn ghost",disabled:!0,children:"Set Up"})]})]}),p&&(0,i.jsx)("div",{className:"mf-error",children:p}),(0,i.jsx)("div",{className:"mf-table-wrap",children:(0,i.jsxs)("table",{className:"mf-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Lead Source"}),(0,i.jsx)("th",{children:"Name"}),(0,i.jsx)("th",{children:"Message"}),(0,i.jsx)("th",{children:"Phone"}),(0,i.jsx)("th",{children:"Email"}),(0,i.jsx)("th",{children:"Assign To"}),(0,i.jsx)("th",{children:"Spam"}),(0,i.jsx)("th",{children:"No Go"}),(0,i.jsx)("th",{children:"Move to Quote"})]})}),(0,i.jsxs)("tbody",{children:[m&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:9,className:"mf-empty",children:"Loading\u2026"})}),!m&&0===k.length&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:9,className:"mf-empty",children:"No inquiries"})}),!m&&k.map(((e,t)=>{return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"mf-cell-lead",children:[(0,i.jsx)("span",{className:"mf-chip",children:e.source||"Form"}),(0,i.jsx)("div",{className:"mf-subtext",children:l(e.created)})]})}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"mf-cell-name",children:[(0,i.jsx)("div",{className:"mf-avatar",children:o(N(e,["name","full_name"])||"U")}),(0,i.jsx)("span",{children:N(e,["name","full_name"])||"Unknown"})]})}),(0,i.jsx)("td",{className:"mf-ellipsis",title:N(e,["message","note","comments"]),children:N(e,["message","note","comments"])||"\u2014"}),(0,i.jsx)("td",{children:(a=N(e,["phone","mobile","tel"]),a||"")}),(0,i.jsx)("td",{className:"mf-ellipsis",children:N(e,["email"])}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"mf-cell-name muted",children:[(0,i.jsx)("div",{className:"mf-avatar small",children:o(e.assignee_name||"")}),(0,i.jsx)("span",{children:e.assignee_name||"\u2014"})]})}),(0,i.jsx)("td",{className:"mf-icon-col",children:"\ud83e\uddf9"}),(0,i.jsx)("td",{className:"mf-icon-col",children:"\ud83d\udeab"}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{className:"mf-btn small",children:"Move"})})]},e.id||t);var a}))]})]})}),(0,i.jsx)("style",{children:"\n        .mf-inquiries-page {font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;}\n        .mf-toolbar {display:flex; align-items:center; justify-content:space-between; gap:12px; margin:12px 0;}\n        .mf-toolbar-left, .mf-toolbar-right {display:flex; gap:8px; align-items:center;}\n        .mf-toolbar-mid {display:flex; align-items:center; gap:12px; flex:1;}\n        .mf-input {height:36px; border:1px solid #e5e7eb; border-radius:8px; padding:0 10px; background:#fff;}\n        .mf-search {flex:1; height:36px; border:1px solid #e5e7eb; border-radius:18px; padding:0 14px;}\n        .mf-tabs {display:flex; gap:6px;}\n        .mf-tab {height:30px; padding:0 12px; border-radius:16px; border:1px solid #e5e7eb; background:#fff;}\n        .mf-tab.active {background:#eef2ff; border-color:#c7d2fe; color:#3730a3;}\n        .mf-btn {height:32px; padding:0 12px; border-radius:8px; border:1px solid #e5e7eb; background:#fff; cursor:pointer;}\n        .mf-btn.primary {background:#2563eb; color:#fff; border-color:#2563eb;}\n        .mf-btn.ghost {background:transparent;}\n        .mf-btn.small {height:28px; padding:0 10px;}\n        .mf-error {margin:8px 0; color:#b91c1c;}\n        .mf-table-wrap {background:#fff; border:1px solid #e5e7eb; border-radius:12px; overflow:hidden;}\n        table.mf-table {width:100%; border-collapse:separate; border-spacing:0;}\n        .mf-table th {text-align:left; font-weight:600; font-size:12px; color:#6b7280; padding:12px; background:#f9fafb; border-bottom:1px solid #eef2f7;}\n        .mf-table td {padding:14px 12px; border-bottom:1px solid #f3f4f6; vertical-align:middle;}\n        .mf-empty {text-align:center; padding:24px; color:#6b7280;}\n        .mf-cell-lead {display:flex; flex-direction:column; gap:4px;}\n        .mf-chip {display:inline-block; font-size:12px; background:#eef2ff; color:#3730a3; padding:4px 8px; border-radius:999px;}\n        .mf-subtext {font-size:11px; color:#9ca3af;}\n        .mf-cell-name {display:flex; align-items:center; gap:10px;}\n        .mf-cell-name.muted span {color:#6b7280}\n        .mf-avatar {width:28px; height:28px; border-radius:50%; background:#e5e7eb; display:flex; align-items:center; justify-content:center; font-size:12px; font-weight:600; color:#374151;}\n        .mf-avatar.small {width:22px; height:22px; font-size:10px;}\n        .mf-ellipsis {max-width:420px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}\n        .mf-icon-col {text-align:center;}\n      "})]})}function o(e){const t=String(e||"").trim();if(!t)return"\u2014";return t.split(/\s+/).slice(0,2).map((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.toUpperCase()})).join("")}function l(e){if(!e)return"";const t=Number(e),a=Number.isFinite(t)&&t>1e10?new Date(t):new Date(1e3*t),s=isNaN(a.getTime())?new Date(e):a;return isNaN(s.getTime())?"":s.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"})}},87201:(e,t,a)=>{a.d(t,{Jy:()=>r,Mb:()=>l,bJ:()=>n,i6:()=>c,lI:()=>o,sk:()=>i});const s="https://app.memate.com.au/api/v1/inquiries/form/";async function n(e){const t=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.text().catch((()=>""));throw new Error(`API ${t.status}: ${e||t.statusText}`)}return t.json()}async function i(e){const t=`https://app.memate.com.au/api/v1/inquiries/forms/?organization=${encodeURIComponent(e)}`,a=await fetch(t);if(!a.ok){const e=await a.text().catch((()=>""));throw new Error(`API ${a.status}: ${e||a.statusText}`)}return a.json()}async function r(e){const t=`https://app.memate.com.au/api/v1/inquiries/form/${e}/`,a=await fetch(t);if(!a.ok){const e=await a.text().catch((()=>""));throw new Error(`API ${a.status}: ${e||a.statusText}`)}return a.json()}async function o(e,t){const a=`https://app.memate.com.au/api/v1/inquiries/form/${e}/update/`,s=await fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const e=await s.text().catch((()=>""));throw new Error(`API ${s.status}: ${e||s.statusText}`)}return s.json()}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("formId is required");const a=`https://app.memate.com.au/api/v1/inquiries/form/${encodeURIComponent(e)}/submissions/`,s=new URLSearchParams;t.page&&s.set("page",t.page),t.page_size&&s.set("page_size",t.page_size),null!=t.status&&s.set("status",t.status),t.assigned_to&&s.set("assigned_to",t.assigned_to),t.search&&s.set("search",t.search),t.ordering&&s.set("ordering",t.ordering);const n=s.toString()?`${a}?${s.toString()}`:a,i=await fetch(n);if(!i.ok){const e=await i.text().catch((()=>""));throw new Error(`API ${i.status}: ${e||i.statusText}`)}return i.json()}async function c(e){const t=`https://app.memate.com.au/api/v1/inquiries/form/${e}/delete/`,a=await fetch(t,{method:"DELETE"});if(!a.ok){const e=await a.text().catch((()=>""));throw new Error(`API ${a.status}: ${e||a.statusText}`)}return!0}}}]);
//# sourceMappingURL=7302.4b1ae0d1.chunk.js.map