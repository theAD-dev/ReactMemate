"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[1242,2543],{316:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(65043),i=s(68811),o=s(70579);const l=e=>{let{project:t,reInitialize:s,projectCardData:l}=e;const[a,r]=(0,n.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"linkByttonStyle py-2 border-right pe-5",onClick:()=>r(!0),children:"New Task"}),(0,o.jsx)(i.A,{show:a,setShow:r,project:t,reInitialize:s,projectCardData:l})]})}},623:(e,t,s)=>{s.d(t,{IY:()=>f,Kh:()=>c,Nh:()=>d,Np:()=>v,PR:()=>r,SG:()=>m,YC:()=>j,fD:()=>g,hW:()=>u,ic:()=>w,j:()=>h,ms:()=>b,oQ:()=>a,sq:()=>C,vU:()=>p,yA:()=>y,yi:()=>x});var n=s(63712),i=s(40472);const o="https://app.memate.com.au/api/v1",l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:n={},body:i}=t,o={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...n},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,o),n=s.headers.get("Content-Type");if(!s.ok){if(n&&n.includes("application/json")){const e=await s.json(),t=new Error(e.detail||`HTTP error! Status: ${s.status}`);throw t.status=s.status,t.data=e,t}{const e=await s.text(),t=new Error(e||`HTTP error! Status: ${s.status}`);throw t.status=s.status,t}}if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(l){throw console.error("Fetch API error:",l),l}},a=async()=>{const e=new URL(`${o}/settings/subscriptions/tax-id/`);return l(e.toString(),{method:"GET"})},r=async()=>{const e=new URL(`${o}/settings/subscriptions/upcoming/`);return l(e.toString(),{method:"GET"})},d=async e=>{const t={method:"PUT",body:e},s=new URL(`${o}/settings/subscriptions/tax-id/`);return l(s.toString(),t)},c=async()=>{const e=new URL(`${o}/settings/subscriptions/payment-method/`);return l(e.toString(),{method:"GET"})},u=async()=>{const e=new URL(`${o}/subscriptions/retry/`);return l(e.toString(),{method:"POST"})},h=async e=>{const t={method:"PUT",body:e},s=new URL(`${o}/settings/subscriptions/payment-method/`);return l(s.toString(),t)},m=async()=>{const e=new URL(`${o}/settings/organization/region-language/`);return l(e.toString(),{method:"GET"})},p=async e=>{const t={method:"PUT",body:e},s=new URL(`${o}/settings/organization/region-language/`);return l(s.toString(),t)},x=async e=>{console.log("data: ",e),e.id&&delete e.id,e.isNew&&delete e.isNew,e.isChanged&&delete e.isChanged,e.value&&delete e.value;const t={method:"POST",body:e},s=new URL(`${o}/settings/project-statuses/new/`);return l(s.toString(),t)},v=async(e,t)=>{const s={method:"PUT",body:t},n=new URL(`${o}${`/settings/project-statuses/update/${e}/`}`);return l(n.toString(),s)},g=async e=>{const t=new URL(`${o}${`/settings/project-statuses/delete/${e}/`}`);return l(t.toString(),{method:"DELETE"})},j=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${o}/settings/organization/general/`,s);return await e.json()}catch(n){throw console.error("Profile fetch error:",n),n}},f=async(e,t)=>{const s=new Headers,i=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${i}`);const l=new FormData;if(Object.keys(e).forEach((t=>{l.append(t,e[t])})),null!==t&&void 0!==t&&t.croppedImageBlob){const e=(0,n.Ak)(6);l.append("company_logo",null===t||void 0===t?void 0:t.croppedImageBlob,`${e}.jpg`)}const a={method:"PUT",headers:s,body:l,redirect:"follow"};try{const e=await fetch(`${o}/settings/organization/general/`,a),t=await e.text();return console.log("result>>>>>>>>>>: ",t),t}catch(r){throw console.error("Profile fetch error:",r),r}},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${o}/settings/organization/bank/`,s);return await e.text()}catch(n){throw console.error("Profile fetch error:",n),n}},y=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`);const n=new FormData;Object.keys(e).forEach((t=>{n.append(t,e[t])}));const i={method:"PUT",headers:t,body:n,redirect:"follow"};try{const e=await fetch(`${o}/settings/organization/bank/`,i),t=await e.text();return console.log("result: ",t),t}catch(l){throw console.error("Profile fetch error:",l),l}},w=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${o}/settings/project-statuses/`,s);return await e.json()}catch(n){throw console.error("project fetch error:",n),n}},C=async()=>{try{const e=JSON.parse(localStorage.getItem("profileData")).location,t=await(0,i.g$)(e);if(!t||!t.state)return console.error("Invalid location details:",t),[];const s=`/locations/${t.state}/holidays/`,n={method:"GET"},a=new URL(`${o}${s}`);return l(a.toString(),n)}catch(e){return console.error("Error fetching holidays:",e),[]}}},11520:(e,t,s)=>{s.d(t,{Mv:()=>b,Np:()=>l,OE:()=>y,SE:()=>h,Wb:()=>v,ZE:()=>c,aj:()=>a,fi:()=>m,jE:()=>d,jy:()=>g,ky:()=>f,m2:()=>x,mw:()=>o,o2:()=>r,pV:()=>p,qm:()=>j,yE:()=>u});const n="https://app.memate.com.au/api/v1",i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:s="GET",headers:n={},body:i}=t,o={method:s,headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json",...n},body:JSON.stringify(i),redirect:"follow"};try{const t=new URL(`${e}`),s=await fetch(t,o);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const n=s.headers.get("Content-Type");if(n&&n.includes("application/json"))return await s.json();return{message:"Non-JSON response",body:await s.text()}}catch(l){throw console.error("Fetch API error:",l),l}},o=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/schedule/${e}/`}`);return i(o.toString(),s)},l=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/custom-status/${e}/`}`);return i(o.toString(),s)},a=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/reference/${e}/`}`);return i(o.toString(),s)},r=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/project-card/note/${e}/`}`);return i(o.toString(),s)},d=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/back/`);return i(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/decline/`);return i(s.toString(),t)},u=async e=>{const t={method:"PUT",body:{unique_id:e}},s=new URL(`${n}/projects/complete/`);return i(s.toString(),t)},h=async e=>{const t=new URL(`${n}${`/invoices/create/${e}/`}`);return i(t.toString(),{method:"POST"})},m=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/invoices/send/${e}/`}`);return i(o.toString(),s)},p=async e=>{const t=new URL(`${n}${`/projects/file-list/${e}/`}`);return i(t.toString(),{method:"GET"})},x=async(e,t)=>{const s={method:"POST",body:{file_name:t}},o=new URL(`${n}${`/projects/file-delete/${e}/`}`);return i(o.toString(),s)},v=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${n}${`/project-card/calc-description/${e}/`}`);return i(o.toString(),s)},g=async(e,t,s)=>{let o;o=t?`/custom/email/${e}/${t}/`:`/custom/email/${e}/`;const l={method:"POST",body:s},a=new URL(`${n}${o}`);return i(a.toString(),l)},j=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/sms/${e}/`}`);return i(o.toString(),s)},f=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${n}${`/resend/quote/${e}/`}`);return i(o.toString(),s)},b=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`),e.append("Content-Type","application/json");const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${n}/management/`,s);return await e.json()}catch(i){throw console.error(i),i}},y=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"GET",headers:t,redirect:"follow"};try{const t=await fetch(`${n}/project-card/${e}/`,i);return await t.json()}catch(o){throw console.error(o),o}}},12925:(e,t,s)=>{s.r(t),s.d(t,{default:()=>qt});var n=s(65043),i=s(49367),o=s(94802),l=s(14282),a=s(27417),r=s(89082),d=s(62812),c=s(39759),u=s(58387),h=s(748),m=s(11520),p=s(79106);let x,v,g;function j(e){return new Date(new Date(e).getTime()-60*new Date(e).getTimezoneOffset()*1e3)}function f(e,t){const s=[],n=null===e||void 0===e?void 0:e.map((e=>{var n,i,o,l,a,r,d,c,u;let h=(null===e||void 0===e||null===(n=e.custom_status)||void 0===n?void 0:n.color)||"rgb(192, 192, 192)",m=null===e||void 0===e||null===(i=e.custom_status)||void 0===i?void 0:i.background,p=null===e||void 0===e||null===(o=e.custom_status)||void 0===o?void 0:o.font;const x=null!==e&&void 0!==e&&null!==(l=e.custom_status)&&void 0!==l&&l.title?`<div style='color:${p}; background:${m}; border: 1px solid ${h}; width: fit-content; max-width: 85px; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px;' title="${e.custom_status.title}">\n          <div style='max-width: 80px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 0px; white-space: nowrap; font-size: 12px;'>${e.custom_status.title}</div>\n        </div>`:"<div style='font-size: 12px;color: #344054; background: #F2F4F7; border: 1px solid rgba(0, 0, 0, 0.498); width: fit-content; border-radius: 20px; padding: 0px 6px; font-weight: 500; margin-left: auto; display: flex; align-items: center; height: 22px'>No status</div>";let v="not-started";0===e.jobs_count&&0===e.jobs_count?v="not-started":e.jobs_done===e.jobs_count?v="done":0===e.jobs_done?v="not-done":e.jobs_done&&(v="pending");const f=new Date(1e3*parseInt(e.booking_end));f.setHours(23,59,59,999);let b=f<new Date;s.push({start:j(1e3*+e.booking_start),end:j(1e3*+e.booking_end),id:e.unique_id,cssClass:"project-item",resource:e.unique_id,backColor:m,borderColor:h,tag:{number:e.number,reference:e.reference,value:e.id,type:"project"},text:`<ul class="eventStyleCal">\n        <li>\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_6815_57879)"><rect width="24" height="24" rx="4" fill="url(#paint0_linear_6815_57879)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="23.25" height="23.25" rx="3.625" stroke="#101828" stroke-width="0.75"/></g><g clip-path="url(#clip1_6815_57879)">\n            <path d="M8.57171 7.28592C8.57171 7.04923 8.76359 6.85735 9.00028 6.85735H9.85742C10.0941 6.85735 10.286 7.04923 10.286 7.28592V8.14307C10.286 8.37976 10.0941 8.57164 9.85742 8.57164H9.00028C8.76359 8.57164 8.57171 8.37976 8.57171 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M11.1431 7.28592C11.1431 7.04923 11.335 6.85735 11.5717 6.85735H12.4289C12.6655 6.85735 12.8574 7.04923 12.8574 7.28592V8.14307C12.8574 8.37976 12.6655 8.57164 12.4289 8.57164H11.5717C11.335 8.57164 11.1431 8.37976 11.1431 8.14307V7.28592Z" fill="#667085"/>\n            <path d="M14.1431 6.85735C13.9064 6.85735 13.7146 7.04923 13.7146 7.28592V8.14307C13.7146 8.37976 13.9064 8.57164 14.1431 8.57164H15.0003C15.237 8.57164 15.4289 8.37976 15.4289 8.14307V7.28592C15.4289 7.04923 15.237 6.85735 15.0003 6.85735H14.1431Z" fill="#667085"/>\n            <path d="M8.57171 9.85735C8.57171 9.62066 8.76359 9.42878 9.00028 9.42878H9.85742C10.0941 9.42878 10.286 9.62066 10.286 9.85735V10.7145C10.286 10.9512 10.0941 11.1431 9.85742 11.1431H9.00028C8.76359 11.1431 8.57171 10.9512 8.57171 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M11.5717 9.42878C11.335 9.42878 11.1431 9.62066 11.1431 9.85735V10.7145C11.1431 10.9512 11.335 11.1431 11.5717 11.1431H12.4289C12.6655 11.1431 12.8574 10.9512 12.8574 10.7145V9.85735C12.8574 9.62066 12.6655 9.42878 12.4289 9.42878H11.5717Z" fill="#667085"/>\n            <path d="M13.7146 9.85735C13.7146 9.62066 13.9064 9.42878 14.1431 9.42878H15.0003C15.237 9.42878 15.4289 9.62066 15.4289 9.85735V10.7145C15.4289 10.9512 15.237 11.1431 15.0003 11.1431H14.1431C13.9064 11.1431 13.7146 10.9512 13.7146 10.7145V9.85735Z" fill="#667085"/>\n            <path d="M9.00028 12.0002C8.76359 12.0002 8.57171 12.1921 8.57171 12.4288V13.2859C8.57171 13.5226 8.76359 13.7145 9.00028 13.7145H9.85742C10.0941 13.7145 10.286 13.5226 10.286 13.2859V12.4288C10.286 12.1921 10.0941 12.0002 9.85742 12.0002H9.00028Z" fill="#667085"/>\n            <path d="M11.1431 12.4288C11.1431 12.1921 11.335 12.0002 11.5717 12.0002H12.4289C12.6655 12.0002 12.8574 12.1921 12.8574 12.4288V13.2859C12.8574 13.5226 12.6655 13.7145 12.4289 13.7145H11.5717C11.335 13.7145 11.1431 13.5226 11.1431 13.2859V12.4288Z" fill="#667085"/>\n            <path d="M14.1431 12.0002C13.9064 12.0002 13.7146 12.1921 13.7146 12.4288V13.2859C13.7146 13.5226 13.9064 13.7145 14.1431 13.7145H15.0003C15.237 13.7145 15.4289 13.5226 15.4289 13.2859V12.4288C15.4289 12.1921 15.237 12.0002 15.0003 12.0002H14.1431Z" fill="#667085"/>\n            <path d="M6.85742 6.00021C6.85742 5.52682 7.24118 5.14307 7.71456 5.14307H16.286C16.7594 5.14307 17.1431 5.52682 17.1431 6.00021V18.0002C17.1431 18.4736 16.7594 18.8574 16.286 18.8574H7.71456C7.24118 18.8574 6.85742 18.4736 6.85742 18.0002V6.00021ZM16.286 6.00021L7.71456 6.00021V18.0002H10.286V15.8574C10.286 15.6207 10.4779 15.4288 10.7146 15.4288H13.286C13.5227 15.4288 13.7146 15.6207 13.7146 15.8574V18.0002H16.286V6.00021Z" fill="#667085"/></g></g><defs><linearGradient id="paint0_linear_6815_57879" x1="12" y1="0" x2="12" y2="24" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_6815_57879"><rect width="24" height="24" rx="4" fill="white"/></clipPath><clipPath id="clip1_6815_57879"><rect width="13.7143" height="13.7143" fill="white" transform="translate(5.14307 5.14307)"/></clipPath></defs>\n          </svg>\n          &nbsp;\n          <strong style="color: ${p}; font-weight: 400">${e.reference}</strong>\n        </li>\n      </ul>`});const y=(null===(a=e.tasks.filter((e=>!e.finished)))||void 0===a?void 0:a.length)||0,w=e.tasks.length,C=[];C.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M10.875 2.25C11.0821 2.25 11.25 2.41789 11.25 2.625V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V2.625C0.75 2.41789 0.917893 2.25 1.125 2.25H10.875ZM1.125 1.5C0.50368 1.5 0 2.00368 0 2.625V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V2.625C12 2.00368 11.4963 1.5 10.875 1.5H1.125Z" fill="#475467"/>\n                <path d="M5.25 4.125C5.25 3.91789 5.41789 3.75 5.625 3.75H9.375C9.58211 3.75 9.75 3.91789 9.75 4.125C9.75 4.33211 9.58211 4.5 9.375 4.5H5.625C5.41789 4.5 5.25 4.33211 5.25 4.125Z" fill="#475467"/>\n                <path d="M4.12767 3.48484C4.27411 3.63128 4.27411 3.86872 4.12767 4.01516L3.00267 5.14016C2.85622 5.28661 2.61878 5.28661 2.47234 5.14016L2.09734 4.76516C1.95089 4.61872 1.95089 4.38128 2.09734 4.23484C2.24378 4.08839 2.48122 4.08839 2.62767 4.23484L2.7375 4.34467L3.59734 3.48484C3.74378 3.33839 3.98122 3.33839 4.12767 3.48484Z" fill="#475467"/>\n                <path d="M5.25 7.125C5.25 6.91789 5.41789 6.75 5.625 6.75H9.375C9.58211 6.75 9.75 6.91789 9.75 7.125C9.75 7.33211 9.58211 7.5 9.375 7.5H5.625C5.41789 7.5 5.25 7.33211 5.25 7.125Z" fill="#475467"/>\n                <path d="M4.12767 6.48484C4.27411 6.63128 4.27411 6.86872 4.12767 7.01516L3.00267 8.14017C2.85622 8.28661 2.61878 8.28661 2.47234 8.14017L2.09734 7.76517C1.95089 7.61872 1.95089 7.38128 2.09734 7.23484C2.24378 7.08839 2.48122 7.08839 2.62767 7.23484L2.7375 7.34467L3.59734 6.48484C3.74378 6.33839 3.98122 6.33839 4.12767 6.48484Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Tasks</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(r=e.tasks)||void 0===r||r.forEach((e=>{var t;s.push({start:j(1e3*+e.from_date),end:j(1e3*+e.to_date),id:e.id,cssClass:"childEvent task-item",resource:e.id,backColor:e.finished?"#DCFAE6":"#F2F4F7",borderColor:e.finished?"#DCFAE6":"#F2F4F7",text:e.title,tag:{type:"task",task:e}});const n=e.finished?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>';C.push({id:e.id,name:`<div class="d-flex flex-column">\n            <div task-id="${e.id}" class="task-list rowResourceEvent" style="--main-color: ${h}" task-id="${e.id}">\n              <div class="flex">\n                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_5999_560822)"><rect width="16" height="16" rx="8" fill="url(#paint0_linear_5999_560822)"/><g opacity="0.08"><rect x="0.375" y="0.375" width="15.25" height="15.25" rx="7.625" stroke="#101828" stroke-width="0.75"/></g>\n                  <path d="M6.57129 6.28585C6.41349 6.28585 6.28557 6.41377 6.28557 6.57157C6.28557 6.72936 6.41349 6.85728 6.57129 6.85728H9.42843C9.58623 6.85728 9.71415 6.72936 9.71415 6.57157C9.71415 6.41377 9.58623 6.28585 9.42843 6.28585H6.57129Z" fill="#475467"/>\n                  <path d="M6.57129 7.42871C6.41349 7.42871 6.28557 7.55663 6.28557 7.71443C6.28557 7.87222 6.41349 8.00014 6.57129 8.00014H8.28557C8.44337 8.00014 8.57129 7.87222 8.57129 7.71443C8.57129 7.55663 8.44337 7.42871 8.28557 7.42871H6.57129Z" fill="#475467"/>\n                  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99986 4.57157C8.63104 4.57157 9.14272 4.05989 9.14272 3.42871H10.5713C11.0447 3.42871 11.4284 3.81247 11.4284 4.28585V11.7144C11.4284 12.1878 11.0447 12.5716 10.5713 12.5716H5.42843C4.95505 12.5716 4.57129 12.1878 4.57129 11.7144V4.28585C4.57129 3.81247 4.95505 3.42871 5.42843 3.42871H6.857C6.857 4.05989 7.36868 4.57157 7.99986 4.57157ZM7.99986 5.143C8.74627 5.143 9.38127 4.66596 9.6166 4.00014H10.5713C10.7291 4.00014 10.857 4.12806 10.857 4.28585V11.7144C10.857 11.8722 10.7291 12.0001 10.5713 12.0001H5.42843C5.27064 12.0001 5.14272 11.8722 5.14272 11.7144V4.28585C5.14272 4.12806 5.27064 4.00014 5.42843 4.00014H6.38312C6.61846 4.66596 7.25345 5.143 7.99986 5.143Z" fill="#475467"/></g><defs><linearGradient id="paint0_linear_5999_560822" x1="8" y1="0" x2="8" y2="16" gradientUnits="userSpaceOnUse"><stop stop-color="#F9FAFB"/><stop offset="1" stop-color="#EDF0F3"/></linearGradient><clipPath id="clip0_5999_560822"><rect width="16" height="16" rx="8" fill="white"/></clipPath></defs>\n                </svg>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===e||void 0===e||null===(t=e.assigned_to)||void 0===t?void 0:t.name}</span>\n                  <span class="task-title">${e.title}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===n?"completed-class":"incomplete-class"}">\n                ${n}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),C.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(d=e.tasks)&&void 0!==d&&d.length?"45px":"40px"}">\n              <button class="create-task-button" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}" style="margin-bottom: ${null!==(c=e.tasks)&&void 0!==c&&c.length?"16px":"6px"}">Create Task\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0});let A=0,N=0;var _,S,F,k,E,L;t&&(A=(null===e||void 0===e||null===(_=e.jobs)||void 0===_||null===(S=_.filter((e=>!e.finished)))||void 0===S?void 0:S.length)||0,N=(null===e||void 0===e||null===(F=e.jobs)||void 0===F?void 0:F.length)||0,C.push({id:e.number,name:`<div class="d-flex flex-column rowResourceEvent">\n            <div class="d-flex gap-1 task-heading rowResourceEvent" style="--main-color: ${h}; height: 34px">\n              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 12" fill="none">\n                <path d="M4.875 0.75C4.2538 0.75 3.75 1.25338 3.75 1.87482V2.25H1.125C0.50368 2.25 0 2.75368 0 3.375V9.375C0 9.99632 0.50368 10.5 1.125 10.5H10.875C11.4963 10.5 12 9.99632 12 9.375V3.375C12 2.75368 11.4963 2.25 10.875 2.25H8.25V1.87482C8.25 1.25338 7.7462 0.75 7.125 0.75H4.875ZM4.875 1.5H7.125C7.33223 1.5 7.5 1.66847 7.5 1.87546V2.25H4.5V1.87482C4.5 1.66783 4.66777 1.5 4.875 1.5ZM6.28987 6.68581L11.25 5.3631V9.375C11.25 9.58211 11.0821 9.75 10.875 9.75H1.125C0.917893 9.75 0.75 9.58211 0.75 9.375V5.3631L5.71013 6.68581C5.90006 6.73645 6.09994 6.73645 6.28987 6.68581ZM1.125 3H10.875C11.0821 3 11.25 3.16789 11.25 3.375V4.5869L6.09662 5.96113C6.03331 5.97801 5.96669 5.97801 5.90338 5.96113L0.75 4.5869V3.375C0.75 3.16789 0.917893 3 1.125 3Z" fill="#475467"/>\n              </svg>\n              <span class="font-14">Jobs</span>\n            </div>\n           </div>`,minHeight:40,marginBottom:4}),null===e||void 0===e||null===(k=e.jobs)||void 0===k||k.forEach(((t,n)=>{var i,o,l,a;s.push({start:j(1e3*+t.start_date),end:j(1e3*+t.end_date),id:`project_${e.id}_job_${t.id}_${n}`,cssClass:"childEvent job-item",resource:t.id,backColor:t.finished?"#DCFAE6":"#F2F4F7",borderColor:t.finished?"#DCFAE6":"#F2F4F7",text:t.short_description,tag:{type:"job",job:t},resizeDisabled:!0});const r="5"===t.status?'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#DCFAE6"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#085D3A"/>\n            </svg>':'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="20" height="20" rx="10" fill="#F2F4F7"/>\n              <path d="M13.5524 6.97725C13.7692 6.75758 14.1206 6.75758 14.3374 6.97725C14.5515 7.19423 14.5542 7.54436 14.3453 7.7646L9.91018 13.0073C9.90592 13.0127 9.90136 13.0179 9.89654 13.0227C9.67975 13.2424 9.32828 13.2424 9.11149 13.0227L6.41259 10.2879C6.1958 10.0682 6.1958 9.71209 6.41259 9.49242C6.62937 9.27275 6.98085 9.27275 7.19763 9.49242L9.48729 11.8126L13.5376 6.99408C13.5422 6.98818 13.5471 6.98256 13.5524 6.97725Z" fill="#475467"/>\n            </svg>',d=(null===t||void 0===t||null===(i=t.worker)||void 0===i?void 0:i.alias)||"",c=null!==t&&void 0!==t&&null!==(o=t.worker)&&void 0!==o&&o.has_photo?`<img src="${null===t||void 0===t||null===(l=t.worker)||void 0===l?void 0:l.photo}" style="width: 20px; height: 20px; border-radius: 50%;" onerror="this.outerHTML='<div class=\\'job-alias\\'>${d}</div>'" />`:`<div class="job-alias">${d}</div>`;C.push({id:t.id,name:`<div class="d-flex flex-column job-resource-child" job-id="${t.id}">\n            <div class="task-list rowResourceEvent" style="--main-color: ${h}">\n              <div class="flex">\n                <div class="job-icon">\n                 ${c}\n                </div>\n                <div class="title-description-section">\n                  <span class="task-assigner">${null===t||void 0===t||null===(a=t.worker)||void 0===a?void 0:a.full_name}</span>\n                  <span class="task-title">${t.short_description}</span>\n                </div> \n              </div>\n              <div class="completion-status ${"completed"===r?"completed-class":"incomplete-class"}">\n                ${r}\n              </div>\n            </div>\n          </div>`,minHeight:40,marginBottom:4})})),C.push({id:e.number,name:`<div class="create-task-div rowResourceEvent" style="--main-color: ${h}; height: ${null!==(E=e.tasks)&&void 0!==E&&E.length?"45px":"40px"}">\n              <button class="createJobButton" project-id="${e.id}" style="margin-bottom: ${null!==(L=e.tasks)&&void 0!==L&&L.length?"16px":"6px"}">\n                Create Job\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                  <path d="M10 5C10.3452 5 10.625 5.27982 10.625 5.625V9.375H14.375C14.7202 9.375 15 9.65482 15 10C15 10.3452 14.7202 10.625 14.375 10.625H10.625V14.375C10.625 14.7202 10.3452 15 10 15C9.65482 15 9.375 14.7202 9.375 14.375V10.625H5.625C5.27982 10.625 5 10.3452 5 10C5 9.65482 5.27982 9.375 5.625 9.375H9.375V5.625C9.375 5.27982 9.65482 5 10 5Z" fill="#106B99"/>\n                </svg>\n              </button> \n            </div>`,minHeight:40,marginBottom:0}));const B=y+A,$=w+N;return{id:e.unique_id,expanded:g===e.unique_id,name:`<div class="resourceList rowResourceEvent" style="--main-color: ${h};">\n        <ul class="resourceMan me-2">\n          <li title="${e.number}">\n            <div style="width: 70px; overflow: hidden; text-overflow: ellipsis; display: inline-block; position: relative; top: 2px; white-space: nowrap;" class="">${e.number}</div>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M5 4C4.72386 4 4.5 4.22386 4.5 4.5C4.5 4.77614 4.72386 5 5 5H11C11.2761 5 11.5 4.77614 11.5 4.5C11.5 4.22386 11.2761 4 11 4H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M4.5 6.5C4.5 6.22386 4.72386 6 5 6H11C11.2761 6 11.5 6.22386 11.5 6.5C11.5 6.77614 11.2761 7 11 7H5C4.72386 7 4.5 6.77614 4.5 6.5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 8C4.72386 8 4.5 8.22386 4.5 8.5C4.5 8.77614 4.72386 9 5 9H11C11.2761 9 11.5 8.77614 11.5 8.5C11.5 8.22386 11.2761 8 11 8H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M5 10C4.72386 10 4.5 10.2239 4.5 10.5C4.5 10.7761 4.72386 11 5 11H8C8.27614 11 8.5 10.7761 8.5 10.5C8.5 10.2239 8.27614 10 8 10H5Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n              <path d="M2 2C2 0.89543 2.89543 0 4 0H12C13.1046 0 14 0.89543 14 2V14C14 15.1046 13.1046 16 12 16H4C2.89543 16 2 15.1046 2 14V2ZM12 1H4C3.44772 1 3 1.44772 3 2V14C3 14.5523 3.44772 15 4 15H12C12.5523 15 13 14.5523 13 14V2C13 1.44772 12.5523 1 12 1Z" fill="${e.is_invoice_created?"#17B26A":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M11 7.5C11 7.22386 11.2239 7 11.5 7H12.5C12.7761 7 13 7.22386 13 7.5V8.5C13 8.77614 12.7761 9 12.5 9H11.5C11.2239 9 11 8.77614 11 8.5V7.5Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M3.5 0C3.77614 0 4 0.223858 4 0.5V1H12V0.5C12 0.223858 12.2239 0 12.5 0C12.7761 0 13 0.223858 13 0.5V1H14C15.1046 1 16 1.89543 16 3V14C16 15.1046 15.1046 16 14 16H2C0.895431 16 0 15.1046 0 14V3C0 1.89543 0.895431 1 2 1H3V0.5C3 0.223858 3.22386 0 3.5 0ZM2 2C1.44772 2 1 2.44772 1 3V14C1 14.5523 1.44772 15 2 15H14C14.5523 15 15 14.5523 15 14V3C15 2.44772 14.5523 2 14 2H2Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n              <path d="M2.5 4C2.5 3.72386 2.72386 3.5 3 3.5H13C13.2761 3.5 13.5 3.72386 13.5 4V5C13.5 5.27614 13.2761 5.5 13 5.5H3C2.72386 5.5 2.5 5.27614 2.5 5V4Z" fill="${e.booking_start?"#1AB2FF":"#98A2B3"}"/>\n            </svg>\n          </li>\n          <li>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n              <path d="M4 10.7813C4.14782 12.4484 5.51294 13.6306 7.59107 13.7837V15H8.63448V13.7837C10.9039 13.6051 12.3125 12.3463 12.3125 10.4836C12.3125 8.89307 11.3647 7.97448 9.35617 7.45565L8.63448 7.26853V3.46659C9.75615 3.57716 10.5126 4.18104 10.7039 5.08262H12.1734C12.0082 3.4836 10.6343 2.33536 8.63448 2.20778V1H7.59107V2.23329C5.65207 2.46294 4.32172 3.70474 4.32172 5.38882C4.32172 6.84326 5.28687 7.87242 6.98241 8.3062L7.59107 8.4678V12.4994C6.44332 12.3293 5.65207 11.6999 5.46077 10.7813H4ZM7.39108 6.94532C6.34767 6.68165 5.79119 6.12029 5.79119 5.32928C5.79119 4.38518 6.49549 3.68773 7.59107 3.50061V6.99635L7.39108 6.94532ZM8.98228 8.81652C10.2692 9.13973 10.8343 9.67558 10.8343 10.5857C10.8343 11.6829 10.0083 12.4143 8.63448 12.5249V8.73147L8.98228 8.81652Z" fill="${e.is_invoice_created?"PAID"===e.paid?"#17B26A":"NOT PAID"===e.paid?"#F04438":"PARTIAL PAYMENT"===e.paid?"#fedf89":"#F79009":"#667085"}"/>\n            </svg>\n          </li>\n          <li>\n            <span class='${v}'>${e.jobs_done}/${e.jobs_count}</span>\n          </li>\n          <li>\n            ${b?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <rect width="24" height="24" rx="12" fill="#FEE4E2" />\n            <path d="M12.515 5.01896C12.344 5.00635 12.1722 5 12 5V4C12.1968 4 12.3931 4.00726 12.5885 4.02167L12.515 5.01896ZM14.5193 5.46905C14.1985 5.34533 13.8691 5.2454 13.5337 5.17008L13.7528 4.19438C14.1361 4.28046 14.5126 4.39467 14.8792 4.53605L14.5193 5.46905ZM15.889 6.17971C15.7458 6.08402 15.5994 5.99388 15.4503 5.90939L15.9432 5.0393C16.1136 5.13586 16.2809 5.23888 16.4446 5.34824C16.6082 5.4576 16.7674 5.5727 16.9219 5.69322L16.3066 6.48158C16.1715 6.37612 16.0322 6.27541 15.889 6.17971ZM17.7231 7.96934C17.5252 7.68829 17.3068 7.42218 17.0697 7.17321L17.794 6.48368C18.0649 6.76821 18.3145 7.07233 18.5407 7.39353L17.7231 7.96934ZM18.4672 9.32122C18.4012 9.16208 18.3296 9.00583 18.2526 8.85271L19.1458 8.40311C19.2339 8.5781 19.3157 8.75667 19.391 8.93853C19.4664 9.12039 19.5348 9.30453 19.5962 9.49054L18.6467 9.80423C18.5929 9.64147 18.5331 9.48035 18.4672 9.32122ZM18.9979 11.8282C18.9895 11.4846 18.9557 11.142 18.8969 10.8033L19.8822 10.6323C19.9494 11.0194 19.988 11.4109 19.9976 11.8037L18.9979 11.8282ZM18.8655 13.3656C18.8991 13.1967 18.9264 13.027 18.9474 12.8569L19.9398 12.9793C19.9159 13.1737 19.8847 13.3677 19.8463 13.5607C19.8079 13.7538 19.7625 13.9449 19.7102 14.1337L18.7464 13.867C18.7922 13.7018 18.8319 13.5346 18.8655 13.3656ZM17.914 15.745C18.0979 15.4546 18.2602 15.151 18.3995 14.8367L19.3137 15.2419C19.1545 15.6011 18.969 15.9481 18.7588 16.28L17.914 15.745ZM16.9497 16.9497C17.0715 16.828 17.1885 16.702 17.3005 16.5722L18.0577 17.2254C17.9297 17.3737 17.796 17.5177 17.6569 17.6569L16.9497 16.9497Z" fill="#F04438" />\n            <path d="M12 5C10.8488 5 9.71545 5.2839 8.70022 5.82655C7.68499 6.3692 6.81926 7.15386 6.17971 8.11101C5.54017 9.06816 5.14654 10.1683 5.03371 11.3139C4.92088 12.4595 5.09232 13.6153 5.53285 14.6788C5.97337 15.7423 6.66939 16.6808 7.55925 17.4111C8.44911 18.1414 9.50533 18.6409 10.6344 18.8655C11.7634 19.0901 12.9304 19.0327 14.032 18.6986C15.1336 18.3644 16.1358 17.7637 16.9497 16.9497L17.6569 17.6569C16.7266 18.5871 15.5812 19.2736 14.3223 19.6555C13.0633 20.0374 11.7296 20.1029 10.4393 19.8463C9.14895 19.5896 7.94183 19.0187 6.92486 18.1841C5.90788 17.3495 5.11243 16.2769 4.60897 15.0615C4.1055 13.846 3.90957 12.5251 4.03852 11.2159C4.16748 9.90659 4.61733 8.64933 5.34825 7.55544C6.07916 6.46155 7.06857 5.5648 8.22883 4.94463C9.38909 4.32446 10.6844 4 12 4V5Z" fill="#F04438" />\n            <path d="M11.5 7C11.7761 7 12 7.22386 12 7.5V12.7098L15.2481 14.5659C15.4878 14.7029 15.5711 15.0083 15.4341 15.2481C15.2971 15.4878 14.9917 15.5711 14.7519 15.4341L11.2519 13.4341C11.0961 13.3451 11 13.1794 11 13V7.5C11 7.22386 11.2239 7 11.5 7Z" fill="#F04438" />\n          </svg>':""}\n          </li>\n          <li class="text-end float-end me-2" style="width: 100px; flex: 1">\n            ${x}\n          </li>\n          <li class="me-3" style="position: relative;">\n            ${0!==B?`<div class="taskUnreadCount">${B}</div>`:""}\n            <div class="taskCount">${$||0}</div>\n          </li>\n        </ul>\n        <div class="project-content" unique-id="${e.unique_id}" project-id="${e.id}" number="${null===e||void 0===e?void 0:e.number}" reference="${null===e||void 0===e?void 0:e.reference}">\n          <span class="small project-content-name" unique-id="${e.unique_id}">${null===e||void 0===e||null===(u=e.client)||void 0===u?void 0:u.name}</span>\n          <h2 class="project-content-name" unique-id="${e.unique_id}">${e.reference}</h2>\n        </div>\n      </div>`,children:C,minHeight:95}}));x.update({resources:n,events:s}),x.onResourceExpand=function(e){g=e.resource.id}}function b(e,t,s,n,i,o){if(!(void 0!==typeof window&&Boolean(window.DayPilot)))return;v=window.DayPilot,x=new v.Scheduler(e,{days:365,scale:"Day",separators:[{color:"#48C1FF",width:4}],treeImage:"img/nochildren.png",rowMinHeight:110,cellWidth:73,eventEndSpec:"Date",durationBarVisible:!1,eventArrangement:"Cascade",eventMoveHandling:"Disabled",eventResizingStartEndEnabled:!0,timeRangeSelectedHandling:"Disabled",treeImageNoChildren:!1,rowHeaderWidth:380,timeHeaders:[{groupBy:"Month",format:"MMMM yyyy"},{groupBy:"Day",format:"d"}],treeEnabled:!0,progressiveRowRendering:!0,treePreventParentUsage:!1,scrollDelayEvents:0,infiniteScrollingEnabled:!0,infiniteScrollingStepDays:100}),x.onBeforeRowHeaderRender=function(e){e.row.cssClass="resourcesRow"};const l=(null===o||void 0===o?void 0:o.map((e=>{const t=new Date(1e3*+e.date);return new Date(t.toLocaleString("en-US",{timeZone:"Australia/Sydney"})).toISOString().split("T")[0]})))||[],a=(null===o||void 0===o?void 0:o.reduce(((e,t)=>{const s=new Date(1e3*+t.date),n=new Date(s.toLocaleString("en-US",{timeZone:"Australia/Sydney"})).toISOString().split("T")[0];return e[n]||(e[n]=[]),e[n].push({title:t.title,type:t.type||"Public Holiday"}),e}),{}))||{},r=e=>"Public Holiday"===e?'<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" fill="#EBF8FF"/>\n        <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" stroke="#BAE8FF"/>\n        <path d="M16.1402 14.1098C16.2866 14.2563 16.2866 14.4937 16.1402 14.6402L13.8902 16.8902C13.8198 16.9605 13.7245 17 13.625 17C13.5255 17 13.4302 16.9605 13.3598 16.8902L12.2348 15.7652C12.0884 15.6187 12.0884 15.3813 12.2348 15.2348C12.3813 15.0884 12.6187 15.0884 12.7652 15.2348L13.625 16.0947L15.6098 14.1098C15.7563 13.9634 15.9937 13.9634 16.1402 14.1098Z" fill="#158ECC"/>\n        <path d="M10.625 8C10.8321 8 11 8.16789 11 8.375V8.75H17V8.375C17 8.16789 17.1679 8 17.375 8C17.5821 8 17.75 8.16789 17.75 8.375V8.75H18.5C19.3284 8.75 20 9.42157 20 10.25V18.5C20 19.3284 19.3284 20 18.5 20H9.5C8.67157 20 8 19.3284 8 18.5V10.25C8 9.42157 8.67157 8.75 9.5 8.75H10.25V8.375C10.25 8.16789 10.4179 8 10.625 8ZM9.5 9.5C9.08579 9.5 8.75 9.83579 8.75 10.25V18.5C8.75 18.9142 9.08579 19.25 9.5 19.25H18.5C18.9142 19.25 19.25 18.9142 19.25 18.5V10.25C19.25 9.83579 18.9142 9.5 18.5 9.5H9.5Z" fill="#158ECC"/>\n        <path d="M9.875 11C9.875 10.7929 10.0429 10.625 10.25 10.625H17.75C17.9571 10.625 18.125 10.7929 18.125 11V11.75C18.125 11.9571 17.9571 12.125 17.75 12.125H10.25C10.0429 12.125 9.875 11.9571 9.875 11.75V11Z" fill="#158ECC"/>\n      </svg>':'<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" fill="#FFF8E1"/>\n        <rect x="0.5" y="0.5" width="27" height="27" rx="13.5" stroke="#FFECB3"/>\n        <path d="M14 8L20.5263 18.5H7.47372L14 8Z" fill="#FFB800" stroke="#FFB800" stroke-width="1.5"/>\n        <path d="M14 12V15" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round"/>\n        <circle cx="14" cy="17.5" r="1" fill="#FFFFFF"/>\n      </svg>';x.onBeforeTimeHeaderRender=function(e){if(e.header.text="",e.header.toolTip="",1===e.header.level){const t=e.header.start.toLocaleString("en-US",{timeZone:"Australia/Sydney"}).split("T")[0],s=a[t];e.header.start&&s&&s.length>0?(e.header.backColor="#F2FAFF",e.header.cssClass="holidayHeader",e.header.html=((e,t)=>{if(!e||0===e.length)return t;const s=e.filter((e=>"Public Holiday"===e.type)),n=e.filter((e=>"Public Holiday"!==e.type)),i=s.length>0,o=n.length>0;let l="";i&&(l+=`<div class="event-modal-group">\n        <div class="event-modal-group-header">\n          <span class="event-modal-icon">\ud83c\udf89</span>\n          <span>Public Holidays (${s.length})</span>\n        </div>\n        <ul class="event-modal-list">\n          ${s.map((e=>`<li>${e.title}</li>`)).join("")}\n        </ul>\n      </div>`),o&&(l+=`<div class="event-modal-group">\n        <div class="event-modal-group-header">\n          <span class="event-modal-icon">\u26a0\ufe0f</span>\n          <span>Reminders (${n.length})</span>\n        </div>\n        <ul class="event-modal-list">\n          ${n.map((e=>`<li>${e.title}</li>`)).join("")}\n        </ul>\n      </div>`);let a="";const d=e.length;return a=r(i?"Public Holiday":"vehicle_reminder"),`\n    <div style="position: relative; width: 84px;">\n      <div style="position: absolute; top: -25px; left: 0px; z-index: 1;">\n        <div class="event-icon-trigger" data-event-count="${d}" data-modal-content="${l.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" onclick="window.showEventModal(this, event)">\n          ${a}\n          ${d>1?`<span class="event-count-badge">${d}</span>`:""}\n        </div>\n      </div>\n      ${t}\n    </div>`})(s,e.header.html)):6!==e.header.start.getDayOfWeek()&&0!==e.header.start.getDayOfWeek()||(e.header.cssClass="weekendHeader",e.header.backColor="#F9FAFB")}},x.onBeforeEventRender=function(e){e.data.areas=[{top:0,left:0,right:0,width:1,cssClass:"childEventborder",text:e.data.text,backColor:e.data.borderColor,fontColor:"#ffffff",horizontalAlignment:"center",style:"border-top-left-radius: 4px; border-bottom-left-radius: 4px; background-color: #0000007f; color: #ffffff; padding: 2px;height: 36px;"}],e.data.text="Event details"},x.onEventClicked=function(e){const t=e.e.id();if(e.div.className.includes("task-item")&&t)s(t,!1);else if(e.div.className.includes("project-item")&&t){const n=e.e.tag();s(t,!0,n)}else if(e.div.className.includes("job-item")&&t){const n=e.e.tag();s(t,!0,n)}},x.onBeforeCellRender=function(e){6!==e.cell.start.getDayOfWeek()&&0!==e.cell.start.getDayOfWeek()||(e.cell.backColor="#F9FAFB");const t=e.cell.start.toLocaleString("en-US",{timeZone:"Australia/Sydney"}).split("T")[0];e.cell.start&&l.includes(t)&&(e.cell.backColor="#F2FAFF")},x.onEventResize=async function(e){const t=e.e.id(),s=new Date(e.newStart).toISOString(),i=new Date(e.newEnd).toISOString();if(console.log("args.e.tag().type: ",e.e.tag().type),"task"===e.e.tag().type){const n=e.e.tag().task;try{await(0,p.lC)(t,{title:n.title,description:n.description,user:n.assigned_to.id,from_date:s,to_date:i}),x.message("The task has been successfully updated.",{cssClass:"success_message"})}catch(o){console.log(o),x.message("An error occurred while updating the task. Please try again.")}}if("project"===e.e.tag().type)try{await(0,m.mw)(t,{booking_start:s,booking_end:i}),x.message("The project schedule has been successfully updated.",{cssClass:"success_message"}),n()}catch(o){console.log(o),x.message("An error occurred while updating the project schedule. Please try again.")}},x.init(),window.showEventModal=function(e,t){t.stopPropagation();const s=document.querySelector(".event-popup-modal");s&&s.remove();const n=e.getAttribute("data-modal-content"),i=e.getBoundingClientRect(),o=document.createElement("div");o.className="event-popup-modal",o.innerHTML=`\n      <div class="event-popup-header">\n        <span>Events</span>\n        <button class="event-popup-close" onclick="this.closest('.event-popup-modal').remove()">&times;</button>\n      </div>\n      <div class="event-popup-content">\n        ${n}\n      </div>\n    `,document.body.appendChild(o);const l=o.getBoundingClientRect();let a=i.left+i.width/2-l.width/2,r=i.bottom+8;a<10&&(a=10),a+l.width>window.innerWidth-10&&(a=window.innerWidth-l.width-10),o.style.left=a+"px",o.style.top=r+"px",setTimeout((()=>{document.addEventListener("click",(function t(s){o.contains(s.target)||s.target===e||(o.remove(),document.removeEventListener("click",t))}))}),0)},f(t,i)}function y(e,t){try{x&&f(e,t)}catch(s){console.log(s)}}var w=s(37990),C=s(623),A=s(57189),N=s(48417),_=s(11281),S=s(56008),F=s(65975),k=s(64196),E=s(36097),L=s(10615),B=s(73898),$=s(94673),R=s(38345),I=s(44713),D=s(56741),T=s(19e3),P=s(71807),M=s(52572),H=s(72413),z=s(99832),U=s(27066),O=s(38300),V=s(22927),q=s(90991),W=s(33361),Z=s(87677),G=s(64967),K=s(93202),Y=s(72970),J=s(88578),Q=s(78869),X=s(70836),ee=s(73216),te=s(35475),se=s(28261),ne=s(47097),ie=s(9642),oe=s(64824),le=s(93740),ae=s(78602),re=s(32952),de=s(61072),ce=s(56328),ue=s(91242);const he={cancelProjectContainer:"cancel-project_cancelProjectContainer__y6XWT",cancelProjectDescription:"cancel-project_cancelProjectDescription__hduCm",cancelProjectActions:"cancel-project_cancelProjectActions__IlWRQ",cancelProjectTitle:"cancel-project_cancelProjectTitle__49fSj",cancelProjectDescriptionText:"cancel-project_cancelProjectDescriptionText__GQncp",cancelProjectButton:"cancel-project_cancelProjectButton__REME8"};var me=s(70579);const pe=e=>{let{show:t,onClose:s,onConfirm:n,isLoading:i}=e;return t?(0,me.jsxs)("div",{className:he.cancelProjectContainer,children:[(0,me.jsxs)("div",{className:"d-flex align-items-end",children:[(0,me.jsx)("div",{className:"me-2",children:(0,me.jsxs)("svg",{width:"38",height:"38",viewBox:"0 0 38 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,me.jsx)("rect",{x:"9",y:"9",width:"20",height:"20",rx:"10",fill:"white"}),(0,me.jsx)("g",{opacity:"0.3",children:(0,me.jsx)("rect",{x:"6",y:"6",width:"26",height:"26",rx:"13",stroke:"#D92D20",strokeWidth:"2"})}),(0,me.jsx)("g",{opacity:"0.1",children:(0,me.jsx)("rect",{x:"1",y:"1",width:"36",height:"36",rx:"18",stroke:"#D92D20",strokeWidth:"2"})}),(0,me.jsx)("g",{clipPath:"url(#clip0_3922_546259)",children:(0,me.jsx)("path",{d:"M18.9998 15.6665V18.9998M18.9998 22.3332H19.0082M27.3332 18.9998C27.3332 23.6022 23.6022 27.3332 18.9998 27.3332C14.3975 27.3332 10.6665 23.6022 10.6665 18.9998C10.6665 14.3975 14.3975 10.6665 18.9998 10.6665C23.6022 10.6665 27.3332 14.3975 27.3332 18.9998Z",stroke:"#D92D20",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,me.jsx)("defs",{children:(0,me.jsx)("clipPath",{id:"clip0_3922_546259",children:(0,me.jsx)("rect",{width:"20",height:"20",fill:"white",transform:"translate(9 9)"})})})]})}),(0,me.jsx)("h1",{className:he.cancelProjectTitle,children:"Cancel Project?"}),(0,me.jsx)("button",{className:"ms-auto mb-3",onClick:s,style:{background:"none",border:"none",cursor:"pointer",padding:0},children:(0,me.jsx)(D.A,{size:24,className:he.cancelProjectCloseIcon})})]}),(0,me.jsxs)("div",{className:he.cancelProjectDescription,children:[(0,me.jsx)("p",{className:he.cancelProjectDescriptionText,children:"This will cancel the project and permanently delete the linked invoice."}),(0,me.jsx)("p",{className:he.cancelProjectDescriptionText,children:"Are you sure you want to proceed?"})]}),(0,me.jsx)("div",{className:he.cancelProjectActions,children:(0,me.jsxs)("button",{className:he.cancelProjectButton,onClick:n,disabled:i,style:{opacity:i?.6:1,cursor:i?"not-allowed":"pointer"},children:["Cancel Project",i&&(0,me.jsx)(le.p,{style:{width:"14px",height:"14px",marginLeft:"8px",position:"relative",top:"2px"}})]})})]}):null};var xe=s(31812),ve=s(73184),ge=s(68974),je=s(50105);const fe=s.p+"static/media/googleReviewIcon.0184cc6ef401c44935cf67effccb9dd0.svg";var be=s(81242);const ye=e=>{let{projectId:t,contactPersons:s=[],hasGoogleReviewEmailSend:i,reInitialize:o}=e;const{session:a}=(0,A.As)(),[,r]=(0,n.useState)({}),[d,c]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),x=(0,ne.n)({mutationFn:e=>(0,m.jy)(t,"google-review",e),onSuccess:()=>{c(!1),o(),ce.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),ce.oR.error("Failed to send email. Please try again.")}});return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(l.A,{variant:"light",className:(0,u.A)("rounded-circle px-2"),onClick:()=>{null!==a&&void 0!==a&&a.has_google_review?c(!0):p(!0)},title:"Add to Mailchimp",style:{width:"38px",height:"38px"},children:i?(0,me.jsx)("img",{src:fe,alt:"GoogleReview",style:{width:"18px",height:"18px"}}):(0,me.jsx)(ge.A,{size:16,color:"#667085"})}),(0,me.jsxs)(re.A,{show:h,onHide:()=>p(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,me.jsxs)(re.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,me.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,me.jsxs)("span",{children:[(0,me.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,me.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,me.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,me.jsx)("path",{d:"M28 18C22.48 18 18 22.48 18 28C18 33.52 22.48 38 28 38C33.52 38 38 33.52 38 28C38 22.48 33.52 18 28 18ZM29 33H27V31H29V33ZM29 29H27V23H29V29Z",fill:"#F04438"})]}),(0,me.jsx)("span",{className:"ms-3",children:"Google Review is currently unavailable"})]})}),(0,me.jsx)("button",{className:"CustonCloseModal",onClick:()=>p(!1),children:(0,me.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,me.jsx)(re.A.Body,{children:(0,me.jsxs)("div",{className:"ContactModel",children:[(0,me.jsxs)("p",{style:{color:"#475467",fontSize:"14px",fontWeight:"400",lineHeight:"20px",textAlign:"center"},children:["Google Review functionality is currently unavailable. To use this feature, please connect your Google Review account via ",(0,me.jsx)(te.N_,{to:"/settings/integrations?openGoogleReview=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]}),(0,me.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto border p-3 rounded"),style:{marginTop:"16px",width:"fit-content"},children:[(0,me.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center gap-2"),children:[(0,me.jsx)("img",{src:je,alt:"Google Review",style:{width:"20px",height:"20px"}}),(0,me.jsx)("h6",{className:"mb-0",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Google Review"})]}),(0,me.jsxs)("span",{className:"px-2 py-1",style:{fontSize:"12px",color:"#F79009",backgroundColor:"#FEF6EE",borderRadius:"16px"},children:["Disconnected \xa0",(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"9",viewBox:"0 0 8 9",fill:"none",children:(0,me.jsx)("circle",{cx:"4",cy:"4.5",r:"3",fill:"#F79009"})})]})]})]})})]}),(0,me.jsx)(be.A,{show:d,mutation:x,isLoading:!1,setShow:c,setPayload:r,contactPersons:s,defaultTemplateId:"Google Review"})]})};var we=s(46291),Ce=s(77918),Ae=s(75758),Ne=s(88060),_e=s(8868),Se=s(28676),Fe=s(74532),ke=s(72052),Ee=s(18226);const Le={headerTitle:"send-invoice_headerTitle__YBmdt",customLabel:"send-invoice_customLabel__0D26B",templateInfo:"send-invoice_templateInfo__osqvZ",bag:"send-invoice_bag__VXoPF",lable:"send-invoice_lable__hDm-2",dropdownSelect:"send-invoice_dropdownSelect__y4YWM",autoCompleteBox:"send-invoice_autoCompleteBox__sVyzX",AutoComplete:"send-invoice_AutoComplete__cCiBx",bcc:"send-invoice_bcc__KYSsZ",box:"send-invoice_box__pOjbC",active:"send-invoice_active__hBlO9",inputBox:"send-invoice_inputBox__gIZLk"};var Be=s(81047),$e=s(36166);const Re=(0,me.jsxs)("span",{className:"ql-formats",children:[(0,me.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,me.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,me.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,me.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,me.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,me.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,me.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,me.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,me.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,me.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,me.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,me.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,me.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,me.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),Ie=e=>{var t,s,i,o;let{show:a,setShow:r,contactPersons:d,setPayload:c,isLoading:h,create:p,projectId:x,projectCardData:v,isCreated:g}=e;const j=(0,n.useRef)(null),f=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[b,y]=(0,n.useState)(""),[w,C]=(0,n.useState)([]),[A,N]=(0,n.useState)([]),[_,S]=(0,n.useState)([]),[F,k]=(0,n.useState)(null),[E,L]=(0,n.useState)(null),[B,$]=(0,n.useState)(null),[R,I]=(0,n.useState)({}),[D,T]=(0,n.useState)([]),P=(0,n.useRef)(null),M=(0,n.useRef)(null),H=(0,n.useRef)(null),[z,U]=(0,n.useState)(!1),[O,V]=(0,n.useState)(!1),q=()=>r(!1),W=(0,n.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),Z=(0,n.useCallback)((e=>!e||0===e.length||e.every((e=>W(e)))),[W]),G=(0,n.useCallback)((e=>e&&0!==e.length?e.filter((e=>!W(e))):[]),[W]),K=(0,n.useCallback)((e=>e&&0!==e.length?e.filter((e=>W(e))):[]),[W]),Y=(0,n.useCallback)((()=>{let e=!1;if(w.length>0){G(w).length>0&&(C(K(w)),e=!0)}if(A.length>0){G(A).length>0&&(N(K(A)),e=!0)}if(_.length>0){G(_).length>0&&(S(K(_)),e=!0)}return!e}),[w,A,_,G,K]),[J,Q]=(0,n.useState)(null),X=(0,se.I)({queryKey:["emailTemplate"],queryFn:Be.SQ}),ee=(0,se.I)({queryKey:["getSignatureTemplates"],queryFn:Be.AO}),te=(0,se.I)({queryKey:["getOutgoingEmail"],queryFn:Be.hx}),ie=(0,se.I)({queryKey:["emailQuery",J],queryFn:()=>(0,Be.hS)(J),enabled:!!J,retry:1});(0,n.useEffect)((()=>{var e,t,s;null!==te&&void 0!==te&&te.data&&(null!==te&&void 0!==te&&null!==(e=te.data)&&void 0!==e&&e.outgoing_email&&null!==te&&void 0!==te&&null!==(t=te.data)&&void 0!==t&&t.outgoing_email_verified?y(null===te||void 0===te||null===(s=te.data)||void 0===s?void 0:s.outgoing_email):y("no-reply@memate.com.au"))}),[ie,te]);const oe=(0,ne.n)({mutationFn:e=>g?(0,$e.LG)(x,e):(0,m.fi)(x,e),onSuccess:()=>{q(),v(),ce.oR.success("Invoice created and send successfully.")},onError:e=>{console.error("Error creating task:",e),ce.oR.error("Failed to create and send invoice. Please try again.")}}),ue=e=>{var t,s;const n=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=null===(s=d.map((e=>e.email)))||void 0===s?void 0:s.filter((e=>e));i=i.filter((e=>!w.includes(e))),i=i.filter((e=>!A.includes(e))),i=i.filter((e=>!_.includes(e))),i=i.filter((e=>e.toLowerCase().includes(n))),T(i)},he=()=>{ue(),P.current&&P.current.show()},pe=()=>{ue(),M.current&&M.current.show()},xe=()=>{ue(),H.current&&H.current.show()};return(0,n.useEffect)((()=>{if(null!==d&&void 0!==d&&d.length){var e;let t=null===(e=d.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));T(t)}}),[d]),(0,n.useEffect)((()=>{if(w.length>0){const e=G(w);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const t=K(w);C(t)}}}),[w,G,K]),(0,n.useEffect)((()=>{if(A.length>0){const e=G(A);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const t=K(A);N(t)}}}),[A,G,K]),(0,n.useEffect)((()=>{if(_.length>0){const e=G(_);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const t=K(_);S(t)}}}),[_,G,K]),(0,n.useEffect)((()=>{c((e=>({...e,subject:F,email_body:E,from_email:b,to:null===w||void 0===w?void 0:w.toString(),...A.length>0&&{cc:A.toString()},..._.length>0&&{bcc:_.toString()},...B&&{signature:B}})))}),[F,E,b,w,A,_,B,c]),(0,n.useEffect)((()=>{var e,t;null!==ee&&void 0!==ee&&ee.data&&$(null===ee||void 0===ee||null===(e=ee.data)||void 0===e||null===(t=e.find((e=>e.id===f.email_signature)))||void 0===t?void 0:t.id)}),[null===ee||void 0===ee?void 0:ee.data,f.email_signature]),(0,n.useEffect)((()=>{var e,t;L((null===ie||void 0===ie||null===(e=ie.data)||void 0===e?void 0:e.body)||""),k(null===ie||void 0===ie||null===(t=ie.data)||void 0===t?void 0:t.subject),I((e=>({...e,subject:!1}))),I((e=>({...e,text:!1})))}),[null===ie||void 0===ie?void 0:ie.data]),(0,n.useEffect)((()=>{if(null!==X&&void 0!==X&&X.data){var e,t;const s=g?null===X||void 0===X||null===(e=X.data)||void 0===e?void 0:e.find((e=>"Invoice"===e.type)):null===X||void 0===X||null===(t=X.data)||void 0===t?void 0:t.find((e=>"Invoice"===e.type));Q(null===s||void 0===s?void 0:s.id)}}),[null===X||void 0===X?void 0:X.data,g]),(0,me.jsxs)(re.A,{show:a,centered:!0,onHide:q,className:"invoice-form",size:"lg",children:[(0,me.jsx)(re.A.Header,{closeButton:!0,children:(0,me.jsx)("div",{className:`${Le.modalHeader}`,children:(0,me.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,me.jsxs)("span",{className:`white-space-nowrap mt-2 mb-2 ${Le.headerTitle}`,children:[g?"Resend":"Send"," a Invoice"]})})})}),(0,me.jsxs)(re.A.Body,{children:[(0,me.jsxs)(de.A,{children:[(0,me.jsxs)(ae.A,{sm:6,className:"mb-3",children:[(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"FROM"}),(0,me.jsx)(Ne.m,{options:te&&(null===te||void 0===te?void 0:te.data)&&[{value:null===te||void 0===te||null===(t=te.data)||void 0===t?void 0:t.outgoing_email,label:`${null===te||void 0===te||null===(s=te.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{y(e.value),I((e=>({...e,from:!1})))},value:b,filterInputAutoFocus:!0})]}),(null===R||void 0===R?void 0:R.from)&&(0,me.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,me.jsx)(ae.A,{sm:6,className:"mb-3",children:(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"Templates"}),(0,me.jsx)(Ne.m,{options:X&&(null===(i=X.data)||void 0===i?void 0:i.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{Q(e.value)},value:J,loading:null===X||void 0===X?void 0:X.isFetching,filterInputAutoFocus:!0}),(0,me.jsx)("div",{className:Le.templateInfo,onClick:e=>j.current.toggle(e),children:(0,me.jsx)(Ce.A,{size:16,color:"#737374ff"})}),(0,me.jsxs)(Ee.j,{ref:j,children:[(0,me.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,me.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,me.jsx)("br",{})," Profile Settings > Templates > Email",(0,me.jsx)("br",{})," Templates."]})]})]})})]}),(0,me.jsxs)(de.A,{children:[(0,me.jsxs)(ae.A,{sm:12,className:"mb-3",children:[(0,me.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,me.jsxs)("div",{style:{position:"relative"},className:Le.autoCompleteBox,children:[(0,me.jsx)("div",{style:{width:"50px"},className:Le.bag}),(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"TO"}),(0,me.jsx)(Ae.j,{ref:P,value:w,completeMethod:ue,onChange:e=>{C(e.value),I((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:D,onClick:he,onFocus:he,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>W(e)));C((e=>[...new Set([...e,...n])])),n.length===s.length&&n.length>0&&I((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(W(t)?(C((e=>[...new Set([...e,t])])),I((e=>({...e,to:!1,toInvalid:!1})))):I((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,me.jsx)(l.A,{className:(0,u.A)(Le.box,{[Le.active]:z}),onClick:()=>{U(!z),N([])},children:"CC"}),(0,me.jsx)(l.A,{className:(0,u.A)(Le.box,{[Le.active]:O}),onClick:()=>{V(!O),S([])},children:"BCC"})]}),(null===R||void 0===R?void 0:R.to)&&!(null!==R&&void 0!==R&&R.toInvalid)&&(0,me.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===R||void 0===R?void 0:R.toInvalid)&&(0,me.jsxs)("div",{children:[(0,me.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===R||void 0===R?void 0:R.invalidToEmails)&&R.invalidToEmails.length>0&&(0,me.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",R.invalidToEmails.join(", ")]})]})]}),z&&(0,me.jsxs)(ae.A,{sm:6,className:"mb-3",children:[(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("div",{style:{width:"50px"},className:Le.bag}),(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"CC"}),(0,me.jsx)(Ae.j,{ref:M,value:A,completeMethod:ue,onChange:e=>{N(e.value),I((e=>({...e,cc:!1})))},multiple:!0,suggestions:D,onClick:pe,onFocus:pe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>W(e)));N((e=>[...new Set([...e,...n])])),n.length===s.length&&I((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(W(t)?(N((e=>[...new Set([...e,t])])),I((e=>({...e,cc:!1})))):I((e=>({...e,cc:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===R||void 0===R?void 0:R.cc)&&(0,me.jsxs)("div",{children:[(0,me.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===R||void 0===R?void 0:R.invalidCcEmails)&&R.invalidCcEmails.length>0&&(0,me.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",R.invalidCcEmails.join(", ")]})]})]}),O&&(0,me.jsxs)(ae.A,{sm:6,className:"mb-3",children:[(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("div",{style:{width:"60px"},className:Le.bag}),(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"BCC"}),(0,me.jsx)(Ae.j,{ref:H,value:_,completeMethod:ue,onChange:e=>{S(e.value),I((e=>({...e,bcc:!1})))},multiple:!0,suggestions:D,onClick:xe,onFocus:xe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>W(e)));S((e=>[...new Set([...e,...n])])),n.length===s.length&&I((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(W(t)?(S((e=>[...new Set([...e,t])])),I((e=>({...e,bcc:!1})))):I((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,u.A)(Le.AutoComplete,Le.bcc,"w-100"),placeholder:"BCC"})]}),(null===R||void 0===R?void 0:R.bcc)&&(0,me.jsxs)("div",{children:[(0,me.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===R||void 0===R?void 0:R.invalidBccEmails)&&R.invalidBccEmails.length>0&&(0,me.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",R.invalidBccEmails.join(", ")]})]})]}),(0,me.jsxs)(ae.A,{sm:12,className:"mb-2",children:[(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("div",{style:{width:"60px"},className:Le.bag}),(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"SUBJECT"}),(0,me.jsxs)(Se.C,{children:[(0,me.jsx)(Fe.m,{children:(null===ie||void 0===ie?void 0:ie.isFetching)&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,me.jsx)(ke.S,{value:F,className:(0,u.A)(Le.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{k(e.target.value),I((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===R||void 0===R?void 0:R.subject)&&(0,me.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,me.jsxs)(ae.A,{sm:12,className:"mb-3",children:[(0,me.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,me.jsx)("label",{className:(0,u.A)(Le.lable),children:"Message"}),(0,me.jsx)(Fe.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ie||void 0===ie?void 0:ie.isFetching)&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,me.jsx)(_e.K,{style:{minHeight:"150px"},headerTemplate:Re,value:E,placeholder:"Enter a description...",onTextChange:e=>{L(e.htmlValue),I((e=>({...e,text:!1})))}})]}),(null===R||void 0===R?void 0:R.text)&&(0,me.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,me.jsx)(ae.A,{sm:12,children:(0,me.jsxs)("div",{style:{position:"relative"},children:[(0,me.jsx)("label",{className:(0,u.A)(Le.customLabel),children:"Signature"}),(0,me.jsx)(Ne.m,{options:ee&&(null===(o=ee.data)||void 0===o?void 0:o.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,u.A)(Le.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{$(e.value)},value:B,loading:null===ee||void 0===ee?void 0:ee.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,me.jsxs)(re.A.Footer,{className:"d-flex justify-content-between",children:[(0,me.jsx)(l.A,{onClick:q,className:"text-button text-danger",children:"Cancel"}),(0,me.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[!g&&(0,me.jsxs)(l.A,{disabled:h,className:"outline-button",onClick:p,children:["Create and Save"," ",h&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",color:"#fff"}})]}),(0,me.jsxs)(l.A,{className:"solid-button",disabled:null===oe||void 0===oe?void 0:oe.isPending,onClick:async()=>{let e=0;I({});if(Y()||console.log("Some emails were invalid and have been cleaned"),b||(++e,I((e=>({...e,from:!0})))),0===(null===w||void 0===w?void 0:w.length))++e,I((e=>({...e,to:!0})));else if(!Z(w)){++e;const t=G(w);console.log("Invalid TO emails:",t),I((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:t})))}if(A.length>0&&!Z(A)){++e;const t=G(A);console.log("Invalid CC emails:",t),I((e=>({...e,cc:!0,invalidCcEmails:t})))}if(_.length>0&&!Z(_)){++e;const t=G(_);console.log("Invalid BCC emails:",t),I((e=>({...e,bcc:!0,invalidBccEmails:t})))}F||(++e,I((e=>({...e,subject:!0})))),E||(++e,I((e=>({...e,text:!0})))),e||oe.mutate({subject:F,email_body:E,from_email:b,to:null===w||void 0===w?void 0:w.toString(),...A.length>0&&{cc:A.toString()},..._.length>0&&{bcc:_.toString()},...B&&{signature:B}})},children:[g?"Resend":"Create and Send"," ",(null===oe||void 0===oe?void 0:oe.isPending)&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})},De=e=>{let{projectId:t,isLoading:s,create:i,projectCardData:o,isCreated:a,contactPersons:r=[]}=e;const[d,c]=(0,n.useState)(!1),[,u]=(0,n.useState)({});return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)(l.A,{className:"InvoiceAction InvoiceActive me-3",onClick:()=>c(!0),children:[a?"Resend":"Create"," Invoice  ",(0,me.jsx)("img",{src:we.A,alt:"Invoices"})]}),(0,me.jsx)(Ie,{projectId:t,show:d,create:i,isLoading:s,setShow:c,setPayload:u,contactPersons:r,projectCardData:o,isCreated:a})]})};var Te=s(33624);const Pe="mailchimp-integration_triggerButton__oUsxN",Me="mailchimp-integration_emailSection__0dpZ5",He="mailchimp-integration_label__nOjz5",ze="mailchimp-integration_dropdownSection__tU1s+",Ue="mailchimp-integration_dropdown__y7w51",Oe="mailchimp-integration_unavailableText__UOZb+",Ve="mailchimp-integration_integrationStatus__-54kn",qe="mailchimp-integration_disconnectedBadge__RVvUU";var We=s(88780),Ze=s(98889);const Ge=e=>{var t;let{projectId:s,contactPersons:i=[],hasIntegratedMailchimp:o,reInitialize:a}=e;const{session:r}=(0,A.As)(),[d,c]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[v,g]=(0,n.useState)(""),j=i.filter((e=>e.email)).map((e=>({value:e.email,label:e.email}))),f=()=>{c(!1),x(""),g("")},b=(0,se.I)({queryKey:["mailchimp-lists"],queryFn:We.Yn,enabled:d&&(null===r||void 0===r?void 0:r.has_mailchimp)}),y=(0,ne.n)({mutationFn:e=>(0,We.uu)(e,s),onSuccess:()=>{a(),ce.oR.success("Successfully added to Mailchimp mailing list!"),f()},onError:e=>{var t;console.log("Error adding to Mailchimp:",e),"Member Exists"!==(null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.title)?ce.oR.error("Failed to add to Mailchimp. Please try again."):ce.oR.warning("User is already subscribed to the mailing list.")}});return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(l.A,{variant:"light",className:(0,u.A)("rounded-circle",Pe),onClick:()=>{null!==r&&void 0!==r&&r.has_mailchimp?c(!0):m(!0)},title:"Add to Mailchimp",children:o?(0,me.jsx)("img",{src:Ze,alt:"Mailchimp Logo",style:{width:"25px",height:"25px"}}):(0,me.jsx)(Te.A,{color:"#667085",size:20})}),(0,me.jsxs)(re.A,{show:h,onHide:()=>m(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,me.jsxs)(re.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,me.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,me.jsxs)("span",{children:[(0,me.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,me.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,me.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,me.jsx)("path",{d:"M28 18C22.48 18 18 22.48 18 28C18 33.52 22.48 38 28 38C33.52 38 38 33.52 38 28C38 22.48 33.52 18 28 18ZM29 33H27V31H29V33ZM29 29H27V23H29V29Z",fill:"#F04438"})]}),(0,me.jsx)("span",{className:"ms-3",children:"Mailchimp is currently unavailable"})]})}),(0,me.jsx)("button",{className:"CustonCloseModal",onClick:()=>m(!1),children:(0,me.jsx)(D.A,{size:24,color:"#667085"})})]}),(0,me.jsx)(re.A.Body,{children:(0,me.jsxs)("div",{className:"ContactModel",children:[(0,me.jsxs)("p",{className:Oe,children:["Mailchimp functionality is currently unavailable. To use this feature, please connect your Mailchimp account via ",(0,me.jsx)(te.N_,{to:"/settings/integrations?openMailchimp=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]}),(0,me.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",Ve),children:[(0,me.jsxs)("div",{className:(0,u.A)("d-flex align-items-center justify-content-center gap-2"),children:[(0,me.jsx)("img",{src:Ze,alt:"Mailchimp",style:{width:"40px",height:"40px"}}),(0,me.jsx)("h6",{className:"mb-0",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Mailchimp"})]}),(0,me.jsxs)("span",{className:(0,u.A)("px-2 py-1",qe),children:["Disconnected \xa0",(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"9",viewBox:"0 0 8 9",fill:"none",children:(0,me.jsx)("circle",{cx:"4",cy:"4.5",r:"3",fill:"#F79009"})})]})]})]})})]}),(0,me.jsxs)(re.A,{show:d,onHide:f,centered:!0,className:"taskModelProject",animation:!1,children:[(0,me.jsx)(re.A.Header,{className:"mb-0 pb-0 border-0",children:(0,me.jsxs)("div",{className:"modelHeader d-flex justify-content-between align-items-start w-100",children:[(0,me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,me.jsx)("img",{src:Ze,alt:"Mailchimp",style:{width:"40px",height:"40px"}}),(0,me.jsx)("span",{className:"ms-3",style:{fontSize:"18px",fontWeight:600,color:"#101828"},children:"Add to Mailchimp"})]}),(0,me.jsx)("button",{className:"CustonCloseModal",onClick:f,children:(0,me.jsx)(D.A,{size:24,color:"#667085"})})]})}),(0,me.jsx)(re.A.Body,{children:(0,me.jsxs)("div",{className:"ContactModel",children:[(0,me.jsxs)("div",{className:Me,children:[(0,me.jsxs)("label",{className:He,children:["Select Email ",(0,me.jsx)("span",{style:{color:"#F04438"},children:"*"})]}),(0,me.jsx)(Ne.m,{value:v,options:j,onChange:e=>g(e.value),className:Ue,placeholder:"Select an email address",emptyMessage:"No email addresses found"})]}),(0,me.jsxs)("div",{className:ze,children:[(0,me.jsxs)("label",{className:He,children:["Select Mailing List ",(0,me.jsx)("span",{style:{color:"#F04438"},children:"*"})]}),(0,me.jsx)(Ne.m,{value:p,options:Array.isArray(null===b||void 0===b||null===(t=b.data)||void 0===t?void 0:t.lists)?b.data.lists.map((e=>({value:e.id,label:e.name}))):[],onChange:e=>x(e.value),className:Ue,placeholder:"Select a mailing list",loading:null===b||void 0===b?void 0:b.isFetching,emptyMessage:null!==b&&void 0!==b&&b.isFetching?"Loading...":"No mailing lists found",filter:!0,filterPlaceholder:"Search lists"})]})]})}),(0,me.jsx)(re.A.Footer,{className:"pt-0",children:(0,me.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,me.jsx)(l.A,{variant:"outline-danger",onClick:f,disabled:y.isPending,children:"Cancel"}),(0,me.jsx)(l.A,{variant:"primary save",onClick:()=>{if(!v)return void ce.oR.error("Please select an email address");if(!p)return void ce.oR.error("Please select a mailing list");const e=i.find((e=>e.email===v));if(!e)return void ce.oR.error("Selected email address is not valid");const t={list_id:p,project_id:s,email:v,first_name:e.firstname||"",last_name:e.lastname||"",phone:e.phone||""};y.mutate(t)},disabled:!v||!p||y.isPending,children:y.isPending?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(le.p,{style:{width:"16px",height:"16px",marginRight:"8px"}}),"Adding..."]}):"Add to Mailchimp"})]})})]})]})};var Ke=s(316),Ye=s(69767),Je=s(83570);const Qe=[{icon:(0,me.jsx)(V.A,{size:16,color:"#1AB2FF"}),label:"Invoice",value:"invoice"},{icon:(0,me.jsx)(Ye.A,{size:16,color:"#1AB2FF"}),label:"Quote",value:"quote"},{icon:(0,me.jsx)(Je.A,{size:16,color:"#1AB2FF"}),label:"System",value:"system"},{icon:(0,me.jsx)(U.A,{size:16,color:"#1AB2FF"}),label:"Notes",value:"note"},{icon:(0,me.jsx)(W.A,{size:16,color:"#1AB2FF"}),label:"Email",value:"email"},{icon:(0,me.jsx)(q.A,{size:16,color:"#1AB2FF"}),label:"SMS",value:"sms"},{icon:(0,me.jsx)(O.A,{size:16,color:"#1AB2FF"}),label:"Tasks",value:"task"},{icon:(0,me.jsx)(z.A,{size:16,color:"#1AB2FF"}),label:"Job Created",value:"job"},{icon:(0,me.jsx)(G.A,{size:16,color:"#1AB2FF"}),label:"Expense Linked",value:"order"}],Xe=e=>{let{setFilteredHistoryOptions:t}=e;const[s,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)([]);return(0,me.jsxs)("div",{className:"projectCardFilterDropdown",children:[(0,me.jsx)("span",{onClick:()=>i((e=>!e)),children:(0,me.jsx)(c.A,{size:20,color:"#344054"})}),s&&(0,me.jsxs)("div",{className:"dropdown-menuF px-0",children:[(0,me.jsxs)("button",{className:"all p-0 ps-2 pe-2 mx-2 text-left d-flex justify-content-between align-items-center rounded",style:{background:"#F9FAFB",width:"94%"},onClick:()=>{(null===o||void 0===o?void 0:o.length)>0?l([]):l(Qe.map((e=>e.value)))},children:[(0,me.jsx)("span",{className:"border-0",style:{background:"transparent"},children:"All"}),Qe.length===(null===o||void 0===o?void 0:o.length)&&(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,me.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]}),(0,me.jsx)("ul",{className:"ps-3",children:Qe.map((e=>{let{icon:t,label:s,value:n}=e;return(0,me.jsx)("li",{className:o.includes(s)?"active":"",onClick:()=>(e=>{l((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(n),children:(0,me.jsxs)("label",{htmlFor:s,className:"w-100 d-flex justify-content-between align-items-center",children:[(0,me.jsx)("input",{id:s,type:"checkbox",checked:o.includes(n),readOnly:!0,style:{cursor:"pointer",height:"40px"}}),(0,me.jsxs)("span",{className:"border-0",children:[t," ",s]}),o.includes(n)&&(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,me.jsx)("path",{d:"M16.6666 5L7.49992 14.1667L3.33325 10",stroke:"#1AB2FF",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})]})},s)}))}),(0,me.jsx)("hr",{}),(0,me.jsxs)("div",{className:"dropdown-buttonsF pb-2 px-3",children:[(0,me.jsx)("button",{className:"cancel",onClick:()=>l([]),children:"Cancel"}),(0,me.jsx)("button",{className:"apply",onClick:()=>{t(o),i(!1)},children:"Apply"})]})]})]})};const et=s.p+"static/media/OrdersIcon.bb129217463e985edc21ff683898e113.svg";var tt=s(83738);const st=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},nt=e=>{let{startDate:t,endDate:s}=e;return(0,me.jsxs)(l.A,{className:"dateSelectdTaskBar schedule schActive",style:{minWidth:"160px",minHeight:"46px"},children:[st(t,s)," ",(0,me.jsx)("img",{src:et,alt:"OrdersIcon"})]})},it=e=>{let{projectId:t,projectCardData:s,isFetching:i,startDate:o,endDate:a}=e;const[r,d]=(0,n.useState)({startDate:null,endDate:null}),[c,u]=(0,n.useState)(!1),h=(0,n.useRef)(null),p=(0,ne.n)({mutationFn:e=>(0,m.mw)(t,e),onSuccess:async()=>{s(t)},onError:e=>{d({startDate:null,endDate:null}),console.error("Error creating task:",e)}}),x=e=>{h.current&&!h.current.contains(e.target)&&u(!1)};return(0,n.useEffect)((()=>{o&&a&&d({startDate:new Date(1e3*+o),endDate:new Date(1e3*+a)})}),[o,a]),(0,n.useEffect)((()=>(c?document.addEventListener("mousedown",x):document.removeEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)})),[c]),(0,me.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:h,children:[(0,me.jsx)("div",{onClick:()=>u((e=>!e)),style:{cursor:"pointer"},children:null!==r&&void 0!==r&&r.startDate&&null!==r&&void 0!==r&&r.endDate&&!p.isPending?(0,me.jsx)(nt,{isPending:p.isPending,startDate:r.startDate,endDate:r.endDate}):(0,me.jsx)(l.A,{className:"schedule schActive text-nowrap",style:{minWidth:"201px",minHeight:"46px"},children:p.isPending||i?(0,me.jsx)("div",{className:"dot-flashing"}):(0,me.jsxs)("span",{children:["Schedule Project  ",(0,me.jsx)("img",{src:et,alt:"OrdersIcon"})]})})}),c&&(0,me.jsx)("div",{className:"select-date-range",style:{position:"absolute",bottom:"40px",background:"#fff",zIndex:1e3},children:(0,me.jsx)(tt.s,{onDataApply:e=>{p.mutate({booking_start:e.startDate,booking_end:e.endDate}),d(e),u(!1)},dateRange:r,onClose:()=>u(!1)})})]})};var ot=s(66415),lt=s(79726),at=s(3930),rt=s(35131);s(93066);const dt={"#1AB2FF":{bg:"#BAE8FF",border:"#1AB2FF",color:"#0A4766",text:"Blue"},"#4E5BA6":{bg:"#EAECF5",border:"#4E5BA6",color:"#293056",text:"Deep Blue"},"#2970FF":{bg:"#D1E0FF",border:"#2970FF",color:"#0040C1",text:"Dark Blue"},"#FFB258":{bg:"#FFE8CD",border:"#FFB258",color:"#6D471A",text:"Orange"},"#15B79E":{bg:"#CCFBEF",border:"#15B79E",color:"#125D56",text:"Green"},"#66C61C":{bg:"#E3FBCC",border:"#66C61C",color:"#326212",text:"Light Green"},"#7A5AF8":{bg:"#EBE9FE",border:"#7A5AF8",color:"#4A1FB8",text:"Light Purple"},"#D444F1":{bg:"#FBE8FF",border:"#D444F1",color:"#821890",text:"Magenta"},"#F63D68":{bg:"#FFE4E8",border:"#F63D68",color:"#A11043",text:"Pink"},"#FF007F":{bg:"#FFCCE5",border:"#FF007F",color:"#6F0A3C",text:"Soft Pink"},"#FFD700":{bg:"#FFF8D1",border:"#FFD700",color:"#997100",text:"Yellow"},"#6C6C1C":{bg:"#E1E1B8",border:"#6C6C1C",color:"#444403",text:"Dark Yellow"}},ct=e=>{var t,s,i;let{projectId:o,statusOptions:l,custom_status:a}=e;const[r,d]=(0,n.useState)(null),c=(0,ne.n)({mutationFn:e=>(0,m.Np)(o,e),onSuccess:async()=>{},onError:e=>{d(a),console.error("Error creating task:",e)}});return(0,n.useEffect)((()=>{d(a)}),[a]),(0,me.jsx)(lt.W,{menuButton:(0,me.jsxs)(at.I,{style:{width:"204px",display:"inline-flex",alignItems:"center",justifyContent:"flex-end",padding:"8px 0px",cursor:"pointer",background:"transparent",border:"none",color:"#98A2B3",gap:"10px"},children:[r&&r.title?(0,me.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,me.jsx)(me.Fragment,{children:c.isPending?(0,me.jsx)("div",{className:"dot-flashing"}):(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=dt[null===r||void 0===r?void 0:r.color])||void 0===t?void 0:t.border}`}}),(0,me.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:`${null===(s=dt[null===r||void 0===r?void 0:r.color])||void 0===s?void 0:s.bg}`},children:[(0,me.jsx)("span",{style:{color:`${null===(i=dt[null===r||void 0===r?void 0:r.color])||void 0===i?void 0:i.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===r||void 0===r?void 0:r.title}),(0,me.jsx)("span",{className:"inArrow",children:(0,me.jsx)(ot.A,{color:"#98A2B3",size:15})})]})]})})}):(0,me.jsx)("div",{className:"d-flex justify-content-center",style:{width:"204px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)("div",{className:"h-100",style:{width:"4px",background:"#1D2939"}}),(0,me.jsxs)("div",{className:"h-100 statusFlex d-flex align-items-center",style:{width:"100%",background:"#F2F4F7"},children:[(0,me.jsx)("span",{style:{color:"#1D2939",fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:"No Status"}),(0,me.jsx)("span",{className:"inArrow",children:(0,me.jsx)(ot.A,{color:"#98A2B3",size:15})})]})]})})}),(0,me.jsx)("span",{className:"outArrow",children:(0,me.jsx)(ot.A,{color:"#98A2B3",size:15})})]}),overflow:"auto",position:"anchor",children:null===l||void 0===l?void 0:l.map((e=>{var t,s,n;return(0,me.jsx)(rt.D,{style:{textAlign:"left"},onClick:()=>{var t;null!==(t=e)&&void 0!==t&&t.id&&(c.mutate({custom_status:null===t||void 0===t?void 0:t.id}),d(t))},children:(0,me.jsxs)("div",{className:"d-flex",style:{width:"163px",height:"30px",borderRadius:"4px",overflow:"hidden"},children:[(0,me.jsx)("div",{className:"h-100",style:{width:"4px",background:`${null===(t=dt[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.border}`}}),(0,me.jsx)("div",{className:"h-100 d-flex align-items-center",style:{width:"100%",background:`${null===(s=dt[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.bg}`},children:(0,me.jsx)("span",{style:{color:`${null===(n=dt[null===e||void 0===e?void 0:e.color])||void 0===n?void 0:n.color}`,fontSize:"14px",paddingLeft:"12px",fontWeight:"400"},children:null===e||void 0===e?void 0:e.title})})]})},e.id)}))})};var ut=s(44787),ht=s(29853),mt=s(9634),pt=s(86213),xt=s(55917),vt=s(670);const gt="send-to-calendar_calendarButton__wLLgP",jt="send-to-calendar_calendarModal__ZnyeK",ft="send-to-calendar_modalTitle__yfOOC",bt="send-to-calendar_formLabel__eKaq1",yt="send-to-calendar_AutoComplete__iw4uu",wt="send-to-calendar_borderDanger__P-SWh";var Ct=s(59638);const At=s.p+"static/media/calendar.9ebe7da58af479b138e37b33d2affea2.svg",Nt=e=>{let{projectId:t,project:s,projectCardData:i}=e;const o=(0,n.useRef)(null),a=JSON.parse(window.localStorage.getItem("profileData")||"{}"),r=localStorage.getItem("access_token"),[d,c]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[v,g]=(0,n.useState)(""),[j,f]=(0,n.useState)(""),[b,y]=(0,n.useState)(""),[w,C]=(0,n.useState)(null),[A,N]=(0,n.useState)(null),[_,S]=(0,n.useState)([]),[F,k]=(0,n.useState)(""),[E,L]=(0,n.useState)([]),[B,$]=(0,n.useState)({}),R=(0,se.I)({queryKey:["getClientById",null===s||void 0===s?void 0:s.client],queryFn:()=>(0,Ct.EZ)(null===s||void 0===s?void 0:s.client),enabled:!(null===s||void 0===s||!s.client)&&!!d,retry:1}),I=(0,se.I)({queryKey:["getOutgoingEmail"],queryFn:Be.hx,enabled:!!d}),D=()=>{c(!1),S([]),x(""),g(""),f(""),C(null),N(null),y(""),k("")};(0,n.useEffect)((()=>{null!==s&&void 0!==s&&s.booking_start&&!w&&C(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&!A&&N(new Date(1e3*s.booking_end))}),[s,w,A]);const T=e=>{var t,s;const n=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=((null===(s=R.data)||void 0===s?void 0:s.contact_persons)||[]).map((e=>e.email)).filter((e=>e));i=i.filter((e=>!_.includes(e))),i=i.filter((e=>e.toLowerCase().includes(n))),L(i)},P=()=>{T(),o.current&&o.current.show()};return(0,n.useEffect)((()=>{var e,t,s;null!==I&&void 0!==I&&I.data&&(null!==I&&void 0!==I&&null!==(e=I.data)&&void 0!==e&&e.outgoing_email&&null!==I&&void 0!==I&&null!==(t=I.data)&&void 0!==t&&t.outgoing_email_verified?k(null===I||void 0===I||null===(s=I.data)||void 0===s?void 0:s.outgoing_email):k("no-reply@memate.com.au"))}),[I]),(0,n.useEffect)((()=>{null!==a&&void 0!==a&&a.email&&d&&S([null===a||void 0===a?void 0:a.email])}),[null===a||void 0===a?void 0:a.email,d]),(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)(l.A,{disabled:!(null!==s&&void 0!==s&&s.booking_start),className:`calenBut calenActive text-nowrap ${gt}`,onClick:()=>{null!==s&&void 0!==s&&s.reference?x(`${s.reference}`):null!==s&&void 0!==s&&s.number?x(`Project #${s.number}`):x("Project Event"),g((null===s||void 0===s?void 0:s.description)||""),null!==s&&void 0!==s&&s.booking_start&&C(new Date(1e3*s.booking_start)),null!==s&&void 0!==s&&s.booking_end&&N(new Date(1e3*s.booking_end)),c(!0)},children:["Send to Calendar ",(0,me.jsx)("img",{src:At,alt:"Calendar"})]}),(0,me.jsxs)(re.A,{show:d,onHide:D,centered:!0,className:jt,children:[(0,me.jsx)(re.A.Header,{closeButton:!0,children:(0,me.jsx)(re.A.Title,{className:ft,children:"Send to Calendar"})}),(0,me.jsx)(re.A.Body,{children:(0,me.jsxs)(ht.A,{onSubmit:async e=>{e.preventDefault(),m(!0);try{if(!(()=>{const e={};return p.trim()||(e.eventTitle="Event title is required"),w||(e.startDate="Start date is required"),A||(e.endDate="End date is required"),w>A&&(e.endDate="End date must be after start date"),0===_.length&&(e.guests="Guests are required"),F||(e.from="From email is required"),v.trim()||(e.eventDescription="Description is required"),!(Object.keys(e).length>0)||($(e),!1)})())return void m(!1);const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(null===a||void 0===a?void 0:a.email)||"no-reply@memate.com.au";const s=e=>(0,xt.A)(e,"yyyyMMdd'T'HHmmss'Z'"),n=new Date,i=`${Date.now()}@memate.com.au`,o=s(n);let l=v||"Meeting Invitation",r=`<html><body><p>${v||"Meeting Invitation"}</p>`;if(b){const e=(d=b)?d.includes("zoom.us")?"Zoom":d.includes("teams.microsoft.com")?"Microsoft Teams":d.includes("meet.google.com")?"Google Meet":d.includes("webex.com")?"Cisco Webex":"Online Meeting":null;l+=`\n\n${e} Link: ${b}`,r+=`<p><strong>${e} Link:</strong> <a href="${b}">${b}</a></p>`}var d;r+="</body></html>",r=r.replace(/\n/g,"").replace(/\s+/g," ");const c=["BEGIN:VCALENDAR","PRODID:-//MeMate//Calendar//EN","VERSION:2.0","CALSCALE:GREGORIAN","METHOD:REQUEST","BEGIN:VEVENT",`UID:${i}`,`DTSTAMP:${o}`,`SUMMARY:${p}`,`DESCRIPTION:${l.replace(/\n/g,"\\n")}`,`LOCATION:${j||b||""}`,b?`URL:${b}`:"",`DTSTART:${s(w)}`,`DTEND:${s(A)}`,`ORGANIZER;CN=${null!==a&&void 0!==a&&a.first_name&&null!==a&&void 0!==a&&a.last_name?`${a.first_name} ${a.last_name}`:t.split("@")[0]||"MeMate"}:mailto:${t}`].filter((e=>""!==e));return e&&e.length>0&&e.forEach((e=>{let t=e.split("@")[0].replace(/[.]/g," ");t=t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),c.push(`ATTENDEE;CUTYPE=INDIVIDUAL;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;CN=${t}:mailto:${e}`)})),c.push("STATUS:CONFIRMED","SEQUENCE:0","TRANSP:OPAQUE","BEGIN:VALARM","TRIGGER:-PT15M","ACTION:DISPLAY","DESCRIPTION:Reminder","END:VALARM","X-MICROSOFT-CDO-BUSYSTATUS:BUSY","X-MICROSOFT-CDO-IMPORTANCE:1","X-MICROSOFT-DISALLOW-COUNTER:FALSE","X-MICROSOFT-DONOTFORWARDMEETING:FALSE","X-MICROSOFT-CDO-ALLDAYEVENT:FALSE"),b&&(b.includes("meet.google.com")?c.push(`X-GOOGLE-CONFERENCE:${b}`):b.includes("teams.microsoft.com")&&c.push(`X-MICROSOFT-SKYPETEAMSMEETINGURL:${b}`)),c.push(`X-ALT-DESC;FMTTYPE=text/html:${r}`),c.push("END:VEVENT","END:VCALENDAR"),c.join("\r\n")}(_,F),s=new File([e],"invite.ics",{type:"text/calendar"}),n=new FormData;n.append("subject",`Invitation: ${p}`),n.append("email_body",v),n.append("from_email",F),n.append("to",_.toString()),n.append("attachments",s),await pt.A.post(`https://app.memate.com.au/api/v1/custom/email/${t}/`,n,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}}),ce.oR.success("Calendar event created successfully!"),D(),i(t)}catch(s){console.error("Error creating calendar event:",s),ce.oR.error("Failed to create calendar event. Please try again.")}finally{m(!1)}},children:[(0,me.jsxs)(ht.A.Group,{className:"mb-3",children:[(0,me.jsxs)(ht.A.Label,{className:bt,children:["Event Title",(0,me.jsx)("span",{className:"required",children:"*"})]}),(0,me.jsx)(ht.A.Control,{type:"text",placeholder:"Enter event title",value:p,onChange:e=>x(e.target.value),className:(0,u.A)("border outline-none",(null===B||void 0===B?void 0:B.eventTitle)&&"border-danger")}),(null===B||void 0===B?void 0:B.eventTitle)&&(0,me.jsx)(ht.A.Text,{className:"error-message",children:B.eventTitle})]}),(0,me.jsxs)(de.A,{className:"mb-3",children:[(0,me.jsx)(ae.A,{children:(0,me.jsxs)(ht.A.Group,{children:[(0,me.jsxs)(ht.A.Label,{className:bt,children:["Start Date & Time",(0,me.jsx)("span",{className:"required",children:"*"})]}),(0,me.jsx)(vt.V,{value:w,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{C(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,stepMinute:15,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,me.jsx)(mt.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===B||void 0===B?void 0:B.startDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===B||void 0===B?void 0:B.startDate)&&(0,me.jsx)(ht.A.Text,{className:"error-message",children:null===B||void 0===B?void 0:B.startDate})]})}),(0,me.jsx)(ae.A,{children:(0,me.jsxs)(ht.A.Group,{children:[(0,me.jsxs)(ht.A.Label,{className:bt,children:["End Date & Time",(0,me.jsx)("span",{className:"required",children:"*"})]}),(0,me.jsx)(vt.V,{value:A,dateFormat:"dd/mm/yy",locale:"en",onChange:e=>{N(e.value)},onSelect:()=>{document.body.click()},onClear:()=>{setTimeout((()=>document.body.click()),100)},onTodayButtonClick:()=>{setTimeout((()=>document.body.click()),100)},showTime:!0,stepMinute:15,showIcon:!0,showButtonBar:!0,todayButtonClassName:"p-button-sm p-button-outlined",clearButtonClassName:"p-button-sm p-button-outlined p-button-danger",icon:(0,me.jsx)(mt.A,{color:"#667085",size:20}),className:(0,u.A)("w-100 border rounded",(null===B||void 0===B?void 0:B.endDate)&&"border-danger"),appendTo:document.body,style:{height:"46px",width:"230px",overflow:"hidden"},panelClassName:"calendar-panel-higher-z"}),(null===B||void 0===B?void 0:B.endDate)&&(0,me.jsx)(ht.A.Text,{className:"error-message",children:null===B||void 0===B?void 0:B.endDate})]})})]}),(0,me.jsxs)(ht.A.Group,{className:"mb-3",children:[(0,me.jsxs)(ht.A.Label,{className:bt,children:["Add Guests",(0,me.jsx)("span",{className:"required",children:"*"})]}),(0,me.jsx)(Ae.j,{ref:o,value:_,completeMethod:T,onChange:e=>{S(e.value)},multiple:!0,suggestions:E,onClick:P,onFocus:P,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e));S((e=>[...new Set([...e,...s])])),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(S((e=>[...new Set([...e,t])])),e.target.value="")},className:(0,u.A)(yt,"w-100",(null===B||void 0===B?void 0:B.guests)&&wt),placeholder:"Add guests"}),(null===B||void 0===B?void 0:B.guests)&&(0,me.jsx)(ht.A.Text,{className:"error-message",children:null===B||void 0===B?void 0:B.guests})]}),(0,me.jsxs)(ht.A.Group,{className:"mb-3",children:[(0,me.jsx)(ht.A.Label,{className:bt,children:"Location"}),(0,me.jsx)(ht.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter physical location (optional)",value:j,onChange:e=>f(e.target.value)})]}),(0,me.jsxs)(ht.A.Group,{className:"mb-3",children:[(0,me.jsx)(ht.A.Label,{className:bt,children:"Meeting Link"}),(0,me.jsx)(ht.A.Control,{type:"text",className:"border outline-none",placeholder:"Enter meeting link (Zoom, Teams, etc.)",value:b,onChange:e=>y(e.target.value)})]}),(0,me.jsxs)(ht.A.Group,{className:"mb-3",children:[(0,me.jsxs)(ht.A.Label,{className:bt,children:["Description",(0,me.jsx)("span",{className:"required",children:"*"})]}),(0,me.jsx)(ht.A.Control,{as:"textarea",rows:3,className:(0,u.A)("border outline-none",(null===B||void 0===B?void 0:B.eventDescription)&&"border-danger"),placeholder:"Enter event description",value:v,onChange:e=>g(e.target.value)}),(null===B||void 0===B?void 0:B.eventDescription)&&(0,me.jsx)(ht.A.Text,{className:"error-message",children:null===B||void 0===B?void 0:B.eventDescription})]}),(0,me.jsxs)("div",{className:"d-flex justify-content-end gap-2 mt-4 border-top pt-4",children:[(0,me.jsx)(l.A,{className:"outline-button",variant:"secondary",onClick:D,children:"Cancel"}),(0,me.jsx)(l.A,{className:"solid-button",variant:"primary",type:"submit",disabled:h,children:h?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Sending..."]}):"Send via Email"})]})]})})]})]})};var _t=s(42104);const St="start-chat_chatButton__cwbTm",Ft=e=>{let{projectId:t,project:s}=e;const i=(0,n.useRef)(null),{session:o}=(0,A.As)(),a=(0,ee.Zp)(),r=null===o||void 0===o?void 0:o.desktop_user_id,[d,c]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!1);(0,n.useEffect)((()=>{var e;const t=(0,_t.io)("https://chat.memate.com.au",{transports:["websocket"],autoConnect:!0});i.current=t,r&&t.emit("register_user",{user_id:r,org_id:null===o||void 0===o||null===(e=o.organization)||void 0===e?void 0:e.id},(e=>{"success"===e.status?(c(!0),console.log("User registered successfully")):ce.oR.error("Failed to connect to chat server")}))}),[r,o]);return(0,me.jsxs)(l.A,{className:(0,u.A)(St,"text-nowrap"),disabled:h||!i.current||!d,onClick:()=>{if(r)return i.current?void(i.current&&(m(!0),i.current.emit("create_chat_group",{user_id:r,name:null===s||void 0===s?void 0:s.reference,participants:[],project_id:t,job_id:null},(e=>{"success"===e.status&&e.chat_group_id?(m(!1),a(`/chat?id=${e.chat_group_id}`)):(m(!1),console.log("Error during creation chat group: ",e),ce.oR.error("Failed to create chat group"))})))):ce.oR.error("Failed to start chat")},children:[h&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",marginRight:"8px"}}),"Start Chat",(0,me.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,me.jsxs)("g",{opacity:"0.4",children:[(0,me.jsx)("path",{d:"M1.66663 11.3082V6.32484C1.66663 4.02484 3.53329 2.1665 5.83329 2.1665H14.1666C16.4666 2.1665 18.3333 4.02484 18.3333 6.32484V12.1415C18.3333 14.4332 16.4666 16.2915 14.1666 16.2915H12.9166C12.6583 16.2915 12.4083 16.4165 12.25 16.6248L11 18.2832C10.45 19.0165 9.54996 19.0165 8.99996 18.2832L7.74996 16.6248C7.61663 16.4415 7.31663 16.2915 7.08329 16.2915H5.83329C3.53329 16.2915 1.66663 14.4332 1.66663 12.1415V11.3082Z",fill:"#1D2939"}),(0,me.jsx)("path",{d:"M1.66663 11.3082V6.32484C1.66663 4.02484 3.53329 2.1665 5.83329 2.1665H14.1666C16.4666 2.1665 18.3333 4.02484 18.3333 6.32484V12.1415C18.3333 14.4332 16.4666 16.2915 14.1666 16.2915H12.9166C12.6583 16.2915 12.4083 16.4165 12.25 16.6248L11 18.2832C10.45 19.0165 9.54996 19.0165 8.99996 18.2832L7.74996 16.6248C7.61663 16.4415 7.31663 16.2915 7.08329 16.2915H5.83329C3.53329 16.2915 1.66663 14.4332 1.66663 12.1415V11.3082Z",fill:"url(#paint0_linear_16871_70907)"})]}),(0,me.jsx)("path",{d:"M14.1667 7.7915H5.83337C5.49171 7.7915 5.20837 7.50817 5.20837 7.1665C5.20837 6.82484 5.49171 6.5415 5.83337 6.5415H14.1667C14.5084 6.5415 14.7917 6.82484 14.7917 7.1665C14.7917 7.50817 14.5084 7.7915 14.1667 7.7915Z",fill:"#292D32"}),(0,me.jsx)("path",{d:"M14.1667 7.7915H5.83337C5.49171 7.7915 5.20837 7.50817 5.20837 7.1665C5.20837 6.82484 5.49171 6.5415 5.83337 6.5415H14.1667C14.5084 6.5415 14.7917 6.82484 14.7917 7.1665C14.7917 7.50817 14.5084 7.7915 14.1667 7.7915Z",fill:"url(#paint1_linear_16871_70907)"}),(0,me.jsx)("path",{d:"M10.8334 11.9585H5.83337C5.49171 11.9585 5.20837 11.6752 5.20837 11.3335C5.20837 10.9918 5.49171 10.7085 5.83337 10.7085H10.8334C11.175 10.7085 11.4584 10.9918 11.4584 11.3335C11.4584 11.6752 11.175 11.9585 10.8334 11.9585Z",fill:"#292D32"}),(0,me.jsx)("path",{d:"M10.8334 11.9585H5.83337C5.49171 11.9585 5.20837 11.6752 5.20837 11.3335C5.20837 10.9918 5.49171 10.7085 5.83337 10.7085H10.8334C11.175 10.7085 11.4584 10.9918 11.4584 11.3335C11.4584 11.6752 11.175 11.9585 10.8334 11.9585Z",fill:"url(#paint2_linear_16871_70907)"}),(0,me.jsxs)("defs",{children:[(0,me.jsxs)("linearGradient",{id:"paint0_linear_16871_70907",x1:"1.66663",y1:"2.1665",x2:"18.3333",y2:"18.8332",gradientUnits:"userSpaceOnUse",children:[(0,me.jsx)("stop",{stopColor:"#89F7FE"}),(0,me.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]}),(0,me.jsxs)("linearGradient",{id:"paint1_linear_16871_70907",x1:"5.20837",y1:"6.5415",x2:"5.52901",y2:"8.99968",gradientUnits:"userSpaceOnUse",children:[(0,me.jsx)("stop",{stopColor:"#89F7FE"}),(0,me.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]}),(0,me.jsxs)("linearGradient",{id:"paint2_linear_16871_70907",x1:"5.20837",y1:"10.7085",x2:"5.68914",y2:"13.1123",gradientUnits:"userSpaceOnUse",children:[(0,me.jsx)("stop",{stopColor:"#89F7FE"}),(0,me.jsx)("stop",{offset:"1",stopColor:"#66A6FF"})]})]})]})]})},kt=()=>(0,me.jsxs)("tr",{children:[(0,me.jsx)("td",{children:(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"80%",height:"14px",position:"relative",left:"-10px"}})})}),(0,me.jsx)("td",{children:(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,me.jsx)("td",{children:(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,me.jsx)("td",{children:(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})}),(0,me.jsx)("td",{children:(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"14px"}})})})]});var Et=s(63965),Lt=s(67046),Bt=s(41292),$t=s(96327),Rt=s(51012),It=s(14834),Dt=s(58027),Tt=s(62284);const Pt=e=>{var t,s,i,o,a;let{viewShow:r,setViewShow:d,projectId:c,project:u,statusOptions:h,reInitialize:p}=e;const x=(0,ee.Zp)(),{socket:v,isConnected:g}=(0,Rt.A)(),j=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[f,b]=(0,n.useState)(!1),[y,w]=(0,n.useState)(!0),[C,A]=(0,n.useState)(null),[N,S]=(0,n.useState)(!1),[he,ge]=(0,n.useState)(""),[je,fe]=(0,n.useState)([]),[be,we]=(0,n.useState)([]),[Ce,Ae]=(0,n.useState)([]),[Ne,_e]=(0,n.useState)(!1),[Se,Fe]=(0,n.useState)(!1),[ke,Ee]=(0,n.useState)(!1),[Le,Be]=(0,n.useState)(!1),$e=(0,se.I)({queryKey:["getClientById",null===C||void 0===C?void 0:C.client],queryFn:()=>(0,Ct.EZ)(null===C||void 0===C?void 0:C.client),enabled:!(null===C||void 0===C||!C.client),retry:1}),Re=[...(null===$e||void 0===$e||null===(t=$e.data)||void 0===t?void 0:t.contact_persons)||[],...null!==$e&&void 0!==$e&&null!==(s=$e.data)&&void 0!==s&&s.email?[{email:null===$e||void 0===$e||null===(i=$e.data)||void 0===i?void 0:i.email}]:[]],Ie=parseFloat(null===C||void 0===C?void 0:C.cost_of_sale)||0,Te=parseFloat(null===C||void 0===C?void 0:C.labor_expense)||0,Pe=parseFloat(null===C||void 0===C?void 0:C.operating_expense)||0,Me=parseFloat(Ie+Te+Pe).toFixed(2),He=()=>{d(!1),p()},ze=async e=>{w(!0);try{const t=await(0,m.OE)(e);if("Not found."===(null===t||void 0===t?void 0:t.detail))throw new Error("Project card not found");A(t)}catch(t){console.error("Error fetching project card data:",t),ce.oR.error("Failed to fetch project card data. Please try again."),d(!1),A(null)}finally{w(!1)}},Ue=(0,ne.n)({mutationFn:e=>(0,m.aj)(c,e),onSuccess:()=>{A((e=>({...e,reference:he})))},onError:e=>{console.error("Error creating task:",e)}}),Oe=e=>{const t=new Date(1e3*e);return`${new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t)} | ${new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(t)} | ${`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`}`},Ve=(0,ne.n)({mutationFn:e=>(0,m.jE)(e),onSuccess:e=>{e?x("/sales"):ce.oR.error("Failed to update sendBack to sales. Please try again.")},onError:e=>{console.error("Error updating sendBack to sales:",e),ce.oR.error("Failed to update sendBack to sales. Please try again.")}}),qe=(0,ne.n)({mutationFn:e=>(0,m.ZE)(e),onSuccess:e=>{e?(He(),ce.oR.success("Order has been successfully cancelled")):ce.oR.error("Failed to cancel the order. Please try again.")},onError:e=>{console.error("Error declining the order:",e),ce.oR.error("Failed to decline the order. Please try again.")}}),We=(0,ne.n)({mutationFn:e=>(0,m.yE)(e),onSuccess:e=>{e?(He(),ce.oR.success("Project has been successfully completed")):ce.oR.error("Failed to complete the project. Please try again.")},onError:e=>{console.error("Error completing the project:",e),ce.oR.error("Failed to complete the project. Please try again.")}}),Ze=(0,ne.n)({mutationFn:e=>(0,m.SE)(e),onSuccess:e=>{e?(He(),ze(c),ce.oR.success("Invoice has been successfully created")):ce.oR.error("Failed to create the invoice. Please try again.")},onError:e=>{console.error("Error creating the invoice:",e),ce.oR.error("Failed to create the invoice. Please try again.")}});(0,n.useEffect)((()=>{if(null!==Ce&&void 0!==Ce&&Ce.length){var e;let t=null===C||void 0===C||null===(e=C.history)||void 0===e?void 0:e.filter((e=>Ce.includes(e.type)));we(t||[])}else we(null===C||void 0===C?void 0:C.history)}),[Ce,null===C||void 0===C?void 0:C.history]),(0,n.useEffect)((()=>{if(C){var e,t;let s=[...null===C||void 0===C||null===(e=C.expenses)||void 0===e?void 0:e.map((e=>({...e,type:"expense"}))),...null===C||void 0===C||null===(t=C.jobs)||void 0===t?void 0:t.map((e=>({...e,type:"job"})))].sort(((e,t)=>parseInt(t.created)-parseInt(e.created)));fe(s),we((null===C||void 0===C?void 0:C.history)||[])}}),[C]),(0,n.useEffect)((()=>{c&&r&&ze(c),window.history.pushState({},"","/management")}),[c,r]);const Ye=e=>{var t,s,i,o;let{emailData:l}=e;const[a,r]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),u=(0,n.useRef)(null),h=(e=>{var t,s,n;const i=e.split("\n"),o=(null===(t=i.find((e=>e.startsWith("Subject:"))))||void 0===t?void 0:t.replace("Subject: ",""))||"",l=(null===(s=i.find((e=>null===e||void 0===e?void 0:e.startsWith("Recipient(s):"))))||void 0===s?void 0:s.replace("Recipient(s): ",""))||[];return{subject:o,recipients:JSON.parse((null===l||void 0===l?void 0:l.length)&&(null===l||void 0===l?void 0:l.replace(/'/g,'"'))),body:null===(n=e.split("Body:")[1])||void 0===n?void 0:n.trim()}})(l),m=null===(t=h.body)||void 0===t||null===(s=t.split(/<\/p>\s*<p>|<br\s*\/?>|\n/))||void 0===s?void 0:s.map(((e,t)=>`<p key=${t}>${null===e||void 0===e?void 0:e.trim()}</p>`)),p=null===m||void 0===m?void 0:m.join("");return(0,n.useEffect)((()=>{if(u.current){const e=u.current.scrollHeight;c(e>90)}}),[p]),(0,me.jsxs)("div",{children:[(0,me.jsxs)("ul",{className:"d-flex flex-column align-items-start",children:[(0,me.jsxs)("li",{className:"font-12",children:[(0,me.jsx)("strong",{className:"font-12",children:"Subject:"}),"\xa0 ",h.subject]}),(0,me.jsxs)("li",{children:[(0,me.jsx)("strong",{className:"font-12",children:"Recipients:"}),"\xa0",(0,me.jsx)("ul",{children:(null===h||void 0===h||null===(i=h.recipients)||void 0===i?void 0:i.length)&&(null===h||void 0===h||null===(o=h.recipients)||void 0===o?void 0:o.map(((e,t)=>(0,me.jsx)("li",{className:"font-12",children:e},t))))})]})]}),(0,me.jsxs)("div",{children:[(0,me.jsx)("div",{ref:u,style:{maxHeight:a?"none":"87px",overflowY:"hidden",overflowX:a?"auto":"hidden"},dangerouslySetInnerHTML:{__html:p}}),d&&(0,me.jsx)("button",{className:"text-button font-12 px-0",onClick:()=>r(!a),children:a?"Show Less":"Load More"})]})]})},Je=(0,ne.n)({mutationFn:e=>(0,m.Wb)(c,e),onSuccess:()=>{ce.oR.success("Cost breakdown updated successfully")},onError:e=>{console.error("Error creating task:",e),ce.oR.error("Failed to update cost breakdown"),ze(c)}});return(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)(re.A,{show:r,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"projectCardModel",onHide:He,animation:!1,enforceFocus:!1,children:[(0,me.jsxs)(re.A.Header,{className:"mb-0 pb-0 justify-content-between ",children:[(0,me.jsx)("div",{className:"modelHeader",style:{flex:"1",maxWidth:"calc(100% - 350px)"},children:(0,me.jsxs)("ul",{className:"d-flex align-items-center",children:[(0,me.jsxs)("li",{className:"me-1 d-flex align-items-center",children:[(0,me.jsx)("strong",{className:"dollorIcon",style:{background:null!==C&&void 0!==C&&C.invoice_created?"paid"===(null===C||void 0===C?void 0:C.payment_status)?"#F2FDEC":"not_paid"===(null===C||void 0===C?void 0:C.payment_status)?"#FEF3F2":"#FFFAEB":"#F9FAFB"},children:(0,me.jsx)($.A,{size:13,color:null!==C&&void 0!==C&&C.invoice_created?"paid"===(null===C||void 0===C?void 0:C.payment_status)?"#17B26A":"not_paid"===(null===C||void 0===C?void 0:C.payment_status)?"#F04438":"#B54708":"#667085"})}),y?(0,me.jsx)(F.A,{as:"span",animation:"wave",className:"ms-2 me-2",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",size:"md",style:{width:"120px"}})}):(0,me.jsxs)("span",{className:"cardId text-nowrap",children:[null===C||void 0===C?void 0:C.number," \xa0"]})]}),(0,me.jsxs)("li",{className:"refrencesTag mt-1",style:{width:"calc(100% - 120px)"},children:["Reference:\xa0",y?(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):N?(0,me.jsx)("input",{type:"text",value:he,onChange:e=>{ge(e.target.value)},onBlur:async()=>{S(!1),await Ue.mutateAsync({reference:he}),await(0,m.SE)(c)},className:"border rounded w-100",style:{maxWidth:"calc(100% - 120px)"}}):(0,me.jsx)(me.Fragment,{children:Ue.isPending?(0,me.jsx)("div",{className:"dot-flashing ms-5 mt-1"}):(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)("small",{className:"ellipsis-width",style:{color:"#1D2939",fontSize:"16px",maxWidth:"calc(100% - 220px)"},children:[" ",null===C||void 0===C?void 0:C.reference]}),(0,me.jsxs)("span",{children:[" ",(0,me.jsx)(B.A,{size:16,color:"#106B99",onClick:()=>{S(!0),ge((null===C||void 0===C?void 0:C.reference)||"")},style:{cursor:"pointer"}})]})]})})]})]})}),(0,me.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"15px"},children:[(0,me.jsx)(Ge,{projectId:c,hasIntegratedMailchimp:null===C||void 0===C?void 0:C.mailchimp,contactPersons:Re,reInitialize:()=>ze(c)}),(0,me.jsx)(ye,{projectId:c,contactPersons:Re,hasGoogleReviewEmailSend:null===C||void 0===C?void 0:C.google_review,reInitialize:()=>ze(c)}),(0,me.jsx)(te.N_,{to:`/api/v1/project-card/${c}/pdf/`,target:"_blank",children:(0,me.jsx)(l.A,{variant:"light",className:"rounded-circle px-2",title:"Project Card",children:(0,me.jsx)(R.A,{color:"#344054",size:20})})}),"            ",(0,me.jsx)(te.N_,{to:`/api/v1/sales/${c}/label/`,target:"_blank",title:"Label",children:(0,me.jsx)(l.A,{variant:"light",className:"rounded-circle px-2",children:(0,me.jsx)(I.A,{color:"#344054",size:20})})}),(0,me.jsx)("div",{className:"selectButStatus",children:y?(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"120px",height:"20px"}})}):(0,me.jsx)(ct,{projectId:c,statusOptions:h,custom_status:null===C||void 0===C?void 0:C.custom_status})}),(0,me.jsx)("button",{className:"CustonCloseModal",onClick:He,children:(0,me.jsx)(D.A,{size:24,color:"#667085"})})]})]}),(0,me.jsx)(re.A.Body,{className:"p-0",children:(0,me.jsxs)("div",{className:"ContactModel",children:[(0,me.jsxs)(de.A,{className:"text-left mt-0 projectCardMain",children:[(0,me.jsxs)(ae.A,{sm:6,className:"orderDiscription",children:[(0,me.jsxs)("div",{className:"d-flex justify-content-between align-items-center w-100",children:[(0,me.jsx)("strong",{children:"Order Description"}),(0,me.jsx)(T.A,{size:16,color:"#106B99",onClick:()=>{var e;if(null!==C&&void 0!==C&&null!==(e=C.calculator_descriptions)&&void 0!==e&&e.length){var t;let e=null===C||void 0===C||null===(t=C.calculator_descriptions)||void 0===t?void 0:t.map((e=>`- ${e.description}`)).join("\n");navigator.clipboard.writeText(e),ce.oR.success("Copied to clipboard")}},style:{cursor:"pointer"}})]}),(0,me.jsx)("div",{className:"customScrollBar",children:y?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})}),(0,me.jsx)(F.A,{as:"p",animation:"wave",className:"mb-0 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:"100%",height:"12px"}})})]}):(0,me.jsx)("ul",{children:null!==C&&void 0!==C&&null!==(o=C.calculator_descriptions)&&void 0!==o&&o.length?null===C||void 0===C||null===(a=C.calculator_descriptions)||void 0===a?void 0:a.map(((e,t)=>{let{description:s}=e;return(0,me.jsxs)("li",{children:["- ",s]},t)})):(0,me.jsx)("li",{children:"No Description available"})})}),(0,me.jsxs)("div",{className:"currentJobsTable",children:[(0,me.jsx)("h5",{children:"Current Jobs / Expense for this order"}),(0,me.jsxs)(k.A,{responsive:!0,children:[(0,me.jsx)("thead",{style:{position:"sticky",top:"0px",zIndex:9},children:(0,me.jsxs)("tr",{children:[(0,me.jsx)("th",{className:"border-right",children:"#"}),(0,me.jsx)("th",{children:"Reference"}),(0,me.jsx)("th",{children:"Provider"}),(0,me.jsx)("th",{children:"Estimate/Total"}),(0,me.jsx)("th",{children:"Status"})]})}),(0,me.jsx)("tbody",{children:y?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(kt,{}),(0,me.jsx)(kt,{}),(0,me.jsx)(kt,{}),(0,me.jsx)(kt,{})]}):null!==je&&void 0!==je&&je.length?null===je||void 0===je?void 0:je.map(((e,t)=>{var s,n,i,o,l,a,r;return(0,me.jsxs)("tr",{children:[(0,me.jsx)("td",{className:"border-right",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,me.jsx)(te.N_,{to:`/work/jobs?jobId=${null===e||void 0===e?void 0:e.id}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number}):(0,me.jsx)(te.N_,{to:`/expenses?expenseId=${null===e||void 0===e?void 0:e.id}&supplierName=${null===e||void 0===e||null===(s=e.supplier)||void 0===s?void 0:s.name}`,className:"linkText",target:"_blank",children:null===e||void 0===e?void 0:e.number})}),(0,me.jsx)("td",{children:(0,me.jsx)("div",{className:"ellipsis-width",children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e?void 0:e.reference)||"-":(null===e||void 0===e?void 0:e.invoice_reference)||"-"})}),(0,me.jsx)("td",{children:(0,me.jsx)(E.A,{placement:"top",overlay:(0,me.jsx)(L.A,{className:"TooltipOverlay",id:`tooltip-${top}`,children:"job"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e||null===(n=e.worker)||void 0===n?void 0:n.full_name)||"":(null===e||void 0===e||null===(i=e.supplier)||void 0===i?void 0:i.name)||""}),children:(0,me.jsx)("div",{className:"mx-auto d-flex align-items-center justify-content-center ps-2",style:{width:"fit-content"},children:"job"===(null===e||void 0===e?void 0:e.type)?(0,me.jsx)(Dt.h,{has_photo:null===e||void 0===e||null===(o=e.worker)||void 0===o?void 0:o.has_photo,photo:null===e||void 0===e||null===(l=e.worker)||void 0===l?void 0:l.photo,is_business:!1,size:16}):(0,me.jsx)(Dt.h,{has_photo:null===e||void 0===e||null===(a=e.supplier)||void 0===a?void 0:a.has_photo,photo:null===e||void 0===e||null===(r=e.supplier)||void 0===r?void 0:r.photo,is_business:!0,size:16})})},"top")}),(0,me.jsxs)("td",{children:["$",(0,It.m)(null===e||void 0===e?void 0:e.total)||"-"]}),(0,me.jsx)("td",{className:"status",children:"job"===(null===e||void 0===e?void 0:e.type)?(0,me.jsx)(Et.A,{status:null===e||void 0===e?void 0:e.status,actionStatus:null===e||void 0===e?void 0:e.action_status,published:null===e||void 0===e?void 0:e.published}):(0,me.jsx)("span",{className:null!==e&&void 0!==e&&e.paid?"paid":"unpaid",children:null!==e&&void 0!==e&&e.paid?"Paid":"Not Paid"})})]},e.number||`je-${t}`)})):(0,me.jsx)("tr",{children:(0,me.jsx)("td",{colSpan:5,className:"noDataAvilable text-center",children:" No data available"})})})]})]})]}),(0,me.jsxs)(ae.A,{sm:6,className:"projectHistoryCol",children:[(0,me.jsxs)(de.A,{children:[(0,me.jsxs)(ae.A,{className:"tabModelMenu d-flex justify-content-between align-items-center p-0",children:[(0,me.jsx)(ue.A,{projectId:c,projectCardData:ze}),(0,me.jsx)(Ke.A,{project:u,reInitialize:p,projectCardData:()=>ze(c)}),(0,me.jsx)(ut.A,{projectId:c,projectCardData:()=>ze(c)}),(0,me.jsx)(xe.A,{projectId:c,projectCardData:()=>ze(c),contactPersons:Re})]}),(0,me.jsx)(ae.A,{className:"d-flex justify-content-center align-items-center filter",children:(0,me.jsx)(Xe,{setFilteredHistoryOptions:Ae})})]}),(0,me.jsx)(de.A,{className:"projectHistoryWrap",children:(0,me.jsxs)(ae.A,{className:"p-0",children:[(0,me.jsx)("h3",{children:"Project History"}),y?(0,me.jsx)(me.Fragment,{children:Array.from({length:10},((e,t)=>(0,me.jsx)(F.A,{as:"p",animation:"wave",className:t%2===0?"mb-0 mt-1":"mb-3 mt-1",children:(0,me.jsx)(F.A,{xs:12,bg:"secondary",className:"rounded-0",size:"sm",style:{width:t%2===0?"200px":"90%",height:t%2===0?"15px":"10px"}})},`history-key-${t+1}`)))}):(0,me.jsx)("div",{className:"projectHistoryScroll",children:null!==be&&void 0!==be&&be.length?null===be||void 0===be?void 0:be.map(((e,t)=>{let{id:s,type:n,text:i,title:o,created:l,manager:a,links:r}=e;return(0,me.jsxs)("div",{className:"projectHistorygroup",children:[(0,me.jsx)("ul",{children:(0,me.jsx)("li",{children:"quote"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,me.jsx)(P.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Quote \xa0"}),"\xa0",(null===r||void 0===r?void 0:r.quote_pdf)&&(0,me.jsx)(te.N_,{to:`${(null===r||void 0===r?void 0:r.quote_pdf)||"#"}`,target:"_blank",children:(0,me.jsx)(M.A,{color:"#FF0000",size:14})}),"\xa0\xa0",c&&"Quote Created"===o&&(0,me.jsx)(te.N_,{to:`/quote/${c}`,target:"_blank",children:(0,me.jsx)(H.A,{color:"#3366CC",size:16})})]})}):"task"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(z.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Task"})]})}):"order"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(z.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Order"})]})}):"note"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(U.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Note"})]})}):"tag"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(O.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Tag"})]})}):"invoice"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,me.jsx)(V.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Invoice\xa0"}),"\xa0",(null===r||void 0===r?void 0:r.invoice_pdf)&&(0,me.jsx)(te.N_,{to:`${(null===r||void 0===r?void 0:r.invoice_pdf)||"#"}`,target:"_blank",children:(0,me.jsx)(M.A,{color:"#FF0000",size:14})}),"\xa0\xa0",c&&"Invoice Created"===o&&(0,me.jsx)(te.N_,{to:`/invoice/${c}`,target:"_blank",children:(0,me.jsx)(H.A,{color:"#3366CC",size:16})})]})}):"billing"===n?(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(q.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Billing"})]})}):"email"===n?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(W.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Email"})]}):"job"===n?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(Z.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Job"})]}):"expense"===n?(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(G.A,{size:16,color:"#1AB2FF"})," ",(0,me.jsx)("strong",{children:"\xa0 Expense"})]}):""})}),(0,me.jsx)("h5",{style:{whiteSpace:"pre-line"},children:"email"!==n&&o||""}),"email"===n&&"Google review sent"!==o?(0,me.jsx)(Ye,{emailData:i}):(0,me.jsx)("h6",{style:{whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:i}}),(0,me.jsxs)("p",{children:[Oe(l)," by ",a]})]},`history-${s||t}`)})):(0,me.jsx)("p",{children:"No history available"})})]})})]})]}),(0,me.jsx)(de.A,{className:"projectCardButWrap",children:(0,me.jsxs)(ae.A,{children:[(0,me.jsx)(it,{projectId:c,projectCardData:ze,isFetching:y,startDate:+(null===C||void 0===C?void 0:C.booking_start),endDate:+(null===C||void 0===C?void 0:C.booking_end)},c),(0,me.jsxs)(l.A,{className:"expense expActive text-nowrap",onClick:()=>Ee(!0),children:["Create Expense ",(0,me.jsx)("img",{src:$t.A,alt:"Expense"})]}),(null===j||void 0===j?void 0:j.has_work_subscription)&&(0,me.jsx)(me.Fragment,{children:(0,me.jsxs)(l.A,{className:"createJob jobActive text-nowrap",onClick:()=>Fe(!0),children:["Create a Job ",(0,me.jsx)("img",{src:Bt.A,alt:"briefcase"})]})}),(0,me.jsx)(ve.A,{projectId:c}),(0,me.jsx)(Nt,{projectId:c,project:C,projectCardData:ze}),(0,me.jsx)(Ft,{projectId:c,project:C})]})}),(0,me.jsxs)(de.A,{className:"projectCardCalculation",children:[(0,me.jsxs)(ae.A,{className:"proCostSale projectColBg",children:[(0,me.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,me.jsx)("h5",{children:"Cost Of Sale"}),(0,me.jsxs)("p",{children:["$",(0,It.m)(null===C||void 0===C?void 0:C.cost_of_sale)]})]}),(0,me.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,me.jsx)(K.A,{size:20,color:"#344054"})})]}),(0,me.jsxs)(ae.A,{className:"proLabour projectColBg",children:[(0,me.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,me.jsx)("h5",{children:"Labour"}),(0,me.jsxs)("p",{children:["$",(0,It.m)(null===C||void 0===C?void 0:C.labor_expense)]})]}),(0,me.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,me.jsx)(K.A,{size:20,color:"#344054"})})]}),(0,me.jsxs)(ae.A,{className:"proOperatingExpense projectColBg",children:[(0,me.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,me.jsx)("h5",{children:"Operating Expense"}),(0,me.jsxs)("p",{children:["$",(0,It.m)(null===C||void 0===C?void 0:C.operating_expense)]})]}),(0,me.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:(0,me.jsx)("path",{d:"M4.16675 8H15.8334M4.16675 13H15.8334",stroke:"#344054",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,me.jsxs)(ae.A,{className:"proRealCost projectColBg",children:[(0,me.jsxs)("div",{style:{position:"relative",left:"20px"},children:[(0,me.jsx)("h5",{children:"Real Cost"}),(0,me.jsxs)("p",{children:["$",(0,It.m)(Me)]})]}),(0,me.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"40px",height:"40px",borderRadius:"40px",border:"1px solid #D0D5DD",background:"#fff",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",position:"relative",left:"42px"},children:(0,me.jsx)("span",{className:"font-14",children:"VS"})})]}),(0,me.jsx)(ae.A,{className:"proBuget projectColBg",children:(0,me.jsxs)("div",{children:[(0,me.jsx)("h5",{children:"Budget"}),(0,me.jsxs)("p",{children:["$",(0,It.m)(null===C||void 0===C?void 0:C.budget)]})]})})]}),(0,me.jsxs)(de.A,{className:"projectCardactionBut",children:[(0,me.jsxs)(ae.A,{className:"actionLeftSide",style:{position:"relative"},children:[(0,me.jsx)(pe,{show:Le,onClose:()=>Be(!1),onConfirm:async()=>{Be(!1),qe.mutate(c)},isLoading:qe.isPending}),(0,me.jsxs)(l.A,{onClick:()=>{Be(!0)},disabled:!(null!==C&&void 0!==C&&C.can_be_declined)||qe.isPending,className:"declineAction",children:[(0,me.jsx)(Y.A,{size:20,color:"#912018"})," Cancel Project",qe.isPending&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]}),(0,me.jsxs)(l.A,{disabled:f,className:"duplicateAction",onClick:async()=>{try{if(!c)return ce.oR.error("Project id not found");b(!0),await(0,Lt.L)(c),x("/sales"),ce.oR.success("Sale has been successfully duplicated")}catch(e){console.error("Error is duplicating:",e),ce.oR.error("Failed to duplicate sale. Please try again.")}finally{b(!1)}},children:[(0,me.jsx)(J.A,{size:20,color:"#0A4766",className:"me-1"}),(0,me.jsx)("span",{style:{position:"relative",top:"2px"},children:"Duplicate"})," ",f&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"6px"}})]}),(0,me.jsxs)(l.A,{disabled:!(null!==C&&void 0!==C&&C.can_be_return),onClick:()=>{!(null!==C&&void 0!==C&&C.can_be_return)||Ve.mutate(c)},className:"sendBackAction",children:[(0,me.jsx)(Q.A,{size:20,color:"#344054",opacity:null!==C&&void 0!==C&&C.can_be_return?1:.5}),"Send Back to Sales",Ve.isPending&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]}),(0,me.jsxs)(ae.A,{className:"actionRightSide",children:[(0,me.jsx)(De,{isCreated:null===C||void 0===C?void 0:C.invoice_created,projectId:c,isLoading:null===Ze||void 0===Ze?void 0:Ze.isPending,create:()=>{Ze.mutate(c)},projectCardData:()=>ze(c),contactPersons:Re}),(0,me.jsxs)(l.A,{onClick:()=>{v&&g?(We.mutate(c),v.emit("archive_chat_by_project",{project_id:c})):(console.error("Socket is not connected"),ce.oR.error("Unable to delete chat. Please try again."))},disabled:!(null!==C&&void 0!==C&&C.can_be_completed),className:"CompleteActionBut",children:["Complete & Archive",(null===We||void 0===We?void 0:We.isPending)&&(0,me.jsx)(le.p,{style:{width:"20px",height:"20px",position:"relative",top:"2px",left:"8px"}})]})]})]}),(0,me.jsx)(de.A,{className:"projectBreakdown px-0 pb-0",children:(0,me.jsxs)(ae.A,{sm:12,className:"px-0",children:[(0,me.jsxs)(l.A,{className:"mb-2",onClick:()=>_e(!Ne),children:[Ne?"Hide":"Show"," Cost breakdown"]}),Ne&&(0,me.jsxs)(me.Fragment,{children:[(0,me.jsxs)(oe.b,{value:(null===C||void 0===C?void 0:C.calculations)||[],showGridlines:!0,className:"border-top",children:[(0,me.jsx)(ie.V,{field:"id",header:"Order",bodyClassName:"text-center",headerClassName:"text-center",style:{width:"60px"},body:(e,t)=>t.rowIndex+1}),(0,me.jsx)(ie.V,{field:"subindex",header:"Department",style:{minWidth:"192px"},body:e=>(0,me.jsx)("div",{className:"ellipsis-width",title:e.subindex,style:{maxWidth:"192px"},children:e.subindex})}),(0,me.jsx)(ie.V,{field:"description",header:"Description",body:e=>{var t;const[s,i]=(0,n.useState)(e.description),[o,l]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{var t;o&&(null===(t=document.getElementById(`cost-breakdown-${e.id}`))||void 0===t||t.focus())}),[o,e.id]),(0,me.jsxs)("div",{className:"d-flex",children:[(0,me.jsx)("textarea",{rows:1,className:"auto-expand",style:{background:"transparent",border:"0px solid #fff",fontSize:"14px",minHeight:"50px"},value:s,id:`cost-breakdown-${e.id}`,onChange:e=>{i(e.target.value)},disabled:!o,onInput:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`},onFocus:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`,e.target.style.border="1px solid #dedede",e.target.style.background="#fff"},onBlur:t=>{t.target.style.height="50px",t.target.style.border="0px solid #fff",t.target.style.background="transparent",((e,t)=>{Je.mutate({id:e,description:t})})(e.id,s),l(!1)},onClick:e=>{e.target.style.height="auto",e.target.style.height=`${e.target.scrollHeight}px`}}),null!==Je&&void 0!==Je&&Je.isPending&&(null===Je||void 0===Je||null===(t=Je.variables)||void 0===t?void 0:t.id)===e.id?(0,me.jsx)(le.p,{style:{width:"20px",height:"20px"}}):(0,me.jsx)(B.A,{size:16,color:"#106B99",onClick:()=>l(!0),style:{cursor:"pointer",marginLeft:"8px"}})]})},style:{width:"100%"}}),(0,me.jsx)(ie.V,{field:"cost",header:"Cost",style:{width:"100%"},body:e=>`$${(0,It.m)(e.cost)}`}),(0,me.jsx)(ie.V,{field:"profit_type_value",header:"Markup/Margin",body:e=>`${e.profit_type_value} ${"AMN"===e.profit_type?"AMT $":"MRG"===e.profit_type?"MRG %":"MRK %"}`,style:{width:"100%"}}),(0,me.jsx)(ie.V,{field:"unit_price",header:"Unit Price",style:{width:"100%"},body:e=>`$${(0,It.m)(e.unit_price)}`}),(0,me.jsx)(ie.V,{field:"quantity",header:"Qty/Unit",style:{width:"100%"}}),(0,me.jsx)(ie.V,{field:"discount",header:"Discount",style:{width:"100%"},body:e=>`${e.discount}%`}),(0,me.jsx)(ie.V,{field:"total",header:"Amount",style:{width:"100%"},body:e=>`$${(0,It.m)(e.total)}`})]}),(0,me.jsxs)("div",{className:"w-100 d-flex align-items-center justify-content-end gap-4",style:{background:"#EBF8FF",padding:"8px 24px 8px 40px"},children:[(0,me.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,me.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Sub Total"}),(0,me.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,It.m)(null===C||void 0===C?void 0:C.sub_total)]})]}),(0,me.jsx)("div",{children:(0,me.jsx)(K.A,{size:20,color:"#106B99"})}),(0,me.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,me.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Tax"}),(0,me.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,It.m)(null===C||void 0===C?void 0:C.gst)]})]}),(0,me.jsx)("div",{children:(0,me.jsx)("div",{children:(0,me.jsx)(X.A,{size:20,color:"#106B99",style:{transform:"rotate(90deg)"}})})}),(0,me.jsxs)("div",{className:"d-flex flex-column align-items-end",children:[(0,me.jsx)("p",{className:"font-16 mb-0",style:{color:"#106B99",fontWeight:400},children:"Total Invoice Amount"}),(0,me.jsxs)("p",{className:"font-18 mb-0",style:{color:"#106B99",fontWeight:600},children:["$",(0,It.m)(null===C||void 0===C?void 0:C.total)]})]})]})]})]})})]})})]}),(0,me.jsx)(_.A,{visible:Se,setVisible:Fe,setRefetch:()=>ze(c),jobProjectId:Se?null===u||void 0===u?void 0:u.value:"",projectReference:Se?null===u||void 0===u?void 0:u.reference:""}),(0,me.jsx)(Tt.A,{visible:ke,setVisible:Ee,setRefetch:()=>ze(c),expenseProjectId:null===u||void 0===u?void 0:u.value,projectReference:null===u||void 0===u?void 0:u.reference})]})};var Mt=s(68811),Ht=s(72796),zt=s(55973);const Ut=e=>{let{view:t,setView:s,taskId:i,setTaskId:o,reInitialize:l}=e;const{data:a,refetch:r,isFetching:d}=(0,se.I)({queryKey:["task",i],queryFn:()=>(0,Ht.dd)(i),enabled:!!i,retry:1});return(0,n.useEffect)((()=>{i&&r({cancelRefetch:!1})}),[i,r]),(0,me.jsx)(me.Fragment,{children:t&&(0,me.jsx)(zt.A,{show:t,setShow:s,taskId:i,setTaskId:o,defaultValue:a,refetch:l,refetchTask:r,isFetching:d})})},Ot="calender";const Vt=function(){const{session:e}=(0,A.As)(),t=(null===e||void 0===e?void 0:e.has_work_subscription)||!1,s=(0,n.useRef)(null),{trialHeight:i}=(0,N.$)(),[p,x]=(0,n.useState)(""),[v,g]=(0,n.useState)([]),[j,f]=(0,n.useState)(!1),[F,k]=(0,n.useState)(!1),[E,L]=(0,n.useState)(!1),[B,$]=(0,n.useState)(!1),[R,I]=(0,n.useState)([]),[D,T]=(0,n.useState)(null),[P,M]=(0,n.useState)(null),[H,z]=(0,n.useState)({}),[U,O]=(0,n.useState)(""),[V,q]=(0,n.useState)(""),[W,Z]=(0,n.useState)(""),[G,K]=(0,n.useState)(!1),[Y,J]=(0,n.useState)(null),[Q,X]=(0,n.useState)({visible:!1,jobId:null}),[ee,te]=(0,n.useState)(!1),se=window.location.href,ne=new URL(se),ie=new URLSearchParams(ne.search),oe=ie.get("unique_id");if(oe&&!P){M(oe);const e=ie.get("reference"),t=ie.get("number"),s=ie.get("value");z({number:t||"",reference:e,value:s}),L(!0)}function le(e){let t=arguments.length>2?arguments[2]:void 0;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){"job"===t.type?X({visible:!0,jobId:t.job.id}):(M(e),z(t),L(!0))}else T(e),k(!0)}(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,C.ic)();I([...e])}catch(e){console.error("Error fetching project status data:",e)}})()}),[]),(0,n.useEffect)((()=>{const e=e=>{if(!(e.target instanceof HTMLSelectElement)){if(e.target.closest(".createJobButton")){const t=e.target.getAttribute("project-id");J(t),K(!0)}if(e.target.closest(".job-resource-child")){const t=e.target.closest(".job-resource-child").getAttribute("job-id");X({visible:!0,jobId:t})}if(e.target.closest(".create-task-button")){const t=e.target.getAttribute("number"),s=e.target.getAttribute("reference"),n=e.target.getAttribute("project-id");z({number:t,reference:s,value:n}),f(!0)}else if(e.target.closest(".task-list")){const t=e.target.closest(".task-list").getAttribute("task-id");console.log("task-list: ....",t),t&&le(t)}else if(e.target.closest(".project-content")){const t=e.target.closest(".project-content").getAttribute("unique-id"),s=e.target.closest(".project-content").getAttribute("number"),n=e.target.closest(".project-content").getAttribute("reference"),i=e.target.closest(".project-content").getAttribute("project-id");console.log("uniqueId: ....",t),M(t),z({number:s,reference:n,value:i}),L(!0)}}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]),(0,n.useEffect)((()=>{const e=e=>{const{type:t,item:s}=e.detail;"project"===t&&(M(s.unique_id||s.id),z({number:s.number||"",reference:s.reference||"",value:s.id}),L(!0))};return window.addEventListener("openSearchResult",e),()=>{window.removeEventListener("openSearchResult",e)}}),[]);const ae=async()=>{try{$(!0);const e=await(0,m.Mv)();g(e),p?de(p,e):y(e,t),$(!1)}catch(e){console.error("Error initializing DayPilot:",e)}};(0,n.useEffect)((()=>{const e=document.createElement("script");e.src="/daypilot-all.min.js",e.id="daypilot-script-ele";const s=()=>{console.error("Failed to load DayPilot script.")},n=async()=>{try{const e=await(0,m.Mv)(),s=await(async()=>{try{var e;const t=await(0,C.sq)(),s=await(0,w.Ww)(),n=null===s||void 0===s||null===(e=s.results)||void 0===e?void 0:e.map((e=>{var t,s;return{title:`${null===e||void 0===e?void 0:e.label} - ${null===e||void 0===e||null===(t=e.vehicle)||void 0===t?void 0:t.make} ${null===e||void 0===e||null===(s=e.vehicle)||void 0===s?void 0:s.model}`,date:null===e||void 0===e?void 0:e.due_on,type:"vehicle_reminder"}}));return[...t,...n]}catch(t){return console.error("Error fetching holidays:",t),[]}})();g(e),function(e,t,s,n,i,o){try{b(e,t,s,n,i,o)}catch(l){console.log(l)}}(Ot,e,le,ae,t,s)}catch(e){console.error("Error initializing DayPilot:",e)}};return e.addEventListener("error",s),e.addEventListener("load",n),document.body.appendChild(e),()=>{e.removeEventListener("error",s),e.removeEventListener("load",n),document.body.contains(e)&&document.body.removeChild(e)}}),[]);const re=()=>{console.log("handleViewTask: ")};(0,n.useEffect)((()=>{const e=document.querySelector(".task-list");if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.addEventListener("click",re())}return()=>{if(e){let t=e.getAttribute("task-id");console.log("taskId: ",t),e.removeEventListener("click",re)}}}),[]);const de=(e,n)=>{const i=n||v;s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{y(i.filter((t=>{var s,n,i,o,l,a;return!!(null!==t&&void 0!==t&&null!==(s=t.number)&&void 0!==s&&null!==(n=s.toLowerCase())&&void 0!==n&&n.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(i=t.reference)&&void 0!==i&&null!==(o=i.toLowerCase())&&void 0!==o&&o.includes((null===e||void 0===e?void 0:e.toLowerCase())||"")||null!==t&&void 0!==t&&null!==(l=t.client)&&void 0!==l&&null!==(a=l.name.toLowerCase())&&void 0!==a&&a.includes((null===e||void 0===e?void 0:e.toLowerCase())||""))}))||[],t)}),600)},ce=(0,n.useCallback)((()=>{let e=[...v];if("Not Invoiced"===U?e=e.filter((e=>!e.is_invoice_created)):"Not Booked"===U?e=e.filter((e=>!e.booking_start)):"Not Paid"===U&&(e=e.filter((e=>"PAID"!==e.paid))),"Date Due"===V?e.sort(((e,t)=>new Date(1e3*e.booking_end)-new Date(1e3*t.booking_end))):"Date Accepted"===V?e.sort(((e,t)=>new Date(1e3*e.booking_start)-new Date(1e3*t.booking_start))):"Job Number"===V?e.sort(((e,t)=>e.number.localeCompare(t.number))):"Order Status"===V&&e.sort(((e,t)=>{var s,n;return((null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.title)||"").localeCompare((null===t||void 0===t||null===(n=t.custom_status)||void 0===n?void 0:n.title)||"")})),(null===W||void 0===W?void 0:W.length)>0){const t=W.map((e=>e.id));e=e.filter((e=>{var s;return t.includes(null===e||void 0===e||null===(s=e.custom_status)||void 0===s?void 0:s.id)}))}p&&(e=e.filter((e=>{var t,s,n,i,o,l;return!!(null!==e&&void 0!==e&&null!==(t=e.number)&&void 0!==t&&null!==(s=t.toLowerCase())&&void 0!==s&&s.includes((null===p||void 0===p?void 0:p.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(n=e.reference)&&void 0!==n&&null!==(i=n.toLowerCase())&&void 0!==i&&i.includes((null===p||void 0===p?void 0:p.toLowerCase())||"")||null!==e&&void 0!==e&&null!==(o=e.client)&&void 0!==o&&null!==(l=o.name.toLowerCase())&&void 0!==l&&l.includes((null===p||void 0===p?void 0:p.toLowerCase())||""))}))),y(e,t)}),[v,U,V,p,t,W]);(0,n.useEffect)((()=>{ce()}),[U,V,p,ce,W]);const ue=e=>{O(e)},he=e=>{q(e)};return(0,me.jsxs)(n.Fragment,{children:[(0,me.jsxs)("div",{className:"topbar bottom-border",style:{padding:"0px 20px",position:"relative"},children:[(0,me.jsxs)("div",{className:"left-side d-flex align-items-center",style:{gap:"12px"},children:[(0,me.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,me.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,me.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,me.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,me.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>{const t=e.target.value;x(t)},className:"border search-resource",style:{borderRadius:"4px",border:"1px solid #D0D5DD",width:"184px",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,me.jsxs)("div",{className:"d-flex gap-1 justify-content-end align-items-center",style:{position:"absolute",left:"4px",top:"56px",zIndex:1e3},children:[(0,me.jsxs)(o.A,{children:[(0,me.jsxs)(o.A.Toggle,{as:l.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,me.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,me.jsx)(r.A,{size:16,color:"#667085",className:"me-1"}),(0,me.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:V,children:V||(0,me.jsx)("span",{style:{color:"#667085"},children:"Sort By"})})]}),V&&(0,me.jsx)("span",{onClick:e=>{e.stopPropagation(),he("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,me.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,me.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,me.jsxs)(o.A.Menu,{children:[(0,me.jsx)(o.A.Item,{eventKey:"Date Due",active:"Date Due"===V,onClick:()=>he("Date Due"),children:"Date Due"},"Date Due"),(0,me.jsx)(o.A.Item,{eventKey:"Date Accepted",active:"Date Accepted"===V,onClick:()=>he("Date Accepted"),children:"Date Accepted"},"Date Accepted"),(0,me.jsx)(o.A.Item,{eventKey:"Job Number",active:"Job Number"===V,onClick:()=>he("Job Number"),children:"Job Number"},"Job Number"),(0,me.jsx)(o.A.Item,{eventKey:"Order Status",active:"Order Status"===V,onClick:()=>he("Order Status"),children:"Order Status"},"Order Status")]})]}),(0,me.jsxs)(o.A,{children:[(0,me.jsxs)(o.A.Toggle,{as:l.A,className:(0,u.A)("outline-button mx-auto"),style:{padding:"6px 16px",position:"relative"},children:[(0,me.jsxs)("span",{className:"font-14 d-flex align-items-center",children:[(0,me.jsx)(d.A,{size:16,color:"#667085",className:"me-1"}),(0,me.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"55px",color:"#424242",fontWeight:400},title:U,children:U||(0,me.jsx)("span",{style:{color:"#667085"},children:"Filter By"})})]}),U&&(0,me.jsx)("span",{onClick:e=>{e.stopPropagation(),ue("")},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#F2F4F7",marginLeft:"8px"},children:(0,me.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,me.jsx)("path",{d:"M9 3L3 9M3 3L9 9",stroke:"#667085",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,me.jsxs)(o.A.Menu,{children:[(0,me.jsx)(o.A.Item,{eventKey:"Not Invoiced",active:"Not Invoiced"===U,onClick:()=>ue("Not Invoiced"),children:"Not Invoiced"},"Not Invoiced"),(0,me.jsx)(o.A.Item,{eventKey:"Not Booked",active:"Not Booked"===U,onClick:()=>ue("Not Booked"),children:"Not Booked"},"Not Booked"),(0,me.jsx)(o.A.Item,{eventKey:"Not Paid",active:"Not Paid"===U,onClick:()=>ue("Not Paid"),children:"Not Paid"},"Not Paid")]})]}),(0,me.jsxs)("div",{style:{position:"relative",maxWidth:"113px"},children:[(0,me.jsx)("div",{style:{position:"absolute",top:"3px",left:"12px",zIndex:1},children:(0,me.jsx)(c.A,{size:20,color:"#667085"})}),(0,me.jsx)(h.K,{value:W,options:R,onChange:e=>Z(e.value),optionLabel:"title",placeholder:"Status",maxSelectedLabels:0,itemTemplate:e=>{var t,s,n;return(0,me.jsx)("div",{className:"d-flex align-items-center gap-2",style:{width:"250px"},children:(0,me.jsx)("div",{className:"w-100 p-2 rounded",style:{background:`${null===(t=dt[null===e||void 0===e?void 0:e.color])||void 0===t?void 0:t.bg}`,borderLeft:`4px solid ${null===(s=dt[null===e||void 0===e?void 0:e.color])||void 0===s?void 0:s.border}`,color:`${null===(n=dt[null===e||void 0===e?void 0:e.color])||void 0===n?void 0:n.color}`},children:(0,me.jsx)("span",{className:"ellipsis-width",style:{maxWidth:"250px"},children:e.title})})})},filter:!0,scrollHeight:"400px",display:"chip",showClear:!0,className:"w-100 custom-multiselect management-multiselect",style:{width:"184px",borderRadius:"40px",padding:"2px 8px",paddingLeft:"34px"}})]})]})]}),(0,me.jsx)("div",{className:"featureName",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,me.jsx)("h1",{className:"title mx-0",children:"Project Management"})}),(0,me.jsx)("div",{className:"right-side d-flex align-items-center"})]}),(0,me.jsx)("div",{className:i&&"trial-height-added",children:(0,me.jsx)("div",{id:Ot,children:(0,me.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,me.jsx)(a.A,{animation:"border",role:"status",children:(0,me.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})})}),(0,me.jsx)(Ut,{view:F,setView:k,taskId:D,setTaskId:T,reInitialize:ae}),(0,me.jsx)(Mt.A,{show:j,setShow:f,project:H,reInitialize:ae}),(0,me.jsx)(Pt,{viewShow:E,setViewShow:L,projectId:P,project:H,statusOptions:R,reInitialize:ae},P),(0,me.jsx)(_.A,{visible:G,setVisible:K,setRefetch:ae,jobProjectId:Y}),(0,me.jsx)(S.A,{visible:null===Q||void 0===Q?void 0:Q.visible,jobId:null===Q||void 0===Q?void 0:Q.jobId,setVisible:e=>X((t=>({...t,visible:e}))),setRefetch:ae,editMode:ee,setEditMode:te}),B&&(0,me.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",background:"white",width:"60px",height:"60px",borderRadius:"4px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},className:"shadow-lg",children:(0,me.jsx)(a.A,{animation:"border",role:"status",children:(0,me.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})},qt=()=>(0,me.jsxs)(me.Fragment,{children:[(0,me.jsx)(i.mg,{children:(0,me.jsx)("title",{children:"MeMate - Management"})}),(0,me.jsx)(Vt,{})]})},31812:(e,t,s)=>{s.d(t,{A:()=>b});var n=s(65043),i=s(56741),o=s(33361),l=s(35475),a=s(28261),r=s(47097),d=s(58387),c=s(32952),u=s(56328);const h="compose-email_emailUnavailableText__-vpup",m="compose-email_emailStatus__ounlY",p="compose-email_disconnected__mB26k",x="compose-email_dots__Lk2LO";var v=s(81047),g=s(11520),j=s(81242),f=s(70579);const b=e=>{let{projectId:t,projectCardData:s,contactPersons:b=[]}=e;const[,y]=(0,n.useState)({}),[w,C]=(0,n.useState)(!1),[A,N]=(0,n.useState)(!1),_=(0,a.I)({queryKey:["getOutgoingEmail"],queryFn:v.hx}),S=(0,r.n)({mutationFn:e=>(0,g.jy)(t,"",e),onSuccess:()=>{C(!1),s(),u.oR.success("Email send successfully.")},onError:e=>{console.error("Error sending email:",e),u.oR.error("Failed to send email. Please try again.")}});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"linkByttonStyle py-2 ps-0",onClick:()=>{var e,t;null!==_&&void 0!==_&&null!==(e=_.data)&&void 0!==e&&e.outgoing_email&&"no-reply@memate.com.au"!==(null===_||void 0===_||null===(t=_.data)||void 0===t?void 0:t.outgoing_email)?C(!0):N(!0)},children:"Compose Email"}),(0,f.jsxs)(c.A,{show:A,onHide:()=>N(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,f.jsxs)(c.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,f.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,f.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,f.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,f.jsx)("path",{d:"M18 21.5H38C39.1 21.5 40 22.4 40 23.5V33.5C40 34.6 39.1 35.5 38 35.5H18C16.9 35.5 16 34.6 16 33.5V23.5C16 22.4 16.9 21.5 18 21.5ZM38 23.5L28 29.5L18 23.5V25.5L28 31.5L38 25.5V23.5Z",fill:"#F04438"})]}),(0,f.jsx)("span",{className:"ms-3",children:"Email is currently unavailable"})]})}),(0,f.jsx)("button",{className:"CustonCloseModal",onClick:()=>N(!1),children:(0,f.jsx)(i.A,{size:24,color:"#667085"})})]}),(0,f.jsxs)(c.A.Body,{children:[(0,f.jsx)("div",{className:"ContactModel",children:(0,f.jsxs)("p",{className:h,children:["Email functionality is currently unavailable. To use this feature, please configure an email account via ",(0,f.jsx)(l.N_,{to:"/settings/integrations?openEmail=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]})}),(0,f.jsxs)("div",{className:(0,d.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",m),children:[(0,f.jsxs)("div",{className:(0,d.A)("d-flex align-items-center justify-content-center"),children:[(0,f.jsx)(o.A,{size:25,color:"#667085"}),(0,f.jsx)("h6",{className:"ms-2 mt-2",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Outgoing Email"})]}),(0,f.jsxs)("span",{className:(0,d.A)("px-2 py-1",p),children:["Pending",(0,f.jsx)("span",{className:x})]})]})]})]}),(0,f.jsx)(j.A,{show:w,isLoading:!1,mutation:S,setShow:C,setPayload:y,contactPersons:b,isComposeEmail:!0})]})}},36166:(e,t,s)=>{s.d(t,{DX:()=>o,H2:()=>r,LG:()=>u,RC:()=>a,Y4:()=>l,de:()=>p,e0:()=>h,ml:()=>c,os:()=>x,r$:()=>d,rf:()=>m});var n=s(31342);const i="https://app.memate.com.au/api/v1",o=async function(e,t){var s;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;const d=(e-1)*t,c=new URL(`${i}/invoices/`);c.searchParams.append("limit",t),c.searchParams.append("offset",d),o&&c.searchParams.append("search",o),l&&c.searchParams.append("ordering",l),a&&c.searchParams.append("status","not_paid");let u="";var h;null!==r&&void 0!==r&&r.client&&(u=null===r||void 0===r||null===(h=r.client)||void 0===h?void 0:h.map((e=>e.id)).join(","));u&&c.searchParams.append("clients",u);let m="";var p;null!==r&&void 0!==r&&r.status&&1===(null===r||void 0===r||null===(s=r.status)||void 0===s?void 0:s.length)&&(null===r||void 0===r||null===(p=r.status)||void 0===p||p.forEach((e=>{"Paid"===(null===e||void 0===e?void 0:e.name)?m="paid":"Not Paid"===(null===e||void 0===e?void 0:e.name)&&(m="not_paid")})));if(m&&c.searchParams.append("status",m),null!==r&&void 0!==r&&r.date){var x,v,g,j;const e=null===r||void 0===r||null===(x=r.date[0])||void 0===x||null===(v=x.value)||void 0===v?void 0:v[0];if(e){const t=new Date(e),s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");c.searchParams.append("create_date_after",`${s}-${n}-${i}`)}const t=null===r||void 0===r||null===(g=r.date[0])||void 0===g||null===(j=g.value)||void 0===j?void 0:j[1];if(t){const e=new Date(t),s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");c.searchParams.append("create_date_before",`${s}-${n}-${i}`)}}return(0,n.f)(c.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${i}${`/invoices/view/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"},!1)},a=async e=>{if(!e)return null;const t=new URL(`${i}${`/invoices/read/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},r=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/invoices/payment-intent/${e}/`}`);return(0,n.f)(o.toString(),s,!1)},d=async e=>{const t=new URL(`${i}${`/invoices/delete/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},c=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/invoices/send/${e}/`}`);return(0,n.f)(o.toString(),s)},u=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/resend/invoice/${e}/`}`);return(0,n.f)(o.toString(),s)},h=async(e,t)=>{const s={method:"POST",body:t},o=new URL(`${i}${`/invoices/partial-payment/${e}/`}`);return(0,n.f)(o.toString(),s)},m=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/invoices/to-xero/`);return(0,n.f)(s.toString(),t)},p=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/pay/`}`);return(0,n.f)(t.toString(),{method:"POST"})},x=async e=>{const t=new URL(`${i}${`/team/mobile-users/invoices/${e}/unpay/`}`);return(0,n.f)(t.toString(),{method:"POST"})}},40472:(e,t,s)=>{s.d(t,{MA:()=>c,N_:()=>h,Nt:()=>r,g$:()=>l,ir:()=>u,uU:()=>o,yJ:()=>a,zR:()=>d});var n=s(31342);const i="https://app.memate.com.au/api/v1",o=async()=>{const e=new URL(`${i}/locations/`);return(0,n.f)(e.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${i}${`/locations/${e}`}`);return(0,n.f)(t.toString(),{method:"GET"})},a=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/locations/new/`);return(0,n.f)(s.toString(),t)},r=async(e,t)=>{if(!e)throw new Error("No id found");const s={method:"PUT",body:t},o=new URL(`${i}${`/locations/${e}/update/`}`);return(0,n.f)(o.toString(),s)},d=async e=>{const t=new URL(`${i}${`/locations/${e}/delete/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},c=async()=>{const e=new URL(`${i}/references/desktop-users/`);return(0,n.f)(e.toString(),{method:"GET"})},u=async(e,t)=>{const s=new URL(`${i}${`/locations/${e}/${t}/assign-user/`}`);return(0,n.f)(s.toString(),{method:"POST"})},h=async(e,t)=>{if(!e)throw new Error("Location id not found");if(!t)throw new Error("User id not found");const s=new URL(`${i}${`/locations/${e}/${t}/unassign-user/`}`);return(0,n.f)(s.toString(),{method:"POST"})}},44787:(e,t,s)=>{s.d(t,{A:()=>N});var n=s(65043),i=s(56741),o=s(17380),l=s(35475),a=s(28261),r=s(47097),d=s(58387),c=s(17803),u=s(88060),h=s(93740),m=s(14282),p=s(78602),x=s(32952),v=s(61072),g=s(56328);const j={phoneInput:"send-sms_phoneInput__Qgh+S",countrySelector:"send-sms_countrySelector__y14UT",customLabel:"send-sms_customLabel__RzF9F",smsUnavailableAlert:"send-sms_smsUnavailableAlert__8Wmw4",smsIcon:"send-sms_smsIcon__mwlTu",twilioStatus:"send-sms_twilioStatus__9LyX9",twilioIcon:"send-sms_twilioIcon__vuhjt",disconnectedBadge:"send-sms_disconnectedBadge__L41qv",smsUnavailableText:"send-sms_smsUnavailableText__iot1y",settingsLink:"send-sms_settingsLink__DYIqa"};var f=s(81047),b=s(11520),y=s(70767),w=s(70579);const C=c.PhoneNumberUtil.getInstance(),A=e=>{try{return C.isValidNumber(C.parseAndKeepRawInput(e))}catch(t){return!1}},N=e=>{var t;let{projectId:s,projectCardData:c}=e;const[C,N]=(0,n.useState)(null),[_,S]=(0,n.useState)(!1),[F,k]=(0,n.useState)(!1),[E,L]=(0,n.useState)(""),[B,$]=(0,n.useState)({}),[R,I]=(0,n.useState)(""),D=()=>{S(!1),L(""),I(""),$({}),N(null)},T=(0,a.I)({queryKey:["getSMSTemplates"],queryFn:f.pJ}),P=(0,a.I)({queryKey:["smsQuery",C],queryFn:()=>(0,f.Mp)(C),enabled:!!C,retry:1}),M=(0,r.n)({mutationFn:e=>(0,b.qm)(s,e),onSuccess:()=>{g.oR.success("SMS send successfully"),D(),c()},onError:e=>{console.error("Error creating expense:",e),g.oR.error("Failed to send sms. Please try again.")}});return(0,n.useEffect)((()=>{var e;null!==P&&void 0!==P&&null!==(e=P.data)&&void 0!==e&&e.text&&(L(P.data.text),$((e=>({...e,message:!1}))))}),[P.data]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"linkByttonStyle py-2 border-right text-center ps-0",onClick:()=>{const e=JSON.parse(window.localStorage.getItem("profileData")||"{}");null!==e&&void 0!==e&&e.has_twilio?S(!0):k(!0)},children:"Send SMS"}),(0,w.jsxs)(x.A,{show:F,onHide:()=>k(!1),"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",animation:!1,children:[(0,w.jsxs)(x.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,w.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,w.jsxs)("span",{children:[(0,w.jsxs)("svg",{width:"56",height:"57",viewBox:"0 0 56 57",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,w.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",fill:"#FEE4E2"}),(0,w.jsx)("rect",{x:"4",y:"4.5",width:"48",height:"48",rx:"24",stroke:"#FEF3F2",strokeWidth:"8"}),(0,w.jsx)("path",{d:"M20.0168 34.3409C20.3324 34.6574 20.4904 35.0981 20.4479 35.5431C20.3524 36.5401 20.1325 37.5778 19.8502 38.5417C21.9425 38.0581 23.2204 37.4972 23.8012 37.2028C24.1309 37.0357 24.5107 36.9963 24.8677 37.092C25.8545 37.3566 26.9061 37.5 28 37.5C33.9934 37.5 38.5 33.2887 38.5 28.5C38.5 23.7113 33.9934 19.5 28 19.5C22.0066 19.5 17.5 23.7113 17.5 28.5C17.5 30.7021 18.426 32.7456 20.0168 34.3409ZM19.2773 40.1984C19.2672 40.2004 19.2571 40.2024 19.247 40.2044C19.1093 40.2315 18.9688 40.2583 18.8257 40.2845C18.625 40.3212 18.419 40.357 18.2076 40.3916C17.9091 40.4405 17.6805 40.1282 17.7985 39.8496C17.8755 39.6676 17.9515 39.4769 18.0255 39.2791C18.0725 39.1535 18.1187 39.025 18.1639 38.8941C18.1658 38.8885 18.1678 38.8828 18.1697 38.8772C18.5413 37.7976 18.8439 36.5567 18.9547 35.4001C17.1146 33.5548 16 31.1413 16 28.5C16 22.701 21.3726 18 28 18C34.6274 18 40 22.701 40 28.5C40 34.299 34.6274 39 28 39C26.7749 39 25.5926 38.8394 24.4793 38.5408C23.7 38.9357 22.0215 39.6545 19.2773 40.1984Z",fill:"#F04438"}),(0,w.jsx)("path",{d:"M22 24.75C22 24.3358 22.3358 24 22.75 24H33.25C33.6642 24 34 24.3358 34 24.75C34 25.1642 33.6642 25.5 33.25 25.5H22.75C22.3358 25.5 22 25.1642 22 24.75ZM22 28.5C22 28.0858 22.3358 27.75 22.75 27.75H33.25C33.6642 27.75 34 28.0858 34 28.5C34 28.9142 33.6642 29.25 33.25 29.25H22.75C22.3358 29.25 22 28.9142 22 28.5ZM22 32.25C22 31.8358 22.3358 31.5 22.75 31.5H28.75C29.1642 31.5 29.5 31.8358 29.5 32.25C29.5 32.6642 29.1642 33 28.75 33H22.75C22.3358 33 22 32.6642 22 32.25Z",fill:"#F04438"})]}),(0,w.jsx)("span",{className:"ms-3",children:"SMS is currently unavailable"})]})}),(0,w.jsx)("button",{className:"CustonCloseModal",onClick:()=>k(!1),children:(0,w.jsx)(i.A,{size:24,color:"#667085"})})]}),(0,w.jsx)(x.A.Body,{children:(0,w.jsxs)("div",{className:"ContactModel",children:[(0,w.jsxs)("p",{className:j.smsUnavailableText,children:["SMS functionality is currently unavailable. To use this",(0,w.jsx)("br",{})," feature, please ask your admin to set up a Twilio",(0,w.jsx)("br",{})," account and connect it via ",(0,w.jsx)(l.N_,{to:"/settings/integrations?openTwilio=true",style:{color:"#158ECC"},children:"Settings > Integrations"}),"."]}),(0,w.jsxs)("div",{className:(0,d.A)("d-flex align-items-center justify-content-center flex-column gap-1 m-auto",j.twilioStatus),children:[(0,w.jsxs)("div",{className:(0,d.A)("d-flex align-items-center justify-content-center",j.twilioIcon),children:[(0,w.jsx)("img",{src:"/static/media/twilio-logo.c9f32aa9e92765a4deb7.png",style:{width:"50px"}}),(0,w.jsx)("h6",{className:"mb-1",style:{color:"#101828",fontSize:"16px",fontWeight:"400",lineHeight:"24px"},children:"Twilio"})]}),(0,w.jsxs)("span",{className:(0,d.A)("px-2 py-1",j.disconnectedBadge),children:["Disconnected \xa0",(0,w.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"9",viewBox:"0 0 8 9",fill:"none",children:(0,w.jsx)("circle",{cx:"4",cy:"4.5",r:"3",fill:"#F79009"})})]})]})]})})]}),(0,w.jsxs)(x.A,{show:_,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:D,animation:!1,children:[(0,w.jsxs)(x.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,w.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,w.jsxs)("span",{children:[(0,w.jsx)("img",{src:y.A,alt:"AddNoteModeIcon"}),"Send SMS"]})}),(0,w.jsx)("button",{className:"CustonCloseModal",onClick:D,children:(0,w.jsx)(i.A,{size:24,color:"#667085"})})]}),(0,w.jsx)(x.A.Body,{children:(0,w.jsxs)("div",{className:"ContactModel",children:[(0,w.jsxs)(v.A,{children:[(0,w.jsx)(p.A,{sm:12,className:"mb-3",children:(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("label",{className:(0,d.A)(j.customLabel),children:"Templates"}),(0,w.jsx)(u.m,{options:T&&(null===(t=T.data)||void 0===t?void 0:t.map((e=>({value:e.id,label:`${e.title}`}))))||[],className:(0,d.A)(j.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{N(e.value)},value:C,loading:null===T||void 0===T?void 0:T.isFetching,filterInputAutoFocus:!0})]})}),(0,w.jsx)(p.A,{children:(0,w.jsxs)("div",{className:"formgroup sendSMSPhone mb-2 mt-0",children:[(0,w.jsxs)("label",{children:["To",(0,w.jsx)("span",{className:"required",children:"*"})]}),(0,w.jsx)("div",{className:"inputInfo p-0 "+(B.taskRead?"error-border":"border-0"),children:(0,w.jsx)(o.LR,{defaultCountry:"au",placeholder:"Enter phone number",value:R||"",className:"phoneInput w-100",containerClass:j.countrySelector,onChange:e=>{I(e),A(e)&&$((e=>({...e,phone:!1})))}})}),B.phone&&(0,w.jsx)("p",{className:"error-message",children:"Phone is not valid"})]})})]}),(0,w.jsx)(v.A,{children:(0,w.jsx)(p.A,{children:(0,w.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,w.jsxs)("label",{children:["Message",(0,w.jsx)("span",{className:"required",children:"*"})]}),(0,w.jsxs)("div",{className:"inputInfo "+(B.description?"error-border":""),style:{position:"relative"},children:[(0,w.jsx)("div",{style:{position:"absolute",right:"10px",top:"15px"},children:(null===P||void 0===P?void 0:P.isFetching)&&(0,w.jsx)(h.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,w.jsx)("textarea",{type:"text",name:"Enter a message here...",value:E,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value.slice(0,150);L(t),$((e=>({...e,message:!1})))}})]}),(0,w.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-1",children:[(0,w.jsx)("p",{className:"error-message",children:B.message&&"Description is required"}),(0,w.jsxs)("div",{style:{float:"right",fontSize:"14px",color:"#6c757d"},children:[(null===E||void 0===E?void 0:E.length)||0,"/150"]})]})]})})}),(0,w.jsx)(v.A,{}),(0,w.jsxs)("div",{className:"popoverbottom  mt-0 pt-4",children:[(0,w.jsx)(m.A,{variant:"outline-danger",onClick:D,children:"Cancel"}),(0,w.jsxs)(m.A,{disabled:null===M||void 0===M?void 0:M.isPending,variant:"primary save d-flex align-items-center gap-2",onClick:()=>{let e={};if(E||(e.message=!0),R&&A(R)||(e.phone=!0),Object.keys(e).length)return $(e);M.mutate({phone_number:R,message:E})},children:["Send",(null===M||void 0===M?void 0:M.isPending)&&(0,w.jsx)(h.p,{style:{width:"15px",height:"15px"}})]})]})]})})]})]})}},50105:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABBCAYAAACO98lFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAjGSURBVHgB1ZsPcBTVHce/b3dzhyGSBCEUqkmEmIQEsFTpaM3YKAIh2rEFk45Mi7URZ2qQap1W/pUe0tGOlhmwFf+NVWYoVQ6a2kFEFKGK9D+IlhjIHwOEiRCRhGByf3b352/vciF/Lsnu3l1y95m5e29v973d9933fvvb93snMALQ9Mx0eJAOcqTCScnQhBLYoesd/NUOVWoWDQ1tGCYEYgzl5DjhkK4F0V18tsn80zT+ZPAnfZBiF/j443x5ZyHoQ0h4G7rjoKiu9iEGxESEQMMV/XZA/i43YiGEuByRQtTGV7ub63odBd/YJtxuDVEiqiK0z5iSkaKK+/hCfwFCGmLHGei0CQ56TnxUfxYREhURKDs7DclJK7m2JTFufF++4CY8Da/2rKi3L0bEIlBBzg8B6UnOTcTI0QBd/pmoqdkJG9gWgaZenQWhbOJsKeID4s9mZHx9idi/X7VS0JYIlJs7Cwrt4uw4xB/cK/yzRU1jo9kCEixChTmVLMBBxKcABpMhJR0I3CiTWBKBCq/5FUhs4KyC+GYsFJFn9mDTw4Hyc9dAorWIfwik3y0+qX/NbAFTItC0vJ+yS7sJ8Q5Bh4wy8f/av1gpNqQIND23FBq9gbiHWtmrvJd7wF9hkUFFoPzsbDYy/0LQ148GXr7QQzrwukTiFCS1DpLSDk3jR5pwQsj8UqWxwZWmsbt9G9ufIr5CM3arjT3IO0VN3d9hgwFF4IeujKnXsK+O2xA5n3KFG0HyFnZozpktRDNyroRfGO8eD/NW1gCH8ZunKBHVx9+HTQYWoSBnBe9+HJFRw2d4DEdrXxVBZ8YWZFxn/pRKCOnXnBvXYwe/VIk7WIADiICwInTdgcO9TmgFw0AJPIMO/xrR2NiKKEH5+Tw8VTbQYj6foxmSdqc42vAfREh4EabmvMAKL4E9eHyzgaqu24IYQAUFDsC3krNuPsdRRIF+ItDbyMQfJjaiNsWOS90KTV8gjtXvQwLR3/LqWI0HmgVms/2SdZiGoLFFX5xoAhjIPTfoPYznzvw8Z0chtxOY+CXb9dGARx66JoFHuXu+ggSkd0/wYAF/p3ZvT+cpvQdPAxO8g9dCqBLVtb9DgtJbBB2L+h0x1g/8/CRw4/nwNRBPivppGRKY7n7OBtGYCX4K4eyEcVQh+yQp3DPqeHjoPWymRMvFsbo9SGAuNVjDTPSxEf0ougg8ejLYO4KcgeTbjASn513/kakSV7AAS5uA/AvGNPh28fHJ80hwek6OZMMs6ewPVZzhJ0fbNixFxGS7iGeoPcM5S93FqNZGl2gNiED7WAwfCi2VV3AKGZ5/IgpoDvURSSStxjBDUF2crA0OBy9mwOqUGaFGlCMmYbHhQkDcYqQhm2AnZhCVXjCSkOBXBIREsPO2KHAICY6gYFA4KIKOFFhFYycp0ekKFAdFkKzHH7gnJLQ9CEAk5zxNzlBPsBPmjvfYgylaO+EI9QAvrCIPusgiYUi7DL7QcLgIq5AF5yp+8dctE95QTzgFqxCuR6Ij0G4kQRHacBiwaBcEZgU8zUSG6IyRBBrBnl8n7ebZW4ErLVQxmQ2q4WlG7C9IQjnEE9SvIAIEkYOdn+/xS36y+ULiMyO5dCcFPuZv0yI87s2WN7Rlzgfei1iEEytEFSdViIBJ6ygvSdEWWSmjczTMSHv6B++aKdhOMn7cWYBV3jy0iFHLuEvFfBmgGeQkLR8WkSAOB9NLv+wdqtBxfRSKvvwWNvuv6vpFZMA9/x7EATwxXgmLCJLrjPSSCH5U85CoHqjAi/6voZgF+Egf07emtXj+uiSMIFnrOq/m/lgMS4gm9nmPGLluEUSpETHGrnCHV3rycH/ntWimy8LtzkT6Fb/ECCKUpOWcWLoRxPaAJ1Q8Rr7vbPMzPTebdAdu7ZiJTb7swWsU4jfYMecmjACZv/UWcsD2flhESHgulO8lAoc5Gzl508i/o47h8X8D9qkmlyZo0lZUzZ+CYWS8i1IEKZYXZbBoF32eju5Abrgw3PqNvizM6bgRJ8J3//AYExR+fRe2FFvxNezjIinZqW00VlLDIjyjVNXsGvN5aLufCNwb9j7kyd8NOwjkwuF8H1Ul2YglZdvkLKf2Iud+AhuoQlrfczv8PALRam6QpVWh3Qh+sVLpA2wvuRsxINdF4zKvW2AMWVsCcNt2nl4ujvT8KbwI5Xv+xwNnK+wziU+2Fe55L+BPt2YhOgjsmPuDhtx7qz2O2jmwie5QHutf8UBUFadBdX7IuUgb0cqneY0jVU9g4bsnYBWXS0LBQQ4USw+xTxJ8ArHXmnbuHqS2LoRF/nhihVLR98fBXd4dpTdDU/fzIzBarvG/jVq5FQdATf9F+QD/ZHl1di5k5abAojGiUr7MsIEZ58WbMe7sUij6aJigSdLkok9Xi343YujGuec9wt+xCLsby/aaWZDzXWucHCz2aG70WN5n+p8yijoBGU1PIInTQSDStcUnVznDLiEyd4fdJexE0QOIU4SaxsPjPoxpvyX8fsLLjSuVAQ2puVlmutxYRxi34XdSWnF+wnq0jDdWHvdeKch3+R+NK+WKwcqbE6Hc7YPT8X2uP46X9xI6Ut/A6cxKqEron0B0BF65NNAXBsHEYqQu/nzcj7JvbofwGjM330acostt6Ew5CMWTdyTFm3p7/RpHy1BlrFt94jLb567iousQt9BOdKICi/eY+nOY/Uefe+4dXPxZAMPzrmCeDSh762ErBayH30KU7dkJv3o9h3ZfQnxQy4NhnlUBDKLjBBlzCbr0e87NxPDDsQPaiNHyUyh901aQOHqTpC7uVdPm3cU240HeKkKsCfxtWLzMZ30SC99qRgTEZqbYPdd4eizmoVLOZ4h2zNJY1r8DF5wvoeJv7YgCsZ4uF9hWcgMkKmFBvsN3bxb/Yj44EuQY3/YPeLi9A6++16zFt3aRw4mrWEF+8mSQbxIUZSyLchV36XTjBddwflkovrNaCyTlHFR/HXS1BYv2f44Y8xVfS9GFRtJwAQAAAABJRU5ErkJggg=="},55973:(e,t,s)=>{s.d(t,{A:()=>De});var n=s(65043),i=s(93202),o=s(38161),l=s(56741),a=s(95192),r=s(88166),d=s(28261),c=s(47097),u=s(58387),h=s(10446),m=s.n(h),p=s(88060),x=s(93740),v=s(20288),g=s(74856),j=s(14282),f=s(78602),b=s(29853),y=s(61072),w=s(56328),C=s(43984),A=s(71807),N=s(8242),_=s(47009),S=s(86213),F=s(4258);const k="comment-editor_asanaEditorWrapper__1UAiy",E="comment-editor_avatarWrapper__HX3H9",L="comment-editor_editorContainer__5DNNe",B="comment-editor_focused__A0TDm",$="comment-editor_dragOver__3RQri",R="comment-editor_disabled__kEgBL",I="comment-editor_inputArea__iqu88",D="comment-editor_textInput__BuSfR",T="comment-editor_attachmentsPreview__2tXR3",P="comment-editor_attachmentChip__tsAPk",M="comment-editor_error__Gh98k",H="comment-editor_fileIcon__9QnuH",z="comment-editor_fileInfo__Ak+Ca",U="comment-editor_fileName__NFnbx",O="comment-editor_fileSize__I8VsI",V="comment-editor_fileStatus__O7zuJ",q="comment-editor_removeChip__UIpfQ",W="comment-editor_toolbar__H14ex",Z="comment-editor_toolbarLeft__QjN7m",G="comment-editor_toolbarRight__q1XK-",K="comment-editor_toolbarIcon__YrnT2",Y="comment-editor_emojiWrapper__xJmG8",J="comment-editor_emojiPickerDropdown__hdgWf",Q="comment-editor_commentBtn__zCVYF",X="comment-editor_active__j2dE3",ee="comment-editor_imagePreviewChip__YNUuv",te="comment-editor_removeImageBtn__lUflP",se="comment-editor_progressBar__PTWAG",ne="comment-editor_progressFill__lTJmW";var ie=s(79106),oe=s(58027),le=s(70579);const ae=e=>{let{taskId:t,session:s,onCommentAdded:i,disabled:o=!1,commentsScrollRef:a}=e;const[r,d]=(0,n.useState)(""),[c,h]=(0,n.useState)([]),[m,p]=(0,n.useState)(!1),[v,g]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!1),[y,ae]=(0,n.useState)([]),[re,de]=(0,n.useState)(!1),ce=(0,n.useRef)(null),ue=(0,n.useRef)(null),he=(0,n.useRef)(null),me=(0,n.useRef)(null);(0,n.useEffect)((()=>{const e=e=>{me.current&&!me.current.contains(e.target)&&g(!1)};return v&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[v]);const pe=async(e,t,s)=>{try{const n=await S.A.put(t,e,{headers:{"Content-Type":""},onUploadProgress:e=>{const n=Math.round(e.loaded/e.total*100);ae((e=>e.map((e=>e.id===s?{...e,progress:n,url:t}:e))))}});return ae((e=>e.map((e=>e.id===s?{...e,progress:100,uploaded:!0}:e)))),n}catch(n){let t="Upload failed";return t=n.response?403===n.response.status?"Permission denied (403 Forbidden)":`Server error: ${n.response.status}`:n.request?"No response from server":n.message,console.error(`Error uploading ${e.name}:`,t),ae((e=>e.map((e=>e.id===s?{...e,progress:0,error:!0,errorMessage:t,uploadFailed:!0}:e)))),{error:!0,message:t}}},xe=async e=>{if(!t)return void w.oR.error("Save the task first before adding attachments");const s=Array.from(e).filter((e=>!(e.size>10485760)||(w.oR.error(`${e.name} is too large. Max size is 10MB`),!1)));if(0===s.length)return;const n=s.map(((e,t)=>({id:`upload-${Date.now()}-${t}`,name:e.name,size:e.size,type:e.type,progress:0,file:e})));ae((e=>[...e,...n]));for(const o of n)try{const e=await(0,ie.qT)(t,o.name,o.type),{url:s}=e;if(!s){console.error(`No URL returned for file: ${o.name}`),ae((e=>e.map((e=>e.id===o.id?{...e,error:!0,errorMessage:"No URL returned"}:e))));continue}const n=await pe(o.file,s,o.id);if(n&&!n.error){const e=s.split("?")[0];h((t=>[...t,{id:o.id,name:o.name,url:e,type:o.type,size:o.size}])),ae((e=>e.filter((e=>e.id!==o.id))))}}catch(i){console.error("Error uploading file:",o.name,i),ae((e=>e.map((e=>e.id===o.id?{...e,progress:0,error:!0,errorMessage:i.message||"Failed to get upload URL",uploadFailed:!0}:e))))}},ve=(0,n.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),p(!0)}),[]),ge=(0,n.useCallback)((e=>{var t;e.preventDefault(),e.stopPropagation(),null!==(t=he.current)&&void 0!==t&&t.contains(e.relatedTarget)||p(!1)}),[]),je=(0,n.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),fe=(0,n.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),p(!1);const t=e.dataTransfer.files;t.length>0&&xe(t)}),[t]),be=(0,n.useCallback)((e=>{var t;const s=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!s)return;const n=[];for(const i of s)if("file"===i.kind){const e=i.getAsFile();e&&n.push(e)}n.length>0&&(e.preventDefault(),xe(n))}),[t]),ye=e=>{h((t=>t.filter((t=>t.id!==e))))},we=e=>{ae((t=>t.filter((t=>t.id!==e))))},Ce=async()=>{if(r.trim()||0!==c.length)if(t){b(!0);try{var e;let n=null,o=null;c.length>0&&(1===c.length?(n=c[0].url,o=c[0].type):(n=JSON.stringify(c.map((e=>e.url))),o=JSON.stringify(c.map((e=>e.type))))),await(0,ie.Zi)(t,{comment:r.trim(),attachment_url:n,attachment_type:o,created_by:{role:null===s||void 0===s||null===(e=s.user)||void 0===e?void 0:e.role}}),d(""),h([]),null===i||void 0===i||i(),setTimeout((()=>{null!==a&&void 0!==a&&a.current&&a.current.scrollIntoView({behavior:"smooth",block:"end"})}),500)}catch(o){console.error("Error adding comment:",o),w.oR.error("Failed to add comment. Please try again.")}finally{var n;b(!1),null===(n=ce.current)||void 0===n||n.focus()}}else w.oR.error("Save the task first")},Ae=e=>null!==e&&void 0!==e&&e.startsWith("image/")?(0,le.jsx)(C.A,{size:16}):(0,le.jsx)(A.A,{size:16}),Ne=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",_e=e=>null===e||void 0===e?void 0:e.startsWith("image/"),Se=r.trim()||c.length>0;return(0,le.jsxs)("div",{className:k,children:[(0,le.jsx)("div",{className:E,children:(0,le.jsx)(oe.A,{photo:null===s||void 0===s?void 0:s.photo,has_photo:null===s||void 0===s?void 0:s.has_photo,is_business:!1,size:20})}),(c.length>0||y.length>0)&&(0,le.jsxs)("div",{className:T,children:[y.map((e=>_e(e.type)?(0,le.jsxs)("div",{className:ee,children:[(0,le.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.name}),(0,le.jsx)("button",{className:te,onClick:()=>we(e.id),type:"button",children:(0,le.jsx)(l.A,{size:12})}),!e.uploaded&&!e.error&&(0,le.jsx)("div",{className:se,children:(0,le.jsx)("div",{className:ne,style:{width:`${e.progress}%`}})})]},e.id):(0,le.jsxs)("div",{className:(0,u.A)(P,e.error&&M),children:[(0,le.jsx)("div",{className:H,children:Ae(e.type)}),(0,le.jsxs)("div",{className:z,children:[(0,le.jsx)("span",{className:U,children:e.name}),(0,le.jsx)("span",{className:O,children:Ne(e.size)})]}),(0,le.jsx)("span",{className:(0,u.A)(V,e.error&&M),children:e.error?"Failed":`${e.progress}%`}),(0,le.jsx)("button",{className:q,onClick:()=>we(e.id),type:"button",children:(0,le.jsx)(l.A,{size:14})})]},e.id))),c.map((e=>_e(e.type)?(0,le.jsxs)("div",{className:ee,children:[(0,le.jsx)("img",{src:e.url,alt:e.name}),(0,le.jsx)("button",{className:te,onClick:()=>ye(e.id),type:"button",children:(0,le.jsx)(l.A,{size:12})})]},e.id):(0,le.jsxs)("div",{className:P,children:[(0,le.jsx)("div",{className:H,children:Ae(e.type)}),(0,le.jsxs)("div",{className:z,children:[(0,le.jsx)("span",{className:U,children:e.name}),(0,le.jsx)("span",{className:O,children:Ne(e.size)})]}),(0,le.jsx)("button",{className:q,onClick:()=>ye(e.id),type:"button",children:(0,le.jsx)(l.A,{size:14})})]},e.id)))]}),(0,le.jsxs)("div",{className:(0,u.A)(L,re&&B,m&&$,o&&R),ref:he,onDragEnter:ve,onDragLeave:ge,onDragOver:je,onDrop:fe,children:[(0,le.jsx)("div",{className:I,children:(0,le.jsx)("input",{ref:ce,type:"text",className:D,placeholder:"Add a comment",value:r,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Ce())},onPaste:be,onFocus:()=>de(!0),onBlur:()=>de(!1),disabled:o||f||!t})}),(0,le.jsxs)("div",{className:W,children:[(0,le.jsxs)("div",{className:Z,children:[(0,le.jsxs)("div",{className:Y,ref:me,children:[(0,le.jsx)("button",{className:K,type:"button",title:"Add emoji",disabled:o||!t,onClick:()=>g(!v),children:(0,le.jsx)(N.A,{size:18})}),v&&(0,le.jsx)("div",{className:J,children:(0,le.jsx)(F.Ay,{onEmojiClick:e=>{var t;d((t=>t+e.emoji)),g(!1),null===(t=ce.current)||void 0===t||t.focus()},theme:"light",width:300,height:350,searchPlaceHolder:"Search emoji...",previewConfig:{showPreview:!1}})})]}),(0,le.jsx)("button",{className:K,onClick:()=>{var e;return null===(e=ue.current)||void 0===e?void 0:e.click()},type:"button",title:"Attach file",disabled:o||!t,children:(0,le.jsx)(_.A,{size:18})}),(0,le.jsx)("input",{ref:ue,type:"file",multiple:!0,onChange:e=>xe(e.target.files),style:{display:"none"}})]}),(0,le.jsx)("div",{className:G,children:(0,le.jsx)(j.A,{onClick:Ce,className:(0,u.A)(Q,Se&&X),disabled:o||f||!t||!Se,children:f?(0,le.jsx)(x.p,{style:{width:"14px",height:"14px"},strokeWidth:"3"}):"Comment"})})]})]})]})},re="create-task_circleDesignStyle__vtKho",de="create-task_out__LG-iY",ce="create-task_taskTitleInput__s+lNu",ue="create-task_formLabel__04J0h",he="create-task_taskDescriptionInput__RZWSI",me="create-task_projectDropdown__qXb5+",pe="create-task_saveStatusWrapper__1NhE+",xe="create-task_saveStatus__6yreg",ve="create-task_saved__jqL5a",ge="create-task_error__5CguB",je="create-task_footerHint__acXGx",fe="create-task_sidebarFooter__+ieeU",be="create-task_taskFooter__zplYw",ye="create-task_footerRight__UmNHb";var we=s(10586),Ce=s(72796),Ae=s(57189),Ne=s(63040),_e=s(83738);const Se=(e,t)=>{const s={month:"short",day:"numeric"};return`${new Date(e).toLocaleDateString("en-US",s)} - ${new Date(t).toLocaleDateString("en-US",s)}`},Fe=e=>{let{startDate:t,endDate:s}=e;return(0,le.jsx)("div",{className:"dateSelectdTaskBar",children:Se(t,s)})},ke=e=>{let{setDateRange:t,dateRange:s}=e;const[i,o]=(0,n.useState)(!1),l=(0,n.useRef)(null),a=e=>{l.current&&!l.current.contains(e.target)&&o(!1)};return(0,n.useEffect)((()=>(i?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)})),[i]),(0,le.jsxs)("div",{className:"select-date",style:{position:"relative"},ref:l,children:[(0,le.jsx)("div",{onClick:()=>o((e=>!e)),style:{cursor:"pointer"},children:null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate?(0,le.jsx)(Fe,{startDate:s.startDate,endDate:s.endDate}):(0,le.jsx)("div",{style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},className:"iconStyleCircle d-flex justify-content-center align-items-center iconStyleCircleRight "+(i?"active":""),children:(0,le.jsx)(Ne.A,{color:i?"#1AB2FF":"#475467",size:14})})}),i&&(0,le.jsx)("div",{className:"select-date-range",style:{position:"absolute",top:"-100px",background:"#fff",zIndex:1e3},children:(0,le.jsx)(_e.s,{onDataApply:e=>{t(e),o(!1)},dateRange:s,onClose:()=>o(!1)})})]})};var Ee=s(75714);const Le={commentsContainer:"task-comments_commentsContainer__9Qiud",commentsHeader:"task-comments_commentsHeader__SxVw0",commentsTitle:"task-comments_commentsTitle__f66k0",commentsList:"task-comments_commentsList__NBm+d",commentItem:"task-comments_commentItem__bv78f",deleteButton:"task-comments_deleteButton__XLlzH",userName:"task-comments_userName__EH9bR",commentTime:"task-comments_commentTime__4eCW6",commentText:"task-comments_commentText__rSHhj",addCommentSection:"task-comments_addCommentSection__-KvEG",avatar:"task-comments_avatar__GZ9fT",loadMoreWrapper:"task-comments_loadMoreWrapper__TLDxd",loadMoreBtn:"task-comments_loadMoreBtn__6oQeF",loading:"task-comments_loading__3LE67",commentAvatar:"task-comments_commentAvatar__Pc8rI",commentHeader:"task-comments_commentHeader__T9R4I",noComments:"task-comments_noComments__xAIGD",attachmentContainer:"task-comments_attachmentContainer__QEIIm",imageAttachment:"task-comments_imageAttachment__pMEwt",attachmentImage:"task-comments_attachmentImage__3TpwU",fileAttachment:"task-comments_fileAttachment__F5SBZ",fileIconWrapper:"task-comments_fileIconWrapper__bozGA",fileDetails:"task-comments_fileDetails__3maHd",fileName:"task-comments_fileName__6bsXF",fileAction:"task-comments_fileAction__bNX3c"},Be=e=>{var t,s,n,i,o;let l=[],a=[];if(e.attachment_url)try{const t=JSON.parse(e.attachment_url);l=Array.isArray(t)?t:[e.attachment_url]}catch{l=[e.attachment_url]}if(e.attachment_type)try{const t=JSON.parse(e.attachment_type);a=Array.isArray(t)?t:[e.attachment_type]}catch{a=[e.attachment_type]}return{id:e.id,text:e.comment,created_at:e.created_at,attachments:l.map(((e,t)=>({url:e,type:a[t]||"application/octet-stream"}))),attachment_url:e.attachment_url||null,attachment_type:e.attachment_type||null,user:{id:null===(t=e.created_by)||void 0===t?void 0:t.id,full_name:null===(s=e.created_by)||void 0===s?void 0:s.full_name,email:null===(n=e.created_by)||void 0===n?void 0:n.email,photo:null===(i=e.created_by)||void 0===i?void 0:i.avatar,role:null===(o=e.created_by)||void 0===o?void 0:o.role}}},$e=e=>{const t=new Date,s=new Date(e),n=Math.floor((t-s)/6e4);return n<1?"Just now":n<60?`${n} min ago`:n<1440?`${Math.floor(n/60)} hours ago`:`${Math.floor(n/1440)} days ago`},Re=(0,n.forwardRef)(((e,t)=>{let{taskId:s,usersMap:i=new Map}=e;const{data:o,refetch:l,fetchNextPage:a,hasNextPage:r,isFetchingNextPage:d,isLoading:u}=(0,Ee.q)({queryKey:["task-comments",s],queryFn:e=>{let{pageParam:t}=e;return t?fetch(t).then((e=>e.json())):(0,ie.Lb)(s)},enabled:!!s,getNextPageParam:e=>e.next});(0,n.useImperativeHandle)(t,(()=>({refetchComments:()=>l()})));const h=(0,c.n)({mutationFn:ie.Co,onSuccess:()=>{w.oR.success("Comment deleted"),l()},onError:()=>{w.oR.error("Failed to delete comment")}}),m=o?o.pages.slice().flatMap((e=>e.results)).map(Be).sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())).reverse():[];if(u)return(0,le.jsx)("div",{className:Le.loading,children:"Loading comments\u2026"});if(!m.length)return(0,le.jsx)("div",{className:Le.noComments,children:"No comments yet."});return(0,le.jsxs)("div",{className:Le.commentsContainer,children:[r&&(0,le.jsx)("div",{className:Le.loadMoreWrapper,children:(0,le.jsx)("button",{onClick:a,disabled:d,className:Le.loadMoreBtn,children:d?"Loading\u2026":"Load older comments"})}),(0,le.jsx)("div",{className:Le.commentsList,children:m.map((e=>{var t,s,n;const o=i.get(null===(t=e.user)||void 0===t?void 0:t.id),l=(null===o||void 0===o?void 0:o.photo)||(null===(s=e.user)||void 0===s?void 0:s.photo),a=(null===o||void 0===o?void 0:o.has_photo)||!!l;return(0,le.jsx)("div",{className:Le.commentItem,children:(0,le.jsxs)("div",{className:"d-flex gap-3",children:[(0,le.jsx)("div",{className:Le.avatar,children:(0,le.jsx)(oe.A,{photo:l,has_photo:a,is_business:!1,size:18})}),(0,le.jsxs)("div",{className:"flex-grow-1",style:{width:"calc(100% - 50px)"},children:[(0,le.jsxs)("div",{className:Le.header,children:[(0,le.jsx)("span",{className:Le.userName,children:null===(n=e.user)||void 0===n?void 0:n.full_name}),(0,le.jsxs)("span",{className:Le.commentTime,children:["\xb7 ",$e(1e3*e.created_at)]}),(0,le.jsx)("button",{onClick:()=>{return t=e.id,void h.mutate(t);var t},disabled:h.isPending,className:Le.deleteButton,style:{marginLeft:"5px",background:"none",border:"none",color:"#D92D20",cursor:h.isPending&&h.variables===e.id?"not-allowed":"pointer",fontSize:12,opacity:h.isPending&&h.variables===e.id?.6:1},children:h.isPending&&h.variables===e.id?"Deleting...":"Delete"})]}),(0,le.jsx)("p",{className:Le.commentText,children:e.text}),e.attachments&&e.attachments.length>0&&(0,le.jsx)("div",{className:Le.attachmentContainer,children:e.attachments.map(((e,t)=>{var s,n;return null!==(s=e.type)&&void 0!==s&&s.startsWith("image/")?(0,le.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:Le.imageAttachment,children:(0,le.jsx)("img",{src:e.url,alt:`Attachment ${t+1}`,className:Le.attachmentImage})},t):(0,le.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:Le.fileAttachment,children:[(0,le.jsx)("div",{className:Le.fileIconWrapper,children:(0,le.jsx)(A.A,{size:18})}),(0,le.jsxs)("div",{className:Le.fileDetails,children:[(0,le.jsx)("span",{className:Le.fileName,children:(null===(n=e.url.split("/").pop())||void 0===n?void 0:n.split("?")[0])||"Attachment"}),(0,le.jsx)("span",{className:Le.fileAction,children:"Click to download"})]})]},t)}))})]})]})},e.id)}))})]})})),Ie=e=>{if(!e)return null;return new Date(1e3*+e)},De=e=>{var t,s;let{show:h,setShow:C,refetch:A,taskId:N,setTaskId:_,defaultValue:S,projectId:F,refetchTask:k,isFetching:E=!1}=e;const L=(0,n.useRef)(null),B=(0,n.useRef)(null),$=(0,n.useRef)(null),R=(0,n.useRef)(null),{session:I}=(0,Ae.As)(),[D,T]=(0,n.useState)("idle"),[P,M]=(0,n.useState)(null),[H,z]=(0,n.useState)(""),[U,O]=(0,n.useState)(""),[V,q]=(0,n.useState)(""),[W,Z]=(0,n.useState)(null),[G,K]=(0,n.useState)(null),[Y,J]=(0,n.useState)({taskTitle:!1,description:!1,project:!1,user:!1,date:!1}),Q=N||P;(0,n.useEffect)((()=>{var e,t;N&&S&&(z(null===S||void 0===S?void 0:S.title),O(null===S||void 0===S?void 0:S.description),q(null===S||void 0===S||null===(e=S.project)||void 0===e?void 0:e.id),Z(null===S||void 0===S||null===(t=S.user)||void 0===t?void 0:t.id),K({startDate:Ie(null===S||void 0===S?void 0:S.from_date),endDate:Ie(null===S||void 0===S?void 0:S.to_date)}))}),[N,S]);const X=()=>{A(),z(""),O(""),q(""),Z(null),K(null),T("idle"),M(null),Se.current=null,Fe.current=!0,J({taskTitle:!1,description:!1,project:!1,user:!1,date:!1})},ee=(0,d.I)({queryKey:["getProjectsList"],queryFn:we.Bu}),te=(0,d.I)({queryKey:["getUserList"],queryFn:ie.aU}),se=(0,d.I)({queryKey:["getMobileUserList"],queryFn:ie.gy}),ne=n.useMemo((()=>{var e,t,s,n;const i=new Map;return null===te||void 0===te||null===(e=te.data)||void 0===e||null===(t=e.users)||void 0===t||t.forEach((e=>{i.set(e.id,{id:e.id,label:`${e.first_name} ${e.last_name}`.trim()||e.first_name||"-",photo:e.photo||"",has_photo:e.has_photo})})),null===se||void 0===se||null===(s=se.data)||void 0===s||null===(n=s.users)||void 0===n||n.forEach((e=>{i.has(e.id)||i.set(e.id,{id:e.id,label:`${e.first_name} ${e.last_name}`.trim()||e.first_name||"-",photo:e.photo||"",has_photo:e.has_photo})})),i}),[null===te||void 0===te||null===(t=te.data)||void 0===t?void 0:t.users,null===se||void 0===se||null===(s=se.data)||void 0===s?void 0:s.users]);(0,n.useEffect)((()=>{h||X()}),[h]);const Ne=(0,c.n)({mutationFn:e=>(0,ie.Af)(e),onSuccess:e=>{M(null===e||void 0===e?void 0:e.id),T("saved"),w.oR.success("Task created"),setTimeout((()=>T("idle")),2e3)},onError:e=>{console.error("Error creating task:",e),T("error"),w.oR.error("Failed to create task")}}),_e=(0,c.n)({mutationFn:e=>(0,ie.lC)(Q,e),onSuccess:()=>{T("saved"),setTimeout((()=>T("idle")),2e3)},onError:e=>{console.error("Error updating task:",e),T("error"),w.oR.error("Failed to save changes")}}),Se=(0,n.useRef)(null),Fe=(0,n.useRef)(!0),Ee=(0,n.useRef)(null);(0,n.useEffect)((()=>{Ee.current=()=>{var e,t;if(null===H||void 0===H||!H.trim())return;const s={title:H,description:U||"",...V&&{project:V},...W&&{user:W},...(null===G||void 0===G?void 0:G.startDate)&&{from_date:G.startDate},...(null===G||void 0===G?void 0:G.endDate)&&{to_date:G.endDate}},n=JSON.stringify({title:H,description:U||"",project:V||null,user:W||null,fromDate:(null===G||void 0===G||null===(e=G.startDate)||void 0===e?void 0:e.toString())||null,toDate:(null===G||void 0===G||null===(t=G.endDate)||void 0===t?void 0:t.toString())||null});if(Se.current!==n){if(Fe.current&&Q)return Fe.current=!1,void(Se.current=n);Se.current=n,Fe.current=!1,T("saving"),Q?_e.mutate(s):Ne.mutate(s)}}}),[H,U,V,W,G,Q,_e,Ne]);const Le=(0,n.useCallback)(m()((()=>{var e;null===(e=Ee.current)||void 0===e||e.call(Ee)}),1500),[]);(0,n.useEffect)((()=>(h&&null!==H&&void 0!==H&&H.trim()&&Le(),()=>{var e;null===(e=Le.cancel)||void 0===e||e.call(Le)})),[H,U,V,W,G,h,Le]);const Be=(0,c.n)({mutationFn:()=>(0,Ce.mM)(Q),onSuccess:()=>{console.log("Delete success"),C(!1),A()},onError:e=>{console.error("Error creating task:",e)}}),$e=(0,c.n)({mutationFn:e=>(0,Ce._x)(Q,e),onSuccess:(e,t)=>{w.oR.success(t?"Task marked as complete":"Task marked as incomplete"),null===k||void 0===k||k()},onError:e=>{console.error("Error updating task status:",e),w.oR.error("Failed to update task status")}}),De=()=>{const e=null===S||void 0===S?void 0:S.finished;$e.mutate(!e)},Te=()=>{Be.mutate()},Pe=()=>{var e;null===(e=$.current)||void 0===e||e.refetchComments()};return(0,n.useEffect)((()=>{setTimeout((()=>{B.current&&(B.current.style.height="auto",B.current.style.height=B.current.scrollHeight+"px")}),200)}),[U,N]),(0,n.useEffect)((()=>{F&&q(+F)}),[F]),(0,le.jsx)(v.B,{visible:h,position:"right",onHide:()=>{C(!1),N&&_(null),X()},modal:!1,dismissable:!1,style:{width:"591px",height:"97vh",borderRadius:"10px",marginRight:"10px"},content:e=>{var t,s,n,d,c,h,m,v,w,C;let{closeIconRef:A,hide:_}=e;return(0,le.jsxs)("div",{className:"create-sidebar d-flex flex-column",children:[(0,le.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-shrink-0",style:{borderBottom:"1px solid #EAECF0",padding:"24px"},children:[(0,le.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,le.jsx)("div",{className:re,children:(0,le.jsx)("div",{className:de,children:(0,le.jsx)(i.A,{size:24,color:"#17B26A"})})}),(0,le.jsxs)("span",{style:{color:"344054",fontSize:"20px",fontWeight:600},children:[Q?"Edit":"Create New"," Task"]}),(0,le.jsxs)("div",{className:pe,children:["saving"===D&&(0,le.jsxs)("div",{className:xe,children:[(0,le.jsx)(x.p,{style:{width:"14px",height:"14px"},strokeWidth:"3"}),(0,le.jsx)("span",{children:"Saving..."})]}),"saved"===D&&(0,le.jsxs)("div",{className:(0,u.A)(xe,ve),children:[(0,le.jsx)(o.A,{size:14}),(0,le.jsx)("span",{children:"Saved"})]}),"error"===D&&(0,le.jsx)("div",{className:(0,u.A)(xe,ge),children:(0,le.jsx)("span",{children:"Save failed"})})]})]}),(0,le.jsx)("span",{children:(0,le.jsx)(j.A,{type:"button",className:"text-button",ref:A,onClick:e=>_(e),children:(0,le.jsx)(l.A,{size:24,color:"#667085"})})})]}),(0,le.jsxs)("div",{className:"modal-body",style:{height:"calc(100vh - 72px - 200px)",overflow:"auto"},children:[E&&N?(0,le.jsxs)("div",{className:"task-content",style:{padding:"24px"},children:[(0,le.jsx)(g.E,{width:"70%",height:"28px",className:"mb-3"}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,le.jsx)(g.E,{width:"80px",height:"22px"})}),(0,le.jsxs)(f.A,{sm:8,className:"d-flex align-items-center",children:[(0,le.jsx)(g.E,{shape:"circle",size:"24px",className:"me-2"}),(0,le.jsx)(g.E,{width:"120px",height:"22px",style:{marginLeft:"8px"}})]})]}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,le.jsx)(g.E,{width:"80px",height:"22px"})}),(0,le.jsx)(f.A,{sm:8,children:(0,le.jsx)(g.E,{width:"180px",height:"22px"})})]}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,le.jsx)(g.E,{width:"100px",height:"22px"})}),(0,le.jsx)(f.A,{sm:8,children:(0,le.jsx)(g.E,{width:"200px",height:"46px",borderRadius:"8px"})})]}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,children:(0,le.jsx)(g.E,{width:"90px",height:"22px"})}),(0,le.jsx)(f.A,{sm:12,className:"mt-2",children:(0,le.jsx)(g.E,{width:"100%",height:"120px",borderRadius:"8px"})})]})]}):(0,le.jsxs)("div",{className:"task-content",style:{padding:"24px"},children:[(0,le.jsx)(b.A.Control,{type:"text",name:"taskTitle",id:"taskTitle",placeholder:"Enter task title",value:H,onChange:e=>z(e.target.value),className:ce}),Y.taskTitle&&(0,le.jsx)(b.A.Text,{className:"error-message",children:"Task title is required"}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-2",children:(0,le.jsx)(b.A.Label,{className:ue,children:"Assignee"})}),(0,le.jsxs)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:[!W&&(0,le.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>{var e;return null===(e=L.current)||void 0===e?void 0:e.show()},style:{border:"1px dashed #98A2B3",width:"24px",height:"24px",borderRadius:"50%"},children:(0,le.jsx)(a.A,{color:null!==(t=L.current)&&void 0!==t&&null!==(s=t.panel)&&void 0!==s&&null!==(n=s.element)&&void 0!==n&&n.offsetParent?"#1AB2FF":"#475467",size:18,className:"cursor-pointer"})}),(0,le.jsx)(p.m,{ref:L,options:[{label:"Desktop User",items:(null===te||void 0===te||null===(d=te.data)||void 0===d||null===(c=d.users)||void 0===c||null===(h=c.filter((e=>null===e||void 0===e?void 0:e.is_active)))||void 0===h?void 0:h.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]},...null!==I&&void 0!==I&&I.has_work_subscription?[{label:"Mobile User",items:(null===se||void 0===se||null===(m=se.data)||void 0===m||null===(v=m.users)||void 0===v||null===(w=v.filter((e=>"disconnected"!==(null===e||void 0===e?void 0:e.status))))||void 0===w?void 0:w.map((e=>({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.first_name} ${null===e||void 0===e?void 0:e.last_name}`||(null===e||void 0===e?void 0:e.first_name)||"-",photo:(null===e||void 0===e?void 0:e.photo)||"",has_photo:null===e||void 0===e?void 0:e.has_photo}))))||[]}]:[]],onChange:e=>{Z(e.value)},valueTemplate:e=>{const t="object"===typeof e?null===e||void 0===e?void 0:e.value:e,s=ne.get(t);return s?(0,le.jsxs)("div",{className:"d-flex gap-2 align-items-center",style:{position:"relative",left:"-10px"},children:[(0,le.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,le.jsx)(oe.A,{photo:null===s||void 0===s?void 0:s.photo,has_photo:null===s||void 0===s?void 0:s.has_photo,is_business:!1,size:17})}),null===s||void 0===s?void 0:s.label]}):null},itemTemplate:e=>(0,le.jsxs)("div",{className:"d-flex gap-2 align-items-center",children:[(0,le.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{width:"24px",height:"24px",borderRadius:"50%",overflow:"hidden",border:"1px solid #dedede"},children:(0,le.jsx)(oe.A,{photo:null===e||void 0===e?void 0:e.photo,has_photo:null===e||void 0===e?void 0:e.has_photo,is_business:!1,size:17})}),null===e||void 0===e?void 0:e.label]}),className:"outline-none border-0 p-0",style:{width:W?"fit-content":"0px",height:W?"46px":"0px",zIndex:W?"1":"0",position:"relative",left:W?"-4px":"-60px",top:W?"0px":"-15px"},value:W,dropdownIcon:(0,le.jsx)(le.Fragment,{}),collapseIcon:(0,le.jsx)(le.Fragment,{}),placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,optionGroupLabel:"label",optionGroupChildren:"items",scrollHeight:"400px"})]})]}),Y.user&&(0,le.jsx)(b.A.Text,{className:"error-message",children:"User is required"}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center",children:(0,le.jsx)(b.A.Label,{className:ue,children:"Due Date"})}),(0,le.jsx)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,le.jsx)(ke,{dateRange:G,setDateRange:K})})]}),Y.date&&(0,le.jsx)(b.A.Text,{className:"error-message",children:"Date is required"}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,className:"d-flex flex-column justify-content-center pt-3",children:(0,le.jsx)(b.A.Label,{className:ue,children:"Link to Project"})}),(0,le.jsx)(f.A,{sm:8,className:"d-flex flex-column justify-content-center",children:(0,le.jsx)(p.m,{options:(null===ee||void 0===ee||null===(C=ee.data)||void 0===C?void 0:C.map((e=>({value:e.id,label:`${e.number}: ${e.reference}`}))))||[],onChange:e=>{q(e.value)},className:(0,u.A)("outline-none",me),style:{height:"46px",maxWidth:"100%",width:"fit-content"},value:V,loading:null===ee||void 0===ee?void 0:ee.isFetching,placeholder:"Select project",filter:!0,filterInputAutoFocus:!0,panelStyle:{maxHeight:"400px",width:"591px"}})})]}),Y.project&&(0,le.jsx)(b.A.Text,{className:"error-message",children:"Project task is required"}),(0,le.jsxs)(y.A,{className:"mt-3",children:[(0,le.jsx)(f.A,{sm:4,children:(0,le.jsx)(b.A.Label,{className:ue,children:"Description"})}),(0,le.jsx)(f.A,{sm:12,children:(0,le.jsx)(b.A.Control,{name:"taskDescription",id:"taskDescription",as:"textarea",placeholder:"Enter a description...",value:U,rows:2,ref:B,onChange:e=>{O(e.target.value)},className:he,onInput:e=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onFocus:()=>{B.current&&(B.current.style.height="auto",B.current.style.height=B.current.scrollHeight+"px")}})})]}),Y.description&&(0,le.jsx)(b.A.Text,{className:"error-message",children:"Description is required"})]}),Q&&(0,le.jsxs)("div",{className:"border-top",style:{background:"#F2F3F4",padding:"12px 24px"},children:[(0,le.jsx)(b.A.Label,{className:ue,children:"Comments"}),(0,le.jsx)("div",{ref:R,children:(0,le.jsx)(Re,{taskId:Q,ref:$,usersMap:ne})})]})]}),(0,le.jsxs)("div",{className:fe,children:[(0,le.jsx)(ae,{taskId:Q,session:I,onCommentAdded:Pe,disabled:!Q,commentsScrollRef:R}),(0,le.jsxs)("div",{className:be,children:[(0,le.jsxs)(j.A,{disabled:!Q||$e.isPending,className:null!==S&&void 0!==S&&S.finished?"outline-in-complete-button":"outline-complete-button",onClick:De,children:[null!==S&&void 0!==S&&S.finished?"Completed":"Mark Complete",(0,le.jsx)(r.A,{size:16,color:"#079455"}),$e.isPending&&(0,le.jsx)(x.p,{style:{width:"16px",height:"16px"},strokeWidth:"3"})]}),(0,le.jsxs)("div",{className:ye,children:[(0,le.jsxs)("span",{className:je,children:["saving"===D&&"Saving...","saved"===D&&"Changes saved","idle"===D&&"Auto-save enabled"]}),(0,le.jsxs)(j.A,{className:"danger-text-button",onClick:Te,disabled:!Q,children:["Delete",Be.isPending&&(0,le.jsx)(x.p,{style:{width:"18px",height:"18px"}})]})]})]})]})]})}})}},63965:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(58387);const i={defaultStatus:"job-status_defaultStatus__emAxy",status:"job-status_status__HXyT-",DRAFT:"job-status_DRAFT__HqpDF",OPEN:"job-status_OPEN__yb7zB",ASSIGNED:"job-status_ASSIGNED__0WFAv",CONFIRMED:"job-status_CONFIRMED__iTcji",DECLINED:"job-status_DECLINED__2RC2+",SUBMITTED:"job-status_SUBMITTED__GFRLu",FINISHED:"job-status_FINISHED__RbfR-",IN_PROGRESS:"job-status_IN_PROGRESS__BoR97"};var o=s(70579);const l=e=>{let{status:t,actionStatus:s,published:l}=e;const a=function(e,t){if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return{label:"Draft",className:"DRAFT",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"};if("a"===e&&t)return{label:"In Progress",className:"IN_PROGRESS",color:"#3D5AFE",backColor:"#EEF1FF",borderColor:"#C3CCFF"};return{1:{label:"Open",className:"OPEN",color:"#065b76",backColor:"#ecf7fd",borderColor:"#a9d6ef"},2:{label:"Assigned",className:"ASSIGNED",color:"#520676",backColor:"#f6ecfd",borderColor:"#dda9ef"},3:{label:"Submitted",className:"SUBMITTED",color:"#344054",backColor:"#f9fafb",borderColor:"#eaecf0"},4:{label:"Finished",className:"FINISHED",color:"#29B27C",backColor:"#BBFFE4",borderColor:"#BBFFE4"},6:{label:"Declined",className:"DECLINED",color:"#b42318",backColor:"#fef3f2",borderColor:"#fecdca"},a:{label:"Confirmed",className:"CONFIRMED",color:"#067647",backColor:"#ecfdf3",borderColor:"#a9efc5"}}[e]||{label:e,className:"defaultStatus"}};return(0,o.jsx)("div",{className:(0,n.A)(i.status,i[a(t,s,l).className]),children:a(t,s,l).label})}},67046:(e,t,s)=>{s.d(t,{D7:()=>o,HT:()=>x,L:()=>p,Op:()=>c,Sg:()=>l,V3:()=>h,WG:()=>d,cS:()=>r,fW:()=>m,j3:()=>a,oe:()=>u});var n=s(31342);const i="https://app.memate.com.au/api/v1",o=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/sales/new-request/`);return(0,n.f)(s.toString(),t)},l=async(e,t)=>{const s={method:"POST",body:{managers:t}},o=new URL(`${i}${`/sales/managers/${e}/`}`);return(0,n.f)(o.toString(),s)},a=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const s={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${i}/sales/`,s);return await e.text()}catch(n){throw console.error("Profile fetch error:",n),n}},r=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const o={method:"PUT",headers:s,body:JSON.stringify({sales_note:t}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/notes/`,o);if(!t.ok){const e=await t.text();throw new Error(`Sales notes update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(l){throw console.error("Sales notes update error:",l),l}},d=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/won/`);return(0,n.f)(s.toString(),t)},c=async e=>{const t={method:"PUT",body:{ids:e}},s=new URL(`${i}/sales/status/lost/`);return(0,n.f)(s.toString(),t)},u=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const o={method:"POST",headers:s,body:JSON.stringify(t),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/contacts/`,o);return t.ok?t:(console.log("Error:",t.status),null)}catch(l){return console.log("Error:",l),null}},h=async(e,t)=>{const s=new Headers,n=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${n}`),s.append("Content-Type","application/json");const o={method:"PUT",headers:s,body:JSON.stringify({lead:t,unique_id:e}),redirect:"follow"};try{const t=await fetch(`${i}/sales/${e}/lead/`,o);if(!t.ok){const e=await t.text();throw new Error(`Sales lead update failed with status ${t.status}: ${e}`)}const s=await t.text();return s.trim()?JSON.parse(s):null}catch(l){throw console.error("Sales lead update error:",l),l}},m=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},o=await Promise.all([fetch(`${i}/sales/status/won/`,n)]);return await Promise.all(o.map((e=>e.json())))},p=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"POST",headers:t,redirect:"follow"},o=await fetch(`${i}/sales/${e}/duplicate/`,n);return(await o.json())[0]},x=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const n={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},o=await Promise.all([fetch(`${i}/sales/status/lost/`,n)]);return await Promise.all(o.map((e=>e.json())))}},68811:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(55973),i=s(70579);const o=e=>{let{show:t,setShow:s,project:o,reInitialize:l}=e;const a=o.value;return(0,i.jsx)(i.Fragment,{children:t&&(0,i.jsx)(n.A,{show:t,setShow:s,projectId:a,refetch:l})})}},70767:(e,t,s)=>{s.d(t,{A:()=>n});s(65043);const n=s.p+"static/media/addNoteModeIcon.43bdc8582f3ef769329a44f15a05fe67.svg"},72796:(e,t,s)=>{s.d(t,{_x:()=>l,dd:()=>i,mM:()=>o});const n="https://app.memate.com.au/api/v1",i=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"GET",headers:t};try{const t=new URL(`${n}/tasks/${e}/`),s=await fetch(t,i);return await s.json()}catch(o){throw console.error("Tasks fetch error:",o),o}},o=async e=>{const t=new Headers,s=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${s}`),t.append("Content-Type","application/json");const i={method:"DELETE",headers:t,redirect:"follow"};try{const t=new URL(`${n}/tasks/delete/${e}/`);if((await fetch(t,i)).ok)return{message:"Task deleted successfully"};throw new Error("Error during deleting")}catch(o){throw console.error("Tasks fetch error:",o),o}},l=async(e,t)=>{const s=new Headers,i=localStorage.getItem("access_token");s.append("Authorization",`Bearer ${i}`),s.append("Content-Type","application/json");const o={method:"PATCH",headers:s,body:JSON.stringify({finished:t}),redirect:"follow"};try{const t=new URL(`${n}/tasks/complete/${e}/`),s=await fetch(t,o);return await s.json()}catch(l){throw console.error("Tasks fetch error:",l),l}}},73184:(e,t,s)=>{s.d(t,{A:()=>B});var n=s(65043),i=s(14282),o=s(44505),l=s(56741),a=s(55850),r=s(84062),d=s(69956),c=s(38161),u=s(94819),h=s(89488),m=s(35475),p=s(28261),x=s(47097),v=s(86213),g=s(21576),j=s(93740),f=s(74856),b=s(32952),y=s(56328),w=s(11520);const C=s.p+"static/media/folderFileIcon.ea8d1ab0e5f9d712876b6e6f3e9f303d.svg";var A=s(95753),N=s(99678),_=s(70579);const S=e=>{var t,s;let{file:n}=e;const i=null===n||void 0===n||null===(t=n.key)||void 0===t||null===(s=t.split(".").pop())||void 0===s?void 0:s.toLowerCase(),o=(e=>["jpg","jpeg","png","gif","svg","bmp","webp","heic"].includes(null===e||void 0===e?void 0:e.toLowerCase()))(i);return o?(0,_.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",overflow:"hidden",flexShrink:0,background:"#E5E7EB"},children:(0,_.jsx)("img",{src:n.url,alt:n.key,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML='<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;"><svg width="24" height="24" viewBox="0 0 24 24" fill="#9CA3AF"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></div>'}})}):(0,_.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,_.jsx)(N.L,{extension:i,size:28})})},F=()=>(0,_.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,_.jsx)(o.A,{size:28,color:"#FFA500"})}),k=e=>{if(!e)return[];if(Array.isArray(e))return e;const t=[];return Array.isArray(e.project)&&t.push(...e.project),e.jobs&&"object"===typeof e.jobs&&Object.entries(e.jobs).forEach((e=>{let[s,n]=e;Array.isArray(n)&&t.push(...n.map((e=>({...e,jobId:s}))))})),t},E=e=>{let{file:t,onClose:s,triggerRef:i}=e;const[o,r]=(0,n.useState)(!1),d=(0,n.useRef)(null),c=t.url,[u,h]=(0,n.useState)(null);if((0,n.useEffect)((()=>{if(null!==i&&void 0!==i&&i.current){const e=i.current.getBoundingClientRect(),t=415,s=280;let n=e.right-t;n<10&&(n=10);let o=e.bottom+8;o+s>window.innerHeight-10&&(o=e.top-s-8),o<10&&(o=10),h({top:o,left:n})}}),[i]),(0,n.useEffect)((()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&s()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[s]),!u)return null;const m=[{name:"WhatsApp",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#25D366"}),(0,_.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z",fill:"white"})]}),onClick:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`Check out this file: ${t.name}\n${c}`)}`,"_blank"),s()}},{name:"Facebook",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#1877F2"}),(0,_.jsx)("path",{d:"M16.671 15.469l.547-3.469h-3.343V9.531c0-.969.475-1.906 1.984-1.906h1.532V4.656s-1.39-.234-2.719-.234c-2.773 0-4.578 1.657-4.578 4.656V12H6.921v3.469h3.173V24h3.906v-8.531h2.671z",fill:"white"})]}),onClick:()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(c)}`,"_blank","width=600,height=400"),s()}},{name:"X",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#000000"}),(0,_.jsx)("path",{d:"M13.544 10.456L17.89 5.5h-1.03l-3.773 4.305L10.16 5.5H6.5l4.56 6.513L6.5 17.5h1.03l3.987-4.55 3.184 4.55H18l-4.456-7.044zm-1.41 1.608l-.462-.649L8.04 6.28h1.585l2.97 4.17.462.649 3.862 5.423h-1.585l-3.2-4.458z",fill:"white"})]}),onClick:()=>{window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(`Check out this file: ${t.name}`)}&url=${encodeURIComponent(c)}`,"_blank","width=600,height=400"),s()}},{name:"Email",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#9CA3AF"}),(0,_.jsx)("path",{d:"M6 8.5C6 7.67157 6.67157 7 7.5 7H16.5C17.3284 7 18 7.67157 18 8.5V15.5C18 16.3284 17.3284 17 16.5 17H7.5C6.67157 17 6 16.3284 6 15.5V8.5Z",stroke:"white",strokeWidth:"1.5"}),(0,_.jsx)("path",{d:"M6.5 8L12 12L17.5 8",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round"})]}),onClick:()=>{const e=encodeURIComponent(`Shared File: ${t.name}`),n=encodeURIComponent(`Hi,\n\nI wanted to share this file with you:\n\n${t.name}\n\nYou can access it here:\n${c}\n\nBest regards`);window.location.href=`mailto:?subject=${e}&body=${n}`,s()}},{name:"LinkedIn",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#0A66C2"}),(0,_.jsx)("path",{d:"M8.5 10H6.5V17.5H8.5V10Z",fill:"white"}),(0,_.jsx)("path",{d:"M7.5 8.5C8.19036 8.5 8.75 7.94036 8.75 7.25C8.75 6.55964 8.19036 6 7.5 6C6.80964 6 6.25 6.55964 6.25 7.25C6.25 7.94036 6.80964 8.5 7.5 8.5Z",fill:"white"}),(0,_.jsx)("path",{d:"M13 10H10.5V17.5H13V13.5C13 12.5 13.5 11.5 14.75 11.5C16 11.5 16 12.75 16 13.5V17.5H18V13C18 10.5 16.5 10 15.25 10C14 10 13.25 10.75 13 11V10Z",fill:"white"})]}),onClick:()=>{window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(c)}`,"_blank","width=600,height=400"),s()}},{name:"Telegram",icon:(0,_.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#0088CC"}),(0,_.jsx)("path",{d:"M17.0708 7.25736L5.82893 11.7157C5.19282 11.9722 5.19617 12.3354 5.71355 12.4916L8.45534 13.3441L15.2726 8.87451C15.5898 8.67576 15.879 8.78168 15.6426 9.00033L10.0851 14.0632H10.0839L10.0851 14.0637L9.87243 16.8879C10.1449 16.8879 10.2654 16.7614 10.4166 16.6161L11.734 15.3391L14.5173 17.4133C15.0157 17.6918 15.3734 17.5497 15.4991 16.9561L17.4706 8.19979C17.6561 7.47058 17.1969 7.14026 17.0708 7.25736Z",fill:"white"})]}),onClick:()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(c)}&text=${encodeURIComponent(`Check out this file: ${t.name}`)}`,"_blank"),s()}}];return(0,_.jsxs)("div",{ref:d,onClick:e=>e.stopPropagation(),style:{position:"fixed",top:`${u.top}px`,left:`${u.left}px`,background:"#FFFFFF",borderRadius:"12px",boxShadow:"0px 12px 24px -4px rgba(16, 24, 40, 0.18), 0px 8px 16px -4px rgba(16, 24, 40, 0.08)",border:"1px solid #EAECF0",padding:"16px",width:"415px",zIndex:9999},children:[(0,_.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,_.jsx)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#101828"},children:"Share"}),(0,_.jsx)("div",{onClick:s,style:{cursor:"pointer",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,_.jsx)(l.A,{size:20,color:"#667085"})})]}),(0,_.jsx)("div",{className:"d-flex justify-content-start gap-3 mb-4",style:{overflowX:"auto",paddingBottom:"4px"},children:m.map((e=>(0,_.jsxs)("div",{onClick:e.onClick,className:"d-flex flex-column align-items-center gap-2",style:{cursor:"pointer",minWidth:"48px"},children:[(0,_.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.1)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:e.icon}),(0,_.jsx)("span",{style:{fontSize:"11px",color:"#667085",textAlign:"center"},children:e.name})]},e.name)))}),(0,_.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{background:"#F9FAFB",borderRadius:"8px",border:"1px solid #E5E7EB",padding:"8px 12px"},children:[(0,_.jsx)("input",{type:"text",value:c,readOnly:!0,style:{flex:1,border:"none",background:"transparent",fontSize:"13px",color:"#667085",outline:"none",overflow:"hidden",textOverflow:"ellipsis"}}),(0,_.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(c),r(!0),y.oR.success("Link copied to clipboard!"),setTimeout((()=>{r(!1)}),2e3)}catch(e){const t=document.createElement("textarea");t.value=c,document.body.appendChild(t),t.select(),document.execCommand&&document.execCommand("copy"),document.body.removeChild(t),r(!0),y.oR.success("Link copied to clipboard!"),setTimeout((()=>{r(!1)}),2e3)}},style:{padding:"8px 16px",background:o?"#17B26A":"#158ECC",border:"none",borderRadius:"20px",color:"#FFFFFF",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"4px"},children:o?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.A,{size:14}),"Copied"]}):"Copy"})]})]})},L=e=>{let{item:t,isShareOpen:s,onToggle:i,onClose:o}=e;const l=(0,n.useRef)(null);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{ref:l,className:"d-flex align-items-center justify-content-center",onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},title:"Share",style:{background:s?"#EBF8FF":"#F0F9FF",borderRadius:"50%",width:"28px",height:"28px",flexShrink:0,cursor:"pointer",transition:"all 0.2s ease",border:s?"1px solid #158ECC":"1px solid transparent"},onMouseEnter:e=>{s||(e.currentTarget.style.background="#E0F2FE")},onMouseLeave:e=>{s||(e.currentTarget.style.background="#F0F9FF")},children:(0,_.jsx)(r.A,{size:14,color:"#158ECC"})}),s&&(0,_.jsx)(E,{file:t,onClose:o,triggerRef:l})]})},B=e=>{var t;let{projectId:s}=e;const[o,a]=(0,n.useState)([]),[r,N]=(0,n.useState)(!1),[E,B]=(0,n.useState)(!1),[$,R]=(0,n.useState)(!1),[I,D]=(0,n.useState)(""),[T,P]=(0,n.useState)(!1),[M,H]=(0,n.useState)(""),[z,U]=(0,n.useState)([]),[O,V]=(0,n.useState)(null),q=(0,n.useRef)(null),W=localStorage.getItem("access_token"),Z=()=>{P(!1),U([]),H(""),B(!1),D(""),a([]),V(null)},G=(0,p.I)({queryKey:["id",s],queryFn:()=>(0,w.pV)(s),enabled:!!s,retry:1,staleTime:0,cacheTime:0}),K=async(e,t,s)=>v.A.put(t,e,{headers:{"Content-Type":""},onUploadProgress:e=>{const t=Math.round(e.loaded/e.total*100);a((e=>e.map((e=>e.id===s?{...e,progress:t}:e))))}}).catch((e=>{throw console.log("err: ",e),a((e=>e.map((e=>e.id===s?{...e,progress:0,error:!0}:e)))),e})),Y=async e=>{if(!e.trim())return y.oR.error("Folder name cannot be empty."),B(!1),void D("");if(!W)return y.oR.error("Access token is missing. Please log in again."),void B(!1);const t=`${z.join("/")+(z.length?"/":"")}${e}/`;try{R(!0);const n=await v.A.post(`https://app.memate.com.au/api/v1/projects/file/${s}/`,{file_name:t},{headers:{Authorization:`Bearer ${W}`}}),{url:i}=n.data;if(!i)throw new Error("No URL received");await v.A.put(i,new Blob,{headers:{"Content-Type":""}}),y.oR.success(`Successfully created folder ${e}`),null===G||void 0===G||G.refetch()}catch(n){console.error("Error creating folder:",n),y.oR.error(`Failed to create folder ${e}. Please try again.`)}finally{B(!1),D(""),R(!1)}},{getRootProps:J,getInputProps:Q}=(0,h.VB)({multiple:!0,accept:{"application/pdf":[".pdf"],"image/*":[".png",".jpg",".jpeg"],"video/mp4":[".mp4"]},maxSize:26214400,onDrop:e=>{(async e=>{if(!e.length)return;if(!W)return y.oR.error("Access token is missing. Please log in again.");const t=z.join("/")+(z.length?"/":""),n=e.map(((e,t)=>({id:Date.now()+t,name:e.name,progress:0,error:!1,type:"uploading_file"})));a((e=>[...n,...e]));for(const[o,l]of e.entries()){const e=n[o].id,r=Date.now(),d=l.name.split("."),c=d.pop(),u=`${t}${d.join(".")}-${r}.${c}`;try{const t=await v.A.post(`https://app.memate.com.au/api/v1/projects/file/${s}/`,{file_name:u},{headers:{Authorization:`Bearer ${W}`}}),{url:n}=t.data;if(!n)throw new Error("No URL received");let i=n.split("?")[0];await K(l,i,e),y.oR.success(`Successfully uploaded ${l.name}`),null===G||void 0===G||G.refetch()}catch(i){console.error("Error uploading file:",l.name,i),y.oR.error(`Failed to upload ${l.name}. Please try again.`),a((t=>t.map((t=>t.id===e?{...t,error:!0}:t))));continue}finally{a((t=>t.filter((t=>t.id!==e))))}}})(e)}}),X=(0,x.n)({mutationFn:e=>(0,w.m2)(s,e),onSuccess:()=>{y.oR.success("File deleted successfully"),null===G||void 0===G||G.refetch()},onError:()=>{y.oR.error("Failed to delete file")}}),ee=(0,x.n)({mutationFn:async e=>{console.log("folderPrefix: ",e);const t=k(G.data),n=t.filter((t=>t.url.includes(e)));console.log("toDelete: ",n),await Promise.all(n.map((e=>{let t=null===e||void 0===e?void 0:e.url;if(!t)return;const n=new URL(t).pathname.replace(/^\/+/,"");(0,w.m2)(s,n)})));const i=e;t.some((e=>e.key===i))&&!n.some((e=>e.key===i))&&await(0,w.m2)(s,i)},onSuccess:()=>{y.oR.success("Folder deleted successfully"),null===G||void 0===G||G.refetch()},onError:e=>{console.error("Error deleting folder:",e),y.oR.error("Failed to delete folder")}}),te=()=>{B(!1),D("")},se=k(G.data),ne=((e,t)=>{const s=t.join("/")+(t.length?"/":""),n=new Map;for(const i of e)if(i.key.startsWith(s)){const e=i.key.slice(s.length);if(""===e)continue;const t=e.split("/"),o=t[0];t.length>1?n.has(o)||n.set(o,{type:"folder",name:o,...i}):n.set(o,{type:"file",name:o,...i})}return Array.from(n.values()).sort(((e,t)=>e.type===t.type?e.name.localeCompare(t.name):"folder"===e.type?-1:1))})(se,z);let ie=M?ne.filter((e=>e.name.toLowerCase().includes(M.toLowerCase()))):ne;return ie=[...o,...ie],E&&(ie=[{type:"new_folder"},...ie]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(i.A,{className:"filebut "+(null!==se&&void 0!==se&&se.length?"fileActive":""),onClick:()=>{P(!0)},children:["Files",(0,_.jsx)("img",{src:C,alt:"FolderFileIcon"})]}),(0,_.jsxs)(b.A,{show:T,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject taskModelProjectFiles",onHide:Z,animation:!1,children:[(0,_.jsxs)(b.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,_.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start py-2",children:(0,_.jsx)("span",{children:"Integrated File System"})}),(0,_.jsx)("button",{className:"CustonCloseModal",onClick:Z,children:(0,_.jsx)(l.A,{size:24,color:"#667085"})})]}),(0,_.jsxs)(b.A.Body,{children:[(0,_.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,_.jsx)("nav",{"aria-label":"breadcrumb",children:(0,_.jsx)("ol",{className:"breadcrumb",style:{fontSize:"14px",marginBottom:"0"},children:["Files",...z].map(((e,t,s)=>(0,_.jsx)("li",{className:"breadcrumb-item "+(t===s.length-1?"active":""),children:(0,_.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),U(z.slice(0,t))},className:"font-14",style:{color:t===s.length-1?"#344054":"#106B99",textDecoration:"none"},children:e})},t)))})}),(0,_.jsxs)("div",{className:"d-flex gap-2 justify-content-end align-items-center",children:[(0,_.jsx)(i.A,{className:"solid-button font-14 d-flex align-items-center",onClick:()=>N(!r),children:"Upload Files"}),(0,_.jsx)(i.A,{className:"outline-button font-14 d-flex align-items-center",onClick:()=>{B(!0),D(""),setTimeout((()=>{q.current&&q.current.focus()}),0)},children:"New Folder"}),(0,_.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,_.jsx)("div",{style:{position:"absolute",top:"3px",left:"8px"},children:(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",children:(0,_.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,_.jsx)("input",{type:"text",placeholder:"Search",value:M,onChange:e=>H(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]})]})]}),r&&(0,_.jsxs)("div",{...J({className:"dropzone d-flex justify-content-center align-items-center flex-column cursor-pointer mb-4"}),style:{width:"100%",height:"100px",background:"#F9FAFB",borderRadius:"8px",border:"2px dashed #D0D5DD",padding:"20px"},children:[(0,_.jsx)("input",{...Q()}),(0,_.jsx)(d.A,{size:24,color:"#106B99"}),(0,_.jsxs)("p",{className:"mb-0 mt-2",style:{color:"#475467",fontSize:"14px",textAlign:"center"},children:[(0,_.jsx)("span",{style:{color:"#106B99",fontWeight:"600"},children:"Click to upload"})," or drag and drop files here",(0,_.jsx)("br",{}),(0,_.jsx)("small",{children:"(PDF, PNG, JPG, JPEG, MP4 - Max 25MB)"})]})]}),(0,_.jsx)("div",{style:{height:"300px",overflow:"auto",paddingRight:"4px"},children:(0,_.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[!(null!==G&&void 0!==G&&G.isPending)&&(null===(t=ie)||void 0===t?void 0:t.map(((e,t)=>{if("new_folder"===e.type)return(0,_.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px"},className:"d-flex align-items-center gap-2",children:[(0,_.jsx)(F,{}),(0,_.jsx)("input",{ref:q,type:"text",value:I,onChange:e=>D(e.target.value),onKeyDown:e=>{"Enter"===e.key?Y(I):"Escape"===e.key&&te()},style:{flex:1,border:"none",background:"transparent",fontSize:"13px",fontWeight:"500",color:"#344054"},placeholder:"Folder name"}),(0,_.jsxs)("div",{className:"d-flex gap-1",children:[(0,_.jsx)("div",{onClick:()=>Y(I),style:{cursor:"pointer",color:"#106B99"},title:"Save",children:$?(0,_.jsx)(j.p,{style:{width:"14px",height:"14px"}}):(0,_.jsx)(c.A,{size:20})}),(0,_.jsx)("div",{onClick:te,style:{cursor:"pointer",color:"#F04438"},title:"Cancel",children:(0,_.jsx)(l.A,{size:20})})]})]},"new_folder");if("uploading_file"===e.type)return(0,_.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px"},className:"d-flex align-items-center justify-content-between gap-2",children:[(0,_.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{flex:1,minWidth:0},children:[(0,_.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"6px",background:"#F9FAFB",border:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,_.jsx)(d.A,{size:28,color:"#106B99"})}),(0,_.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,_.jsx)("div",{title:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:e.name}),e.error?(0,_.jsx)("small",{style:{color:"#F04438",fontSize:"12px"},children:"Upload failed"}):(0,_.jsx)(g.z,{value:e.progress,style:{height:"6px"},showValue:!1})]})]}),e.error&&(0,_.jsx)("div",{onClick:()=>a((t=>t.filter((t=>t.id!==e.id)))),style:{cursor:"pointer",color:"#F04438"},title:"Remove",children:(0,_.jsx)(u.A,{size:14})})]},e.id);const s=(null===X||void 0===X?void 0:X.isPending)&&e.url.includes(null===X||void 0===X?void 0:X.variables),n=O===e.key;return(0,_.jsxs)("div",{style:{background:"#F9FAFB",padding:"10px",borderRadius:"8px",border:"1px solid #EAECF0",height:"fit-content",width:"calc(33.333% - 5.33px)",minWidth:"200px",position:"relative"},className:"d-flex align-items-center justify-content-between gap-2",children:["file"===e.type?(0,_.jsxs)(m.N_,{to:`${e.url}`,target:"_blank",className:"d-flex align-items-center gap-2",style:{flex:1,minWidth:0,textDecoration:"none"},children:[(0,_.jsx)(S,{file:e}),(0,_.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,_.jsx)("div",{title:null===e||void 0===e?void 0:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:null===e||void 0===e?void 0:e.name}),(0,_.jsx)("small",{style:{color:"#667085",fontSize:"12px"},children:(0,A.v)(null===e||void 0===e?void 0:e.size)})]})]}):(0,_.jsxs)("div",{className:"d-flex align-items-center gap-2 cursor-pointer",style:{flex:1,minWidth:0},onClick:()=>U([...z,e.name]),children:[(0,_.jsx)(F,{}),(0,_.jsxs)("div",{className:"d-flex flex-column",style:{flex:1,minWidth:0,fontSize:"13px"},children:[(0,_.jsx)("div",{title:null===e||void 0===e?void 0:e.name,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:"500",color:"#344054",marginBottom:"2px"},children:null===e||void 0===e?void 0:e.name}),(0,_.jsx)("small",{style:{color:"#667085",fontSize:"12px"},children:"Folder"})]})]}),(0,_.jsxs)("div",{className:"d-flex align-items-center gap-1",children:["file"===e.type&&(0,_.jsx)(L,{item:e,isShareOpen:n,onToggle:()=>V(n?null:e.key),onClose:()=>V(null)}),(0,_.jsx)("div",{className:"d-flex align-items-center justify-content-center",onClick:()=>"file"===e.type?(e=>{let t=null===e||void 0===e?void 0:e.url;if(t)try{const e=new URL(t).pathname.replace(/^\/+/,"");X.mutate(e)}catch(s){console.error("Invalid URL:",t),y.oR.error("Failed to delete file")}})(e):(async e=>{let t=null===e||void 0===e?void 0:e.url;if(t)try{const e=new URL(t).pathname.replace(/^\/+/,"");await ee.mutateAsync(e),null===G||void 0===G||G.refetch()}catch(s){console.error("Invalid URL:",t),y.oR.error("Failed to delete folder")}})(e),title:"Delete",style:{background:"#FEE4E2",borderRadius:"50%",width:"28px",height:"28px",flexShrink:0,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.background="#FEF3F2",onMouseLeave:e=>e.currentTarget.style.background="#FEE4E2",children:s?(0,_.jsx)(j.p,{style:{width:"14px",height:"14px"}}):(0,_.jsx)(u.A,{size:14,color:"#F04438"})})]})]},e.name||t)}))),(null===G||void 0===G?void 0:G.isPending)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"}),(0,_.jsx)(f.E,{width:"calc(33.333% - 5.33px)",height:68,borderRadius:"8px"})]}),!(null!==G&&void 0!==G&&G.isPending)&&0===ie.length&&(0,_.jsx)("div",{style:{width:"100%",textAlign:"center",color:"#667085",fontSize:"14px"},children:"No files found."})]})})]}),(0,_.jsx)("div",{className:"CustonCloseModalBottom",children:(0,_.jsx)("button",{className:"but",onClick:Z,children:"Close"})})]})]})}},79106:(e,t,s)=>{s.d(t,{Af:()=>a,Co:()=>m,Lb:()=>u,U9:()=>o,Zi:()=>h,aU:()=>d,gg:()=>l,gy:()=>c,lC:()=>r,qT:()=>p});var n=s(31342);const i="https://app.memate.com.au/api/v1",o=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6?arguments[6]:void 0;const d=(e-1)*t,c=new URL(`${i}/tasks/`);return c.searchParams.append("limit",t),c.searchParams.append("offset",d),s&&c.searchParams.append("search",s),o&&c.searchParams.append("ordering",o),l&&c.searchParams.append("deleted",1),!0===a&&c.searchParams.append("finished",!1),!1===a&&c.searchParams.append("finished",!0),r&&c.searchParams.append("users",r),(0,n.f)(c.toString(),{method:"GET"})},l=async e=>{const t=new URL(`${i}${`/tasks/${e}/`}`);return(0,n.f)(t.toString(),{method:"GET"})},a=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/tasks/new/`);return(0,n.f)(s.toString(),t)},r=async(e,t)=>{const s={method:"PUT",body:t},o=new URL(`${i}${`/tasks/update/${e}/`}`);return(0,n.f)(o.toString(),s)},d=async()=>{const e=new URL(`${i}/desktop-users/`);return(0,n.f)(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${i}/team/mobile-users/`);return(0,n.f)(e.toString(),{method:"GET"})},u=async e=>{const t=new URL(`${i}${`/tasks/${e}/comments/`}`);return(0,n.f)(t.toString(),{method:"GET"})},h=async(e,t)=>{const s=new URL(`${i}${`/tasks/${e}/comments/`}`);return(0,n.f)(s.toString(),{method:"POST",body:t})},m=async e=>{const t=new URL(`${i}${`/tasks/comments/${e}/`}`);return(0,n.f)(t.toString(),{method:"DELETE"})},p=async(e,t,s)=>{const o=new URL(`${i}/tasks/comments/presigned-url/`);return(0,n.f)(o.toString(),{method:"POST",body:{file_name:t,task_id:e,attachment_type:s}})}},81242:(e,t,s)=>{s.d(t,{A:()=>C});var n=s(65043),i=s(32952),o=s(61072),l=s(78602),a=s(14282),r=s(77918),d=s(28261),c=s(58387),u=s(75758),h=s(88060),m=s(8868),p=s(28676),x=s(74532),v=s(72052),g=s(18226),j=s(93740);const f={headerTitle:"send-email_headerTitle__50KUB",customLabel:"send-email_customLabel__r5xED",templateInfo:"send-email_templateInfo__mWkVT",bag:"send-email_bag__wtdwK",lable:"send-email_lable__+kNCa",dropdownSelect:"send-email_dropdownSelect__RY5w8",autoCompleteBox:"send-email_autoCompleteBox__fWZ7C",AutoComplete:"send-email_AutoComplete__m9YI5",bcc:"send-email_bcc__BwFzl",box:"send-email_box__Zlmer",active:"send-email_active__vEx4h",inputBox:"send-email_inputBox__NpU2b"};var b=s(81047),y=s(70579);const w=(0,y.jsxs)("span",{className:"ql-formats",children:[(0,y.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,y.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,y.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,y.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,y.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,y.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,y.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,y.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,y.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,y.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,y.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,y.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,y.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,y.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),C=e=>{var t,s,C,A;let{show:N,setShow:_,mutation:S,contactPersons:F,setPayload:k,defaultTemplateId:E,isAddingContact:L=!1}=e;const B=(0,n.useRef)(null),$=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[R,I]=(0,n.useState)(""),[D,T]=(0,n.useState)([]),[P,M]=(0,n.useState)([]),[H,z]=(0,n.useState)([]),[U,O]=(0,n.useState)(null),[V,q]=(0,n.useState)(null),[W,Z]=(0,n.useState)(null),[G,K]=(0,n.useState)({}),[Y,J]=(0,n.useState)([]),Q=(0,n.useRef)(null),X=(0,n.useRef)(null),ee=(0,n.useRef)(null),[te,se]=(0,n.useState)(!1),[ne,ie]=(0,n.useState)(!1),oe=(0,n.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),le=(0,n.useCallback)((e=>!e||0===e.length||e.every((e=>oe(e)))),[oe]),ae=(0,n.useCallback)((e=>e&&0!==e.length?e.filter((e=>!oe(e))):[]),[oe]),re=(0,n.useCallback)((e=>e&&0!==e.length?e.filter((e=>oe(e))):[]),[oe]),de=(0,n.useCallback)((()=>{let e=!1;if(D.length>0){const t=ae(D);t.length>0&&(console.log("Found invalid TO emails:",t),T(re(D)),e=!0)}if(P.length>0){const t=ae(P);t.length>0&&(console.log("Found invalid CC emails:",t),M(re(P)),e=!0)}if(H.length>0){const t=ae(H);t.length>0&&(console.log("Found invalid BCC emails:",t),z(re(H)),e=!0)}return!e}),[D,P,H,ae,re]),[ce,ue]=(0,n.useState)(null),he=()=>{_(!1),E||(I([]),T([]),M([]),z([]),O([]),q([]),ue(null))},me=(0,d.I)({queryKey:["emailTemplate"],queryFn:b.SQ,enabled:!!N}),pe=(0,d.I)({queryKey:["getSignatureTemplates"],queryFn:b.AO,enabled:!!N}),xe=(0,d.I)({queryKey:["getOutgoingEmail"],queryFn:b.hx,enabled:!!N}),ve=(0,d.I)({queryKey:["emailQuery",ce],queryFn:()=>(0,b.hS)(ce),enabled:!!ce,retry:1});(0,n.useEffect)((()=>{var e,t,s;null!==xe&&void 0!==xe&&xe.data&&(null!==xe&&void 0!==xe&&null!==(e=xe.data)&&void 0!==e&&e.outgoing_email&&null!==xe&&void 0!==xe&&null!==(t=xe.data)&&void 0!==t&&t.outgoing_email_verified?I(null===xe||void 0===xe||null===(s=xe.data)||void 0===s?void 0:s.outgoing_email):I("no-reply@memate.com.au"));if(!ce&&null!==me&&void 0!==me&&me.data&&E){var n;const e=null===me||void 0===me||null===(n=me.data)||void 0===n?void 0:n.find((e=>e.type===E));e&&ue(null===e||void 0===e?void 0:e.id)}}),[me,xe,E,ce]);const ge=e=>{var t,s;const n=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let i=null===(s=F.map((e=>e.email)))||void 0===s?void 0:s.filter((e=>e));i=i.filter((e=>!D.includes(e))),i=i.filter((e=>!P.includes(e))),i=i.filter((e=>!H.includes(e))),i=i.filter((e=>e.toLowerCase().includes(n))),J(i)},je=()=>{ge(),Q.current&&Q.current.show()},fe=()=>{ge(),X.current&&X.current.show()},be=()=>{ge(),ee.current&&ee.current.show()};return(0,n.useEffect)((()=>{if(null!==F&&void 0!==F&&F.length){var e;let t=null===(e=F.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));J(t)}}),[F]),(0,n.useEffect)((()=>{if(D.length>0){const e=ae(D);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const t=re(D);T(t)}}}),[D,ae,re]),(0,n.useEffect)((()=>{if(P.length>0){const e=ae(P);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const t=re(P);M(t)}}}),[P,ae,re]),(0,n.useEffect)((()=>{if(H.length>0){const e=ae(H);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const t=re(H);z(t)}}}),[H,ae,re]),(0,n.useEffect)((()=>{k((e=>({...e,subject:U,email_body:V,from_email:R,to:null===D||void 0===D?void 0:D.toString(),...P.length>0&&{cc:P.toString()},...H.length>0&&{bcc:H.toString()},...W&&{signature:W}})))}),[U,V,R,D,P,H,W,k]),(0,n.useEffect)((()=>{var e,t;null!==pe&&void 0!==pe&&pe.data&&Z(null===pe||void 0===pe||null===(e=pe.data)||void 0===e||null===(t=e.find((e=>e.id===$.email_signature)))||void 0===t?void 0:t.id)}),[null===pe||void 0===pe?void 0:pe.data,$.email_signature]),(0,n.useEffect)((()=>{var e,t;q((null===ve||void 0===ve||null===(e=ve.data)||void 0===e?void 0:e.body)||""),O(null===ve||void 0===ve||null===(t=ve.data)||void 0===t?void 0:t.subject),K((e=>({...e,subject:!1}))),K((e=>({...e,text:!1})))}),[null===ve||void 0===ve?void 0:ve.data]),(0,y.jsxs)(i.A,{show:N,centered:!0,onHide:he,className:"invoice-form",size:"lg",children:[(0,y.jsx)(i.A.Header,{closeButton:!0,children:(0,y.jsx)("div",{className:`${f.modalHeader}`,children:(0,y.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,y.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${f.headerTitle}`,children:"Send email"})})})}),(0,y.jsxs)(i.A.Body,{children:[(0,y.jsxs)(o.A,{children:[(0,y.jsxs)(l.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"FROM"}),(0,y.jsx)(h.m,{options:xe&&(null===xe||void 0===xe?void 0:xe.data)&&[{value:null===xe||void 0===xe||null===(t=xe.data)||void 0===t?void 0:t.outgoing_email,label:`${null===xe||void 0===xe||null===(s=xe.data)||void 0===s?void 0:s.outgoing_email}`}]||[],className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{I(e.value),K((e=>({...e,from:!1})))},value:R,filterInputAutoFocus:!0})]}),(null===G||void 0===G?void 0:G.from)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,y.jsx)(l.A,{sm:6,className:"mb-3",children:(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"Templates"}),(0,y.jsx)(h.m,{options:me&&(null===(C=me.data)||void 0===C?void 0:C.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{ue(e.value)},value:ce,loading:null===me||void 0===me?void 0:me.isFetching,filterInputAutoFocus:!0}),(0,y.jsx)("div",{className:f.templateInfo,onClick:e=>B.current.toggle(e),children:(0,y.jsx)(r.A,{size:16,color:"#737374ff"})}),(0,y.jsxs)(g.j,{ref:B,children:[(0,y.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,y.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,y.jsx)("br",{})," Profile Settings > Templates > Email",(0,y.jsx)("br",{})," Templates."]})]})]})})]}),(0,y.jsxs)(o.A,{children:[(0,y.jsxs)(l.A,{sm:12,className:"mb-3",children:[(0,y.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,y.jsxs)("div",{style:{position:"relative"},className:f.autoCompleteBox,children:[(0,y.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"TO"}),(0,y.jsx)(u.j,{ref:Q,value:D,completeMethod:ge,onChange:e=>{T(e.value),K((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:Y,onClick:je,onFocus:je,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>oe(e)));T((e=>[...new Set([...e,...n])])),n.length===s.length&&n.length>0&&K((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(oe(t)?(T((e=>[...new Set([...e,t])])),K((e=>({...e,to:!1,toInvalid:!1})))):K((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,y.jsx)(a.A,{className:(0,c.A)(f.box,{[f.active]:te}),onClick:()=>{se(!te),M([])},children:"CC"}),(0,y.jsx)(a.A,{className:(0,c.A)(f.box,{[f.active]:ne}),onClick:()=>{ie(!ne),z([])},children:"BCC"})]}),(null===G||void 0===G?void 0:G.to)&&!(null!==G&&void 0!==G&&G.toInvalid)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===G||void 0===G?void 0:G.toInvalid)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===G||void 0===G?void 0:G.invalidToEmails)&&G.invalidToEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",G.invalidToEmails.join(", ")]})]})]}),te&&(0,y.jsxs)(l.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"50px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"CC"}),(0,y.jsx)(u.j,{ref:X,value:P,completeMethod:ge,onChange:e=>{M(e.value),K((e=>({...e,cc:!1})))},multiple:!0,suggestions:Y,onClick:fe,onFocus:fe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>oe(e)));M((e=>[...new Set([...e,...n])])),n.length===s.length&&K((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(oe(t)?(M((e=>[...new Set([...e,t])])),K((e=>({...e,cc:!1})))):K((e=>({...e,cc:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===G||void 0===G?void 0:G.cc)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===G||void 0===G?void 0:G.invalidCcEmails)&&G.invalidCcEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",G.invalidCcEmails.join(", ")]})]})]}),ne&&(0,y.jsxs)(l.A,{sm:6,className:"mb-3",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"BCC"}),(0,y.jsx)(u.j,{ref:ee,value:H,completeMethod:ge,onChange:e=>{z(e.value),K((e=>({...e,bcc:!1})))},multiple:!0,suggestions:Y,onClick:be,onFocus:be,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const s=t.split(/[\s,]+/).filter((e=>e)),n=s.filter((e=>oe(e)));z((e=>[...new Set([...e,...n])])),n.length===s.length&&K((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(oe(t)?(z((e=>[...new Set([...e,t])])),K((e=>({...e,bcc:!1})))):K((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,c.A)(f.AutoComplete,f.bcc,"w-100"),placeholder:"BCC"})]}),(null===G||void 0===G?void 0:G.bcc)&&(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===G||void 0===G?void 0:G.invalidBccEmails)&&G.invalidBccEmails.length>0&&(0,y.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",G.invalidBccEmails.join(", ")]})]})]}),(0,y.jsxs)(l.A,{sm:12,className:"mb-2",children:[(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("div",{style:{width:"60px"},className:f.bag}),(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"SUBJECT"}),(0,y.jsxs)(p.C,{children:[(0,y.jsx)(x.m,{children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,y.jsx)(v.S,{value:U,className:(0,c.A)(f.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{O(e.target.value),K((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===G||void 0===G?void 0:G.subject)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,y.jsxs)(l.A,{sm:12,className:"mb-3",children:[(0,y.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.lable),children:"Message"}),(0,y.jsx)(x.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ve||void 0===ve?void 0:ve.isFetching)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,y.jsx)(m.K,{style:{minHeight:"150px"},headerTemplate:w,value:V,placeholder:"Enter a description...",onTextChange:e=>{q(e.htmlValue),K((e=>({...e,text:!1})))}})]}),(null===G||void 0===G?void 0:G.text)&&(0,y.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,y.jsx)(l.A,{sm:12,children:(0,y.jsxs)("div",{style:{position:"relative"},children:[(0,y.jsx)("label",{className:(0,c.A)(f.customLabel),children:"Signature"}),(0,y.jsx)(h.m,{options:pe&&(null===(A=pe.data)||void 0===A?void 0:A.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,c.A)(f.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{Z(e.value)},value:W,loading:null===pe||void 0===pe?void 0:pe.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,y.jsxs)(i.A.Footer,{className:"d-flex justify-content-between",children:[(0,y.jsx)("span",{}),(0,y.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,y.jsxs)(a.A,{className:"outline-button",onClick:he,children:["Cancel"," "]}),(0,y.jsxs)(a.A,{disabled:null===S||void 0===S?void 0:S.isPending,className:"solid-button",onClick:async()=>{let e=0;K({});if(de()||console.log("Some emails were invalid and have been cleaned"),R||(++e,K((e=>({...e,from:!0})))),0===(null===D||void 0===D?void 0:D.length))++e,K((e=>({...e,to:!0})));else if(!le(D)){++e;const t=ae(D);console.log("Invalid TO emails:",t),K((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:t})))}if(P.length>0&&!le(P)){++e;const t=ae(P);console.log("Invalid CC emails:",t),K((e=>({...e,cc:!0,invalidCcEmails:t})))}if(H.length>0&&!le(H)){++e;const t=ae(H);console.log("Invalid BCC emails:",t),K((e=>({...e,bcc:!0,invalidBccEmails:t})))}U||(++e,K((e=>({...e,subject:!0})))),V||(++e,K((e=>({...e,text:!0})))),e||S.mutate({subject:U,email_body:V,from_email:R,to:null===D||void 0===D?void 0:D.toString(),...P.length>0&&{cc:P.toString()},...H.length>0&&{bcc:H.toString()},...W&&{signature:W}})},children:["Send"," ",((null===S||void 0===S?void 0:S.isPending)||L)&&(0,y.jsx)(j.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})}},83738:(e,t,s)=>{s.d(t,{s:()=>d});var n=s(65043),i=s(58387),o=s(670),l=s(68767),a=s(32370),r=s(70579);const d=e=>{let{onDataApply:t,dateRange:s,onClose:d,className:c=""}=e;const[u,h]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(null!==s&&void 0!==s&&s.startDate&&null!==s&&void 0!==s&&s.endDate){const e=s.startDate instanceof Date?s.startDate:new Date(s.startDate),t=s.endDate instanceof Date?s.endDate:new Date(s.endDate);h([e,t])}}),[s]);const m=(0,n.useCallback)((()=>{u&&2===u.length&&u[0]&&u[1]?t({startDate:u[0],endDate:u[1]}):u&&1===u.length&&u[0]&&t({startDate:u[0],endDate:u[0]})}),[u,t]),p=(0,n.useCallback)((()=>{h(null),d&&d()}),[d]),x=(0,n.useCallback)((()=>{const e=new Date;e.setHours(0,0,0,0),h([e,e])}),[]),v=(0,n.useCallback)((()=>{const e=u&&u.length>=1&&u[0];return(0,r.jsxs)("div",{className:"date-range-footer",children:[(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-today",onClick:x,children:"Today"}),(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-cancel",onClick:p,children:"Cancel"}),(0,r.jsx)("button",{type:"button",className:"date-range-footer-btn date-range-footer-btn-apply",onClick:m,disabled:!e,children:"Apply"})]})}),[u,x,p,m]),g=(0,n.useCallback)((()=>{var e,t;if(!u||0===u.length)return"Select date range";const s={month:"short",day:"numeric",year:"numeric"},n=(null===(e=u[0])||void 0===e?void 0:e.toLocaleDateString("en-US",s))||"",i=(null===(t=u[1])||void 0===t?void 0:t.toLocaleDateString("en-US",s))||"";return n&&i?`${n} - ${i}`:n?`${n} - Select end date`:"Select date range"}),[u]);return(0,r.jsxs)("div",{className:(0,i.A)("date-range-picker-calendar",c),children:[(0,r.jsx)("div",{className:"date-range-header",children:(0,r.jsx)("span",{className:"date-range-header-text",children:g()})}),(0,r.jsx)(o.V,{value:u,onChange:e=>h(e.value),selectionMode:"range",inline:!0,numberOfMonths:1,locale:"en",dateFormat:"dd M yy",footerTemplate:v,firstDayOfWeek:1,showButtonBar:!1,prevIcon:(0,r.jsx)(l.Y,{}),nextIcon:(0,r.jsx)(a.v,{})})]})}},88780:(e,t,s)=>{s.d(t,{EG:()=>h,KQ:()=>p,M4:()=>u,Nz:()=>d,RA:()=>l,Yn:()=>j,ZR:()=>r,ZW:()=>g,cd:()=>f,cx:()=>a,o5:()=>c,oI:()=>v,qU:()=>x,sp:()=>m,uu:()=>b,x2:()=>o});var n=s(31342);const i="https://app.memate.com.au/api/v1",o=async()=>{const e=new URL(`${i}/settings/integrations/stripe/`);return(0,n.f)(e.toString(),{method:"GET"})},l=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/integrations/stripe/`);return(0,n.f)(s.toString(),t)},a=async e=>{const t={method:"DELETE",body:e},s=new URL(`${i}/settings/integrations/stripe/disconnect/`);return(0,n.f)(s.toString(),t)},r=async()=>{const e=new URL(`${i}/settings/integrations/google/review/`);return(0,n.f)(e.toString(),{method:"GET"})},d=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/integrations/google/review/`);return(0,n.f)(s.toString(),t)},c=async()=>{const e=new URL(`${i}/settings/integrations/twilio/`);return(0,n.f)(e.toString(),{method:"GET"})},u=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/integrations/twilio/`);return(0,n.f)(s.toString(),t)},h=async()=>{const e=new URL(`${i}/references/outgoing-email/`);return(0,n.f)(e.toString(),{method:"GET"})},m=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/references/outgoing-email/`);return(0,n.f)(s.toString(),t)},p=async()=>{const e=new URL(`${i}/xero/status/`);return(0,n.f)(e.toString(),{method:"GET"})},x=async()=>{const e=new URL(`${i}/xero/disconnect/`);return(0,n.f)(e.toString(),{method:"POST"})},v=async e=>{const t={method:"PUT",body:e},s=new URL(`${i}/settings/integrations/mailchimp/`);return(0,n.f)(s.toString(),t)},g=async()=>{const e=new URL(`${i}/settings/integrations/mailchimp/disconnect/`);return(0,n.f)(e.toString(),{method:"DELETE"})},j=async()=>{const e=new URL(`${i}/settings/integrations/mailchimp/get-lists/`);return(0,n.f)(e.toString(),{method:"GET"})},f=async e=>{const t={method:"POST",body:e},s=new URL(`${i}/settings/integrations/mailchimp/add-users/`);return(0,n.f)(s.toString(),t)},b=async(e,t)=>{const s={method:"POST",body:e},o=new URL(`${i}${`/settings/integrations/mailchimp/add-users/${t}/`}`);return(0,n.f)(o.toString(),s)}},91242:(e,t,s)=>{s.d(t,{A:()=>m});var n=s(65043),i=s(56741),o=s(47097),l=s(14282),a=s(78602),r=s(32952),d=s(61072),c=s(11520),u=s(70767),h=s(70579);const m=e=>{let{projectId:t,projectCardData:s}=e;const[m,p]=(0,n.useState)(!1),[x,v]=(0,n.useState)(""),[g,j]=(0,n.useState)({description:""}),f=2e3,b=()=>p(!1),y=(0,o.n)({mutationFn:e=>(0,c.o2)(t,e),onSuccess:()=>{b(),s(t)},onError:e=>{console.error("Error creating note:",e),j((t=>({...t,description:e.message||"Failed to save note. Please try again."})))}}),w=e=>e.trim()?e.length<3?"Note must be at least 3 characters long":e.length>f?"Note must not exceed 2000 characters":/^\s+$/.test(e)?"Note cannot contain only whitespace":"":"Note is required";return(0,n.useEffect)((()=>{m||(v(""),j({description:""}))}),[m]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"linkByttonStyle py-2 border-right",onClick:()=>p(!0),children:"Add Note"}),(0,h.jsxs)(r.A,{show:m,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"taskModelProject",onHide:b,animation:!1,size:"lg",children:[(0,h.jsxs)(r.A.Header,{className:"mb-0 pb-0 border-0",children:[(0,h.jsx)("div",{className:"modelHeader d-flex justify-content-between align-items-start",children:(0,h.jsxs)("span",{children:[(0,h.jsx)("img",{src:u.A,alt:"AddNoteModeIcon"}),"Add Note"]})}),(0,h.jsx)("button",{className:"CustonCloseModal",onClick:b,children:(0,h.jsx)(i.A,{size:24,color:"#667085"})})]}),(0,h.jsx)(r.A.Body,{children:(0,h.jsx)("div",{className:"ContactModel",children:(0,h.jsx)(d.A,{children:(0,h.jsx)(a.A,{children:(0,h.jsxs)("div",{className:"formgroup mb-2 mt-2",children:[(0,h.jsxs)("label",{htmlFor:"note-input",children:["Note ",(0,h.jsx)("span",{className:"required",children:"*"})]}),(0,h.jsx)("div",{className:"inputInfo "+(g.description?"error-border":""),children:(0,h.jsx)("textarea",{id:"note-input",type:"text",name:"note",value:x,placeholder:"Enter a message here...",onChange:e=>{const t=e.target.value;v(t);const s=w(t);j((e=>({...e,description:s})))},maxLength:f,rows:10,className:"w-100"})}),(0,h.jsx)("div",{className:"d-flex justify-content-between mt-1",children:(0,h.jsx)("small",{className:g.description?"error-message":"text-muted",children:g.description||`${x.length}/2000 characters`})})]})})})})}),(0,h.jsx)(r.A.Footer,{className:"pt-0",children:(0,h.jsxs)("div",{className:"popoverbottom w-100 border-0 mt-0 pt-0",children:[(0,h.jsx)(l.A,{variant:"outline-danger",onClick:b,disabled:y.isPending,children:"Cancel"}),(0,h.jsx)(l.A,{variant:"primary save",onClick:()=>{const e=w(x);e?j((t=>({...t,description:e}))):y.mutate({text:x.trim()})},disabled:y.isPending||!!g.description,children:y.isPending?"Saving...":"Save"})]})})]})]})}},95753:(e,t,s)=>{s.d(t,{A:()=>r,v:()=>a});var n=s(65043),i=s(22927),o=s(43984),l=s(70579);function a(e){return e>=1048576?(e/1048576).toFixed(1)+" MB":e>=1024?(e/1024).toFixed(1)+" KB":e+" B"}const r=e=>{let{onFileChange:t,styles:s}=e;const[a,r]=(0,n.useState)(!1),d=(0,n.useRef)(),c=(0,n.useRef)(),u=e=>{const t=d.current,s=c.current;if(!t||!s)return;const n=t.contains(e.target),i=s.contains(e.target);n||i||r(!1)};return n.useEffect((()=>(document.addEventListener("click",u),()=>{document.removeEventListener("click",u)})),[]),(0,l.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,l.jsx)("button",{className:s.attachButton,type:"button","aria-label":"Attach file",ref:d,onClick:()=>r((e=>!e)),style:{padding:"6px 6px 6px 8px"},children:(0,l.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M18.0833 8.33333L9.16667 17.25C8.17221 18.2444 6.82407 18.8042 5.41667 18.8042C4.00926 18.8042 2.66112 18.2444 1.66667 17.25C0.672214 16.2556 0.112446 14.9074 0.112446 13.5C0.112446 12.0926 0.672214 10.7444 1.66667 9.75L10.5833 0.833329C11.2486 0.167998 12.1514 -0.149151 13.0833 0.0666624C14.0153 0.282476 14.8056 0.947998 15.25 1.83333C15.6944 2.71866 15.7361 3.75 15.3333 4.66666C14.9306 5.58333 14.1389 6.29166 13.1667 6.5L5.08333 14.5833C4.75 14.9167 4.31944 15.0833 3.83333 15.0833C3.34722 15.0833 2.91667 14.9167 2.58333 14.5833C2.25 14.25 2.08333 13.8194 2.08333 13.3333C2.08333 12.8472 2.25 12.4167 2.58333 12.0833L9.16667 5.5",stroke:"#667085",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})})}),a&&(0,l.jsxs)("div",{ref:c,className:s.attachmentPopover,style:{position:"absolute",bottom:"40px",left:-200,zIndex:20,minWidth:220,background:"#fff",borderRadius:8,boxShadow:"0 4px 24px rgba(16,24,40,0.18)",padding:10},children:[(0,l.jsxs)("label",{className:s.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,l.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{t(e),r(!1)},accept:".pdf, .doc, .docx, .txt"}),(0,l.jsx)(i.A,{size:16,color:"#667085"}),(0,l.jsx)("span",{className:"font-16",children:"Document"})]}),(0,l.jsxs)("label",{className:s.attachmentLabel,style:{display:"flex",alignItems:"center",cursor:"pointer",gap:8,padding:"10px 6px"},children:[(0,l.jsx)("input",{type:"file",style:{display:"none"},onChange:e=>{t(e),r(!1)},accept:"image/*"}),(0,l.jsx)(o.A,{size:16,color:"#667085"}),(0,l.jsx)("span",{className:"font-16",children:"Photo "})]})]})]})}},98889:(e,t,s)=>{e.exports=s.p+"static/media/mailchimp_icon.6f7a48d7f44dbd00950b.png"},99678:(e,t,s)=>{s.d(t,{L:()=>ee});var n=s(10737),i=s(36858),o=s(50917),l=s(35646),a=s(62645),r=s(50410),d=s(43808),c=s(26506),u=s(11062),h=s(53516),m=s(57927),p=s(80501),x=s(25004),v=s(64721),g=s(55251),j=s(25958),f=s(28987),b=s(86169),y=s(10213),w=s(65961),C=s(78909),A=s(988),N=s(71584),_=s(11733),S=s(98465),F=s(83700),k=s(46),E=s(85421),L=s(97530),B=s(14872),$=s(18917),R=s(60571),I=s(19188),D=s(52068),T=s(27726),P=s(86944),M=s(1427),H=s(94154),z=s(57160),U=s(93819),O=s(40261),V=s(17544),q=s(28494),W=s(81460),Z=s(43414),G=s(10095),K=s(7647),Y=s(91875),J=s(10696),Q=s(70579);const X={aac:{icon:n.A,color:"#4CAF50"},ai:{icon:i.A,color:"#FF9800"},bmp:{icon:o.A,color:"#00ADEF"},cs:{icon:l.A,color:"#239120"},css:{icon:a.A,color:"#1572B6"},csv:{icon:r.A,color:"#22A746"},doc:{icon:d.A,color:"#2368E1"},docx:{icon:c.A,color:"#2368E1"},exe:{icon:u.A,color:"#8E8E8E"},gif:{icon:h.A,color:"#F64A8A"},heic:{icon:m.A,color:"#FFAA00"},html:{icon:p.A,color:"#E34F26"},java:{icon:x.A,color:"#007396"},jpg:{icon:v.A,color:"#FFAA00"},jpeg:{icon:v.A,color:"#FFAA00"},js:{icon:g.A,color:"#F7DF1E"},json:{icon:j.A,color:"#22A746"},jsx:{icon:f.A,color:"#61DAFB"},key:{icon:b.A,color:"#FF9800"},m4p:{icon:y.A,color:"#4CAF50"},md:{icon:w.A,color:"#8E8E8E"},mdx:{icon:C.A,color:"#8E8E8E"},mov:{icon:A.A,color:"#9C27B0"},mp3:{icon:N.A,color:"#4CAF50"},mp4:{icon:_.A,color:"#9C27B0"},otf:{icon:S.A,color:"#795548"},pdf:{icon:F.A,color:"#FF0000"},php:{icon:k.A,color:"#777BB4"},png:{icon:E.A,color:"#00ADEF"},ppt:{icon:L.A,color:"#FF9800"},pptx:{icon:B.A,color:"#FF9800"},psd:{icon:$.A,color:"#31A8FF"},py:{icon:R.A,color:"#3776AB"},raw:{icon:I.A,color:"#FFAA00"},rb:{icon:D.A,color:"#CC342D"},sass:{icon:T.A,color:"#CF649A"},scss:{icon:P.A,color:"#CF649A"},sh:{icon:M.A,color:"#8E8E8E"},sql:{icon:H.A,color:"#336791"},svg:{icon:z.A,color:"#FF5722"},tiff:{icon:U.A,color:"#FFAA00"},tsx:{icon:O.A,color:"#3178C6"},ttf:{icon:V.A,color:"#795548"},txt:{icon:q.A,color:"#8E8E8E"},wav:{icon:W.A,color:"#795548"},woff:{icon:Z.A,color:"#795548"},xls:{icon:G.A,color:"#22A746"},xlsx:{icon:K.A,color:"#22A746"},xml:{icon:Y.A,color:"#E34F26"},yml:{icon:J.A,color:"#8E8E8E"},zip:{icon:u.A,color:"#FFD700"},rar:{icon:u.A,color:"#F44336"},tar:{icon:u.A,color:"#FFC107"},pub:{icon:d.A,color:"#4CAF50"},swf:{icon:u.A,color:"#FFEB3B"}},ee=e=>{let{extension:t,color:s,size:n}=e;const i=null===t||void 0===t?void 0:t.toLowerCase(),o=X[i];if(o){const e=o.icon,t=s||o.color;return(0,Q.jsx)(e,{color:t,size:n})}return(0,Q.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:s||"#888",xmlns:"http://www.w3.org/2000/svg",children:(0,Q.jsx)("path",{d:"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.5L9.5 0H4zm8 1.5V6H9V1h3z"})})}}}]);
//# sourceMappingURL=2543.7a7864c6.chunk.js.map