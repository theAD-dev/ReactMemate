"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[7358],{17358:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var l=s(65043),i=s(14282),n=s(75329),a=s(39759),o=s(49367),r=s(35475),d=s(54972),c=s(2028),u=s(22927),h=s(88166),m=s(47097),x=s(58387),p=s(72018),f=s(9642),j=s(64824),v=s(56328);const g={active:"task_active__XHjXL",selectedCount:"task_selectedCount__KCjbh",filterBox:"task_filterBox__Vl8TJ",newButton:"task_newButton__FgzVj",total:"task_total__iv2al",totalCount:"task_totalCount__g7jIX",shadowRight:"task_shadowRight__POYJ0",clientName:"task_clientName__bfmFM",complete:"task_complete__zEIDq",pending:"task_pending__4JfNO",projectImg:"task_projectImg__SdMAS",projectText:"task_projectText__2Lg5C",projectNumber:"task_projectNumber__bQcj7",linkToProjectCard:"task_linkToProjectCard__cP8ki",statusFilter:"task_statusFilter__Rk3rx"};var b=s(79106),_=s(72796),N=s(48417),y=s(58027),k=s(27734),C=s(99868),w=s(36042),S=s(70579);const A=e=>{const t=new Date(1e3*e);return`${t.getDate()} ${new Intl.DateTimeFormat("en-US",{month:"short"}).format(t)} ${t.getFullYear()}`},T=(0,l.forwardRef)(((e,t)=>{let{searchValue:s,setTotal:i,selected:n,setSelected:a,refetch:o,setRefetch:d,filter:c}=e;const{trialHeight:T}=(0,N.$)(),F=(0,l.useRef)(null),[$,D]=(0,l.useState)(!1),[R,z]=(0,l.useState)(null),[B,I]=(0,l.useState)(1),[V,L]=(0,l.useState)([]),[W,E]=(0,l.useState)({sortField:"id",sortOrder:-1}),[O,M]=(0,l.useState)({sortField:"id",sortOrder:-1}),[P,H]=(0,l.useState)(!0),[q,J]=(0,l.useState)(!1);(0,l.useEffect)((()=>{I(1)}),[s,o,c]),(0,l.useEffect)((()=>{(async()=>{J(!0);let e="";1===(null===O||void 0===O?void 0:O.sortOrder)?e=`${O.sortField}`:-1===(null===O||void 0===O?void 0:O.sortOrder)&&(e=`-${O.sortField}`);let t="not-complete"===c.status;"all"===c.status&&(t=null),"complete"===c.status&&(t=!1);const l=await(0,b.U9)(B,25,s,e,!1,t,null);var n;(i((()=>(null===l||void 0===l?void 0:l.count)||0)),1===B)?L(l.results):(null===l||void 0===l||null===(n=l.results)||void 0===n?void 0:n.length)>0&&L((e=>{const t=new Set(e.map((e=>e.id))),s=l.results.filter((e=>!t.has(e.id)));return[...e,...s]}));E(O),H(l.count!==V.length),J(!1)})()}),[B,s,O,o,c]),(0,l.useEffect)((()=>{if(V.length>0&&P){F.current=new IntersectionObserver((e=>{e[0].isIntersecting&&I((e=>e+1))}));const e=document.querySelector(".p-datatable-tbody tr:not(.p-datatable-emptymessage):last-child");e&&F.current.observe(e)}return()=>{F.current&&F.current.disconnect()}}),[V,P]);const U=(0,m.n)({mutationFn:e=>(0,_._x)(e.id,e.finished),onSuccess:()=>{d((e=>!e))},onError:e=>{console.error("Error updating task:",e)}});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(j.b,{ref:t,value:V,scrollable:!0,selectionMode:"checkbox",columnResizeMode:"expand",resizableColumns:!0,showGridlines:!0,size:"large",scrollHeight:`calc(100vh - 175px - ${T}px)`,className:"border",selection:n,onSelectionChange:e=>a(e.value),loading:q,loadingIcon:k.A,emptyMessage:(0,S.jsx)(C.A,{isDataExist:!!s}),sortField:null===W||void 0===W?void 0:W.sortField,sortOrder:null===W||void 0===W?void 0:W.sortOrder,onSort:e=>{const{sortField:t,sortOrder:s}=e;M({sortField:t,sortOrder:s}),I(1)},rowClassName:e=>{const t=[];return null!==e&&void 0!==e&&e.deleted&&t.push(g.deletedRow),null!==e&&void 0!==e&&e.id&&t.push(`row-id-${e.id}`),t.join(" ")},children:[(0,S.jsx)(f.V,{selectionMode:"multiple",headerClassName:"ps-4 border-end-0",bodyClassName:"show-on-hover border-end-0 ps-4",headerStyle:{width:"3rem",textAlign:"center"},frozen:!0}),(0,S.jsx)(f.V,{field:"number",header:"Task ID",body:e=>{let t=new Date(1e3*+e.to_date).getTime()<Date.now();return(0,S.jsxs)("div",{className:"d-flex align-items-center justify-content-center show-on-hover",children:[(0,S.jsxs)("div",{className:"d-flex flex-column",children:[e.number,(0,S.jsx)("span",{className:"font-12",style:{color:t&&!e.finished?"#F97066":"#98A2B3"},children:A(e.to_date)})]}),(0,S.jsx)(p.$,{label:"Open",onClick:()=>{z(null===e||void 0===e?void 0:e.id),D(!0)},className:"primary-text-button ms-3 show-on-hover-element",text:!0})]})},style:{minWidth:"100px"},frozen:!0,sortable:!0}),(0,S.jsx)(f.V,{field:"title",header:"Task Title",body:e=>(0,S.jsx)("div",{className:"ellipsis-width",style:{maxWidth:"300px"},children:e.title}),style:{minWidth:"150px"},bodyClassName:`${g.shadowRight}`,headerClassName:`${g.shadowRight}`,frozen:!0}),(0,S.jsx)(f.V,{field:"user.full_name",header:"Assigne",body:e=>{var t,s,l,i;if(null===e||void 0===e||!e.user)return(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:`d-flex justify-content-center align-items-center ${g.clientName}`,style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden",background:"#F2F4F7"},children:(0,S.jsx)("span",{style:{fontSize:"12px",color:"#667085"},children:"-"})}),(0,S.jsx)("span",{style:{color:"#98A2B3",fontStyle:"italic"},children:"Unassigned"})]});const n=`${e.user.full_name||""}`,a=`${(null===(t=e.user)||void 0===t?void 0:t.alias)||""}`;return(0,S.jsxs)("div",{className:"d-flex align-items-center",children:[(0,S.jsx)("div",{className:`d-flex justify-content-center align-items-center ${g.clientName}`,style:{width:"30px",height:"30px",borderRadius:"50%",overflow:"hidden"},children:null!==(s=e.user)&&void 0!==s&&s.has_photo?(0,S.jsx)(y.A,{has_photo:null===(l=e.user)||void 0===l?void 0:l.has_photo,photo:null===(i=e.user)||void 0===i?void 0:i.photo,is_business:!1}):a}),n]})},style:{minWidth:"208px"}}),(0,S.jsx)(f.V,{field:"finished",header:"Status",body:e=>(0,S.jsx)("div",{className:`${g.time} ${e.finished?g.complete:g.pending}`,children:e.finished?"Complete":"Not Complete"}),style:{minWidth:"120px",maxWidth:"120px",width:"120px"}}),(0,S.jsx)(f.V,{field:"project.reference",header:"Project",body:e=>{var t,s,l;return(0,S.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,S.jsx)("div",{className:(0,x.A)(g.projectImg,"d-flex align-items-center justify-content-center"),children:(0,S.jsx)(u.A,{color:"#475467",size:13})}),(0,S.jsxs)("div",{style:{lineHeight:"1.385"},children:[(0,S.jsx)("h1",{className:(0,x.A)(g.projectText,"mb-0"),children:null===e||void 0===e||null===(t=e.project)||void 0===t?void 0:t.reference}),(0,S.jsx)("span",{className:"font-12",style:{color:"#98A2B3"},children:(0,S.jsx)(r.N_,{className:`${g.linkToProjectCard}`,to:`/management?unique_id=${null===e||void 0===e||null===(s=e.project)||void 0===s?void 0:s.unique_id}`,children:null===e||void 0===e||null===(l=e.project)||void 0===l?void 0:l.number})})]})]})},style:{minWidth:"460px"}}),(0,S.jsx)(f.V,{field:"from_date",header:"Start Date",body:e=>A(e.from_date),style:{minWidth:"115px",maxWidth:"115px",width:"115px"},sortable:!0}),(0,S.jsx)(f.V,{field:"id",header:"Actions",body:e=>{var t,s;return e.finished?(0,S.jsxs)(p.$,{loading:U.isPending&&e.id===(null===(t=U.variables)||void 0===t?void 0:t.id),className:"outline-in-complete-button",style:{minWidth:"136px"},onClick:()=>(async e=>{await U.mutateAsync({id:e,finished:!1}),v.oR.success("Task marked as incomplete")})(e.id),children:["Completed ",(0,S.jsx)(h.A,{size:16,color:"#079455"})]}):(0,S.jsxs)(p.$,{loading:U.isPending&&e.id===(null===(s=U.variables)||void 0===s?void 0:s.id),className:"outline-complete-button",style:{minWidth:"136px"},onClick:()=>(async e=>{await U.mutateAsync({id:e,finished:!0}),v.oR.success("Task marked as complete")})(e.id),children:["Mark Complete ",(0,S.jsx)(h.A,{size:16,color:"#079455"})]})},style:{minWidth:"170px",maxWidth:"170px",width:"170px"}})]}),(0,S.jsx)(w.A,{view:$,setView:D,taskId:R,setTaskId:z,reInitialize:()=>d((e=>!e))})]})})),F=T;var $=s(55973);const D=()=>{const e=(0,l.useRef)(null),[t,s]=(0,r.ok)(),u=t.get("search"),h=t.get("targetId"),[m,x]=(0,l.useState)(0),[p,f]=(0,l.useState)(!1),[j,v,b]=(0,c.d7)("",400),[_,N]=(0,l.useState)([]),[y,k]=(0,l.useState)(!1),[C,w]=(0,l.useState)(!1),[A,T]=(0,l.useState)({status:"not-complete"}),[D,R]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{const e=e=>{!C||e.target.closest(`.${g.statusFilter}`)||e.target.closest(".p-button")||w(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[C]),(0,l.useEffect)((()=>{u&&h&&(b(u),R(!0),T({status:"all"}))}),[u,h,b]),(0,l.useEffect)((()=>{if(!D||!h||v!==u)return;const e=function(l){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return setTimeout((()=>{const l=document.querySelector(`.row-id-${h}`);if(l)(n=l).classList.add("highlight-row"),setTimeout((()=>{const e=n.closest(".p-datatable-wrapper");if(e){const t=n.offsetTop-e.clientHeight/2+n.clientHeight/2;e.scrollTo({top:t,behavior:"smooth"})}}),100),setTimeout((()=>{n.classList.remove("highlight-row"),R(!1);const e=new URLSearchParams(t);e.delete("search"),e.delete("targetId"),s(e,{replace:!0})}),6e3);else{if(!i){const t=e(1500,!0);return()=>clearTimeout(t)}R(!1),console.warn("Target row not found:",h)}var n}),l)},l=e(800);return()=>clearTimeout(l)}),[D,h,v,u,t,s]),(0,S.jsxs)("div",{className:"jobs-page",children:[(0,S.jsx)(o.mg,{children:(0,S.jsx)("title",{children:"MeMate - Tasks"})}),(0,S.jsxs)("div",{className:`topbar ${null!==_&&void 0!==_&&_.length?g.active:""}`,style:{padding:"4px 32px 4px 23px",position:"relative",height:"48px"},children:[(0,S.jsx)("div",{className:"left-side d-flex align-items-center",style:{gap:"16px"},children:null!==_&&void 0!==_&&_.length?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("h6",{className:g.selectedCount,children:["Selected: ",null===_||void 0===_?void 0:_.length]}),(0,S.jsx)("div",{className:"filtered-box",children:(0,S.jsx)("button",{className:`${g.filterBox}`,onClick:()=>{return t=!0,void(e.current?e.current.exportCSV({selectionOnly:t}):console.error("DataTable ref is null"));var t},children:(0,S.jsx)(n.A,{})})})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"filtered-box",children:(0,S.jsx)("button",{className:`${g.filterBox}`,onClick:()=>{},children:(0,S.jsx)(a.A,{size:20})})}),(0,S.jsxs)("div",{className:"searchBox",style:{position:"relative"},children:[(0,S.jsx)("div",{style:{position:"absolute",top:"2px",left:"6px"},children:(0,S.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:(0,S.jsx)("path",{d:"M14.6777 12.9299C15.6661 11.5841 16.25 9.92275 16.25 8.125C16.25 3.63769 12.6123 0 8.125 0C3.63769 0 0 3.63769 0 8.125C0 12.6123 3.63769 16.25 8.125 16.25C9.92323 16.25 11.585 15.6658 12.9309 14.6769L12.9299 14.6777C12.9667 14.7277 13.0078 14.7756 13.053 14.8208L17.8661 19.6339C18.3543 20.122 19.1457 20.122 19.6339 19.6339C20.122 19.1457 20.122 18.3543 19.6339 17.8661L14.8208 13.053C14.7756 13.0078 14.7277 12.9667 14.6777 12.9299ZM15 8.125C15 11.922 11.922 15 8.125 15C4.32804 15 1.25 11.922 1.25 8.125C1.25 4.32804 4.32804 1.25 8.125 1.25C11.922 1.25 15 4.32804 15 8.125Z",fill:"#98A2B3"})})}),(0,S.jsx)("input",{type:"text",placeholder:"Search",value:j,onChange:e=>b(e.target.value),className:"border search-resource",style:{borderRadius:"4px",width:"184px",border:"1px solid #D0D5DD",color:"#424242",paddingLeft:"36px",fontSize:"14px",height:"32px"}})]}),(0,S.jsxs)("div",{style:{position:"relative"},children:[(0,S.jsxs)(i.A,{className:"outline-button",style:{padding:"4px 8px",height:"32px",fontSize:"14px",color:"#667085",border:"1px solid #D0D5DD",backgroundColor:"#FFFFFF"},onClick:()=>w(!C),children:[(0,S.jsx)(a.A,{size:16,style:{marginRight:"0px"}}),(0,S.jsx)("span",{style:{color:"#667085",fontSize:"14px",fontWeight:"400"},children:"Status"})]}),C&&(0,S.jsxs)("div",{className:`${g.statusFilter}`,children:[(0,S.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,S.jsx)(d.S,{checked:"complete"===A.status,label:"complete",onClick:()=>T({status:"complete"})}),(0,S.jsx)("div",{onClick:()=>T({status:"complete"}),className:g.complete,style:{marginLeft:"16px"},children:"Complete"})]}),(0,S.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,S.jsx)(d.S,{checked:"not-complete"===A.status,label:"not-complete",onClick:()=>T({status:"not-complete"})}),(0,S.jsx)("div",{onClick:()=>T({status:"not-complete"}),className:`${g.pending} cursor-pointer`,style:{marginLeft:"16px"},children:"Not Complete"})]}),(0,S.jsxs)("div",{className:"d-flex align-items-center p-2 mb-2",children:[(0,S.jsx)(d.S,{checked:"all"===A.status,label:"all",onClick:()=>T({status:"all"})}),(0,S.jsx)("div",{onClick:()=>T({status:"all"}),className:`${g.pending} cursor-pointer`,style:{marginLeft:"16px"},children:"All"})]})]})]})]})}),(0,S.jsxs)("div",{className:"featureName d-flex align-items-center",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[(0,S.jsx)("h1",{className:"title p-0",style:{marginRight:"16px"},children:"Tasks"}),(0,S.jsx)(i.A,{onClick:()=>f(!0),className:`${g.newButton}`,children:"Create New Task "})]}),(0,S.jsxs)("div",{className:"right-side d-flex align-items-center",style:{gap:"8px"},children:[(0,S.jsx)("h1",{className:`${g.total} mb-0`,children:"Total"}),(0,S.jsxs)("div",{className:`${g.totalCount}`,children:[m," Jobs"]})]})]}),(0,S.jsx)(F,{ref:e,searchValue:v,setTotal:x,selected:_,setSelected:N,refetch:y,setRefetch:k,filter:A}),(0,S.jsx)($.A,{show:p,setShow:f,refetch:()=>k((e=>!e))})]})}},20793:(e,t,s)=>{e.exports=s.p+"static/media/NodataImg.ee3ccbdc6b7e66284e17.png"},99868:(e,t,s)=>{s.d(t,{A:()=>p});var l=s(65043),i=s(14282),n=s(38294),a=s(35475),o=s(58387);const r="no-data-found-template_noDataBox__HgeT1",d="no-data-found-template_title__P5uV2",c="no-data-found-template_subTitle__zMBB-",u="no-data-found-template_supportext__pHg2P";var h=s(20793),m=s(32808),x=s(70579);const p=e=>{let{isDataExist:t=!0}=e;const[s,p]=(0,l.useState)(!1);return(0,x.jsxs)("div",{className:(0,o.A)(r),children:[(0,x.jsx)("div",{className:"position-relative d-flex flex-column",children:(0,x.jsx)("img",{src:h,alt:"no-data"})}),t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h2",{className:(0,o.A)(d),children:"There is no results"}),(0,x.jsxs)("p",{className:(0,o.A)(c),children:["The user you are looking for doesn't exist. ",(0,x.jsx)("br",{}),"Here are some helpful links:"]}),(0,x.jsx)(a.N_,{to:"/",children:(0,x.jsxs)(i.A,{className:"outline-button",style:{marginBottom:"32px"},children:[" ",(0,x.jsx)(n.A,{})," Go back"]})}),(0,x.jsx)(a.N_,{onClick:()=>p(!0),to:"#",children:(0,x.jsx)("span",{className:(0,o.A)(u),children:"Support"})})]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("h2",{className:(0,o.A)(d),children:"No historical records yet."})}),(0,x.jsx)(m.A,{setVisible:p,visible:s})]})}}}]);
//# sourceMappingURL=7358.11fff996.chunk.js.map