"use strict";(self.webpackChunkmemateapp=self.webpackChunkmemateapp||[]).push([[9927],{59638:(e,t,l)=>{l.d(t,{EZ:()=>o,F1:()=>x,Fl:()=>m,OF:()=>r,QK:()=>v,Ql:()=>i,X6:()=>c,Ye:()=>g,ab:()=>b,i6:()=>u,kB:()=>j,nP:()=>d,o6:()=>p,oO:()=>n,oo:()=>h,zZ:()=>f});var a=l(31342);const s="https://app.memate.com.au/api/v1",n=async e=>{const t=new URL(`${s}${`/clients/restore/${e}/`}`);return(0,a.f)(t.toString(),{method:"POST"})},o=async e=>{const t=new URL(`${s}${`/clients/${e}/`}`);return(0,a.f)(t.toString(),{method:"GET"})},i=async()=>{const e=new URL(`${s}/references/clients/categories/`);return(0,a.f)(e.toString(),{method:"GET"})},r=async()=>{const e=new URL(`${s}/references/clients/industries/`);return(0,a.f)(e.toString(),{method:"GET"})},c=async()=>{const e=new URL(`${s}/references/countries/`),t=await(0,a.f)(e.toString(),{method:"GET"},!1),l=[1];return(null===t||void 0===t?void 0:t.filter((e=>l.includes(e.id))))||[]},d=async e=>{const t=new URL(`${s}${`/references/states/${e}/`}`);return(0,a.f)(t.toString(),{method:"GET"},!1)},u=async e=>{const t=new URL(`${s}${`/references/cities/${e}/`}`);return(0,a.f)(t.toString(),{method:"GET"},!1)},m=async()=>{const e=new URL(`${s}/references/desktop-users/`);return(0,a.f)(e.toString(),{method:"GET"})},h=async function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4?arguments[4]:void 0;const i=(e-1)*t,r=new URL(`${s}/clients/`);return r.searchParams.append("limit",t),r.searchParams.append("offset",i),l&&r.searchParams.append("search",l),n&&r.searchParams.append("ordering",n),o&&r.searchParams.append("deleted",1),(0,a.f)(r.toString(),{method:"GET"})},p=async function(e,t,l){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";const i=(t-1)*l,r=new URL(`${s}${`/clients/${e}/orders/`}`);return r.searchParams.append("limit",l),r.searchParams.append("offset",i),n&&r.searchParams.append("number",n),o&&r.searchParams.append("ordering",o),(0,a.f)(r.toString(),{method:"GET"})},v=async e=>{const t=new URL(`${s}${`/clients/address/${e}/main`}`);return(0,a.f)(t.toString(),{method:"PUT"})},g=async e=>{const t=new URL(`${s}${`/clients/contact-persons/${e}/main`}`);return(0,a.f)(t.toString(),{method:"PUT"})},f=async e=>{const t=new URL(`${s}${`/clients/delete/${e}/`}`);return(0,a.f)(t.toString(),{method:"DELETE"})},x=async e=>{const t=new URL(`${s}${`/clients/contact-persons/${e}/delete/`}`);return(0,a.f)(t.toString(),{method:"DELETE"})},b=async e=>{const t=new URL(`${s}${`/clients/address/${e}/delete/`}`);return(0,a.f)(t.toString(),{method:"DELETE"})},j=async e=>{const t={method:"PUT",body:{unique_id:e}},l=new URL(`${s}/projects/back/`);return(0,a.f)(l.toString(),t)}},67046:(e,t,l)=>{l.d(t,{CK:()=>h,D7:()=>n,HT:()=>p,Op:()=>c,V3:()=>u,WG:()=>r,cS:()=>i,fW:()=>m,j3:()=>o,oe:()=>d});var a=l(31342);const s="https://app.memate.com.au/api/v1",n=async e=>{const t={method:"POST",body:e},l=new URL(`${s}/sales/new-request/`);return(0,a.f)(l.toString(),t)},o=async()=>{const e=new Headers,t=localStorage.getItem("access_token");e.append("Authorization",`Bearer ${t}`);const l={method:"GET",headers:e,redirect:"follow"};try{const e=await fetch(`${s}/sales/`,l);return await e.text()}catch(a){throw console.error("Profile fetch error:",a),a}},i=async(e,t)=>{const l=new Headers,a=localStorage.getItem("access_token");l.append("Authorization",`Bearer ${a}`),l.append("Content-Type","application/json");const n={method:"PUT",headers:l,body:JSON.stringify({sales_note:t}),redirect:"follow"};try{const t=await fetch(`${s}/sales/${e}/notes/`,n);if(!t.ok){const e=await t.text();throw new Error(`Sales notes update failed with status ${t.status}: ${e}`)}const l=await t.text();return l.trim()?JSON.parse(l):null}catch(o){throw console.error("Sales notes update error:",o),o}},r=async e=>{const t={method:"PUT",body:{ids:e}},l=new URL(`${s}/sales/status/won/`);return(0,a.f)(l.toString(),t)},c=async e=>{const t={method:"PUT",body:{ids:e}},l=new URL(`${s}/sales/status/lost/`);return(0,a.f)(l.toString(),t)},d=async(e,t)=>{const l=new Headers,a=localStorage.getItem("access_token");l.append("Authorization",`Bearer ${a}`),l.append("Content-Type","application/json");const n={method:"POST",headers:l,body:JSON.stringify(t),redirect:"follow"};try{const t=await fetch(`${s}/sales/${e}/contacts/`,n);return t.ok?t:(console.log("Error:",t.status),null)}catch(o){return console.log("Error:",o),null}},u=async(e,t)=>{const l=new Headers,a=localStorage.getItem("access_token");l.append("Authorization",`Bearer ${a}`),l.append("Content-Type","application/json");const n={method:"PUT",headers:l,body:JSON.stringify({lead:t,unique_id:e}),redirect:"follow"};try{const t=await fetch(`${s}/sales/${e}/lead/`,n);if(!t.ok){const e=await t.text();throw new Error(`Sales lead update failed with status ${t.status}: ${e}`)}const l=await t.text();return l.trim()?JSON.parse(l):null}catch(o){throw console.error("Sales lead update error:",o),o}},m=async e=>{const t=new Headers,l=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${l}`),t.append("Content-Type","application/json");const a={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},n=await Promise.all([fetch(`${s}/sales/status/won/`,a)]);return await Promise.all(n.map((e=>e.json())))},h=async e=>{const t=new Headers,l=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${l}`),t.append("Content-Type","application/json");const a={method:"POST",headers:t,redirect:"follow"},n=await fetch(`${s}/sales/${e}/duplicate/`,a);return(await n.json())[0]},p=async e=>{const t=new Headers,l=localStorage.getItem("access_token");t.append("Authorization",`Bearer ${l}`),t.append("Content-Type","application/json");const a={method:"PUT",headers:t,body:JSON.stringify({ids:e}),redirect:"follow"},n=await Promise.all([fetch(`${s}/sales/status/lost/`,a)]);return await Promise.all(n.map((e=>e.json())))}},81242:(e,t,l)=>{l.d(t,{A:()=>S});var a=l(65043),s=l(32952),n=l(61072),o=l(78602),i=l(14282),r=l(77918),c=l(93747),d=l(58387),u=l(75758),m=l(88060),h=l(8868),p=l(28676),v=l(74532),g=l(72052),f=l(18226),x=l(93740);const b={headerTitle:"send-email_headerTitle__50KUB",customLabel:"send-email_customLabel__r5xED",templateInfo:"send-email_templateInfo__mWkVT",bag:"send-email_bag__wtdwK",lable:"send-email_lable__+kNCa",dropdownSelect:"send-email_dropdownSelect__RY5w8",autoCompleteBox:"send-email_autoCompleteBox__fWZ7C",AutoComplete:"send-email_AutoComplete__m9YI5",bcc:"send-email_bcc__BwFzl",box:"send-email_box__Zlmer",active:"send-email_active__vEx4h",inputBox:"send-email_inputBox__NpU2b"};var j=l(81047),w=l(70579);const y=(0,w.jsxs)("span",{className:"ql-formats",children:[(0,w.jsx)("button",{className:"ql-bold","aria-label":"Bold"}),(0,w.jsx)("button",{className:"ql-italic","aria-label":"Italic"}),(0,w.jsx)("button",{className:"ql-underline","aria-label":"Underline"}),(0,w.jsx)("button",{className:"ql-strike","aria-label":"Strikethrough"}),(0,w.jsx)("button",{className:"ql-blockquote","aria-label":"Blockquote"}),(0,w.jsx)("button",{className:"ql-list",value:"ordered","aria-label":"Ordered List"}),(0,w.jsx)("button",{className:"ql-list",value:"bullet","aria-label":"Bullet List"}),(0,w.jsx)("button",{className:"ql-align",value:"","aria-label":"Align Left"}),(0,w.jsx)("button",{className:"ql-align",value:"center","aria-label":"Align Center"}),(0,w.jsx)("button",{className:"ql-align",value:"right","aria-label":"Align Right"}),(0,w.jsx)("button",{className:"ql-align",value:"justify","aria-label":"Justify"}),(0,w.jsx)("button",{className:"ql-link","aria-label":"Insert Link"}),(0,w.jsx)("button",{className:"ql-image","aria-label":"Insert Image"}),(0,w.jsx)("button",{className:"ql-code-block","aria-label":"Code Block"})]}),S=e=>{var t,l,S,C;let{show:N,setShow:$,mutation:A,contactPersons:T,setPayload:_,defaultTemplateId:E,isAddingContact:k=!1}=e;const L=(0,a.useRef)(null),I=JSON.parse(window.localStorage.getItem("profileData")||"{}"),[B,P]=(0,a.useState)(""),[U,q]=(0,a.useState)([]),[O,R]=(0,a.useState)([]),[F,z]=(0,a.useState)([]),[H,K]=(0,a.useState)(null),[G,J]=(0,a.useState)(null),[D,M]=(0,a.useState)(null),[Q,W]=(0,a.useState)({}),[Z,V]=(0,a.useState)([]),Y=(0,a.useRef)(null),X=(0,a.useRef)(null),ee=(0,a.useRef)(null),[te,le]=(0,a.useState)(!1),[ae,se]=(0,a.useState)(!1),ne=(0,a.useCallback)((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())),[]),oe=(0,a.useCallback)((e=>!e||0===e.length||e.every((e=>ne(e)))),[ne]),ie=(0,a.useCallback)((e=>e&&0!==e.length?e.filter((e=>!ne(e))):[]),[ne]),re=(0,a.useCallback)((e=>e&&0!==e.length?e.filter((e=>ne(e))):[]),[ne]),ce=(0,a.useCallback)((()=>{let e=!1;if(U.length>0){const t=ie(U);t.length>0&&(console.log("Found invalid TO emails:",t),q(re(U)),e=!0)}if(O.length>0){const t=ie(O);t.length>0&&(console.log("Found invalid CC emails:",t),R(re(O)),e=!0)}if(F.length>0){const t=ie(F);t.length>0&&(console.log("Found invalid BCC emails:",t),z(re(F)),e=!0)}return!e}),[U,O,F,ie,re]),[de,ue]=(0,a.useState)(null),me=()=>{$(!1),E||(P([]),q([]),R([]),z([]),K([]),J([]),ue(null))},he=(0,c.I)({queryKey:["emailTemplate"],queryFn:j.SQ,enabled:!!N}),pe=(0,c.I)({queryKey:["getSignatureTemplates"],queryFn:j.AO,enabled:!!N}),ve=(0,c.I)({queryKey:["getOutgoingEmail"],queryFn:j.hx,enabled:!!N}),ge=(0,c.I)({queryKey:["emailQuery",de],queryFn:()=>(0,j.hS)(de),enabled:!!de,retry:1});(0,a.useEffect)((()=>{var e,t,l;null!==ve&&void 0!==ve&&ve.data&&(null!==ve&&void 0!==ve&&null!==(e=ve.data)&&void 0!==e&&e.outgoing_email&&null!==ve&&void 0!==ve&&null!==(t=ve.data)&&void 0!==t&&t.outgoing_email_verified?P(null===ve||void 0===ve||null===(l=ve.data)||void 0===l?void 0:l.outgoing_email):P("no-reply@memate.com.au"));if(!de&&null!==he&&void 0!==he&&he.data&&E){var a;const e=null===he||void 0===he||null===(a=he.data)||void 0===a?void 0:a.find((e=>e.type===E));e&&ue(null===e||void 0===e?void 0:e.id)}}),[he,ve,E,de]);const fe=e=>{var t,l;const a=(null===e||void 0===e||null===(t=e.query)||void 0===t?void 0:t.toLowerCase())||"";let s=null===(l=T.map((e=>e.email)))||void 0===l?void 0:l.filter((e=>e));s=s.filter((e=>!U.includes(e))),s=s.filter((e=>!O.includes(e))),s=s.filter((e=>!F.includes(e))),s=s.filter((e=>e.toLowerCase().includes(a))),V(s)},xe=()=>{fe(),Y.current&&Y.current.show()},be=()=>{fe(),X.current&&X.current.show()},je=()=>{fe(),ee.current&&ee.current.show()};return(0,a.useEffect)((()=>{if(null!==T&&void 0!==T&&T.length){var e;let t=null===(e=T.map((e=>e.email)))||void 0===e?void 0:e.filter((e=>e));V(t)}}),[T]),(0,a.useEffect)((()=>{if(U.length>0){const e=ie(U);if(e.length>0){console.log("Auto-cleaning invalid TO emails:",e);const t=re(U);q(t)}}}),[U,ie,re]),(0,a.useEffect)((()=>{if(O.length>0){const e=ie(O);if(e.length>0){console.log("Auto-cleaning invalid CC emails:",e);const t=re(O);R(t)}}}),[O,ie,re]),(0,a.useEffect)((()=>{if(F.length>0){const e=ie(F);if(e.length>0){console.log("Auto-cleaning invalid BCC emails:",e);const t=re(F);z(t)}}}),[F,ie,re]),(0,a.useEffect)((()=>{_((e=>({...e,subject:H,email_body:G,from_email:B,to:null===U||void 0===U?void 0:U.toString(),...O.length>0&&{cc:O.toString()},...F.length>0&&{bcc:F.toString()},...D&&{signature:D}})))}),[H,G,B,U,O,F,D,_]),(0,a.useEffect)((()=>{var e,t;null!==pe&&void 0!==pe&&pe.data&&M(null===pe||void 0===pe||null===(e=pe.data)||void 0===e||null===(t=e.find((e=>e.id===I.email_signature)))||void 0===t?void 0:t.id)}),[null===pe||void 0===pe?void 0:pe.data,I.email_signature]),(0,a.useEffect)((()=>{var e,t;J((null===ge||void 0===ge||null===(e=ge.data)||void 0===e?void 0:e.body)||""),K(null===ge||void 0===ge||null===(t=ge.data)||void 0===t?void 0:t.subject),W((e=>({...e,subject:!1}))),W((e=>({...e,text:!1})))}),[null===ge||void 0===ge?void 0:ge.data]),(0,w.jsxs)(s.A,{show:N,centered:!0,onHide:me,className:"invoice-form",size:"lg",children:[(0,w.jsx)(s.A.Header,{closeButton:!0,children:(0,w.jsx)("div",{className:`${b.modalHeader}`,children:(0,w.jsx)("div",{className:"w-100 d-flex align-items-center gap-2",children:(0,w.jsx)("span",{className:`white-space-nowrap mt-2 mb-2 ${b.headerTitle}`,children:"Send email"})})})}),(0,w.jsxs)(s.A.Body,{children:[(0,w.jsxs)(n.A,{children:[(0,w.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"FROM"}),(0,w.jsx)(m.m,{options:ve&&(null===ve||void 0===ve?void 0:ve.data)&&[{value:null===ve||void 0===ve||null===(t=ve.data)||void 0===t?void 0:t.outgoing_email,label:`${null===ve||void 0===ve||null===(l=ve.data)||void 0===l?void 0:l.outgoing_email}`}]||[],className:(0,d.A)(b.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"60px"},placeholder:"Select from email",onChange:e=>{P(e.value),W((e=>({...e,from:!1})))},value:B,filterInputAutoFocus:!0})]}),(null===Q||void 0===Q?void 0:Q.from)&&(0,w.jsx)("p",{className:"error-message mb-0",children:"From email is required"})]}),(0,w.jsx)(o.A,{sm:6,className:"mb-3",children:(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"Templates"}),(0,w.jsx)(m.m,{options:he&&(null===(S=he.data)||void 0===S?void 0:S.map((e=>({value:e.id,label:`${e.name}`}))))||[],className:(0,d.A)(b.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select template",onChange:e=>{ue(e.value)},value:de,loading:null===he||void 0===he?void 0:he.isFetching,filterInputAutoFocus:!0}),(0,w.jsx)("div",{className:b.templateInfo,onClick:e=>L.current.toggle(e),children:(0,w.jsx)(r.A,{size:16,color:"#737374ff"})}),(0,w.jsxs)(f.j,{ref:L,children:[(0,w.jsx)("p",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:"Choose from your existing templates here."}),(0,w.jsxs)("div",{className:"font-12",style:{color:"#344054",lineHeight:"18px"},children:["To edit or add new templates, go to",(0,w.jsx)("br",{})," Profile Settings > Templates > Email",(0,w.jsx)("br",{})," Templates."]})]})]})})]}),(0,w.jsxs)(n.A,{children:[(0,w.jsxs)(o.A,{sm:12,className:"mb-3",children:[(0,w.jsxs)("div",{className:"d-flex gap-3 w-100",children:[(0,w.jsxs)("div",{style:{position:"relative"},className:b.autoCompleteBox,children:[(0,w.jsx)("div",{style:{width:"50px"},className:b.bag}),(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"TO"}),(0,w.jsx)(u.j,{ref:Y,value:U,completeMethod:fe,onChange:e=>{q(e.value),W((e=>({...e,to:!1,toInvalid:!1})))},multiple:!0,suggestions:Z,onClick:xe,onFocus:xe,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e)),a=l.filter((e=>ne(e)));q((e=>[...new Set([...e,...a])])),a.length===l.length&&a.length>0&&W((e=>({...e,to:!1,toInvalid:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(q((e=>[...new Set([...e,t])])),W((e=>({...e,to:!1,toInvalid:!1})))):W((e=>({...e,toInvalid:!0}))),e.target.value="")},className:(0,d.A)(b.AutoComplete,"w-100"),placeholder:"TO"})]}),(0,w.jsx)(i.A,{className:(0,d.A)(b.box,{[b.active]:te}),onClick:()=>{le(!te),R([])},children:"CC"}),(0,w.jsx)(i.A,{className:(0,d.A)(b.box,{[b.active]:ae}),onClick:()=>{se(!ae),z([])},children:"BCC"})]}),(null===Q||void 0===Q?void 0:Q.to)&&!(null!==Q&&void 0!==Q&&Q.toInvalid)&&(0,w.jsx)("p",{className:"error-message mb-0",children:"To email is required"}),(null===Q||void 0===Q?void 0:Q.toInvalid)&&(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for TO"}),(null===Q||void 0===Q?void 0:Q.invalidToEmails)&&Q.invalidToEmails.length>0&&(0,w.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidToEmails.join(", ")]})]})]}),te&&(0,w.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("div",{style:{width:"50px"},className:b.bag}),(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"CC"}),(0,w.jsx)(u.j,{ref:X,value:O,completeMethod:fe,onChange:e=>{R(e.value),W((e=>({...e,cc:!1})))},multiple:!0,suggestions:Z,onClick:be,onFocus:be,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e)),a=l.filter((e=>ne(e)));R((e=>[...new Set([...e,...a])])),a.length===l.length&&W((e=>({...e,cc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(R((e=>[...new Set([...e,t])])),W((e=>({...e,cc:!1})))):W((e=>({...e,cc:!0}))),e.target.value="")},className:(0,d.A)(b.AutoComplete,"w-100"),placeholder:"CC"})]}),(null===Q||void 0===Q?void 0:Q.cc)&&(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for CC"}),(null===Q||void 0===Q?void 0:Q.invalidCcEmails)&&Q.invalidCcEmails.length>0&&(0,w.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidCcEmails.join(", ")]})]})]}),ae&&(0,w.jsxs)(o.A,{sm:6,className:"mb-3",children:[(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("div",{style:{width:"60px"},className:b.bag}),(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"BCC"}),(0,w.jsx)(u.j,{ref:ee,value:F,completeMethod:fe,onChange:e=>{z(e.value),W((e=>({...e,bcc:!1})))},multiple:!0,suggestions:Z,onClick:je,onFocus:je,onKeyUp:e=>{const t=e.target.value;if(t.includes(",")||"Enter"===e.key){const l=t.split(/[\s,]+/).filter((e=>e)),a=l.filter((e=>ne(e)));z((e=>[...new Set([...e,...a])])),a.length===l.length&&W((e=>({...e,bcc:!1}))),e.target.value=""}},onBlur:e=>{const t=e.target.value.trim();t&&(ne(t)?(z((e=>[...new Set([...e,t])])),W((e=>({...e,bcc:!1})))):W((e=>({...e,bcc:!0}))),e.target.value="")},className:(0,d.A)(b.AutoComplete,b.bcc,"w-100"),placeholder:"BCC"})]}),(null===Q||void 0===Q?void 0:Q.bcc)&&(0,w.jsxs)("div",{children:[(0,w.jsx)("p",{className:"error-message mb-0",children:"Please enter valid email addresses for BCC"}),(null===Q||void 0===Q?void 0:Q.invalidBccEmails)&&Q.invalidBccEmails.length>0&&(0,w.jsxs)("p",{className:"error-message mb-0 mt-1",style:{fontSize:"12px",color:"#dc3545"},children:["Invalid emails: ",Q.invalidBccEmails.join(", ")]})]})]}),(0,w.jsxs)(o.A,{sm:12,className:"mb-2",children:[(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("div",{style:{width:"60px"},className:b.bag}),(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"SUBJECT"}),(0,w.jsxs)(p.C,{children:[(0,w.jsx)(v.m,{children:(null===ge||void 0===ge?void 0:ge.isFetching)&&(0,w.jsx)(x.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,w.jsx)(g.S,{value:H,className:(0,d.A)(b.inputBox,"w-100"),style:{paddingLeft:"100px"},onChange:e=>{K(e.target.value),W((e=>({...e,subject:!1})))},placeholder:"{Organization} | Quotation: {number} | {reference}"})]})]}),(null===Q||void 0===Q?void 0:Q.subject)&&(0,w.jsx)("p",{className:"error-message mb-0",children:"Subject is required"})]}),(0,w.jsxs)(o.A,{sm:12,className:"mb-3",children:[(0,w.jsxs)("div",{className:"d-flex flex-column gap-1",style:{position:"relative"},children:[(0,w.jsx)("label",{className:(0,d.A)(b.lable),children:"Message"}),(0,w.jsx)(v.m,{style:{position:"absolute",right:"15px",top:"40px",zIndex:1},children:(null===ge||void 0===ge?void 0:ge.isFetching)&&(0,w.jsx)(x.p,{style:{width:"20px",height:"20px",position:"relative",top:"-5px"}})}),(0,w.jsx)(h.K,{style:{minHeight:"150px"},headerTemplate:y,value:G,placeholder:"Enter a description...",onTextChange:e=>{J(e.htmlValue),W((e=>({...e,text:!1})))}})]}),(null===Q||void 0===Q?void 0:Q.text)&&(0,w.jsx)("p",{className:"error-message mb-0",children:"Message is required"})]}),(0,w.jsx)(o.A,{sm:12,children:(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)("label",{className:(0,d.A)(b.customLabel),children:"Signature"}),(0,w.jsx)(m.m,{options:pe&&(null===(C=pe.data)||void 0===C?void 0:C.map((e=>({value:e.id,label:`${e.name}`}))))||[],panelClassName:"px880-dropdown-item",className:(0,d.A)(b.dropdownSelect,"dropdown-height-fixed w-100"),style:{height:"46px",paddingLeft:"88px"},placeholder:"Select signature",onChange:e=>{M(e.value)},value:D,loading:null===pe||void 0===pe?void 0:pe.isFetching,filterInputAutoFocus:!0})]})})]})]}),(0,w.jsxs)(s.A.Footer,{className:"d-flex justify-content-between",children:[(0,w.jsx)("span",{}),(0,w.jsxs)("div",{className:"d-flex justify-content-end gap-2",children:[(0,w.jsxs)(i.A,{className:"outline-button",onClick:me,children:["Cancel"," "]}),(0,w.jsxs)(i.A,{disabled:null===A||void 0===A?void 0:A.isPending,className:"solid-button",onClick:async()=>{let e=0;W({});if(ce()||console.log("Some emails were invalid and have been cleaned"),B||(++e,W((e=>({...e,from:!0})))),0===(null===U||void 0===U?void 0:U.length))++e,W((e=>({...e,to:!0})));else if(!oe(U)){++e;const t=ie(U);console.log("Invalid TO emails:",t),W((e=>({...e,to:!0,toInvalid:!0,invalidToEmails:t})))}if(O.length>0&&!oe(O)){++e;const t=ie(O);console.log("Invalid CC emails:",t),W((e=>({...e,cc:!0,invalidCcEmails:t})))}if(F.length>0&&!oe(F)){++e;const t=ie(F);console.log("Invalid BCC emails:",t),W((e=>({...e,bcc:!0,invalidBccEmails:t})))}H||(++e,W((e=>({...e,subject:!0})))),G||(++e,W((e=>({...e,text:!0})))),e||A.mutate({subject:H,email_body:G,from_email:B,to:null===U||void 0===U?void 0:U.toString(),...O.length>0&&{cc:O.toString()},...F.length>0&&{bcc:F.toString()},...D&&{signature:D}})},children:["Send"," ",((null===A||void 0===A?void 0:A.isPending)||k)&&(0,w.jsx)(x.p,{style:{width:"20px",height:"20px",color:"#fff"}})]})]})]})]})}}}]);
//# sourceMappingURL=9927.91e6c2fd.chunk.js.map